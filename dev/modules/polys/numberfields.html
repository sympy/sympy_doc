
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>Number Fields &#8212; SymPy 1.10.dev documentation</title>
    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/default.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/graphviz.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/plot_directive.css" />
    <link rel="stylesheet" type="text/css" href="https://live.sympy.org/static/live-core.css" />
    <link rel="stylesheet" type="text/css" href="https://live.sympy.org/static/live-autocomplete.css" />
    <link rel="stylesheet" type="text/css" href="https://live.sympy.org/static/live-sphinx.css" />
    
    <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/jquery.js"></script>
    <script src="../../_static/underscore.js"></script>
    <script src="../../_static/doctools.js"></script>
    <script src="https://live.sympy.org/static/utilities.js"></script>
    <script src="https://live.sympy.org/static/external/classy.js"></script>
    <script src="https://live.sympy.org/static/live-core.js"></script>
    <script src="https://live.sympy.org/static/live-autocomplete.js"></script>
    <script src="https://live.sympy.org/static/live-sphinx.js"></script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>window.MathJax = {"tex": {"inlineMath": [["\\(", "\\)"]], "displayMath": [["\\[", "\\]"]]}}</script>
    
    <link rel="shortcut icon" href="../../_static/sympy-notailtext-favicon.ico"/>
    <link href="https://docs.sympy.org/latest/modules/polys/numberfields.html" rel="canonical" />
    
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Printing" href="../printing.html" />
    <link rel="prev" title="Introducing the domainmatrix of the poly module" href="domainmatrix.html" /> 
  </head><body>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="../printing.html" title="Printing"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="domainmatrix.html" title="Introducing the domainmatrix of the poly module"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../../index.html">SymPy 1.10.dev documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="../../reference/index.html" >Reference</a> &#187;</li>
          <li class="nav-item nav-item-2"><a href="../index.html" >SymPy Modules Reference</a> &#187;</li>
          <li class="nav-item nav-item-3"><a href="index.html" accesskey="U">Polynomial Manipulation</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">Number Fields</a></li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <section id="number-fields">
<span id="polys-numberfields"></span><h1>Number Fields<a class="headerlink" href="#number-fields" title="Permalink to this headline">¶</a></h1>
<section id="introduction">
<h2>Introduction<a class="headerlink" href="#introduction" title="Permalink to this headline">¶</a></h2>
<blockquote>
<div><p>Like many other computations in algebraic number theory, the splitting of
rational primes can be treated by <em>rational</em> methods only. This fact is very
important if computation by automatic computing machinery is considered. Only
the knowledge of the irreducible polynomial <span class="math notranslate nohighlight">\(f(x)\)</span>, a zero of which generates
the field in question, is needed.</p>
<blockquote>
<div><p>Olga Taussky, 1953</p>
</div></blockquote>
</div></blockquote>
<p>Concepts like number fields and algebraic numbers are essential to our
understanding of algebraic number theory, but to the computer the subject is
all about polynomials: the ring <span class="math notranslate nohighlight">\(\mathbb{Q}[x]\)</span> reduced modulo irreducible
polynomials <span class="math notranslate nohighlight">\(f(x) \in \mathbb{Q}[x]\)</span>. It thus finds a natural home under the
<a class="reference internal" href="reference.html#module-sympy.polys" title="sympy.polys"><code class="xref py py-mod docutils literal notranslate"><span class="pre">polys</span></code></a> module in SymPy.</p>
<p>Various authors (such as Taussky, Zimmer, Pohst and Zassenhaus, or Cohen)
have articulated the main goals of computational algebraic number theory in
different ways, but invariably the list centers around a certain essential set
of tasks. As a goal for the <code class="docutils literal notranslate"><span class="pre">numberfields</span></code> module in SymPy, we may set the
following list, based on <a class="reference internal" href="literature.html#cohen93" id="id1"><span>[Cohen93]</span></a>, Sec. 4.9.3.</p>
<p>For a number field <span class="math notranslate nohighlight">\(K = \mathbb{Q}(\theta)\)</span>, whose ring of algebraic integers
is denoted <span class="math notranslate nohighlight">\(\mathbb{Z}_K\)</span>, compute:</p>
<ol class="arabic simple">
<li><p>an integral basis of <span class="math notranslate nohighlight">\(\mathbb{Z}_K\)</span></p></li>
<li><p>the decomposition of rational primes in <span class="math notranslate nohighlight">\(\mathbb{Z}_K\)</span></p></li>
<li><p><span class="math notranslate nohighlight">\(\mathfrak{p}\)</span>-adic valuations for ideals and elements</p></li>
<li><p>the Galois group of the Galois closure of <span class="math notranslate nohighlight">\(K\)</span></p></li>
<li><p>a system of fundamental units of <span class="math notranslate nohighlight">\(K\)</span></p></li>
<li><p>the regulator <span class="math notranslate nohighlight">\(R(K)\)</span></p></li>
<li><p>the class number</p></li>
<li><p>the structure of the class group <span class="math notranslate nohighlight">\(Cl(K)\)</span></p></li>
<li><p>decide whether a given ideal is principal, and if so compute a generator.</p></li>
</ol>
<p>As a foundation, and to support our basic ability to define and work with
number fields and algebraic numbers, we also set the following problems,
following <a class="reference internal" href="literature.html#cohen93" id="id2"><span>[Cohen93]</span></a>, Sec. 4.5.</p>
<ol class="arabic simple" start="10">
<li><p>Given an algebraic number – expressed by radicals and rational operations,
or even as a special value of a transcendental function – determine its
minimal polynomial over <span class="math notranslate nohighlight">\(\mathbb{Q}\)</span>.</p></li>
<li><p>The Subfield Problem: Given two number fields <span class="math notranslate nohighlight">\(\mathbb{Q}(\alpha)\)</span>,
<span class="math notranslate nohighlight">\(\mathbb{Q}(\beta)\)</span> via the minimal polynomials for their generators
<span class="math notranslate nohighlight">\(\alpha\)</span> and <span class="math notranslate nohighlight">\(\beta\)</span>, decide whether one field is isomorphic to a subfield
of the other, and if so exhibit an embedding.</p></li>
<li><p>The Field Membership Problem: Given two algebraic numbers <span class="math notranslate nohighlight">\(\alpha\)</span>,
<span class="math notranslate nohighlight">\(\beta\)</span>, decide whether <span class="math notranslate nohighlight">\(\alpha \in \mathbb{Q}(\beta)\)</span>, and if so write
<span class="math notranslate nohighlight">\(\alpha = f(\beta)\)</span> for some <span class="math notranslate nohighlight">\(f(x) \in \mathbb{Q}[x]\)</span>.</p></li>
<li><p>The Primitive Element Problem: Given several algebraic numbers
<span class="math notranslate nohighlight">\(\alpha_1, \ldots, \alpha_m\)</span>, compute a single algebraic number <span class="math notranslate nohighlight">\(\theta\)</span>
such that <span class="math notranslate nohighlight">\(\mathbb{Q}(\alpha_1, \ldots, \alpha_m) = \mathbb{Q}(\theta)\)</span>.</p></li>
</ol>
<p>At present only a subset of the tasks enumerated above is yet supported in
SymPy, and if you are interested in expanding support, you are encouraged to
contribute! An excellent source, providing solutions to all the remaining
problems (as well as those already solved) is <a class="reference internal" href="literature.html#cohen93" id="id3"><span>[Cohen93]</span></a>.</p>
<p>At time of writing, the existing solutions to the above problems are found
in the following places:</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 46%" />
<col style="width: 54%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Task</p></th>
<th class="head"><p>Implementation</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><ol class="arabic simple">
<li><p>integral basis</p></li>
</ol>
</td>
<td><p><a class="reference internal" href="#sympy.polys.numberfields.basis.round_two" title="sympy.polys.numberfields.basis.round_two"><code class="xref py py-func docutils literal notranslate"><span class="pre">round_two()</span></code></a></p></td>
</tr>
<tr class="row-odd"><td><ol class="arabic simple" start="2">
<li><p>prime decomposition</p></li>
</ol>
</td>
<td><p><a class="reference internal" href="#sympy.polys.numberfields.primes.prime_decomp" title="sympy.polys.numberfields.primes.prime_decomp"><code class="xref py py-func docutils literal notranslate"><span class="pre">prime_decomp()</span></code></a></p></td>
</tr>
<tr class="row-even"><td><ol class="arabic simple" start="3">
<li><p><span class="math notranslate nohighlight">\(\mathfrak{p}\)</span>-adic valuation</p></li>
</ol>
</td>
<td><p><a class="reference internal" href="#sympy.polys.numberfields.primes.prime_valuation" title="sympy.polys.numberfields.primes.prime_valuation"><code class="xref py py-func docutils literal notranslate"><span class="pre">prime_valuation()</span></code></a></p></td>
</tr>
<tr class="row-odd"><td><ol class="arabic simple" start="10">
<li><p>find minimal polynomial</p></li>
</ol>
</td>
<td><p><a class="reference internal" href="#sympy.polys.numberfields.minpoly.minimal_polynomial" title="sympy.polys.numberfields.minpoly.minimal_polynomial"><code class="xref py py-func docutils literal notranslate"><span class="pre">minimal_polynomial()</span></code></a></p></td>
</tr>
<tr class="row-even"><td><ol class="arabic simple" start="11">
<li><p>subfield</p></li>
</ol>
</td>
<td><p><a class="reference internal" href="#sympy.polys.numberfields.subfield.field_isomorphism" title="sympy.polys.numberfields.subfield.field_isomorphism"><code class="xref py py-func docutils literal notranslate"><span class="pre">field_isomorphism()</span></code></a></p></td>
</tr>
<tr class="row-odd"><td><ol class="arabic simple" start="12">
<li><p>field membership</p></li>
</ol>
</td>
<td><p><a class="reference internal" href="#sympy.polys.numberfields.subfield.to_number_field" title="sympy.polys.numberfields.subfield.to_number_field"><code class="xref py py-func docutils literal notranslate"><span class="pre">to_number_field()</span></code></a></p></td>
</tr>
<tr class="row-even"><td><ol class="arabic simple" start="13">
<li><p>primitive element</p></li>
</ol>
</td>
<td><p><a class="reference internal" href="#sympy.polys.numberfields.subfield.primitive_element" title="sympy.polys.numberfields.subfield.primitive_element"><code class="xref py py-func docutils literal notranslate"><span class="pre">primitive_element()</span></code></a></p></td>
</tr>
</tbody>
</table>
</section>
<section id="solving-the-main-problems">
<h2>Solving the Main Problems<a class="headerlink" href="#solving-the-main-problems" title="Permalink to this headline">¶</a></h2>
<section id="integral-basis">
<h3>Integral Basis<a class="headerlink" href="#integral-basis" title="Permalink to this headline">¶</a></h3>
<span class="target" id="integralbasis"></span><dl class="py function">
<dt class="sig sig-object py" id="sympy.polys.numberfields.basis.round_two">
<span class="sig-prename descclassname"><span class="pre">sympy.polys.numberfields.basis.</span></span><span class="sig-name descname"><span class="pre">round_two</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">T</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">radicals</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/sympy/sympy/blob/180fe9384a7cd4c51be1b26da453d299219e02ec/sympy/polys/numberfields/basis.py#L94-L243"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sympy.polys.numberfields.basis.round_two" title="Permalink to this definition">¶</a></dt>
<dd><p>Zassenhaus’s “Round 2” algorithm.</p>
<dl class="field-list">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>T</strong> : <a class="reference internal" href="reference.html#sympy.polys.polytools.Poly" title="sympy.polys.polytools.Poly"><code class="xref py py-class docutils literal notranslate"><span class="pre">Poly</span></code></a></p>
<blockquote>
<div><p>The irreducible monic polynomial over <a class="reference internal" href="domainsref.html#zz"><span class="std std-ref">ZZ</span></a> defining the number
field.</p>
</div></blockquote>
<p><strong>radicals</strong> : dict, optional</p>
<blockquote>
<div><p>This is a way for any <span class="math notranslate nohighlight">\(p\)</span>-radicals (if computed) to be returned by
reference. If desired, pass an empty dictionary. If the algorithm
reaches the point where it computes the nilradical mod <span class="math notranslate nohighlight">\(p\)</span> of the ring
of integers <span class="math notranslate nohighlight">\(Z_K\)</span>, then an <span class="math notranslate nohighlight">\(\mathbb{F}_p\)</span>-basis for this ideal will be
stored in this dictionary under the key <code class="docutils literal notranslate"><span class="pre">p</span></code>. This can be useful for
other algorithms, such as prime decomposition.</p>
</div></blockquote>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Pair <code class="docutils literal notranslate"><span class="pre">(ZK,</span> <span class="pre">dK)</span></code>, where:</p>
<blockquote>
<div><p><code class="docutils literal notranslate"><span class="pre">ZK</span></code> is a <a class="reference internal" href="#sympy.polys.numberfields.modules.Submodule" title="sympy.polys.numberfields.modules.Submodule"><code class="xref py py-class docutils literal notranslate"><span class="pre">Submodule</span></code></a>
representing the maximal order.</p>
<p><code class="docutils literal notranslate"><span class="pre">dK</span></code> is the discriminant of the field <span class="math notranslate nohighlight">\(K = \mathbb{Q}[x]/(T(x))\)</span>.</p>
</div></blockquote>
</dd>
</dl>
<p class="rubric">Explanation</p>
<p>Carry out Zassenhaus’s “Round 2” algorithm on a monic irreducible
polynomial <em>T</em> over <a class="reference internal" href="domainsref.html#zz"><span class="std std-ref">ZZ</span></a>. This computes an integral basis and the
discriminant for the field <span class="math notranslate nohighlight">\(K = \mathbb{Q}[x]/(T(x))\)</span>.</p>
<p>Ordinarily this function need not be called directly, as one can instead
access the <a class="reference internal" href="domainsref.html#sympy.polys.domains.AlgebraicField.maximal_order" title="sympy.polys.domains.AlgebraicField.maximal_order"><code class="xref py py-meth docutils literal notranslate"><span class="pre">maximal_order()</span></code></a>,
<a class="reference internal" href="domainsref.html#sympy.polys.domains.AlgebraicField.integral_basis" title="sympy.polys.domains.AlgebraicField.integral_basis"><code class="xref py py-meth docutils literal notranslate"><span class="pre">integral_basis()</span></code></a>, and
<a class="reference internal" href="domainsref.html#sympy.polys.domains.AlgebraicField.discriminant" title="sympy.polys.domains.AlgebraicField.discriminant"><code class="xref py py-meth docutils literal notranslate"><span class="pre">discriminant()</span></code></a> methods of an
<a class="reference internal" href="domainsref.html#sympy.polys.domains.AlgebraicField" title="sympy.polys.domains.AlgebraicField"><code class="xref py py-class docutils literal notranslate"><span class="pre">AlgebraicField</span></code></a>.</p>
<p class="rubric">Examples</p>
<p>Working through an AlgebraicField:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sympy</span> <span class="kn">import</span> <span class="n">Poly</span><span class="p">,</span> <span class="n">QQ</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sympy.abc</span> <span class="kn">import</span> <span class="n">x</span><span class="p">,</span> <span class="n">theta</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">T</span> <span class="o">=</span> <span class="n">Poly</span><span class="p">(</span><span class="n">x</span> <span class="o">**</span> <span class="mi">3</span> <span class="o">+</span> <span class="n">x</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">-</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">x</span> <span class="o">+</span> <span class="mi">8</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">K</span> <span class="o">=</span> <span class="n">QQ</span><span class="o">.</span><span class="n">algebraic_field</span><span class="p">((</span><span class="n">T</span><span class="p">,</span> <span class="n">theta</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">K</span><span class="o">.</span><span class="n">maximal_order</span><span class="p">())</span>
<span class="go">Submodule[[2, 0, 0], [0, 2, 0], [0, 1, 1]]/2</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">K</span><span class="o">.</span><span class="n">discriminant</span><span class="p">())</span>
<span class="go">-503</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">([</span><span class="n">K</span><span class="o">.</span><span class="n">to_sympy</span><span class="p">(</span><span class="n">a</span><span class="p">)</span> <span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="n">K</span><span class="o">.</span><span class="n">integral_basis</span><span class="p">()])</span>
<span class="go">[1, theta, theta**2/2 + theta/2]</span>
</pre></div>
</div>
<p>Calling directly:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sympy</span> <span class="kn">import</span> <span class="n">Poly</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sympy.abc</span> <span class="kn">import</span> <span class="n">x</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sympy.polys.numberfields.basis</span> <span class="kn">import</span> <span class="n">round_two</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">T</span> <span class="o">=</span> <span class="n">Poly</span><span class="p">(</span><span class="n">x</span> <span class="o">**</span> <span class="mi">3</span> <span class="o">+</span> <span class="n">x</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">-</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">x</span> <span class="o">+</span> <span class="mi">8</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">round_two</span><span class="p">(</span><span class="n">T</span><span class="p">))</span>
<span class="go">(Submodule[[2, 0, 0], [0, 2, 0], [0, 1, 1]]/2, -503)</span>
</pre></div>
</div>
<p>The nilradicals mod <span class="math notranslate nohighlight">\(p\)</span> that are sometimes computed during the Round Two
algorithm may be useful in further calculations. Pass a dictionary under
<span class="math notranslate nohighlight">\(radicals\)</span> to receive these:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">T</span> <span class="o">=</span> <span class="n">Poly</span><span class="p">(</span><span class="n">x</span><span class="o">**</span><span class="mi">3</span> <span class="o">+</span> <span class="mi">3</span><span class="o">*</span><span class="n">x</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">5</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">rad</span> <span class="o">=</span> <span class="p">{}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ZK</span><span class="p">,</span> <span class="n">dK</span> <span class="o">=</span> <span class="n">round_two</span><span class="p">(</span><span class="n">T</span><span class="p">,</span> <span class="n">radicals</span><span class="o">=</span><span class="n">rad</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">rad</span><span class="p">)</span>
<span class="go">{3: Submodule[[-1, 1, 0], [-1, 0, 1]]}</span>
</pre></div>
</div>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="domainsref.html#sympy.polys.domains.AlgebraicField.maximal_order" title="sympy.polys.domains.AlgebraicField.maximal_order"><code class="xref py py-obj docutils literal notranslate"><span class="pre">AlgebraicField.maximal_order</span></code></a>, <a class="reference internal" href="domainsref.html#sympy.polys.domains.AlgebraicField.integral_basis" title="sympy.polys.domains.AlgebraicField.integral_basis"><code class="xref py py-obj docutils literal notranslate"><span class="pre">AlgebraicField.integral_basis</span></code></a>, <a class="reference internal" href="domainsref.html#sympy.polys.domains.AlgebraicField.discriminant" title="sympy.polys.domains.AlgebraicField.discriminant"><code class="xref py py-obj docutils literal notranslate"><span class="pre">AlgebraicField.discriminant</span></code></a></p>
</div>
<p class="rubric">References</p>
<dl class="citation">
<dt class="label" id="r706"><span class="brackets"><a class="fn-backref" href="#id4">R706</a></span></dt>
<dd><p>Cohen, H. <em>A Course in Computational Algebraic Number Theory.</em></p>
</dd>
</dl>
</dd></dl>

</section>
<section id="prime-decomposition">
<h3>Prime Decomposition<a class="headerlink" href="#prime-decomposition" title="Permalink to this headline">¶</a></h3>
<span class="target" id="primedecomposition"></span><dl class="py function">
<dt class="sig sig-object py" id="sympy.polys.numberfields.primes.prime_decomp">
<span class="sig-prename descclassname"><span class="pre">sympy.polys.numberfields.primes.</span></span><span class="sig-name descname"><span class="pre">prime_decomp</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">p</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">T</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ZK</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dK</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">radical</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/sympy/sympy/blob/180fe9384a7cd4c51be1b26da453d299219e02ec/sympy/polys/numberfields/primes.py#L681-L761"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sympy.polys.numberfields.primes.prime_decomp" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the decomposition of rational prime <em>p</em> in a number field.</p>
<dl class="field-list">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>p</strong> : int</p>
<blockquote>
<div><p>The rational prime whose decomposition is desired.</p>
</div></blockquote>
<p><strong>T</strong> : <a class="reference internal" href="reference.html#sympy.polys.polytools.Poly" title="sympy.polys.polytools.Poly"><code class="xref py py-class docutils literal notranslate"><span class="pre">Poly</span></code></a>, optional</p>
<blockquote>
<div><p>Monic irreducible polynomial defining the number field <span class="math notranslate nohighlight">\(K\)</span> in which to
factor. NOTE: at least one of <em>T</em> or <em>ZK</em> must be provided.</p>
</div></blockquote>
<p><strong>ZK</strong> : <a class="reference internal" href="#sympy.polys.numberfields.modules.Submodule" title="sympy.polys.numberfields.modules.Submodule"><code class="xref py py-class docutils literal notranslate"><span class="pre">Submodule</span></code></a>, optional</p>
<blockquote>
<div><p>The maximal order for <span class="math notranslate nohighlight">\(K\)</span>, if already known.
NOTE: at least one of <em>T</em> or <em>ZK</em> must be provided.</p>
</div></blockquote>
<p><strong>dK</strong> : int, optional</p>
<blockquote>
<div><p>The discriminant of the field <span class="math notranslate nohighlight">\(K\)</span>, if already known.</p>
</div></blockquote>
<p><strong>radical</strong> : <a class="reference internal" href="#sympy.polys.numberfields.modules.Submodule" title="sympy.polys.numberfields.modules.Submodule"><code class="xref py py-class docutils literal notranslate"><span class="pre">Submodule</span></code></a>, optional</p>
<blockquote>
<div><p>The nilradical mod <em>p</em> in the integers of <span class="math notranslate nohighlight">\(K\)</span>, if already known.</p>
</div></blockquote>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>List of <a class="reference internal" href="#sympy.polys.numberfields.primes.PrimeIdeal" title="sympy.polys.numberfields.primes.PrimeIdeal"><code class="xref py py-class docutils literal notranslate"><span class="pre">PrimeIdeal</span></code></a> instances.</p>
</dd>
</dl>
<p class="rubric">Explanation</p>
<p>Ordinarily this should be accessed through the
<a class="reference internal" href="domainsref.html#sympy.polys.domains.AlgebraicField.primes_above" title="sympy.polys.domains.AlgebraicField.primes_above"><code class="xref py py-meth docutils literal notranslate"><span class="pre">primes_above()</span></code></a> method of an
<a class="reference internal" href="domainsref.html#sympy.polys.domains.AlgebraicField" title="sympy.polys.domains.AlgebraicField"><code class="xref py py-class docutils literal notranslate"><span class="pre">AlgebraicField</span></code></a>.</p>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sympy</span> <span class="kn">import</span> <span class="n">Poly</span><span class="p">,</span> <span class="n">QQ</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sympy.abc</span> <span class="kn">import</span> <span class="n">x</span><span class="p">,</span> <span class="n">theta</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">T</span> <span class="o">=</span> <span class="n">Poly</span><span class="p">(</span><span class="n">x</span> <span class="o">**</span> <span class="mi">3</span> <span class="o">+</span> <span class="n">x</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">-</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">x</span> <span class="o">+</span> <span class="mi">8</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">K</span> <span class="o">=</span> <span class="n">QQ</span><span class="o">.</span><span class="n">algebraic_field</span><span class="p">((</span><span class="n">T</span><span class="p">,</span> <span class="n">theta</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">K</span><span class="o">.</span><span class="n">primes_above</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span>
<span class="go">[[ (2, x**2 + 1) e=1, f=1 ], [ (2, (x**2 + 3*x + 2)/2) e=1, f=1 ],</span>
<span class="go"> [ (2, (3*x**2 + 3*x)/2) e=1, f=1 ]]</span>
</pre></div>
</div>
<p class="rubric">References</p>
<dl class="citation">
<dt class="label" id="r707"><span class="brackets"><a class="fn-backref" href="#id5">R707</a></span></dt>
<dd><p>Cohen, H. <em>A Course in Computational Algebraic Number Theory.</em>
(See Algorithm 6.2.9.)</p>
</dd>
</dl>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="sympy.polys.numberfields.primes.PrimeIdeal">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">sympy.polys.numberfields.primes.</span></span><span class="sig-name descname"><span class="pre">PrimeIdeal</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ZK</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">p</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">alpha</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">f</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">e</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/sympy/sympy/blob/180fe9384a7cd4c51be1b26da453d299219e02ec/sympy/polys/numberfields/primes.py#L42-L330"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sympy.polys.numberfields.primes.PrimeIdeal" title="Permalink to this definition">¶</a></dt>
<dd><p>A prime ideal in a ring of algebraic integers.</p>
<dl class="py method">
<dt class="sig sig-object py" id="sympy.polys.numberfields.primes.PrimeIdeal.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ZK</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">p</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">alpha</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">f</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">e</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/sympy/sympy/blob/180fe9384a7cd4c51be1b26da453d299219e02ec/sympy/polys/numberfields/primes.py#L47-L71"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sympy.polys.numberfields.primes.PrimeIdeal.__init__" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>ZK</strong> : <a class="reference internal" href="#sympy.polys.numberfields.modules.Submodule" title="sympy.polys.numberfields.modules.Submodule"><code class="xref py py-class docutils literal notranslate"><span class="pre">Submodule</span></code></a></p>
<blockquote>
<div><p>The maximal order where this ideal lives.</p>
</div></blockquote>
<p><strong>p</strong> : int</p>
<blockquote>
<div><p>The rational prime this ideal divides.</p>
</div></blockquote>
<p><strong>alpha</strong> : <a class="reference internal" href="#sympy.polys.numberfields.modules.PowerBasisElement" title="sympy.polys.numberfields.modules.PowerBasisElement"><code class="xref py py-class docutils literal notranslate"><span class="pre">PowerBasisElement</span></code></a></p>
<blockquote>
<div><p>Such that the ideal is equal to <code class="docutils literal notranslate"><span class="pre">p*ZK</span> <span class="pre">+</span> <span class="pre">alpha*ZK</span></code>.</p>
</div></blockquote>
<p><strong>f</strong> : int</p>
<blockquote>
<div><p>The inertia degree.</p>
</div></blockquote>
<p><strong>e</strong> : int, <code class="docutils literal notranslate"><span class="pre">None</span></code>, optional</p>
<blockquote>
<div><p>The ramification index, if already known. If <code class="docutils literal notranslate"><span class="pre">None</span></code>, we will
compute it here.</p>
</div></blockquote>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sympy.polys.numberfields.primes.PrimeIdeal.__add__">
<span class="sig-name descname"><span class="pre">__add__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">other</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/sympy/sympy/blob/180fe9384a7cd4c51be1b26da453d299219e02ec/sympy/polys/numberfields/primes.py#L185-L196"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sympy.polys.numberfields.primes.PrimeIdeal.__add__" title="Permalink to this definition">¶</a></dt>
<dd><p>Convert to a <a class="reference internal" href="#sympy.polys.numberfields.modules.Submodule" title="sympy.polys.numberfields.modules.Submodule"><code class="xref py py-class docutils literal notranslate"><span class="pre">Submodule</span></code></a> and add to another
<a class="reference internal" href="#sympy.polys.numberfields.modules.Submodule" title="sympy.polys.numberfields.modules.Submodule"><code class="xref py py-class docutils literal notranslate"><span class="pre">Submodule</span></code></a>.</p>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="#sympy.polys.numberfields.primes.PrimeIdeal.as_submodule" title="sympy.polys.numberfields.primes.PrimeIdeal.as_submodule"><code class="xref py py-obj docutils literal notranslate"><span class="pre">as_submodule</span></code></a></p>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sympy.polys.numberfields.primes.PrimeIdeal.__mul__">
<span class="sig-name descname"><span class="pre">__mul__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">other</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/sympy/sympy/blob/180fe9384a7cd4c51be1b26da453d299219e02ec/sympy/polys/numberfields/primes.py#L200-L211"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sympy.polys.numberfields.primes.PrimeIdeal.__mul__" title="Permalink to this definition">¶</a></dt>
<dd><p>Convert to a <a class="reference internal" href="#sympy.polys.numberfields.modules.Submodule" title="sympy.polys.numberfields.modules.Submodule"><code class="xref py py-class docutils literal notranslate"><span class="pre">Submodule</span></code></a> and multiply by another
<a class="reference internal" href="#sympy.polys.numberfields.modules.Submodule" title="sympy.polys.numberfields.modules.Submodule"><code class="xref py py-class docutils literal notranslate"><span class="pre">Submodule</span></code></a> or a rational number.</p>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="#sympy.polys.numberfields.primes.PrimeIdeal.as_submodule" title="sympy.polys.numberfields.primes.PrimeIdeal.as_submodule"><code class="xref py py-obj docutils literal notranslate"><span class="pre">as_submodule</span></code></a></p>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sympy.polys.numberfields.primes.PrimeIdeal.as_submodule">
<span class="sig-name descname"><span class="pre">as_submodule</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference external" href="https://github.com/sympy/sympy/blob/180fe9384a7cd4c51be1b26da453d299219e02ec/sympy/polys/numberfields/primes.py#L119-L178"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sympy.polys.numberfields.primes.PrimeIdeal.as_submodule" title="Permalink to this definition">¶</a></dt>
<dd><p>Represent this prime ideal as a <a class="reference internal" href="#sympy.polys.numberfields.modules.Submodule" title="sympy.polys.numberfields.modules.Submodule"><code class="xref py py-class docutils literal notranslate"><span class="pre">Submodule</span></code></a>.</p>
<dl class="field-list">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p><a class="reference internal" href="#sympy.polys.numberfields.modules.Submodule" title="sympy.polys.numberfields.modules.Submodule"><code class="xref py py-class docutils literal notranslate"><span class="pre">Submodule</span></code></a></p>
<blockquote>
<div><p>Will be equal to <code class="docutils literal notranslate"><span class="pre">self.p</span> <span class="pre">*</span> <span class="pre">self.ZK</span> <span class="pre">+</span> <span class="pre">self.alpha</span> <span class="pre">*</span> <span class="pre">self.ZK</span></code>.</p>
</div></blockquote>
</dd>
</dl>
<p class="rubric">Explanation</p>
<p>The <a class="reference internal" href="#sympy.polys.numberfields.primes.PrimeIdeal" title="sympy.polys.numberfields.primes.PrimeIdeal"><code class="xref py py-class docutils literal notranslate"><span class="pre">PrimeIdeal</span></code></a> class serves to bundle information about
a prime ideal, such as its inertia degree, ramification index, and
two-generator representation, as well as to offer helpful methods like
<a class="reference internal" href="#sympy.polys.numberfields.primes.PrimeIdeal.valuation" title="sympy.polys.numberfields.primes.PrimeIdeal.valuation"><code class="xref py py-meth docutils literal notranslate"><span class="pre">valuation()</span></code></a> and
<a class="reference internal" href="#sympy.polys.numberfields.primes.PrimeIdeal.test_factor" title="sympy.polys.numberfields.primes.PrimeIdeal.test_factor"><code class="xref py py-meth docutils literal notranslate"><span class="pre">test_factor()</span></code></a>.</p>
<p>However, in order to be added and multiplied by other ideals or
rational numbers, it must first be converted into a
<a class="reference internal" href="#sympy.polys.numberfields.modules.Submodule" title="sympy.polys.numberfields.modules.Submodule"><code class="xref py py-class docutils literal notranslate"><span class="pre">Submodule</span></code></a>, which is a class that supports these
operations.</p>
<p>In many cases, the user need not perform this conversion deliberately,
since it is automatically performed by the arithmetic operator methods
<a class="reference internal" href="#sympy.polys.numberfields.primes.PrimeIdeal.__add__" title="sympy.polys.numberfields.primes.PrimeIdeal.__add__"><code class="xref py py-meth docutils literal notranslate"><span class="pre">__add__()</span></code></a> and <a class="reference internal" href="#sympy.polys.numberfields.primes.PrimeIdeal.__mul__" title="sympy.polys.numberfields.primes.PrimeIdeal.__mul__"><code class="xref py py-meth docutils literal notranslate"><span class="pre">__mul__()</span></code></a>.</p>
<p>Raising a <a class="reference internal" href="#sympy.polys.numberfields.primes.PrimeIdeal" title="sympy.polys.numberfields.primes.PrimeIdeal"><code class="xref py py-class docutils literal notranslate"><span class="pre">PrimeIdeal</span></code></a> to a non-negative integer power is
also supported.</p>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sympy</span> <span class="kn">import</span> <span class="n">Poly</span><span class="p">,</span> <span class="n">cyclotomic_poly</span><span class="p">,</span> <span class="n">prime_decomp</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">T</span> <span class="o">=</span> <span class="n">Poly</span><span class="p">(</span><span class="n">cyclotomic_poly</span><span class="p">(</span><span class="mi">7</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">P0</span> <span class="o">=</span> <span class="n">prime_decomp</span><span class="p">(</span><span class="mi">7</span><span class="p">,</span> <span class="n">T</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">P0</span><span class="o">**</span><span class="mi">6</span> <span class="o">==</span> <span class="mi">7</span><span class="o">*</span><span class="n">P0</span><span class="o">.</span><span class="n">ZK</span><span class="p">)</span>
<span class="go">True</span>
</pre></div>
</div>
<p>Note that, on both sides of the equation above, we had a
<a class="reference internal" href="#sympy.polys.numberfields.modules.Submodule" title="sympy.polys.numberfields.modules.Submodule"><code class="xref py py-class docutils literal notranslate"><span class="pre">Submodule</span></code></a>. In the next equation we recall that adding
ideals yields their GCD. This time, we need a deliberate conversion
to <a class="reference internal" href="#sympy.polys.numberfields.modules.Submodule" title="sympy.polys.numberfields.modules.Submodule"><code class="xref py py-class docutils literal notranslate"><span class="pre">Submodule</span></code></a> on the right:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">P0</span> <span class="o">+</span> <span class="mi">7</span><span class="o">*</span><span class="n">P0</span><span class="o">.</span><span class="n">ZK</span> <span class="o">==</span> <span class="n">P0</span><span class="o">.</span><span class="n">as_submodule</span><span class="p">())</span>
<span class="go">True</span>
</pre></div>
</div>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="#sympy.polys.numberfields.primes.PrimeIdeal.__add__" title="sympy.polys.numberfields.primes.PrimeIdeal.__add__"><code class="xref py py-obj docutils literal notranslate"><span class="pre">__add__</span></code></a>, <a class="reference internal" href="#sympy.polys.numberfields.primes.PrimeIdeal.__mul__" title="sympy.polys.numberfields.primes.PrimeIdeal.__mul__"><code class="xref py py-obj docutils literal notranslate"><span class="pre">__mul__</span></code></a></p>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sympy.polys.numberfields.primes.PrimeIdeal.pretty">
<span class="sig-name descname"><span class="pre">pretty</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">field_gen</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">just_gens</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/sympy/sympy/blob/180fe9384a7cd4c51be1b26da453d299219e02ec/sympy/polys/numberfields/primes.py#L73-L114"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sympy.polys.numberfields.primes.PrimeIdeal.pretty" title="Permalink to this definition">¶</a></dt>
<dd><p>Print a representation of this prime ideal.</p>
<dl class="field-list">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>field_gen</strong> : <a class="reference internal" href="../core.html#sympy.core.symbol.Symbol" title="sympy.core.symbol.Symbol"><code class="xref py py-class docutils literal notranslate"><span class="pre">Symbol</span></code></a>, <code class="docutils literal notranslate"><span class="pre">None</span></code>, optional (default=None)</p>
<blockquote>
<div><p>The symbol to use for the generator of the field. This will appear
in our representation of <code class="docutils literal notranslate"><span class="pre">self.alpha</span></code>. If <code class="docutils literal notranslate"><span class="pre">None</span></code>, we use the
variable of the defining polynomial of <code class="docutils literal notranslate"><span class="pre">self.ZK</span></code>.</p>
</div></blockquote>
<p><strong>just_gens</strong> : bool, optional (default=False)</p>
<blockquote>
<div><p>If <code class="docutils literal notranslate"><span class="pre">True</span></code>, just print the “(p, alpha)” part, showing “just the
generators” of the prime ideal. Otherwise, print a string of the
form “[ (p, alpha) e=…, f=… ]”, giving the ramification index
and inertia degree, along with the generators.</p>
</div></blockquote>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sympy</span> <span class="kn">import</span> <span class="n">cyclotomic_poly</span><span class="p">,</span> <span class="n">QQ</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sympy.abc</span> <span class="kn">import</span> <span class="n">x</span><span class="p">,</span> <span class="n">zeta</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">T</span> <span class="o">=</span> <span class="n">cyclotomic_poly</span><span class="p">(</span><span class="mi">7</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">K</span> <span class="o">=</span> <span class="n">QQ</span><span class="o">.</span><span class="n">algebraic_field</span><span class="p">((</span><span class="n">T</span><span class="p">,</span> <span class="n">zeta</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">P</span> <span class="o">=</span> <span class="n">K</span><span class="o">.</span><span class="n">primes_above</span><span class="p">(</span><span class="mi">11</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">P</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">pretty</span><span class="p">())</span>
<span class="go">[ (11, x**3 + 5*x**2 + 4*x - 1) e=1, f=3 ]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">P</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">pretty</span><span class="p">(</span><span class="n">field_gen</span><span class="o">=</span><span class="n">zeta</span><span class="p">))</span>
<span class="go">[ (11, zeta**3 + 5*zeta**2 + 4*zeta - 1) e=1, f=3 ]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">P</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">pretty</span><span class="p">(</span><span class="n">field_gen</span><span class="o">=</span><span class="n">zeta</span><span class="p">,</span> <span class="n">just_gens</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span>
<span class="go">(11, zeta**3 + 5*zeta**2 + 4*zeta - 1)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sympy.polys.numberfields.primes.PrimeIdeal.reduce_poly">
<span class="sig-name descname"><span class="pre">reduce_poly</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">f</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gen</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/sympy/sympy/blob/180fe9384a7cd4c51be1b26da453d299219e02ec/sympy/polys/numberfields/primes.py#L259-L330"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sympy.polys.numberfields.primes.PrimeIdeal.reduce_poly" title="Permalink to this definition">¶</a></dt>
<dd><p>Reduce a univariate <a class="reference internal" href="reference.html#sympy.polys.polytools.Poly" title="sympy.polys.polytools.Poly"><code class="xref py py-class docutils literal notranslate"><span class="pre">Poly</span></code></a> <em>f</em>, or an <a class="reference internal" href="../core.html#sympy.core.expr.Expr" title="sympy.core.expr.Expr"><code class="xref py py-class docutils literal notranslate"><span class="pre">Expr</span></code></a>
expressing the same, modulo this <a class="reference internal" href="#sympy.polys.numberfields.primes.PrimeIdeal" title="sympy.polys.numberfields.primes.PrimeIdeal"><code class="xref py py-class docutils literal notranslate"><span class="pre">PrimeIdeal</span></code></a>.</p>
<dl class="field-list">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>f</strong> : <a class="reference internal" href="reference.html#sympy.polys.polytools.Poly" title="sympy.polys.polytools.Poly"><code class="xref py py-class docutils literal notranslate"><span class="pre">Poly</span></code></a>, <a class="reference internal" href="../core.html#sympy.core.expr.Expr" title="sympy.core.expr.Expr"><code class="xref py py-class docutils literal notranslate"><span class="pre">Expr</span></code></a></p>
<blockquote>
<div><p>The univariate polynomial to be reduced.</p>
</div></blockquote>
<p><strong>gen</strong> : <a class="reference internal" href="../core.html#sympy.core.symbol.Symbol" title="sympy.core.symbol.Symbol"><code class="xref py py-class docutils literal notranslate"><span class="pre">Symbol</span></code></a>, None, optional (default=None)</p>
<blockquote>
<div><p>Symbol to use as the variable in the polynomials. If <em>f</em> is a
<a class="reference internal" href="reference.html#sympy.polys.polytools.Poly" title="sympy.polys.polytools.Poly"><code class="xref py py-class docutils literal notranslate"><span class="pre">Poly</span></code></a> or a non-constant <a class="reference internal" href="../core.html#sympy.core.expr.Expr" title="sympy.core.expr.Expr"><code class="xref py py-class docutils literal notranslate"><span class="pre">Expr</span></code></a>, this
replaces its variable. If <em>f</em> is a constant <a class="reference internal" href="../core.html#sympy.core.expr.Expr" title="sympy.core.expr.Expr"><code class="xref py py-class docutils literal notranslate"><span class="pre">Expr</span></code></a>,
then <em>gen</em> must be supplied.</p>
</div></blockquote>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><a class="reference internal" href="reference.html#sympy.polys.polytools.Poly" title="sympy.polys.polytools.Poly"><code class="xref py py-class docutils literal notranslate"><span class="pre">Poly</span></code></a>, <a class="reference internal" href="../core.html#sympy.core.expr.Expr" title="sympy.core.expr.Expr"><code class="xref py py-class docutils literal notranslate"><span class="pre">Expr</span></code></a></p>
<blockquote>
<div><p>Type is same as that of given <em>f</em>. If returning a
<a class="reference internal" href="reference.html#sympy.polys.polytools.Poly" title="sympy.polys.polytools.Poly"><code class="xref py py-class docutils literal notranslate"><span class="pre">Poly</span></code></a>, its domain will be the finite field
<span class="math notranslate nohighlight">\(\mathbb{F}_p\)</span>.</p>
</div></blockquote>
</dd>
<dt class="field-odd">Raises</dt>
<dd class="field-odd"><p><strong>GeneratorsNeeded</strong></p>
<blockquote>
<div><p>If <em>f</em> is a constant <a class="reference internal" href="../core.html#sympy.core.expr.Expr" title="sympy.core.expr.Expr"><code class="xref py py-class docutils literal notranslate"><span class="pre">Expr</span></code></a> and <em>gen</em> is <code class="docutils literal notranslate"><span class="pre">None</span></code>.</p>
</div></blockquote>
<p><strong>NotImplementedError</strong></p>
<blockquote>
<div><p>If <em>f</em> is other than <a class="reference internal" href="reference.html#sympy.polys.polytools.Poly" title="sympy.polys.polytools.Poly"><code class="xref py py-class docutils literal notranslate"><span class="pre">Poly</span></code></a> or <a class="reference internal" href="../core.html#sympy.core.expr.Expr" title="sympy.core.expr.Expr"><code class="xref py py-class docutils literal notranslate"><span class="pre">Expr</span></code></a>,
or is not univariate.</p>
</div></blockquote>
</dd>
</dl>
<p class="rubric">Explanation</p>
<p>If our second generator <span class="math notranslate nohighlight">\(\alpha\)</span> is zero, then we simply reduce the
coefficients of <em>f</em> mod the rational prime <span class="math notranslate nohighlight">\(p\)</span> lying under this ideal.</p>
<p>Otherwise we first reduce <em>f</em> mod <span class="math notranslate nohighlight">\(\alpha\)</span> (as a polynomial in the same
variable as <em>f</em>), and then mod <span class="math notranslate nohighlight">\(p\)</span>.</p>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sympy</span> <span class="kn">import</span> <span class="n">QQ</span><span class="p">,</span> <span class="n">cyclotomic_poly</span><span class="p">,</span> <span class="n">symbols</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">zeta</span> <span class="o">=</span> <span class="n">symbols</span><span class="p">(</span><span class="s1">&#39;zeta&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Phi</span> <span class="o">=</span> <span class="n">cyclotomic_poly</span><span class="p">(</span><span class="mi">7</span><span class="p">,</span> <span class="n">zeta</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">k</span> <span class="o">=</span> <span class="n">QQ</span><span class="o">.</span><span class="n">algebraic_field</span><span class="p">((</span><span class="n">Phi</span><span class="p">,</span> <span class="n">zeta</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">P</span> <span class="o">=</span> <span class="n">k</span><span class="o">.</span><span class="n">primes_above</span><span class="p">(</span><span class="mi">11</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">frp</span> <span class="o">=</span> <span class="n">P</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">B</span> <span class="o">=</span> <span class="p">[</span><span class="n">k</span><span class="o">.</span><span class="n">to_sympy</span><span class="p">(</span><span class="n">a</span><span class="p">)</span> <span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="n">k</span><span class="o">.</span><span class="n">integral_basis</span><span class="p">()]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">([</span><span class="n">frp</span><span class="o">.</span><span class="n">reduce_poly</span><span class="p">(</span><span class="n">b</span><span class="p">,</span> <span class="n">zeta</span><span class="p">)</span> <span class="k">for</span> <span class="n">b</span> <span class="ow">in</span> <span class="n">B</span><span class="p">])</span>
<span class="go">[1, zeta, zeta**2, -5*zeta**2 - 4*zeta + 1, -zeta**2 - zeta - 5,</span>
<span class="go"> 4*zeta**2 - zeta - 1]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sympy.polys.numberfields.primes.PrimeIdeal.test_factor">
<span class="sig-name descname"><span class="pre">test_factor</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference external" href="https://github.com/sympy/sympy/blob/180fe9384a7cd4c51be1b26da453d299219e02ec/sympy/polys/numberfields/primes.py#L221-L239"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sympy.polys.numberfields.primes.PrimeIdeal.test_factor" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute a test factor for this prime ideal.</p>
<p class="rubric">Explanation</p>
<p>Write <span class="math notranslate nohighlight">\(\mathfrak{p}\)</span> for this prime ideal, <span class="math notranslate nohighlight">\(p\)</span> for the rational prime
it divides. Then, for computing <span class="math notranslate nohighlight">\(\mathfrak{p}\)</span>-adic valuations it is
useful to have a number <span class="math notranslate nohighlight">\(\beta \in \mathbb{Z}_K\)</span> such that
<span class="math notranslate nohighlight">\(p/\mathfrak{p} = p \mathbb{Z}_K + \beta \mathbb{Z}_K\)</span>.</p>
<p>Essentially, this is the same as the number <span class="math notranslate nohighlight">\(\Psi\)</span> (or the “reagent”)
from Kummer’s 1847 paper (<em>Ueber die Zerlegung…</em>, Crelle vol. 35) in
which ideal divisors were invented.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sympy.polys.numberfields.primes.PrimeIdeal.valuation">
<span class="sig-name descname"><span class="pre">valuation</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">I</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/sympy/sympy/blob/180fe9384a7cd4c51be1b26da453d299219e02ec/sympy/polys/numberfields/primes.py#L241-L257"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sympy.polys.numberfields.primes.PrimeIdeal.valuation" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the <span class="math notranslate nohighlight">\(\mathfrak{p}\)</span>-adic valuation of integral ideal I at this
prime ideal.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>I</strong> : <a class="reference internal" href="#sympy.polys.numberfields.modules.Submodule" title="sympy.polys.numberfields.modules.Submodule"><code class="xref py py-class docutils literal notranslate"><span class="pre">Submodule</span></code></a></p>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="#sympy.polys.numberfields.primes.prime_valuation" title="sympy.polys.numberfields.primes.prime_valuation"><code class="xref py py-obj docutils literal notranslate"><span class="pre">prime_valuation</span></code></a></p>
</div>
</dd></dl>

</dd></dl>

</section>
<section id="p-adic-valuation">
<h3>p-adic Valuation<a class="headerlink" href="#p-adic-valuation" title="Permalink to this headline">¶</a></h3>
<span class="target" id="padicvaluation"></span><dl class="py function">
<dt class="sig sig-object py" id="sympy.polys.numberfields.primes.prime_valuation">
<span class="sig-prename descclassname"><span class="pre">sympy.polys.numberfields.primes.</span></span><span class="sig-name descname"><span class="pre">prime_valuation</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">I</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">P</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/sympy/sympy/blob/180fe9384a7cd4c51be1b26da453d299219e02ec/sympy/polys/numberfields/primes.py#L379-L468"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sympy.polys.numberfields.primes.prime_valuation" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the <em>P</em>-adic valuation for an integral ideal <em>I</em>.</p>
<dl class="field-list">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>I</strong> : <a class="reference internal" href="#sympy.polys.numberfields.modules.Submodule" title="sympy.polys.numberfields.modules.Submodule"><code class="xref py py-class docutils literal notranslate"><span class="pre">Submodule</span></code></a></p>
<blockquote>
<div><p>An integral ideal whose valuation is desired.</p>
</div></blockquote>
<p><strong>P</strong> : <a class="reference internal" href="#sympy.polys.numberfields.primes.PrimeIdeal" title="sympy.polys.numberfields.primes.PrimeIdeal"><code class="xref py py-class docutils literal notranslate"><span class="pre">PrimeIdeal</span></code></a></p>
<blockquote>
<div><p>The prime at which to compute the valuation.</p>
</div></blockquote>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>int</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sympy</span> <span class="kn">import</span> <span class="n">QQ</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sympy.abc</span> <span class="kn">import</span> <span class="n">theta</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sympy.polys</span> <span class="kn">import</span> <span class="n">cyclotomic_poly</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sympy.polys.numberfields</span> <span class="kn">import</span> <span class="n">prime_valuation</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">T</span> <span class="o">=</span> <span class="n">cyclotomic_poly</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">K</span> <span class="o">=</span> <span class="n">QQ</span><span class="o">.</span><span class="n">algebraic_field</span><span class="p">((</span><span class="n">T</span><span class="p">,</span> <span class="n">theta</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">P</span> <span class="o">=</span> <span class="n">K</span><span class="o">.</span><span class="n">primes_above</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ZK</span> <span class="o">=</span> <span class="n">K</span><span class="o">.</span><span class="n">maximal_order</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">prime_valuation</span><span class="p">(</span><span class="mi">25</span><span class="o">*</span><span class="n">ZK</span><span class="p">,</span> <span class="n">P</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span>
<span class="go">8</span>
</pre></div>
</div>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="#sympy.polys.numberfields.primes.PrimeIdeal.valuation" title="sympy.polys.numberfields.primes.PrimeIdeal.valuation"><code class="xref py py-obj docutils literal notranslate"><span class="pre">PrimeIdeal.valuation</span></code></a></p>
</div>
<p class="rubric">References</p>
<dl class="citation">
<dt class="label" id="r708"><span class="brackets"><a class="fn-backref" href="#id6">R708</a></span></dt>
<dd><p>Cohen, H. <em>A Course in Computational Algebraic Number Theory.</em>
(See Algorithm 4.8.17.)</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="finding-minimal-polynomials">
<h3>Finding Minimal Polynomials<a class="headerlink" href="#finding-minimal-polynomials" title="Permalink to this headline">¶</a></h3>
<span class="target" id="minimalpolynomials"></span><dl class="py function">
<dt class="sig sig-object py" id="sympy.polys.numberfields.minpoly.minimal_polynomial">
<span class="sig-prename descclassname"><span class="pre">sympy.polys.numberfields.minpoly.</span></span><span class="sig-name descname"><span class="pre">minimal_polynomial</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ex</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">compose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">polys</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">domain</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/sympy/sympy/blob/180fe9384a7cd4c51be1b26da453d299219e02ec/sympy/polys/numberfields/minpoly.py#L622-L712"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sympy.polys.numberfields.minpoly.minimal_polynomial" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes the minimal polynomial of an algebraic element.</p>
<dl class="field-list">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>ex</strong> : Expr</p>
<blockquote>
<div><p>Element or expression whose minimal polynomial is to be calculated.</p>
</div></blockquote>
<p><strong>x</strong> : Symbol, optional</p>
<blockquote>
<div><p>Independent variable of the minimal polynomial</p>
</div></blockquote>
<p><strong>compose</strong> : boolean, optional (default=True)</p>
<blockquote>
<div><p>Method to use for computing minimal polynomial. If <code class="docutils literal notranslate"><span class="pre">compose=True</span></code>
(default) then <code class="docutils literal notranslate"><span class="pre">_minpoly_compose</span></code> is used, if <code class="docutils literal notranslate"><span class="pre">compose=False</span></code> then
groebner bases are used.</p>
</div></blockquote>
<p><strong>polys</strong> : boolean, optional (default=False)</p>
<blockquote>
<div><p>If <code class="docutils literal notranslate"><span class="pre">True</span></code> returns a <code class="docutils literal notranslate"><span class="pre">Poly</span></code> object else an <code class="docutils literal notranslate"><span class="pre">Expr</span></code> object.</p>
</div></blockquote>
<p><strong>domain</strong> : Domain, optional</p>
<blockquote>
<div><p>Ground domain</p>
</div></blockquote>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>By default <code class="docutils literal notranslate"><span class="pre">compose=True</span></code>, the minimal polynomial of the subexpressions of <code class="docutils literal notranslate"><span class="pre">ex</span></code>
are computed, then the arithmetic operations on them are performed using the resultant
and factorization.
If <code class="docutils literal notranslate"><span class="pre">compose=False</span></code>, a bottom-up algorithm is used with <code class="docutils literal notranslate"><span class="pre">groebner</span></code>.
The default algorithm stalls less frequently.</p>
<p>If no ground domain is given, it will be generated automatically from the expression.</p>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sympy</span> <span class="kn">import</span> <span class="n">minimal_polynomial</span><span class="p">,</span> <span class="n">sqrt</span><span class="p">,</span> <span class="n">solve</span><span class="p">,</span> <span class="n">QQ</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sympy.abc</span> <span class="kn">import</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">minimal_polynomial</span><span class="p">(</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span> <span class="n">x</span><span class="p">)</span>
<span class="go">x**2 - 2</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">minimal_polynomial</span><span class="p">(</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span> <span class="n">x</span><span class="p">,</span> <span class="n">domain</span><span class="o">=</span><span class="n">QQ</span><span class="o">.</span><span class="n">algebraic_field</span><span class="p">(</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">2</span><span class="p">)))</span>
<span class="go">x - sqrt(2)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">minimal_polynomial</span><span class="p">(</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">+</span> <span class="n">sqrt</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span> <span class="n">x</span><span class="p">)</span>
<span class="go">x**4 - 10*x**2 + 1</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">minimal_polynomial</span><span class="p">(</span><span class="n">solve</span><span class="p">(</span><span class="n">x</span><span class="o">**</span><span class="mi">3</span> <span class="o">+</span> <span class="n">x</span> <span class="o">+</span> <span class="mi">3</span><span class="p">)[</span><span class="mi">0</span><span class="p">],</span> <span class="n">x</span><span class="p">)</span>
<span class="go">x**3 + x + 3</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">minimal_polynomial</span><span class="p">(</span><span class="n">sqrt</span><span class="p">(</span><span class="n">y</span><span class="p">),</span> <span class="n">x</span><span class="p">)</span>
<span class="go">x**2 - y</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="sympy.polys.numberfields.minpoly.minpoly">
<span class="sig-prename descclassname"><span class="pre">sympy.polys.numberfields.minpoly.</span></span><span class="sig-name descname"><span class="pre">minpoly</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ex</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">compose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">polys</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">domain</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/sympy/sympy/blob/180fe9384a7cd4c51be1b26da453d299219e02ec/sympy/polys/numberfields/minpoly.py#L847-L850"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sympy.polys.numberfields.minpoly.minpoly" title="Permalink to this definition">¶</a></dt>
<dd><p>This is a synonym for <a class="reference internal" href="#sympy.polys.numberfields.minpoly.minimal_polynomial" title="sympy.polys.numberfields.minpoly.minimal_polynomial"><code class="xref py py-func docutils literal notranslate"><span class="pre">minimal_polynomial()</span></code></a>.</p>
</dd></dl>

</section>
<section id="the-subfield-problem">
<h3>The Subfield Problem<a class="headerlink" href="#the-subfield-problem" title="Permalink to this headline">¶</a></h3>
<span class="target" id="module-sympy.polys.numberfields.subfield"><span id="subfieldproblem"></span></span><p>Functions in <code class="docutils literal notranslate"><span class="pre">polys.numberfields.subfield</span></code> solve the “Subfield Problem” and
allied problems, for algebraic number fields.</p>
<p>Following Cohen (see <a class="reference internal" href="literature.html#cohen93" id="id7"><span>[Cohen93]</span></a> Section 4.5), we can define the main problem as
follows:</p>
<ul>
<li><p><strong>Subfield Problem:</strong></p>
<p>Given two number fields <span class="math notranslate nohighlight">\(\mathbb{Q}(\alpha)\)</span>, <span class="math notranslate nohighlight">\(\mathbb{Q}(\beta)\)</span>
via the minimal polynomials for their generators <span class="math notranslate nohighlight">\(\alpha\)</span> and <span class="math notranslate nohighlight">\(\beta\)</span>, decide
whether one field is isomorphic to a subfield of the other.</p>
</li>
</ul>
<p>From a solution to this problem flow solutions to the following problems as
well:</p>
<ul>
<li><p><strong>Primitive Element Problem:</strong></p>
<p>Given several algebraic numbers
<span class="math notranslate nohighlight">\(\alpha_1, \ldots, \alpha_m\)</span>, compute a single algebraic number <span class="math notranslate nohighlight">\(\theta\)</span>
such that <span class="math notranslate nohighlight">\(\mathbb{Q}(\alpha_1, \ldots, \alpha_m) = \mathbb{Q}(\theta)\)</span>.</p>
</li>
<li><p><strong>Field Isomorphism Problem:</strong></p>
<p>Decide whether two number fields
<span class="math notranslate nohighlight">\(\mathbb{Q}(\alpha)\)</span>, <span class="math notranslate nohighlight">\(\mathbb{Q}(\beta)\)</span> are isomorphic.</p>
</li>
<li><p><strong>Field Membership Problem:</strong></p>
<p>Given two algebraic numbers <span class="math notranslate nohighlight">\(\alpha\)</span>,
<span class="math notranslate nohighlight">\(\beta\)</span>, decide whether <span class="math notranslate nohighlight">\(\alpha \in \mathbb{Q}(\beta)\)</span>, and if so write
<span class="math notranslate nohighlight">\(\alpha = f(\beta)\)</span> for some <span class="math notranslate nohighlight">\(f(x) \in \mathbb{Q}[x]\)</span>.</p>
</li>
</ul>
<dl class="py function">
<dt class="sig sig-object py" id="sympy.polys.numberfields.subfield.field_isomorphism">
<span class="sig-prename descclassname"><span class="pre">sympy.polys.numberfields.subfield.</span></span><span class="sig-name descname"><span class="pre">field_isomorphism</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">a</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">b</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fast</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/sympy/sympy/blob/180fe9384a7cd4c51be1b26da453d299219e02ec/sympy/polys/numberfields/subfield.py#L159-L233"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sympy.polys.numberfields.subfield.field_isomorphism" title="Permalink to this definition">¶</a></dt>
<dd><p>Find an embedding of one number field into another.</p>
<dl class="field-list">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>a</strong> : <a class="reference internal" href="../core.html#sympy.core.expr.Expr" title="sympy.core.expr.Expr"><code class="xref py py-class docutils literal notranslate"><span class="pre">Expr</span></code></a></p>
<blockquote>
<div><p>Any expression representing an algebraic number.</p>
</div></blockquote>
<p><strong>b</strong> : <a class="reference internal" href="../core.html#sympy.core.expr.Expr" title="sympy.core.expr.Expr"><code class="xref py py-class docutils literal notranslate"><span class="pre">Expr</span></code></a></p>
<blockquote>
<div><p>Any expression representing an algebraic number.</p>
</div></blockquote>
<p><strong>fast</strong> : boolean, optional (default=True)</p>
<blockquote>
<div><p>If <code class="docutils literal notranslate"><span class="pre">True</span></code>, we first attempt a potentially faster way of computing the
isomorphism, falling back on a slower method if this fails. If
<code class="docutils literal notranslate"><span class="pre">False</span></code>, we go directly to the slower method, which is guaranteed to
return a result.</p>
</div></blockquote>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>List of rational numbers, or None</p>
<blockquote>
<div><p>If <span class="math notranslate nohighlight">\(\mathbb{Q}(a)\)</span> is not isomorphic to some subfield of
<span class="math notranslate nohighlight">\(\mathbb{Q}(b)\)</span>, then return <code class="docutils literal notranslate"><span class="pre">None</span></code>. Otherwise, return a list of
rational numbers representing an element of <span class="math notranslate nohighlight">\(\mathbb{Q}(b)\)</span> to which
<span class="math notranslate nohighlight">\(a\)</span> may be mapped, in order to define a monomorphism, i.e. an
isomorphism from <span class="math notranslate nohighlight">\(\mathbb{Q}(a)\)</span> to some subfield of <span class="math notranslate nohighlight">\(\mathbb{Q}(b)\)</span>.
The elements of the list are the coefficients of falling powers of <span class="math notranslate nohighlight">\(b\)</span>.</p>
</div></blockquote>
</dd>
</dl>
<p class="rubric">Explanation</p>
<p>This function looks for an isomorphism from <span class="math notranslate nohighlight">\(\mathbb{Q}(a)\)</span> onto some
subfield of <span class="math notranslate nohighlight">\(\mathbb{Q}(b)\)</span>. Thus, it solves the Subfield Problem.</p>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sympy</span> <span class="kn">import</span> <span class="n">sqrt</span><span class="p">,</span> <span class="n">field_isomorphism</span><span class="p">,</span> <span class="n">I</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">field_isomorphism</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="n">sqrt</span><span class="p">(</span><span class="mi">2</span><span class="p">)))</span>  
<span class="go">[3]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">field_isomorphism</span><span class="p">(</span> <span class="n">I</span><span class="o">*</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span> <span class="n">I</span><span class="o">*</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="p">))</span>  
<span class="go">[2, 0]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="sympy.polys.numberfields.subfield.primitive_element">
<span class="sig-prename descclassname"><span class="pre">sympy.polys.numberfields.subfield.</span></span><span class="sig-name descname"><span class="pre">primitive_element</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">extension</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ex</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">polys</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/sympy/sympy/blob/180fe9384a7cd4c51be1b26da453d299219e02ec/sympy/polys/numberfields/subfield.py#L252-L380"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sympy.polys.numberfields.subfield.primitive_element" title="Permalink to this definition">¶</a></dt>
<dd><p>Find a single generator for a number field given by several generators.</p>
<dl class="field-list">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>extension</strong> : list of <a class="reference internal" href="../core.html#sympy.core.expr.Expr" title="sympy.core.expr.Expr"><code class="xref py py-class docutils literal notranslate"><span class="pre">Expr</span></code></a></p>
<blockquote>
<div><p>Each expression must represent an algebraic number <span class="math notranslate nohighlight">\(\alpha_i\)</span>.</p>
</div></blockquote>
<p><strong>x</strong> : <a class="reference internal" href="../core.html#sympy.core.symbol.Symbol" title="sympy.core.symbol.Symbol"><code class="xref py py-class docutils literal notranslate"><span class="pre">Symbol</span></code></a>, optional (default=None)</p>
<blockquote>
<div><p>The desired symbol to appear in the computed minimal polynomial for the
primitive element <span class="math notranslate nohighlight">\(\theta\)</span>. If <code class="docutils literal notranslate"><span class="pre">None</span></code>, we use a dummy symbol.</p>
</div></blockquote>
<p><strong>ex</strong> : boolean, optional (default=False)</p>
<blockquote>
<div><p>If and only if <code class="docutils literal notranslate"><span class="pre">True</span></code>, compute the representation of each <span class="math notranslate nohighlight">\(\alpha_i\)</span>
as a <span class="math notranslate nohighlight">\(\mathbb{Q}\)</span>-linear combination over the powers of <span class="math notranslate nohighlight">\(\theta\)</span>.</p>
</div></blockquote>
<p><strong>polys</strong> : boolean, optional (default=False)</p>
<blockquote>
<div><p>If <code class="docutils literal notranslate"><span class="pre">True</span></code>, return the minimal polynomial as a <a class="reference internal" href="reference.html#sympy.polys.polytools.Poly" title="sympy.polys.polytools.Poly"><code class="xref py py-class docutils literal notranslate"><span class="pre">Poly</span></code></a>.
Otherwise return it as an <a class="reference internal" href="../core.html#sympy.core.expr.Expr" title="sympy.core.expr.Expr"><code class="xref py py-class docutils literal notranslate"><span class="pre">Expr</span></code></a>.</p>
</div></blockquote>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Pair (f, coeffs) or triple (f, coeffs, reps), where:</p>
<blockquote>
<div><p><code class="docutils literal notranslate"><span class="pre">f</span></code> is the minimal polynomial for the primitive element.
<code class="docutils literal notranslate"><span class="pre">coeffs</span></code> gives the primitive element as a linear combination of the
given generators.
<code class="docutils literal notranslate"><span class="pre">reps</span></code> is present if and only if argument <code class="docutils literal notranslate"><span class="pre">ex=True</span></code> was passed,
and is a list of lists of rational numbers. Each list gives the
coefficients of falling powers of the primitive element, to recover
one of the original, given generators.</p>
</div></blockquote>
</dd>
</dl>
<p class="rubric">Explanation</p>
<p>The basic problem is this: Given several algebraic numbers
<span class="math notranslate nohighlight">\(\alpha_1, \alpha_2, \ldots, \alpha_n\)</span>, find a single algebraic number
<span class="math notranslate nohighlight">\(\theta\)</span> such that
<span class="math notranslate nohighlight">\(\mathbb{Q}(\alpha_1, \alpha_2, \ldots, \alpha_n) = \mathbb{Q}(\theta)\)</span>.</p>
<p>This function actually guarantees that <span class="math notranslate nohighlight">\(\theta\)</span> will be a linear
combination of the <span class="math notranslate nohighlight">\(\alpha_i\)</span>, with non-negative integer coefficients.</p>
<p>Furthermore, if desired, this function will tell you how to express each
<span class="math notranslate nohighlight">\(\alpha_i\)</span> as a <span class="math notranslate nohighlight">\(\mathbb{Q}\)</span>-linear combination of the powers of <span class="math notranslate nohighlight">\(\theta\)</span>.</p>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sympy</span> <span class="kn">import</span> <span class="n">primitive_element</span><span class="p">,</span> <span class="n">sqrt</span><span class="p">,</span> <span class="n">S</span><span class="p">,</span> <span class="n">minpoly</span><span class="p">,</span> <span class="n">simplify</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sympy.abc</span> <span class="kn">import</span> <span class="n">x</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">f</span><span class="p">,</span> <span class="n">lincomb</span><span class="p">,</span> <span class="n">reps</span> <span class="o">=</span> <span class="n">primitive_element</span><span class="p">([</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span> <span class="n">sqrt</span><span class="p">(</span><span class="mi">3</span><span class="p">)],</span> <span class="n">x</span><span class="p">,</span> <span class="n">ex</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
<p>Then <code class="docutils literal notranslate"><span class="pre">lincomb</span></code> tells us the primitive element as a linear combination of
the given generators <code class="docutils literal notranslate"><span class="pre">sqrt(2)</span></code> and <code class="docutils literal notranslate"><span class="pre">sqrt(3)</span></code>.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">lincomb</span><span class="p">)</span>
<span class="go">[1, 1]</span>
</pre></div>
</div>
<p>This means the primtiive element is <span class="math notranslate nohighlight">\(\sqrt{2} + \sqrt{3}\)</span>.
Meanwhile <code class="docutils literal notranslate"><span class="pre">f</span></code> is the minimal polynomial for this primitive element.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
<span class="go">x**4 - 10*x**2 + 1</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">minpoly</span><span class="p">(</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">+</span> <span class="n">sqrt</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span> <span class="n">x</span><span class="p">))</span>
<span class="go">x**4 - 10*x**2 + 1</span>
</pre></div>
</div>
<p>Finally, <code class="docutils literal notranslate"><span class="pre">reps</span></code> (which was returned only because we set keyword arg
<code class="docutils literal notranslate"><span class="pre">ex=True</span></code>) tells us how to recover each of the generators <span class="math notranslate nohighlight">\(\sqrt{2}\)</span> and
<span class="math notranslate nohighlight">\(\sqrt{3}\)</span> as <span class="math notranslate nohighlight">\(\mathbb{Q}\)</span>-linear combinations of the powers of the
primitive element <span class="math notranslate nohighlight">\(\sqrt{2} + \sqrt{3}\)</span>.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">([</span><span class="n">S</span><span class="p">(</span><span class="n">r</span><span class="p">)</span> <span class="k">for</span> <span class="n">r</span> <span class="ow">in</span> <span class="n">reps</span><span class="p">[</span><span class="mi">0</span><span class="p">]])</span>
<span class="go">[1/2, 0, -9/2, 0]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">theta</span> <span class="o">=</span> <span class="n">sqrt</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">+</span> <span class="n">sqrt</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">simplify</span><span class="p">(</span><span class="n">theta</span><span class="o">**</span><span class="mi">3</span><span class="o">/</span><span class="mi">2</span> <span class="o">-</span> <span class="mi">9</span><span class="o">*</span><span class="n">theta</span><span class="o">/</span><span class="mi">2</span><span class="p">))</span>
<span class="go">sqrt(2)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">([</span><span class="n">S</span><span class="p">(</span><span class="n">r</span><span class="p">)</span> <span class="k">for</span> <span class="n">r</span> <span class="ow">in</span> <span class="n">reps</span><span class="p">[</span><span class="mi">1</span><span class="p">]])</span>
<span class="go">[-1/2, 0, 11/2, 0]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">simplify</span><span class="p">(</span><span class="o">-</span><span class="n">theta</span><span class="o">**</span><span class="mi">3</span><span class="o">/</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">11</span><span class="o">*</span><span class="n">theta</span><span class="o">/</span><span class="mi">2</span><span class="p">))</span>
<span class="go">sqrt(3)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="sympy.polys.numberfields.subfield.to_number_field">
<span class="sig-prename descclassname"><span class="pre">sympy.polys.numberfields.subfield.</span></span><span class="sig-name descname"><span class="pre">to_number_field</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">extension</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">theta</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gen</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/sympy/sympy/blob/180fe9384a7cd4c51be1b26da453d299219e02ec/sympy/polys/numberfields/subfield.py#L383-L485"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sympy.polys.numberfields.subfield.to_number_field" title="Permalink to this definition">¶</a></dt>
<dd><p>Express one algebraic number in the field generated by another.</p>
<dl class="field-list">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>extension</strong> : <a class="reference internal" href="../core.html#sympy.core.expr.Expr" title="sympy.core.expr.Expr"><code class="xref py py-class docutils literal notranslate"><span class="pre">Expr</span></code></a> or list of <a class="reference internal" href="../core.html#sympy.core.expr.Expr" title="sympy.core.expr.Expr"><code class="xref py py-class docutils literal notranslate"><span class="pre">Expr</span></code></a></p>
<blockquote>
<div><p>Either the algebraic number that is to be expressed in the other field,
or else a list of algebraic numbers, a primitive element for which is
to be expressed in the other field.</p>
</div></blockquote>
<p><strong>theta</strong> : <a class="reference internal" href="../core.html#sympy.core.expr.Expr" title="sympy.core.expr.Expr"><code class="xref py py-class docutils literal notranslate"><span class="pre">Expr</span></code></a>, None, optional (default=None)</p>
<blockquote>
<div><p>If an <a class="reference internal" href="../core.html#sympy.core.expr.Expr" title="sympy.core.expr.Expr"><code class="xref py py-class docutils literal notranslate"><span class="pre">Expr</span></code></a> representing an algebraic number, behavior is
as described under <strong>Explanation</strong>. If <code class="docutils literal notranslate"><span class="pre">None</span></code>, then this function
reduces to a shorthand for calling <a class="reference internal" href="#sympy.polys.numberfields.subfield.primitive_element" title="sympy.polys.numberfields.subfield.primitive_element"><code class="xref py py-func docutils literal notranslate"><span class="pre">primitive_element()</span></code></a> on
<code class="docutils literal notranslate"><span class="pre">extension</span></code> and turning the computed primitive element into an
<a class="reference internal" href="../core.html#sympy.core.numbers.AlgebraicNumber" title="sympy.core.numbers.AlgebraicNumber"><code class="xref py py-class docutils literal notranslate"><span class="pre">AlgebraicNumber</span></code></a>.</p>
</div></blockquote>
<p><strong>gen</strong> : <a class="reference internal" href="../core.html#sympy.core.symbol.Symbol" title="sympy.core.symbol.Symbol"><code class="xref py py-class docutils literal notranslate"><span class="pre">Symbol</span></code></a>, None, optional (default=None)</p>
<blockquote>
<div><p>If provided, this will be used as the generator symbol for the returned
<a class="reference internal" href="../core.html#sympy.core.numbers.AlgebraicNumber" title="sympy.core.numbers.AlgebraicNumber"><code class="xref py py-class docutils literal notranslate"><span class="pre">AlgebraicNumber</span></code></a>.</p>
</div></blockquote>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>AlgebraicNumber</p>
<blockquote>
<div><p>Belonging to <span class="math notranslate nohighlight">\(\mathbb{Q}(\theta)\)</span> and equaling <span class="math notranslate nohighlight">\(\eta\)</span>.</p>
</div></blockquote>
</dd>
<dt class="field-odd">Raises</dt>
<dd class="field-odd"><p><strong>IsomorphismFailed</strong></p>
<blockquote>
<div><p>If <span class="math notranslate nohighlight">\(\eta \not\in \mathbb{Q}(\theta)\)</span>.</p>
</div></blockquote>
</dd>
</dl>
<p class="rubric">Explanation</p>
<p>Given two algebraic numbers <span class="math notranslate nohighlight">\(\eta, \theta\)</span>, this function either expresses
<span class="math notranslate nohighlight">\(\eta\)</span> as an element of <span class="math notranslate nohighlight">\(\mathbb{Q}(\theta)\)</span>, or else raises an exception
if <span class="math notranslate nohighlight">\(\eta \not\in \mathbb{Q}(\theta)\)</span>.</p>
<p>This function is essentially just a convenience, utilizing
<a class="reference internal" href="#sympy.polys.numberfields.subfield.field_isomorphism" title="sympy.polys.numberfields.subfield.field_isomorphism"><code class="xref py py-func docutils literal notranslate"><span class="pre">field_isomorphism()</span></code></a> (our solution of the Subfield Problem) to
solve this, the Field Membership Problem.</p>
<p>As an additional convenience, this function allows you to pass a list of
algebraic numbers <span class="math notranslate nohighlight">\(\alpha_1, \alpha_2, \ldots, \alpha_n\)</span> instead of <span class="math notranslate nohighlight">\(\eta\)</span>.
It then computes <span class="math notranslate nohighlight">\(\eta\)</span> for you, as a solution of the Primitive Element
Problem, using <a class="reference internal" href="#sympy.polys.numberfields.subfield.primitive_element" title="sympy.polys.numberfields.subfield.primitive_element"><code class="xref py py-func docutils literal notranslate"><span class="pre">primitive_element()</span></code></a> on the list of <span class="math notranslate nohighlight">\(\alpha_i\)</span>.</p>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sympy</span> <span class="kn">import</span> <span class="n">sqrt</span><span class="p">,</span> <span class="n">to_number_field</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">eta</span> <span class="o">=</span> <span class="n">sqrt</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">theta</span> <span class="o">=</span> <span class="n">sqrt</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">+</span> <span class="n">sqrt</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a</span> <span class="o">=</span> <span class="n">to_number_field</span><span class="p">(</span><span class="n">eta</span><span class="p">,</span> <span class="n">theta</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">a</span><span class="p">))</span>
<span class="go">&lt;class &#39;sympy.core.numbers.AlgebraicNumber&#39;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a</span><span class="o">.</span><span class="n">root</span>
<span class="go">sqrt(2) + sqrt(3)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
<span class="go">sqrt(2)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a</span><span class="o">.</span><span class="n">coeffs</span><span class="p">()</span>
<span class="go">[1/2, 0, -9/2, 0]</span>
</pre></div>
</div>
<p>We get an <a class="reference internal" href="../core.html#sympy.core.numbers.AlgebraicNumber" title="sympy.core.numbers.AlgebraicNumber"><code class="xref py py-class docutils literal notranslate"><span class="pre">AlgebraicNumber</span></code></a>, whose <code class="docutils literal notranslate"><span class="pre">.root</span></code> is <span class="math notranslate nohighlight">\(\theta\)</span>, whose
value is <span class="math notranslate nohighlight">\(\eta\)</span>, and whose <code class="docutils literal notranslate"><span class="pre">.coeffs()</span></code> show how to write <span class="math notranslate nohighlight">\(\eta\)</span> as a
<span class="math notranslate nohighlight">\(\mathbb{Q}\)</span>-linear combination in falling powers of <span class="math notranslate nohighlight">\(\theta\)</span>.</p>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="#sympy.polys.numberfields.subfield.field_isomorphism" title="sympy.polys.numberfields.subfield.field_isomorphism"><code class="xref py py-obj docutils literal notranslate"><span class="pre">field_isomorphism</span></code></a>, <a class="reference internal" href="#sympy.polys.numberfields.subfield.primitive_element" title="sympy.polys.numberfields.subfield.primitive_element"><code class="xref py py-obj docutils literal notranslate"><span class="pre">primitive_element</span></code></a></p>
</div>
</dd></dl>

</section>
</section>
<section id="internals">
<h2>Internals<a class="headerlink" href="#internals" title="Permalink to this headline">¶</a></h2>
<section id="algebraic-number-fields">
<h3>Algebraic number fields<a class="headerlink" href="#algebraic-number-fields" title="Permalink to this headline">¶</a></h3>
<p>Algebraic number fields are represented in SymPy by the
<a class="reference internal" href="domainsref.html#sympy.polys.domains.AlgebraicField" title="sympy.polys.domains.AlgebraicField"><code class="xref py py-class docutils literal notranslate"><span class="pre">AlgebraicField</span></code></a> class, which is a part of
<a class="reference internal" href="domainsref.html#polys-domainsref"><span class="std std-ref">the polynomial domains system</span></a>.</p>
</section>
<section id="representing-algebraic-numbers">
<h3>Representing algebraic numbers<a class="headerlink" href="#representing-algebraic-numbers" title="Permalink to this headline">¶</a></h3>
<p>There are several different ways to represent algebraic numbers, and different
forms may be preferable for different computational tasks.
See <a class="reference internal" href="literature.html#cohen93" id="id8"><span>[Cohen93]</span></a>, Sec. 4.2.</p>
<section id="as-number-field-elements">
<h4>As number field elements<a class="headerlink" href="#as-number-field-elements" title="Permalink to this headline">¶</a></h4>
<p>In SymPy, there is a distinction between number and expression classes defined
in the <a class="reference internal" href="../core.html#module-sympy.core.numbers" title="sympy.core.numbers"><code class="xref py py-mod docutils literal notranslate"><span class="pre">sympy.core.numbers</span></code></a> module on the one hand, and domains and
domain elements defined in the <a class="reference internal" href="reference.html#module-sympy.polys" title="sympy.polys"><code class="xref py py-mod docutils literal notranslate"><span class="pre">polys</span></code></a> module on the other.
This is explained in more detail <a class="reference internal" href="domainsintro.html#polys-domainsintro"><span class="std std-ref">here</span></a>.</p>
<p>When it comes to algebraic numbers, the <a class="reference internal" href="../core.html#module-sympy.core.numbers" title="sympy.core.numbers"><code class="xref py py-mod docutils literal notranslate"><span class="pre">sympy.core.numbers</span></code></a> module
offers the <a class="reference internal" href="../core.html#sympy.core.numbers.AlgebraicNumber" title="sympy.core.numbers.AlgebraicNumber"><code class="xref py py-class docutils literal notranslate"><span class="pre">AlgebraicNumber</span></code></a> class, while the
<a class="reference internal" href="reference.html#module-sympy.polys" title="sympy.polys"><code class="xref py py-mod docutils literal notranslate"><span class="pre">polys</span></code></a> module offers the
<a class="reference internal" href="domainsref.html#sympy.polys.polyclasses.ANP" title="sympy.polys.polyclasses.ANP"><code class="xref py py-class docutils literal notranslate"><span class="pre">ANP</span></code></a> class. This is the type of domain
elements belonging to the <a class="reference internal" href="domainsref.html#sympy.polys.domains.AlgebraicField" title="sympy.polys.domains.AlgebraicField"><code class="xref py py-class docutils literal notranslate"><span class="pre">AlgebraicField</span></code></a> domain.</p>
</section>
<section id="as-elements-of-finitely-generated-modules">
<h4>As elements of finitely-generated modules<a class="headerlink" href="#as-elements-of-finitely-generated-modules" title="Permalink to this headline">¶</a></h4>
<p>In computational algebraic number theory, finitely-generated
<span class="math notranslate nohighlight">\(\mathbb{Z}\)</span>-modules are of central importance. For example, every
<a class="reference external" href="https://en.wikipedia.org/wiki/Order_(ring_theory)">order</a> and every <a class="reference external" href="https://en.wikipedia.org/wiki/Ideal_(ring_theory)">ideal</a> is such a module.</p>
<p>In particular, the maximal order – or <a class="reference external" href="https://en.wikipedia.org/wiki/Ring_of_integers">ring of integers</a> – in a number field
is a finitely-generated <span class="math notranslate nohighlight">\(\mathbb{Z}\)</span>-module, whose generators form an
<a class="reference external" href="https://en.wikipedia.org/wiki/Algebraic_number_field#Integral_basis">integral basis</a> for the field.</p>
<p>Classes allowing us to represent such modules, and their elements, are provided
in the <a class="reference internal" href="#module-sympy.polys.numberfields.modules" title="sympy.polys.numberfields.modules"><code class="xref py py-mod docutils literal notranslate"><span class="pre">modules</span></code></a> module. Here, the <a class="reference internal" href="#sympy.polys.numberfields.modules.ModuleElement" title="sympy.polys.numberfields.modules.ModuleElement"><code class="xref py py-class docutils literal notranslate"><span class="pre">ModuleElement</span></code></a> class
provides another way to represent algebraic numbers.</p>
</section>
</section>
<section id="module-sympy.polys.numberfields.modules">
<span id="finitely-generated-modules"></span><h3>Finitely-generated modules<a class="headerlink" href="#module-sympy.polys.numberfields.modules" title="Permalink to this headline">¶</a></h3>
<p>Modules in number fields.</p>
<p>The classes defined here allow us to work with finitely generated, free
modules, whose generators are algebraic numbers.</p>
<p>There is an abstract base class called <a class="reference internal" href="#sympy.polys.numberfields.modules.Module" title="sympy.polys.numberfields.modules.Module"><code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code></a>, which has two
concrete subclasses, <a class="reference internal" href="#sympy.polys.numberfields.modules.PowerBasis" title="sympy.polys.numberfields.modules.PowerBasis"><code class="xref py py-class docutils literal notranslate"><span class="pre">PowerBasis</span></code></a> and <a class="reference internal" href="#sympy.polys.numberfields.modules.Submodule" title="sympy.polys.numberfields.modules.Submodule"><code class="xref py py-class docutils literal notranslate"><span class="pre">Submodule</span></code></a>.</p>
<p>Every module is defined by its basis, or set of generators:</p>
<ul class="simple">
<li><p>For a <a class="reference internal" href="#sympy.polys.numberfields.modules.PowerBasis" title="sympy.polys.numberfields.modules.PowerBasis"><code class="xref py py-class docutils literal notranslate"><span class="pre">PowerBasis</span></code></a>, the generators are the first <span class="math notranslate nohighlight">\(n\)</span> powers
(starting with the zeroth) of an algebraic integer <span class="math notranslate nohighlight">\(\theta\)</span> of degree <span class="math notranslate nohighlight">\(n\)</span>.
The <a class="reference internal" href="#sympy.polys.numberfields.modules.PowerBasis" title="sympy.polys.numberfields.modules.PowerBasis"><code class="xref py py-class docutils literal notranslate"><span class="pre">PowerBasis</span></code></a> is constructed by passing the minimal
polynomial of <span class="math notranslate nohighlight">\(\theta\)</span>.</p></li>
<li><p>For a <a class="reference internal" href="#sympy.polys.numberfields.modules.Submodule" title="sympy.polys.numberfields.modules.Submodule"><code class="xref py py-class docutils literal notranslate"><span class="pre">Submodule</span></code></a>, the generators are a set of
<span class="math notranslate nohighlight">\(\mathbb{Q}\)</span>-linear combinations of the generators of another module. That
other module is then the “parent” of the <a class="reference internal" href="#sympy.polys.numberfields.modules.Submodule" title="sympy.polys.numberfields.modules.Submodule"><code class="xref py py-class docutils literal notranslate"><span class="pre">Submodule</span></code></a>. The
coefficients of the <span class="math notranslate nohighlight">\(\mathbb{Q}\)</span>-linear combinations may be given by an
integer matrix, and a positive integer denominator. Each column of the matrix
defines a generator.</p></li>
</ul>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sympy.polys</span> <span class="kn">import</span> <span class="n">Poly</span><span class="p">,</span> <span class="n">cyclotomic_poly</span><span class="p">,</span> <span class="n">ZZ</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sympy.abc</span> <span class="kn">import</span> <span class="n">x</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sympy.polys.matrices</span> <span class="kn">import</span> <span class="n">DomainMatrix</span><span class="p">,</span> <span class="n">DM</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sympy.polys.numberfields.modules</span> <span class="kn">import</span> <span class="n">PowerBasis</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">T</span> <span class="o">=</span> <span class="n">Poly</span><span class="p">(</span><span class="n">cyclotomic_poly</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="n">x</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">A</span> <span class="o">=</span> <span class="n">PowerBasis</span><span class="p">(</span><span class="n">T</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">A</span><span class="p">)</span>
<span class="go">PowerBasis(x**4 + x**3 + x**2 + x + 1)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">B</span> <span class="o">=</span> <span class="n">A</span><span class="o">.</span><span class="n">submodule_from_matrix</span><span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">DomainMatrix</span><span class="o">.</span><span class="n">eye</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="n">ZZ</span><span class="p">),</span> <span class="n">denom</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">B</span><span class="p">)</span>
<span class="go">Submodule[[2, 0, 0, 0], [0, 2, 0, 0], [0, 0, 2, 0], [0, 0, 0, 2]]/3</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">B</span><span class="o">.</span><span class="n">parent</span><span class="p">)</span>
<span class="go">PowerBasis(x**4 + x**3 + x**2 + x + 1)</span>
</pre></div>
</div>
<p>Thus, every module is either a <a class="reference internal" href="#sympy.polys.numberfields.modules.PowerBasis" title="sympy.polys.numberfields.modules.PowerBasis"><code class="xref py py-class docutils literal notranslate"><span class="pre">PowerBasis</span></code></a>,
or a <a class="reference internal" href="#sympy.polys.numberfields.modules.Submodule" title="sympy.polys.numberfields.modules.Submodule"><code class="xref py py-class docutils literal notranslate"><span class="pre">Submodule</span></code></a>, some ancestor of which is a
<a class="reference internal" href="#sympy.polys.numberfields.modules.PowerBasis" title="sympy.polys.numberfields.modules.PowerBasis"><code class="xref py py-class docutils literal notranslate"><span class="pre">PowerBasis</span></code></a>. (If <code class="docutils literal notranslate"><span class="pre">S</span></code> is a <a class="reference internal" href="#sympy.polys.numberfields.modules.Submodule" title="sympy.polys.numberfields.modules.Submodule"><code class="xref py py-class docutils literal notranslate"><span class="pre">Submodule</span></code></a>, then its
ancestors are <code class="docutils literal notranslate"><span class="pre">S.parent</span></code>, <code class="docutils literal notranslate"><span class="pre">S.parent.parent</span></code>, and so on).</p>
<p>The <a class="reference internal" href="#sympy.polys.numberfields.modules.ModuleElement" title="sympy.polys.numberfields.modules.ModuleElement"><code class="xref py py-class docutils literal notranslate"><span class="pre">ModuleElement</span></code></a> class represents a linear combination of the
generators of any module. Critically, the coefficients of this linear
combination are not restricted to be integers, but may be any rational
numbers. This is necessary so that any and all algebraic integers be
representable, starting from the power basis in a primitive element <span class="math notranslate nohighlight">\(\theta\)</span>
for the number field in question. For example, in a quadratic field
<span class="math notranslate nohighlight">\(\mathbb{Q}(\sqrt{d})\)</span> where <span class="math notranslate nohighlight">\(d \equiv 1 \mod{4}\)</span>, a denominator of <span class="math notranslate nohighlight">\(2\)</span> is
needed.</p>
<p>A <a class="reference internal" href="#sympy.polys.numberfields.modules.ModuleElement" title="sympy.polys.numberfields.modules.ModuleElement"><code class="xref py py-class docutils literal notranslate"><span class="pre">ModuleElement</span></code></a> can be constructed from an integer column vector
and a denominator:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">U</span> <span class="o">=</span> <span class="n">Poly</span><span class="p">(</span><span class="n">x</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span> <span class="mi">5</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">M</span> <span class="o">=</span> <span class="n">PowerBasis</span><span class="p">(</span><span class="n">U</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">e</span> <span class="o">=</span> <span class="n">M</span><span class="p">(</span><span class="n">DM</span><span class="p">([[</span><span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">]],</span> <span class="n">ZZ</span><span class="p">),</span> <span class="n">denom</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>
<span class="go">[1, 1]/2</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">e</span><span class="o">.</span><span class="n">module</span><span class="p">)</span>
<span class="go">PowerBasis(x**2 - 5)</span>
</pre></div>
</div>
<p>The <a class="reference internal" href="#sympy.polys.numberfields.modules.PowerBasisElement" title="sympy.polys.numberfields.modules.PowerBasisElement"><code class="xref py py-class docutils literal notranslate"><span class="pre">PowerBasisElement</span></code></a> class is a subclass of
<a class="reference internal" href="#sympy.polys.numberfields.modules.ModuleElement" title="sympy.polys.numberfields.modules.ModuleElement"><code class="xref py py-class docutils literal notranslate"><span class="pre">ModuleElement</span></code></a> that represents elements of a
<a class="reference internal" href="#sympy.polys.numberfields.modules.PowerBasis" title="sympy.polys.numberfields.modules.PowerBasis"><code class="xref py py-class docutils literal notranslate"><span class="pre">PowerBasis</span></code></a>, and adds functionality pertinent to elements
represented directly over powers of the primitive element <span class="math notranslate nohighlight">\(\theta\)</span>.</p>
<section id="arithmetic-with-module-elements">
<h4>Arithmetic with module elements<a class="headerlink" href="#arithmetic-with-module-elements" title="Permalink to this headline">¶</a></h4>
<p>While a <a class="reference internal" href="#sympy.polys.numberfields.modules.ModuleElement" title="sympy.polys.numberfields.modules.ModuleElement"><code class="xref py py-class docutils literal notranslate"><span class="pre">ModuleElement</span></code></a> represents a linear combination over the
generators of a particular module, recall that every module is either a
<a class="reference internal" href="#sympy.polys.numberfields.modules.PowerBasis" title="sympy.polys.numberfields.modules.PowerBasis"><code class="xref py py-class docutils literal notranslate"><span class="pre">PowerBasis</span></code></a> or a descendant (along a chain of
<a class="reference internal" href="#sympy.polys.numberfields.modules.Submodule" title="sympy.polys.numberfields.modules.Submodule"><code class="xref py py-class docutils literal notranslate"><span class="pre">Submodule</span></code></a> objects) thereof, so that in fact every
<a class="reference internal" href="#sympy.polys.numberfields.modules.ModuleElement" title="sympy.polys.numberfields.modules.ModuleElement"><code class="xref py py-class docutils literal notranslate"><span class="pre">ModuleElement</span></code></a> represents an algebraic number in some field
<span class="math notranslate nohighlight">\(\mathbb{Q}(\theta)\)</span>, where <span class="math notranslate nohighlight">\(\theta\)</span> is the defining element of some
<a class="reference internal" href="#sympy.polys.numberfields.modules.PowerBasis" title="sympy.polys.numberfields.modules.PowerBasis"><code class="xref py py-class docutils literal notranslate"><span class="pre">PowerBasis</span></code></a>. It thus makes sense to talk about the number field
to which a given <a class="reference internal" href="#sympy.polys.numberfields.modules.ModuleElement" title="sympy.polys.numberfields.modules.ModuleElement"><code class="xref py py-class docutils literal notranslate"><span class="pre">ModuleElement</span></code></a> belongs.</p>
<p>This means that any two <a class="reference internal" href="#sympy.polys.numberfields.modules.ModuleElement" title="sympy.polys.numberfields.modules.ModuleElement"><code class="xref py py-class docutils literal notranslate"><span class="pre">ModuleElement</span></code></a> instances can be added,
subtracted, multiplied, or divided, provided they belong to the same number
field. Similarly, since <span class="math notranslate nohighlight">\(\mathbb{Q}\)</span> is a subfield of every number field,
any <a class="reference internal" href="#sympy.polys.numberfields.modules.ModuleElement" title="sympy.polys.numberfields.modules.ModuleElement"><code class="xref py py-class docutils literal notranslate"><span class="pre">ModuleElement</span></code></a> may be added, multiplied, etc. by any
rational number.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sympy</span> <span class="kn">import</span> <span class="n">QQ</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sympy.polys.numberfields.modules</span> <span class="kn">import</span> <span class="n">to_col</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">T</span> <span class="o">=</span> <span class="n">Poly</span><span class="p">(</span><span class="n">cyclotomic_poly</span><span class="p">(</span><span class="mi">5</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">A</span> <span class="o">=</span> <span class="n">PowerBasis</span><span class="p">(</span><span class="n">T</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">C</span> <span class="o">=</span> <span class="n">A</span><span class="o">.</span><span class="n">submodule_from_matrix</span><span class="p">(</span><span class="mi">3</span> <span class="o">*</span> <span class="n">DomainMatrix</span><span class="o">.</span><span class="n">eye</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="n">ZZ</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">e</span> <span class="o">=</span> <span class="n">A</span><span class="p">(</span><span class="n">to_col</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]),</span> <span class="n">denom</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">f</span> <span class="o">=</span> <span class="n">A</span><span class="p">(</span><span class="n">to_col</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">7</span><span class="p">]),</span> <span class="n">denom</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">g</span> <span class="o">=</span> <span class="n">C</span><span class="p">(</span><span class="n">to_col</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">e</span> <span class="o">+</span> <span class="n">f</span>
<span class="go">[0, 10, 0, 21]/15</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">e</span> <span class="o">-</span> <span class="n">f</span>
<span class="go">[0, 10, 0, -21]/15</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">e</span> <span class="o">-</span> <span class="n">g</span>
<span class="go">[-9, -7, -9, -9]/3</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">e</span> <span class="o">+</span> <span class="n">QQ</span><span class="p">(</span><span class="mi">7</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
<span class="go">[21, 20, 0, 0]/30</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">e</span> <span class="o">*</span> <span class="n">f</span>
<span class="go">[-14, -14, -14, -14]/15</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">e</span> <span class="o">**</span> <span class="mi">2</span>
<span class="go">[0, 0, 4, 0]/9</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">f</span> <span class="o">//</span> <span class="n">g</span>
<span class="go">[7, 7, 7, 7]/15</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">f</span> <span class="o">*</span> <span class="n">QQ</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
<span class="go">[0, 0, 0, 14]/15</span>
</pre></div>
</div>
<p>However, care must be taken with arithmetic operations on
<a class="reference internal" href="#sympy.polys.numberfields.modules.ModuleElement" title="sympy.polys.numberfields.modules.ModuleElement"><code class="xref py py-class docutils literal notranslate"><span class="pre">ModuleElement</span></code></a>, because the module <span class="math notranslate nohighlight">\(C\)</span> to which the result will
belong will be the nearest common ancestor (NCA) of the modules <span class="math notranslate nohighlight">\(A\)</span>, <span class="math notranslate nohighlight">\(B\)</span> to
which the two operands belong, and <span class="math notranslate nohighlight">\(C\)</span> may be different from either or both
of <span class="math notranslate nohighlight">\(A\)</span> and <span class="math notranslate nohighlight">\(B\)</span>.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">A</span> <span class="o">=</span> <span class="n">PowerBasis</span><span class="p">(</span><span class="n">T</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">B</span> <span class="o">=</span> <span class="n">A</span><span class="o">.</span><span class="n">submodule_from_matrix</span><span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">DomainMatrix</span><span class="o">.</span><span class="n">eye</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="n">ZZ</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">C</span> <span class="o">=</span> <span class="n">A</span><span class="o">.</span><span class="n">submodule_from_matrix</span><span class="p">(</span><span class="mi">3</span> <span class="o">*</span> <span class="n">DomainMatrix</span><span class="o">.</span><span class="n">eye</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="n">ZZ</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">((</span><span class="n">B</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span> <span class="o">*</span> <span class="n">C</span><span class="p">(</span><span class="mi">0</span><span class="p">))</span><span class="o">.</span><span class="n">module</span> <span class="o">==</span> <span class="n">A</span><span class="p">)</span>
<span class="go">True</span>
</pre></div>
</div>
<p>Before the arithmetic operation is performed, copies of the two operands are
automatically converted into elements of the NCA (the operands themselves are
not modified). This upward conversion along an ancestor chain is easy: it just
requires the successive multiplication by the defining matrix of each
<a class="reference internal" href="#sympy.polys.numberfields.modules.Submodule" title="sympy.polys.numberfields.modules.Submodule"><code class="xref py py-class docutils literal notranslate"><span class="pre">Submodule</span></code></a>.</p>
<p>Conversely, downward conversion, i.e. representing a given
<a class="reference internal" href="#sympy.polys.numberfields.modules.ModuleElement" title="sympy.polys.numberfields.modules.ModuleElement"><code class="xref py py-class docutils literal notranslate"><span class="pre">ModuleElement</span></code></a> in a submodule, is also supported – namely by
the <a class="reference internal" href="#sympy.polys.numberfields.modules.Submodule.represent" title="sympy.polys.numberfields.modules.Submodule.represent"><code class="xref py py-meth docutils literal notranslate"><span class="pre">represent()</span></code></a> method
– but is not guaranteed to succeed in general, since the given element may
not belong to the submodule. The main circumstance in which this issue tends
to arise is with multiplication, since modules, while closed under addition,
need not be closed under multiplication.</p>
<section id="multiplication">
<h5>Multiplication<a class="headerlink" href="#multiplication" title="Permalink to this headline">¶</a></h5>
<p>Generally speaking, a module need not be closed under multiplication, i.e. need
not form a ring. However, many of the modules we work with in the context of
number fields are in fact rings, and our classes do support multiplication.</p>
<p>Specifically, any <a class="reference internal" href="#sympy.polys.numberfields.modules.Module" title="sympy.polys.numberfields.modules.Module"><code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code></a> can attempt to compute its own
multiplication table, but this does not happen unless an attempt is made to
multiply two <a class="reference internal" href="#sympy.polys.numberfields.modules.ModuleElement" title="sympy.polys.numberfields.modules.ModuleElement"><code class="xref py py-class docutils literal notranslate"><span class="pre">ModuleElement</span></code></a> instances belonging to it.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">A</span> <span class="o">=</span> <span class="n">PowerBasis</span><span class="p">(</span><span class="n">T</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">A</span><span class="o">.</span><span class="n">_mult_tab</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">)</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a</span> <span class="o">=</span> <span class="n">A</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="o">*</span><span class="n">A</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">A</span><span class="o">.</span><span class="n">_mult_tab</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">)</span>
<span class="go">False</span>
</pre></div>
</div>
<p>Every <a class="reference internal" href="#sympy.polys.numberfields.modules.PowerBasis" title="sympy.polys.numberfields.modules.PowerBasis"><code class="xref py py-class docutils literal notranslate"><span class="pre">PowerBasis</span></code></a> is, by its nature, closed under multiplication,
so instances of <a class="reference internal" href="#sympy.polys.numberfields.modules.PowerBasis" title="sympy.polys.numberfields.modules.PowerBasis"><code class="xref py py-class docutils literal notranslate"><span class="pre">PowerBasis</span></code></a> can always successfully compute their
multiplication table.</p>
<p>When a <a class="reference internal" href="#sympy.polys.numberfields.modules.Submodule" title="sympy.polys.numberfields.modules.Submodule"><code class="xref py py-class docutils literal notranslate"><span class="pre">Submodule</span></code></a> attempts to compute its multiplication table,
it converts each of its own generators into elements of its parent module,
multiplies them there, in every possible pairing, and then tries to
represent the results in itself, i.e. as <span class="math notranslate nohighlight">\(\mathbb{Z}\)</span>-linear combinations
over its own generators. This will succeed if and only if the submodule is
in fact closed under multiplication.</p>
</section>
</section>
<section id="module-homomorphisms">
<h4>Module Homomorphisms<a class="headerlink" href="#module-homomorphisms" title="Permalink to this headline">¶</a></h4>
<p>Many important number theoretic algorithms require the calculation of the
kernel of one or more module homomorphisms. Accordingly we have several
lightweight classes, <a class="reference internal" href="#sympy.polys.numberfields.modules.ModuleHomomorphism" title="sympy.polys.numberfields.modules.ModuleHomomorphism"><code class="xref py py-class docutils literal notranslate"><span class="pre">ModuleHomomorphism</span></code></a>,
<a class="reference internal" href="#sympy.polys.numberfields.modules.ModuleEndomorphism" title="sympy.polys.numberfields.modules.ModuleEndomorphism"><code class="xref py py-class docutils literal notranslate"><span class="pre">ModuleEndomorphism</span></code></a>, <a class="reference internal" href="#sympy.polys.numberfields.modules.InnerEndomorphism" title="sympy.polys.numberfields.modules.InnerEndomorphism"><code class="xref py py-class docutils literal notranslate"><span class="pre">InnerEndomorphism</span></code></a>, and
<a class="reference internal" href="#sympy.polys.numberfields.modules.EndomorphismRing" title="sympy.polys.numberfields.modules.EndomorphismRing"><code class="xref py py-class docutils literal notranslate"><span class="pre">EndomorphismRing</span></code></a>, which provide the minimal necessary machinery
to support this.</p>
</section>
<section id="class-reference">
<h4>Class Reference<a class="headerlink" href="#class-reference" title="Permalink to this headline">¶</a></h4>
<dl class="py class">
<dt class="sig sig-object py" id="sympy.polys.numberfields.modules.Module">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">sympy.polys.numberfields.modules.</span></span><span class="sig-name descname"><span class="pre">Module</span></span><a class="reference external" href="https://github.com/sympy/sympy/blob/180fe9384a7cd4c51be1b26da453d299219e02ec/sympy/polys/numberfields/modules.py#L201-L670"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sympy.polys.numberfields.modules.Module" title="Permalink to this definition">¶</a></dt>
<dd><p>Generic finitely-generated module.</p>
<p>This is an abstract base class, and should not be instantiated directly.
The two concrete subclasses are <a class="reference internal" href="#sympy.polys.numberfields.modules.PowerBasis" title="sympy.polys.numberfields.modules.PowerBasis"><code class="xref py py-class docutils literal notranslate"><span class="pre">PowerBasis</span></code></a> and
<a class="reference internal" href="#sympy.polys.numberfields.modules.Submodule" title="sympy.polys.numberfields.modules.Submodule"><code class="xref py py-class docutils literal notranslate"><span class="pre">Submodule</span></code></a>.</p>
<p>Every <a class="reference internal" href="#sympy.polys.numberfields.modules.Submodule" title="sympy.polys.numberfields.modules.Submodule"><code class="xref py py-class docutils literal notranslate"><span class="pre">Submodule</span></code></a> is derived from another module, referenced
by its <code class="docutils literal notranslate"><span class="pre">parent</span></code> attribute. If <code class="docutils literal notranslate"><span class="pre">S</span></code> is a submodule, then we refer to
<code class="docutils literal notranslate"><span class="pre">S.parent</span></code>, <code class="docutils literal notranslate"><span class="pre">S.parent.parent</span></code>, and so on, as the “ancestors” of
<code class="docutils literal notranslate"><span class="pre">S</span></code>. Thus, every <a class="reference internal" href="#sympy.polys.numberfields.modules.Module" title="sympy.polys.numberfields.modules.Module"><code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code></a> is either a
<a class="reference internal" href="#sympy.polys.numberfields.modules.PowerBasis" title="sympy.polys.numberfields.modules.PowerBasis"><code class="xref py py-class docutils literal notranslate"><span class="pre">PowerBasis</span></code></a> or a <a class="reference internal" href="#sympy.polys.numberfields.modules.Submodule" title="sympy.polys.numberfields.modules.Submodule"><code class="xref py py-class docutils literal notranslate"><span class="pre">Submodule</span></code></a>, some ancestor of
which is a <a class="reference internal" href="#sympy.polys.numberfields.modules.PowerBasis" title="sympy.polys.numberfields.modules.PowerBasis"><code class="xref py py-class docutils literal notranslate"><span class="pre">PowerBasis</span></code></a>.</p>
<dl class="py method">
<dt class="sig sig-object py" id="sympy.polys.numberfields.modules.Module.__call__">
<span class="sig-name descname"><span class="pre">__call__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">spec</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">denom</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/sympy/sympy/blob/180fe9384a7cd4c51be1b26da453d299219e02ec/sympy/polys/numberfields/modules.py#L443-L487"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sympy.polys.numberfields.modules.Module.__call__" title="Permalink to this definition">¶</a></dt>
<dd><p>Generate a <a class="reference internal" href="#sympy.polys.numberfields.modules.ModuleElement" title="sympy.polys.numberfields.modules.ModuleElement"><code class="xref py py-class docutils literal notranslate"><span class="pre">ModuleElement</span></code></a> belonging to this module.</p>
<dl class="field-list">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>spec</strong> : <a class="reference internal" href="domainmatrix.html#sympy.polys.matrices.domainmatrix.DomainMatrix" title="sympy.polys.matrices.domainmatrix.DomainMatrix"><code class="xref py py-class docutils literal notranslate"><span class="pre">DomainMatrix</span></code></a>, int</p>
<blockquote>
<div><p>Specifies the numerators of the coefficients of the
<a class="reference internal" href="#sympy.polys.numberfields.modules.ModuleElement" title="sympy.polys.numberfields.modules.ModuleElement"><code class="xref py py-class docutils literal notranslate"><span class="pre">ModuleElement</span></code></a>. Can be either a column vector over
<a class="reference internal" href="domainsref.html#zz"><span class="std std-ref">ZZ</span></a>, whose length must equal the number <span class="math notranslate nohighlight">\(n\)</span> of generators of
this module, or else an integer <code class="docutils literal notranslate"><span class="pre">j</span></code>, <span class="math notranslate nohighlight">\(0 \leq j &lt; n\)</span>, which is a
shorthand for column <span class="math notranslate nohighlight">\(j\)</span> of <span class="math notranslate nohighlight">\(I_n\)</span>, the <span class="math notranslate nohighlight">\(n \times n\)</span> identity
matrix.</p>
</div></blockquote>
<p><strong>denom</strong> : int, optional (default=1)</p>
<blockquote>
<div><p>Denominator for the coefficients of the
<a class="reference internal" href="#sympy.polys.numberfields.modules.ModuleElement" title="sympy.polys.numberfields.modules.ModuleElement"><code class="xref py py-class docutils literal notranslate"><span class="pre">ModuleElement</span></code></a>.</p>
</div></blockquote>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><a class="reference internal" href="#sympy.polys.numberfields.modules.ModuleElement" title="sympy.polys.numberfields.modules.ModuleElement"><code class="xref py py-class docutils literal notranslate"><span class="pre">ModuleElement</span></code></a></p>
<blockquote>
<div><p>The coefficients are the entries of the <em>spec</em> vector, divided by
<em>denom</em>.</p>
</div></blockquote>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sympy.polys</span> <span class="kn">import</span> <span class="n">Poly</span><span class="p">,</span> <span class="n">cyclotomic_poly</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sympy.polys.numberfields.modules</span> <span class="kn">import</span> <span class="n">PowerBasis</span><span class="p">,</span> <span class="n">to_col</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">T</span> <span class="o">=</span> <span class="n">Poly</span><span class="p">(</span><span class="n">cyclotomic_poly</span><span class="p">(</span><span class="mi">5</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">A</span> <span class="o">=</span> <span class="n">PowerBasis</span><span class="p">(</span><span class="n">T</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">e</span> <span class="o">=</span> <span class="n">A</span><span class="p">(</span><span class="n">to_col</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">]),</span> <span class="n">denom</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>  
<span class="go">[1, 2, 3, 4]/3</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">f</span> <span class="o">=</span> <span class="n">A</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>  
<span class="go">[0, 0, 1, 0]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sympy.polys.numberfields.modules.Module.ancestors">
<span class="sig-name descname"><span class="pre">ancestors</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">include_self</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/sympy/sympy/blob/180fe9384a7cd4c51be1b26da453d299219e02ec/sympy/polys/numberfields/modules.py#L379-L395"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sympy.polys.numberfields.modules.Module.ancestors" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the list of ancestor modules of this module, from the
foundational <a class="reference internal" href="#sympy.polys.numberfields.modules.PowerBasis" title="sympy.polys.numberfields.modules.PowerBasis"><code class="xref py py-class docutils literal notranslate"><span class="pre">PowerBasis</span></code></a> downward, optionally including
<code class="docutils literal notranslate"><span class="pre">self</span></code>.</p>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="#sympy.polys.numberfields.modules.Module" title="sympy.polys.numberfields.modules.Module"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Module</span></code></a></p>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sympy.polys.numberfields.modules.Module.basis_elements">
<span class="sig-name descname"><span class="pre">basis_elements</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference external" href="https://github.com/sympy/sympy/blob/180fe9384a7cd4c51be1b26da453d299219e02ec/sympy/polys/numberfields/modules.py#L493-L498"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sympy.polys.numberfields.modules.Module.basis_elements" title="Permalink to this definition">¶</a></dt>
<dd><p>Get list of <a class="reference internal" href="#sympy.polys.numberfields.modules.ModuleElement" title="sympy.polys.numberfields.modules.ModuleElement"><code class="xref py py-class docutils literal notranslate"><span class="pre">ModuleElement</span></code></a> being the generators of this
module.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sympy.polys.numberfields.modules.Module.element_from_rational">
<span class="sig-name descname"><span class="pre">element_from_rational</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">a</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/sympy/sympy/blob/180fe9384a7cd4c51be1b26da453d299219e02ec/sympy/polys/numberfields/modules.py#L512-L545"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sympy.polys.numberfields.modules.Module.element_from_rational" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a <a class="reference internal" href="#sympy.polys.numberfields.modules.ModuleElement" title="sympy.polys.numberfields.modules.ModuleElement"><code class="xref py py-class docutils literal notranslate"><span class="pre">ModuleElement</span></code></a> representing a rational number.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>a</strong> : int, <a class="reference internal" href="domainsref.html#zz"><span class="std std-ref">ZZ</span></a>, <a class="reference internal" href="domainsref.html#qq"><span class="std std-ref">QQ</span></a></p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><a class="reference internal" href="#sympy.polys.numberfields.modules.ModuleElement" title="sympy.polys.numberfields.modules.ModuleElement"><code class="xref py py-class docutils literal notranslate"><span class="pre">ModuleElement</span></code></a></p>
</dd>
</dl>
<p class="rubric">Explanation</p>
<p>The returned <a class="reference internal" href="#sympy.polys.numberfields.modules.ModuleElement" title="sympy.polys.numberfields.modules.ModuleElement"><code class="xref py py-class docutils literal notranslate"><span class="pre">ModuleElement</span></code></a> will belong to the first
module on this module’s ancestor chain (including this module
itself) that starts with unity.</p>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sympy.polys</span> <span class="kn">import</span> <span class="n">Poly</span><span class="p">,</span> <span class="n">cyclotomic_poly</span><span class="p">,</span> <span class="n">QQ</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sympy.polys.numberfields.modules</span> <span class="kn">import</span> <span class="n">PowerBasis</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">T</span> <span class="o">=</span> <span class="n">Poly</span><span class="p">(</span><span class="n">cyclotomic_poly</span><span class="p">(</span><span class="mi">5</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">A</span> <span class="o">=</span> <span class="n">PowerBasis</span><span class="p">(</span><span class="n">T</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a</span> <span class="o">=</span> <span class="n">A</span><span class="o">.</span><span class="n">element_from_rational</span><span class="p">(</span><span class="n">QQ</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>  
<span class="go">[2, 0, 0, 0]/3</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sympy.polys.numberfields.modules.Module.endomorphism_ring">
<span class="sig-name descname"><span class="pre">endomorphism_ring</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference external" href="https://github.com/sympy/sympy/blob/180fe9384a7cd4c51be1b26da453d299219e02ec/sympy/polys/numberfields/modules.py#L668-L670"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sympy.polys.numberfields.modules.Module.endomorphism_ring" title="Permalink to this definition">¶</a></dt>
<dd><p>Form the <a class="reference internal" href="#sympy.polys.numberfields.modules.EndomorphismRing" title="sympy.polys.numberfields.modules.EndomorphismRing"><code class="xref py py-class docutils literal notranslate"><span class="pre">EndomorphismRing</span></code></a> for this module.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sympy.polys.numberfields.modules.Module.is_compat_col">
<span class="sig-name descname"><span class="pre">is_compat_col</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">col</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/sympy/sympy/blob/180fe9384a7cd4c51be1b26da453d299219e02ec/sympy/polys/numberfields/modules.py#L439-L441"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sympy.polys.numberfields.modules.Module.is_compat_col" title="Permalink to this definition">¶</a></dt>
<dd><p>Say whether <em>col</em> is a suitable column vector for this module.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sympy.polys.numberfields.modules.Module.mult_tab">
<span class="sig-name descname"><span class="pre">mult_tab</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference external" href="https://github.com/sympy/sympy/blob/180fe9384a7cd4c51be1b26da453d299219e02ec/sympy/polys/numberfields/modules.py#L222-L264"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sympy.polys.numberfields.modules.Module.mult_tab" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the multiplication table for this module (if closed under mult).</p>
<dl class="field-list">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>dict of dict of lists</p>
</dd>
<dt class="field-even">Raises</dt>
<dd class="field-even"><p><strong>ClosureFailure</strong></p>
<blockquote>
<div><p>If the module is not closed under multiplication.</p>
</div></blockquote>
</dd>
</dl>
<p class="rubric">Explanation</p>
<p>Computes a dictionary <code class="docutils literal notranslate"><span class="pre">M</span></code> of dictionaries of lists, representing the
upper triangular half of the multiplication table.</p>
<p>In other words, if <code class="docutils literal notranslate"><span class="pre">0</span> <span class="pre">&lt;=</span> <span class="pre">i</span> <span class="pre">&lt;=</span> <span class="pre">j</span> <span class="pre">&lt;</span> <span class="pre">self.n</span></code>, then <code class="docutils literal notranslate"><span class="pre">M[i][j]</span></code> is the
list <code class="docutils literal notranslate"><span class="pre">c</span></code> of coefficients such that
<code class="docutils literal notranslate"><span class="pre">g[i]</span> <span class="pre">*</span> <span class="pre">g[j]</span> <span class="pre">==</span> <span class="pre">sum(c[k]*g[k],</span> <span class="pre">k</span> <span class="pre">in</span> <span class="pre">range(self.n))</span></code>,
where <code class="docutils literal notranslate"><span class="pre">g</span></code> is the list of generators of this module.</p>
<p>If <code class="docutils literal notranslate"><span class="pre">j</span> <span class="pre">&lt;</span> <span class="pre">i</span></code> then <code class="docutils literal notranslate"><span class="pre">M[i][j]</span></code> is undefined.</p>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sympy.polys</span> <span class="kn">import</span> <span class="n">Poly</span><span class="p">,</span> <span class="n">cyclotomic_poly</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sympy.polys.numberfields.modules</span> <span class="kn">import</span> <span class="n">PowerBasis</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">T</span> <span class="o">=</span> <span class="n">Poly</span><span class="p">(</span><span class="n">cyclotomic_poly</span><span class="p">(</span><span class="mi">5</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">A</span> <span class="o">=</span> <span class="n">PowerBasis</span><span class="p">(</span><span class="n">T</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">A</span><span class="o">.</span><span class="n">mult_tab</span><span class="p">())</span>  
<span class="go">{0: {0: [1, 0, 0, 0], 1: [0, 1, 0, 0], 2: [0, 0, 1, 0],     3: [0, 0, 0, 1]},</span>
<span class="go">                  1: {1: [0, 0, 1, 0], 2: [0, 0, 0, 1],     3: [-1, -1, -1, -1]},</span>
<span class="go">                                   2: {2: [-1, -1, -1, -1], 3: [1, 0, 0, 0]},</span>
<span class="go">                                                        3: {3: [0, 1, 0, 0]}}</span>
</pre></div>
</div>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="sympy.polys.numberfields.modules.Module.n">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">n</span></span><a class="headerlink" href="#sympy.polys.numberfields.modules.Module.n" title="Permalink to this definition">¶</a></dt>
<dd><p>The number of generators of this module.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sympy.polys.numberfields.modules.Module.nearest_common_ancestor">
<span class="sig-name descname"><span class="pre">nearest_common_ancestor</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">other</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/sympy/sympy/blob/180fe9384a7cd4c51be1b26da453d299219e02ec/sympy/polys/numberfields/modules.py#L414-L437"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sympy.polys.numberfields.modules.Module.nearest_common_ancestor" title="Permalink to this definition">¶</a></dt>
<dd><p>Locate the nearest common ancestor of this module and another.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p><a class="reference internal" href="#sympy.polys.numberfields.modules.Module" title="sympy.polys.numberfields.modules.Module"><code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code></a>, <code class="docutils literal notranslate"><span class="pre">None</span></code></p>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="#sympy.polys.numberfields.modules.Module" title="sympy.polys.numberfields.modules.Module"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Module</span></code></a></p>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sympy.polys.numberfields.modules.Module.one">
<span class="sig-name descname"><span class="pre">one</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference external" href="https://github.com/sympy/sympy/blob/180fe9384a7cd4c51be1b26da453d299219e02ec/sympy/polys/numberfields/modules.py#L504-L510"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sympy.polys.numberfields.modules.Module.one" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a <a class="reference internal" href="#sympy.polys.numberfields.modules.ModuleElement" title="sympy.polys.numberfields.modules.ModuleElement"><code class="xref py py-class docutils literal notranslate"><span class="pre">ModuleElement</span></code></a> representing unity,
and belonging to the first ancestor of this module (including
itself) that starts with unity.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="sympy.polys.numberfields.modules.Module.parent">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">parent</span></span><a class="headerlink" href="#sympy.polys.numberfields.modules.Module.parent" title="Permalink to this definition">¶</a></dt>
<dd><p>The parent module, if any, for this module.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p><a class="reference internal" href="#sympy.polys.numberfields.modules.Module" title="sympy.polys.numberfields.modules.Module"><code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code></a>, <code class="docutils literal notranslate"><span class="pre">None</span></code></p>
</dd>
</dl>
<p class="rubric">Explanation</p>
<p>For a <a class="reference internal" href="#sympy.polys.numberfields.modules.Submodule" title="sympy.polys.numberfields.modules.Submodule"><code class="xref py py-class docutils literal notranslate"><span class="pre">Submodule</span></code></a> this is its <code class="docutils literal notranslate"><span class="pre">parent</span></code> attribute; for a
<a class="reference internal" href="#sympy.polys.numberfields.modules.PowerBasis" title="sympy.polys.numberfields.modules.PowerBasis"><code class="xref py py-class docutils literal notranslate"><span class="pre">PowerBasis</span></code></a> this is <code class="docutils literal notranslate"><span class="pre">None</span></code>.</p>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="#sympy.polys.numberfields.modules.Module" title="sympy.polys.numberfields.modules.Module"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Module</span></code></a></p>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sympy.polys.numberfields.modules.Module.power_basis_ancestor">
<span class="sig-name descname"><span class="pre">power_basis_ancestor</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference external" href="https://github.com/sympy/sympy/blob/180fe9384a7cd4c51be1b26da453d299219e02ec/sympy/polys/numberfields/modules.py#L397-L412"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sympy.polys.numberfields.modules.Module.power_basis_ancestor" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the <a class="reference internal" href="#sympy.polys.numberfields.modules.PowerBasis" title="sympy.polys.numberfields.modules.PowerBasis"><code class="xref py py-class docutils literal notranslate"><span class="pre">PowerBasis</span></code></a> that is an ancestor of this module.</p>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="#sympy.polys.numberfields.modules.Module" title="sympy.polys.numberfields.modules.Module"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Module</span></code></a></p>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sympy.polys.numberfields.modules.Module.represent">
<span class="sig-name descname"><span class="pre">represent</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">elt</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/sympy/sympy/blob/180fe9384a7cd4c51be1b26da453d299219e02ec/sympy/polys/numberfields/modules.py#L290-L377"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sympy.polys.numberfields.modules.Module.represent" title="Permalink to this definition">¶</a></dt>
<dd><p>Represent a module element as an integer-linear combination over the
generators of this module.</p>
<dl class="field-list">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>elt</strong> : <a class="reference internal" href="#sympy.polys.numberfields.modules.ModuleElement" title="sympy.polys.numberfields.modules.ModuleElement"><code class="xref py py-class docutils literal notranslate"><span class="pre">ModuleElement</span></code></a></p>
<blockquote>
<div><p>The module element to be represented. Must belong to some ancestor
module of this module (including this module itself).</p>
</div></blockquote>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><a class="reference internal" href="domainmatrix.html#sympy.polys.matrices.domainmatrix.DomainMatrix" title="sympy.polys.matrices.domainmatrix.DomainMatrix"><code class="xref py py-class docutils literal notranslate"><span class="pre">DomainMatrix</span></code></a> over <a class="reference internal" href="domainsref.html#zz"><span class="std std-ref">ZZ</span></a></p>
<blockquote>
<div><p>This will be a column vector, representing the coefficients of a
linear combination of this module’s generators, which equals the
given element.</p>
</div></blockquote>
</dd>
<dt class="field-odd">Raises</dt>
<dd class="field-odd"><p><strong>ClosureFailure</strong></p>
<blockquote>
<div><p>If the given element cannot be represented as a <a class="reference internal" href="domainsref.html#zz"><span class="std std-ref">ZZ</span></a>-linear
combination over this module.</p>
</div></blockquote>
</dd>
</dl>
<p class="rubric">Explanation</p>
<p>In our system, to “represent” always means to write a
<a class="reference internal" href="#sympy.polys.numberfields.modules.ModuleElement" title="sympy.polys.numberfields.modules.ModuleElement"><code class="xref py py-class docutils literal notranslate"><span class="pre">ModuleElement</span></code></a> as a <a class="reference internal" href="domainsref.html#zz"><span class="std std-ref">ZZ</span></a>-linear combination over the
generators of the present <a class="reference internal" href="#sympy.polys.numberfields.modules.Module" title="sympy.polys.numberfields.modules.Module"><code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code></a>. Furthermore, the
incoming <a class="reference internal" href="#sympy.polys.numberfields.modules.ModuleElement" title="sympy.polys.numberfields.modules.ModuleElement"><code class="xref py py-class docutils literal notranslate"><span class="pre">ModuleElement</span></code></a> must belong to an ancestor of
the present <a class="reference internal" href="#sympy.polys.numberfields.modules.Module" title="sympy.polys.numberfields.modules.Module"><code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code></a> (or to the present
<a class="reference internal" href="#sympy.polys.numberfields.modules.Module" title="sympy.polys.numberfields.modules.Module"><code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code></a> itself).</p>
<p>The most common application is to represent a
<a class="reference internal" href="#sympy.polys.numberfields.modules.ModuleElement" title="sympy.polys.numberfields.modules.ModuleElement"><code class="xref py py-class docutils literal notranslate"><span class="pre">ModuleElement</span></code></a> in a <a class="reference internal" href="#sympy.polys.numberfields.modules.Submodule" title="sympy.polys.numberfields.modules.Submodule"><code class="xref py py-class docutils literal notranslate"><span class="pre">Submodule</span></code></a>. For example,
this is involved in computing multiplication tables.</p>
<p>On the other hand, representing in a <a class="reference internal" href="#sympy.polys.numberfields.modules.PowerBasis" title="sympy.polys.numberfields.modules.PowerBasis"><code class="xref py py-class docutils literal notranslate"><span class="pre">PowerBasis</span></code></a> is an
odd case, and one which tends not to arise in practice, except for
example when using a <a class="reference internal" href="#sympy.polys.numberfields.modules.ModuleEndomorphism" title="sympy.polys.numberfields.modules.ModuleEndomorphism"><code class="xref py py-class docutils literal notranslate"><span class="pre">ModuleEndomorphism</span></code></a> on a
<a class="reference internal" href="#sympy.polys.numberfields.modules.PowerBasis" title="sympy.polys.numberfields.modules.PowerBasis"><code class="xref py py-class docutils literal notranslate"><span class="pre">PowerBasis</span></code></a>.</p>
<p>In such a case, (1) the incoming <a class="reference internal" href="#sympy.polys.numberfields.modules.ModuleElement" title="sympy.polys.numberfields.modules.ModuleElement"><code class="xref py py-class docutils literal notranslate"><span class="pre">ModuleElement</span></code></a> must
belong to the <a class="reference internal" href="#sympy.polys.numberfields.modules.PowerBasis" title="sympy.polys.numberfields.modules.PowerBasis"><code class="xref py py-class docutils literal notranslate"><span class="pre">PowerBasis</span></code></a> itself (since the latter has no
proper ancestors) and (2) it is “representable” iff it belongs to
<span class="math notranslate nohighlight">\(\mathbb{Z}[\theta]\)</span> (although generally a
<a class="reference internal" href="#sympy.polys.numberfields.modules.PowerBasisElement" title="sympy.polys.numberfields.modules.PowerBasisElement"><code class="xref py py-class docutils literal notranslate"><span class="pre">PowerBasisElement</span></code></a> may represent any element of
<span class="math notranslate nohighlight">\(\mathbb{Q}(\theta)\)</span>, i.e. any algebraic number).</p>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sympy</span> <span class="kn">import</span> <span class="n">Poly</span><span class="p">,</span> <span class="n">cyclotomic_poly</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sympy.polys.numberfields.modules</span> <span class="kn">import</span> <span class="n">PowerBasis</span><span class="p">,</span> <span class="n">to_col</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sympy.abc</span> <span class="kn">import</span> <span class="n">zeta</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">T</span> <span class="o">=</span> <span class="n">Poly</span><span class="p">(</span><span class="n">cyclotomic_poly</span><span class="p">(</span><span class="mi">5</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">A</span> <span class="o">=</span> <span class="n">PowerBasis</span><span class="p">(</span><span class="n">T</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a</span> <span class="o">=</span> <span class="n">A</span><span class="p">(</span><span class="n">to_col</span><span class="p">([</span><span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">8</span><span class="p">]))</span>
</pre></div>
</div>
<p>The <a class="reference internal" href="#sympy.polys.numberfields.modules.ModuleElement" title="sympy.polys.numberfields.modules.ModuleElement"><code class="xref py py-class docutils literal notranslate"><span class="pre">ModuleElement</span></code></a> <code class="docutils literal notranslate"><span class="pre">a</span></code> has all even coefficients.
If we represent <code class="docutils literal notranslate"><span class="pre">a</span></code> in the submodule <code class="docutils literal notranslate"><span class="pre">B</span> <span class="pre">=</span> <span class="pre">2*A</span></code>, the coefficients in
the column vector will be halved:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">B</span> <span class="o">=</span> <span class="n">A</span><span class="o">.</span><span class="n">submodule_from_gens</span><span class="p">([</span><span class="mi">2</span><span class="o">*</span><span class="n">A</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">4</span><span class="p">)])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">b</span> <span class="o">=</span> <span class="n">B</span><span class="o">.</span><span class="n">represent</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">b</span><span class="o">.</span><span class="n">transpose</span><span class="p">())</span>  
<span class="go">DomainMatrix([[1, 2, 3, 4]], (1, 4), ZZ)</span>
</pre></div>
</div>
<p>However, the element of <code class="docutils literal notranslate"><span class="pre">B</span></code> so defined still represents the same
algebraic number:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">a</span><span class="o">.</span><span class="n">poly</span><span class="p">(</span><span class="n">zeta</span><span class="p">)</span><span class="o">.</span><span class="n">as_expr</span><span class="p">())</span>
<span class="go">8*zeta**3 + 6*zeta**2 + 4*zeta + 2</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">B</span><span class="p">(</span><span class="n">b</span><span class="p">)</span><span class="o">.</span><span class="n">over_power_basis</span><span class="p">()</span><span class="o">.</span><span class="n">poly</span><span class="p">(</span><span class="n">zeta</span><span class="p">)</span><span class="o">.</span><span class="n">as_expr</span><span class="p">())</span>
<span class="go">8*zeta**3 + 6*zeta**2 + 4*zeta + 2</span>
</pre></div>
</div>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="#sympy.polys.numberfields.modules.Submodule.represent" title="sympy.polys.numberfields.modules.Submodule.represent"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Submodule.represent</span></code></a>, <a class="reference internal" href="#sympy.polys.numberfields.modules.PowerBasis.represent" title="sympy.polys.numberfields.modules.PowerBasis.represent"><code class="xref py py-obj docutils literal notranslate"><span class="pre">PowerBasis.represent</span></code></a></p>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sympy.polys.numberfields.modules.Module.starts_with_unity">
<span class="sig-name descname"><span class="pre">starts_with_unity</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference external" href="https://github.com/sympy/sympy/blob/180fe9384a7cd4c51be1b26da453d299219e02ec/sympy/polys/numberfields/modules.py#L489-L491"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sympy.polys.numberfields.modules.Module.starts_with_unity" title="Permalink to this definition">¶</a></dt>
<dd><p>Say whether the module’s first generator equals unity.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sympy.polys.numberfields.modules.Module.submodule_from_gens">
<span class="sig-name descname"><span class="pre">submodule_from_gens</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">gens</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hnf</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hnf_modulus</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/sympy/sympy/blob/180fe9384a7cd4c51be1b26da453d299219e02ec/sympy/polys/numberfields/modules.py#L547-L596"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sympy.polys.numberfields.modules.Module.submodule_from_gens" title="Permalink to this definition">¶</a></dt>
<dd><p>Form the submodule generated by a list of <a class="reference internal" href="#sympy.polys.numberfields.modules.ModuleElement" title="sympy.polys.numberfields.modules.ModuleElement"><code class="xref py py-class docutils literal notranslate"><span class="pre">ModuleElement</span></code></a>
belonging to this module.</p>
<dl class="field-list">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>gens</strong> : list of <a class="reference internal" href="#sympy.polys.numberfields.modules.ModuleElement" title="sympy.polys.numberfields.modules.ModuleElement"><code class="xref py py-class docutils literal notranslate"><span class="pre">ModuleElement</span></code></a> belonging to this module.</p>
<p><strong>hnf</strong> : boolean, optional (default=True)</p>
<blockquote>
<div><p>If True, we will reduce the matrix into Hermite Normal Form before
forming the <a class="reference internal" href="#sympy.polys.numberfields.modules.Submodule" title="sympy.polys.numberfields.modules.Submodule"><code class="xref py py-class docutils literal notranslate"><span class="pre">Submodule</span></code></a>.</p>
</div></blockquote>
<p><strong>hnf_modulus</strong> : int, None, optional (default=None)</p>
<blockquote>
<div><p>Modulus for use in the HNF reduction algorithm. See
<a class="reference internal" href="domainmatrix.html#sympy.polys.matrices.normalforms.hermite_normal_form" title="sympy.polys.matrices.normalforms.hermite_normal_form"><code class="xref py py-func docutils literal notranslate"><span class="pre">hermite_normal_form()</span></code></a>.</p>
</div></blockquote>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><a class="reference internal" href="#sympy.polys.numberfields.modules.Submodule" title="sympy.polys.numberfields.modules.Submodule"><code class="xref py py-class docutils literal notranslate"><span class="pre">Submodule</span></code></a></p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sympy.polys</span> <span class="kn">import</span> <span class="n">Poly</span><span class="p">,</span> <span class="n">cyclotomic_poly</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sympy.polys.numberfields.modules</span> <span class="kn">import</span> <span class="n">PowerBasis</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">T</span> <span class="o">=</span> <span class="n">Poly</span><span class="p">(</span><span class="n">cyclotomic_poly</span><span class="p">(</span><span class="mi">5</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">A</span> <span class="o">=</span> <span class="n">PowerBasis</span><span class="p">(</span><span class="n">T</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">gens</span> <span class="o">=</span> <span class="p">[</span><span class="n">A</span><span class="p">(</span><span class="mi">0</span><span class="p">),</span> <span class="mi">2</span><span class="o">*</span><span class="n">A</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="mi">3</span><span class="o">*</span><span class="n">A</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span> <span class="mi">4</span><span class="o">*</span><span class="n">A</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="o">//</span><span class="mi">5</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">B</span> <span class="o">=</span> <span class="n">A</span><span class="o">.</span><span class="n">submodule_from_gens</span><span class="p">(</span><span class="n">gens</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">B</span><span class="p">)</span>  
<span class="go">Submodule[[5, 0, 0, 0], [0, 10, 0, 0], [0, 0, 15, 0], [0, 0, 0, 4]]/5</span>
</pre></div>
</div>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="#sympy.polys.numberfields.modules.Module.submodule_from_matrix" title="sympy.polys.numberfields.modules.Module.submodule_from_matrix"><code class="xref py py-obj docutils literal notranslate"><span class="pre">submodule_from_matrix</span></code></a></p>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sympy.polys.numberfields.modules.Module.submodule_from_matrix">
<span class="sig-name descname"><span class="pre">submodule_from_matrix</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">B</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">denom</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/sympy/sympy/blob/180fe9384a7cd4c51be1b26da453d299219e02ec/sympy/polys/numberfields/modules.py#L598-L651"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sympy.polys.numberfields.modules.Module.submodule_from_matrix" title="Permalink to this definition">¶</a></dt>
<dd><p>Form the submodule generated by the elements of this module indicated
by the columns of a matrix, with an optional denominator.</p>
<dl class="field-list">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>B</strong> : <a class="reference internal" href="domainmatrix.html#sympy.polys.matrices.domainmatrix.DomainMatrix" title="sympy.polys.matrices.domainmatrix.DomainMatrix"><code class="xref py py-class docutils literal notranslate"><span class="pre">DomainMatrix</span></code></a> over <a class="reference internal" href="domainsref.html#zz"><span class="std std-ref">ZZ</span></a></p>
<blockquote>
<div><p>Each column gives the numerators of the coefficients of one
generator of the submodule. Thus, the number of rows of <em>B</em> must
equal the number of generators of the present module.</p>
</div></blockquote>
<p><strong>denom</strong> : int, optional (default=1)</p>
<blockquote>
<div><p>Common denominator for all generators of the submodule.</p>
</div></blockquote>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><a class="reference internal" href="#sympy.polys.numberfields.modules.Submodule" title="sympy.polys.numberfields.modules.Submodule"><code class="xref py py-class docutils literal notranslate"><span class="pre">Submodule</span></code></a></p>
</dd>
<dt class="field-odd">Raises</dt>
<dd class="field-odd"><p><strong>ValueError</strong></p>
<blockquote>
<div><p>If the given matrix <em>B</em> is not over <a class="reference internal" href="domainsref.html#zz"><span class="std std-ref">ZZ</span></a> or its number of rows
does not equal the number of generators of the present module.</p>
</div></blockquote>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sympy.polys</span> <span class="kn">import</span> <span class="n">Poly</span><span class="p">,</span> <span class="n">cyclotomic_poly</span><span class="p">,</span> <span class="n">ZZ</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sympy.polys.matrices</span> <span class="kn">import</span> <span class="n">DM</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sympy.polys.numberfields.modules</span> <span class="kn">import</span> <span class="n">PowerBasis</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">T</span> <span class="o">=</span> <span class="n">Poly</span><span class="p">(</span><span class="n">cyclotomic_poly</span><span class="p">(</span><span class="mi">5</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">A</span> <span class="o">=</span> <span class="n">PowerBasis</span><span class="p">(</span><span class="n">T</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">B</span> <span class="o">=</span> <span class="n">A</span><span class="o">.</span><span class="n">submodule_from_matrix</span><span class="p">(</span><span class="n">DM</span><span class="p">([</span>
<span class="gp">... </span>    <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
<span class="gp">... </span>    <span class="p">[</span><span class="mi">0</span><span class="p">,</span>  <span class="mi">0</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
<span class="gp">... </span><span class="p">],</span> <span class="n">ZZ</span><span class="p">)</span><span class="o">.</span><span class="n">transpose</span><span class="p">(),</span> <span class="n">denom</span><span class="o">=</span><span class="mi">15</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">B</span><span class="p">)</span>  
<span class="go">Submodule[[0, 10, 0, 0], [0, 0, 7, 0]]/15</span>
</pre></div>
</div>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="#sympy.polys.numberfields.modules.Module.submodule_from_gens" title="sympy.polys.numberfields.modules.Module.submodule_from_gens"><code class="xref py py-obj docutils literal notranslate"><span class="pre">submodule_from_gens</span></code></a></p>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sympy.polys.numberfields.modules.Module.whole_submodule">
<span class="sig-name descname"><span class="pre">whole_submodule</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference external" href="https://github.com/sympy/sympy/blob/180fe9384a7cd4c51be1b26da453d299219e02ec/sympy/polys/numberfields/modules.py#L653-L666"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sympy.polys.numberfields.modules.Module.whole_submodule" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a submodule equal to this entire module.</p>
<p class="rubric">Explanation</p>
<p>This is useful when you have a <a class="reference internal" href="#sympy.polys.numberfields.modules.PowerBasis" title="sympy.polys.numberfields.modules.PowerBasis"><code class="xref py py-class docutils literal notranslate"><span class="pre">PowerBasis</span></code></a> and want to
turn it into a <a class="reference internal" href="#sympy.polys.numberfields.modules.Submodule" title="sympy.polys.numberfields.modules.Submodule"><code class="xref py py-class docutils literal notranslate"><span class="pre">Submodule</span></code></a> (in order to use methods
belonging to the latter).</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sympy.polys.numberfields.modules.Module.zero">
<span class="sig-name descname"><span class="pre">zero</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference external" href="https://github.com/sympy/sympy/blob/180fe9384a7cd4c51be1b26da453d299219e02ec/sympy/polys/numberfields/modules.py#L500-L502"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sympy.polys.numberfields.modules.Module.zero" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a <a class="reference internal" href="#sympy.polys.numberfields.modules.ModuleElement" title="sympy.polys.numberfields.modules.ModuleElement"><code class="xref py py-class docutils literal notranslate"><span class="pre">ModuleElement</span></code></a> representing zero.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="sympy.polys.numberfields.modules.PowerBasis">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">sympy.polys.numberfields.modules.</span></span><span class="sig-name descname"><span class="pre">PowerBasis</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">T</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/sympy/sympy/blob/180fe9384a7cd4c51be1b26da453d299219e02ec/sympy/polys/numberfields/modules.py#L673-L766"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sympy.polys.numberfields.modules.PowerBasis" title="Permalink to this definition">¶</a></dt>
<dd><p>The module generated by the powers of an algebraic integer.</p>
<dl class="py method">
<dt class="sig sig-object py" id="sympy.polys.numberfields.modules.PowerBasis.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">T</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/sympy/sympy/blob/180fe9384a7cd4c51be1b26da453d299219e02ec/sympy/polys/numberfields/modules.py#L676-L688"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sympy.polys.numberfields.modules.PowerBasis.__init__" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>T</strong> : <a class="reference internal" href="reference.html#sympy.polys.polytools.Poly" title="sympy.polys.polytools.Poly"><code class="xref py py-class docutils literal notranslate"><span class="pre">Poly</span></code></a></p>
<blockquote>
<div><p>The monic, irreducible, univariate polynomial over <a class="reference internal" href="domainsref.html#zz"><span class="std std-ref">ZZ</span></a>, a
root of which is the generator of the power basis.</p>
</div></blockquote>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sympy.polys.numberfields.modules.PowerBasis.element_from_poly">
<span class="sig-name descname"><span class="pre">element_from_poly</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">f</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/sympy/sympy/blob/180fe9384a7cd4c51be1b26da453d299219e02ec/sympy/polys/numberfields/modules.py#L740-L766"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sympy.polys.numberfields.modules.PowerBasis.element_from_poly" title="Permalink to this definition">¶</a></dt>
<dd><p>Produce an element of this module, representing <em>f</em> after reduction mod
our defining minimal polynomial.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>f</strong> : <a class="reference internal" href="reference.html#sympy.polys.polytools.Poly" title="sympy.polys.polytools.Poly"><code class="xref py py-class docutils literal notranslate"><span class="pre">Poly</span></code></a> over <a class="reference internal" href="domainsref.html#zz"><span class="std std-ref">ZZ</span></a> in same var as our defining poly.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><a class="reference internal" href="#sympy.polys.numberfields.modules.PowerBasisElement" title="sympy.polys.numberfields.modules.PowerBasisElement"><code class="xref py py-class docutils literal notranslate"><span class="pre">PowerBasisElement</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sympy.polys.numberfields.modules.PowerBasis.represent">
<span class="sig-name descname"><span class="pre">represent</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">elt</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/sympy/sympy/blob/180fe9384a7cd4c51be1b26da453d299219e02ec/sympy/polys/numberfields/modules.py#L717-L732"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sympy.polys.numberfields.modules.PowerBasis.represent" title="Permalink to this definition">¶</a></dt>
<dd><p>Represent a module element as an integer-linear combination over the
generators of this module.</p>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="#sympy.polys.numberfields.modules.Module.represent" title="sympy.polys.numberfields.modules.Module.represent"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Module.represent</span></code></a>, <a class="reference internal" href="#sympy.polys.numberfields.modules.Submodule.represent" title="sympy.polys.numberfields.modules.Submodule.represent"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Submodule.represent</span></code></a></p>
</div>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="sympy.polys.numberfields.modules.Submodule">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">sympy.polys.numberfields.modules.</span></span><span class="sig-name descname"><span class="pre">Submodule</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">parent</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">matrix</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">denom</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mult_tab</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/sympy/sympy/blob/180fe9384a7cd4c51be1b26da453d299219e02ec/sympy/polys/numberfields/modules.py#L769-L1091"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sympy.polys.numberfields.modules.Submodule" title="Permalink to this definition">¶</a></dt>
<dd><p>A submodule of another module.</p>
<dl class="py method">
<dt class="sig sig-object py" id="sympy.polys.numberfields.modules.Submodule.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">parent</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">matrix</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">denom</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mult_tab</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/sympy/sympy/blob/180fe9384a7cd4c51be1b26da453d299219e02ec/sympy/polys/numberfields/modules.py#L772-L796"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sympy.polys.numberfields.modules.Submodule.__init__" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>parent</strong> : <a class="reference internal" href="#sympy.polys.numberfields.modules.Module" title="sympy.polys.numberfields.modules.Module"><code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code></a></p>
<blockquote>
<div><p>The module from which this one is derived.</p>
</div></blockquote>
<p><strong>matrix</strong> : <a class="reference internal" href="domainmatrix.html#sympy.polys.matrices.domainmatrix.DomainMatrix" title="sympy.polys.matrices.domainmatrix.DomainMatrix"><code class="xref py py-class docutils literal notranslate"><span class="pre">DomainMatrix</span></code></a> over <a class="reference internal" href="domainsref.html#zz"><span class="std std-ref">ZZ</span></a></p>
<blockquote>
<div><p>The matrix whose columns define this submodule’s generators as
linear combinations over the parent’s generators.</p>
</div></blockquote>
<p><strong>denom</strong> : int, optional (default=1)</p>
<blockquote>
<div><p>Denominator for the coefficients given by the matrix.</p>
</div></blockquote>
<p><strong>mult_tab</strong> : dict, <code class="docutils literal notranslate"><span class="pre">None</span></code>, optional</p>
<blockquote>
<div><p>If already known, the multiplication table for this module may be
supplied.</p>
</div></blockquote>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="sympy.polys.numberfields.modules.Submodule.QQ_matrix">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">QQ_matrix</span></span><a class="headerlink" href="#sympy.polys.numberfields.modules.Submodule.QQ_matrix" title="Permalink to this definition">¶</a></dt>
<dd><p><a class="reference internal" href="domainmatrix.html#sympy.polys.matrices.domainmatrix.DomainMatrix" title="sympy.polys.matrices.domainmatrix.DomainMatrix"><code class="xref py py-class docutils literal notranslate"><span class="pre">DomainMatrix</span></code></a> over <a class="reference internal" href="domainsref.html#qq"><span class="std std-ref">QQ</span></a>, equal to
<code class="docutils literal notranslate"><span class="pre">self.matrix</span> <span class="pre">/</span> <span class="pre">self.denom</span></code>, and guaranteed to be dense.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p><a class="reference internal" href="domainmatrix.html#sympy.polys.matrices.domainmatrix.DomainMatrix" title="sympy.polys.matrices.domainmatrix.DomainMatrix"><code class="xref py py-class docutils literal notranslate"><span class="pre">DomainMatrix</span></code></a> over <a class="reference internal" href="domainsref.html#qq"><span class="std std-ref">QQ</span></a></p>
</dd>
</dl>
<p class="rubric">Explanation</p>
<p>Depending on how it is formed, a <a class="reference internal" href="domainmatrix.html#sympy.polys.matrices.domainmatrix.DomainMatrix" title="sympy.polys.matrices.domainmatrix.DomainMatrix"><code class="xref py py-class docutils literal notranslate"><span class="pre">DomainMatrix</span></code></a> may have
an internal representation that is sparse or dense. We guarantee a
dense representation here, so that tests for equivalence of submodules
always come out as expected.</p>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sympy.polys</span> <span class="kn">import</span> <span class="n">Poly</span><span class="p">,</span> <span class="n">cyclotomic_poly</span><span class="p">,</span> <span class="n">ZZ</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sympy.abc</span> <span class="kn">import</span> <span class="n">x</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sympy.polys.matrices</span> <span class="kn">import</span> <span class="n">DomainMatrix</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sympy.polys.numberfields.modules</span> <span class="kn">import</span> <span class="n">PowerBasis</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">T</span> <span class="o">=</span> <span class="n">Poly</span><span class="p">(</span><span class="n">cyclotomic_poly</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="n">x</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">A</span> <span class="o">=</span> <span class="n">PowerBasis</span><span class="p">(</span><span class="n">T</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">B</span> <span class="o">=</span> <span class="n">A</span><span class="o">.</span><span class="n">submodule_from_matrix</span><span class="p">(</span><span class="mi">3</span><span class="o">*</span><span class="n">DomainMatrix</span><span class="o">.</span><span class="n">eye</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="n">ZZ</span><span class="p">),</span> <span class="n">denom</span><span class="o">=</span><span class="mi">6</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">C</span> <span class="o">=</span> <span class="n">A</span><span class="o">.</span><span class="n">submodule_from_matrix</span><span class="p">(</span><span class="n">DomainMatrix</span><span class="o">.</span><span class="n">eye</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="n">ZZ</span><span class="p">),</span> <span class="n">denom</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">B</span><span class="o">.</span><span class="n">QQ_matrix</span> <span class="o">==</span> <span class="n">C</span><span class="o">.</span><span class="n">QQ_matrix</span><span class="p">)</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sympy.polys.numberfields.modules.Submodule.add">
<span class="sig-name descname"><span class="pre">add</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">other</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hnf</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hnf_modulus</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/sympy/sympy/blob/180fe9384a7cd4c51be1b26da453d299219e02ec/sympy/polys/numberfields/modules.py#L987-L1021"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sympy.polys.numberfields.modules.Submodule.add" title="Permalink to this definition">¶</a></dt>
<dd><p>Add this <a class="reference internal" href="#sympy.polys.numberfields.modules.Submodule" title="sympy.polys.numberfields.modules.Submodule"><code class="xref py py-class docutils literal notranslate"><span class="pre">Submodule</span></code></a> to another.</p>
<dl class="field-list">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>other</strong> : <a class="reference internal" href="#sympy.polys.numberfields.modules.Submodule" title="sympy.polys.numberfields.modules.Submodule"><code class="xref py py-class docutils literal notranslate"><span class="pre">Submodule</span></code></a></p>
<p><strong>hnf</strong> : boolean, optional (default=True)</p>
<blockquote>
<div><p>If <code class="docutils literal notranslate"><span class="pre">True</span></code>, reduce the matrix of the combined module to its
Hermite Normal Form.</p>
</div></blockquote>
<p><strong>hnf_modulus</strong> : <a class="reference internal" href="domainsref.html#zz"><span class="std std-ref">ZZ</span></a>, None, optional</p>
<blockquote>
<div><p>If a positive integer is provided, use this as modulus in the
HNF reduction. See
<a class="reference internal" href="domainmatrix.html#sympy.polys.matrices.normalforms.hermite_normal_form" title="sympy.polys.matrices.normalforms.hermite_normal_form"><code class="xref py py-func docutils literal notranslate"><span class="pre">hermite_normal_form()</span></code></a>.</p>
</div></blockquote>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><a class="reference internal" href="#sympy.polys.numberfields.modules.Submodule" title="sympy.polys.numberfields.modules.Submodule"><code class="xref py py-class docutils literal notranslate"><span class="pre">Submodule</span></code></a></p>
</dd>
</dl>
<p class="rubric">Explanation</p>
<p>This represents the module generated by the union of the two modules’
sets of generators.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sympy.polys.numberfields.modules.Submodule.basis_element_pullbacks">
<span class="sig-name descname"><span class="pre">basis_element_pullbacks</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference external" href="https://github.com/sympy/sympy/blob/180fe9384a7cd4c51be1b26da453d299219e02ec/sympy/polys/numberfields/modules.py#L937-L942"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sympy.polys.numberfields.modules.Submodule.basis_element_pullbacks" title="Permalink to this definition">¶</a></dt>
<dd><p>Return list of this submodule’s basis elements as elements of the
submodule’s parent module.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sympy.polys.numberfields.modules.Submodule.discard_before">
<span class="sig-name descname"><span class="pre">discard_before</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">r</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/sympy/sympy/blob/180fe9384a7cd4c51be1b26da453d299219e02ec/sympy/polys/numberfields/modules.py#L828-L843"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sympy.polys.numberfields.modules.Submodule.discard_before" title="Permalink to this definition">¶</a></dt>
<dd><p>Produce a new module by discarding all generators before a given
index <em>r</em>.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sympy.polys.numberfields.modules.Submodule.mul">
<span class="sig-name descname"><span class="pre">mul</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">other</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hnf</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hnf_modulus</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/sympy/sympy/blob/180fe9384a7cd4c51be1b26da453d299219e02ec/sympy/polys/numberfields/modules.py#L1030-L1083"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sympy.polys.numberfields.modules.Submodule.mul" title="Permalink to this definition">¶</a></dt>
<dd><p>Multiply this <a class="reference internal" href="#sympy.polys.numberfields.modules.Submodule" title="sympy.polys.numberfields.modules.Submodule"><code class="xref py py-class docutils literal notranslate"><span class="pre">Submodule</span></code></a> by a rational number, a
<a class="reference internal" href="#sympy.polys.numberfields.modules.ModuleElement" title="sympy.polys.numberfields.modules.ModuleElement"><code class="xref py py-class docutils literal notranslate"><span class="pre">ModuleElement</span></code></a>, or another <a class="reference internal" href="#sympy.polys.numberfields.modules.Submodule" title="sympy.polys.numberfields.modules.Submodule"><code class="xref py py-class docutils literal notranslate"><span class="pre">Submodule</span></code></a>.</p>
<dl class="field-list">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>other</strong> : int, <a class="reference internal" href="domainsref.html#zz"><span class="std std-ref">ZZ</span></a>, <a class="reference internal" href="domainsref.html#qq"><span class="std std-ref">QQ</span></a>, <a class="reference internal" href="#sympy.polys.numberfields.modules.ModuleElement" title="sympy.polys.numberfields.modules.ModuleElement"><code class="xref py py-class docutils literal notranslate"><span class="pre">ModuleElement</span></code></a>, <a class="reference internal" href="#sympy.polys.numberfields.modules.Submodule" title="sympy.polys.numberfields.modules.Submodule"><code class="xref py py-class docutils literal notranslate"><span class="pre">Submodule</span></code></a></p>
<p><strong>hnf</strong> : boolean, optional (default=True)</p>
<blockquote>
<div><p>If <code class="docutils literal notranslate"><span class="pre">True</span></code>, reduce the matrix of the product module to its
Hermite Normal Form.</p>
</div></blockquote>
<p><strong>hnf_modulus</strong> : <a class="reference internal" href="domainsref.html#zz"><span class="std std-ref">ZZ</span></a>, None, optional</p>
<blockquote>
<div><p>If a positive integer is provided, use this as modulus in the
HNF reduction. See
<a class="reference internal" href="domainmatrix.html#sympy.polys.matrices.normalforms.hermite_normal_form" title="sympy.polys.matrices.normalforms.hermite_normal_form"><code class="xref py py-func docutils literal notranslate"><span class="pre">hermite_normal_form()</span></code></a>.</p>
</div></blockquote>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><a class="reference internal" href="#sympy.polys.numberfields.modules.Submodule" title="sympy.polys.numberfields.modules.Submodule"><code class="xref py py-class docutils literal notranslate"><span class="pre">Submodule</span></code></a></p>
</dd>
</dl>
<p class="rubric">Explanation</p>
<p>To multiply by a rational number or <a class="reference internal" href="#sympy.polys.numberfields.modules.ModuleElement" title="sympy.polys.numberfields.modules.ModuleElement"><code class="xref py py-class docutils literal notranslate"><span class="pre">ModuleElement</span></code></a> means
to form the submodule whose generators are the products of this
quantity with all the generators of the present submodule.</p>
<p>To multiply by another <a class="reference internal" href="#sympy.polys.numberfields.modules.Submodule" title="sympy.polys.numberfields.modules.Submodule"><code class="xref py py-class docutils literal notranslate"><span class="pre">Submodule</span></code></a> means to form the
submodule whose generators are all the products of one generator from
the one submodule, and one generator from the other.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sympy.polys.numberfields.modules.Submodule.reduced">
<span class="sig-name descname"><span class="pre">reduced</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference external" href="https://github.com/sympy/sympy/blob/180fe9384a7cd4c51be1b26da453d299219e02ec/sympy/polys/numberfields/modules.py#L804-L826"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sympy.polys.numberfields.modules.Submodule.reduced" title="Permalink to this definition">¶</a></dt>
<dd><p>Produce a reduced version of this submodule.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p><a class="reference internal" href="#sympy.polys.numberfields.modules.Submodule" title="sympy.polys.numberfields.modules.Submodule"><code class="xref py py-class docutils literal notranslate"><span class="pre">Submodule</span></code></a></p>
</dd>
</dl>
<p class="rubric">Explanation</p>
<p>In the reduced version, it is guaranteed that 1 is the only positive
integer dividing both the submodule’s denominator, and every entry in
the submodule’s matrix.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sympy.polys.numberfields.modules.Submodule.represent">
<span class="sig-name descname"><span class="pre">represent</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">elt</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/sympy/sympy/blob/180fe9384a7cd4c51be1b26da453d299219e02ec/sympy/polys/numberfields/modules.py#L944-L977"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sympy.polys.numberfields.modules.Submodule.represent" title="Permalink to this definition">¶</a></dt>
<dd><p>Represent a module element as an integer-linear combination over the
generators of this module.</p>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="#sympy.polys.numberfields.modules.Module.represent" title="sympy.polys.numberfields.modules.Module.represent"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Module.represent</span></code></a>, <a class="reference internal" href="#sympy.polys.numberfields.modules.PowerBasis.represent" title="sympy.polys.numberfields.modules.PowerBasis.represent"><code class="xref py py-obj docutils literal notranslate"><span class="pre">PowerBasis.represent</span></code></a></p>
</div>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="sympy.polys.numberfields.modules.ModuleElement">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">sympy.polys.numberfields.modules.</span></span><span class="sig-name descname"><span class="pre">ModuleElement</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">module</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">col</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">denom</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/sympy/sympy/blob/180fe9384a7cd4c51be1b26da453d299219e02ec/sympy/polys/numberfields/modules.py#L1137-L1522"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sympy.polys.numberfields.modules.ModuleElement" title="Permalink to this definition">¶</a></dt>
<dd><p>Represents an element of a <a class="reference internal" href="#sympy.polys.numberfields.modules.Module" title="sympy.polys.numberfields.modules.Module"><code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code></a>.</p>
<p>NOTE: Should not be constructed directly. Use the
<a class="reference internal" href="#sympy.polys.numberfields.modules.Module.__call__" title="sympy.polys.numberfields.modules.Module.__call__"><code class="xref py py-meth docutils literal notranslate"><span class="pre">__call__()</span></code></a> method or the <a class="reference internal" href="#sympy.polys.numberfields.modules.make_mod_elt" title="sympy.polys.numberfields.modules.make_mod_elt"><code class="xref py py-func docutils literal notranslate"><span class="pre">make_mod_elt()</span></code></a>
factory function instead.</p>
<dl class="py method">
<dt class="sig sig-object py" id="sympy.polys.numberfields.modules.ModuleElement.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">module</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">col</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">denom</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/sympy/sympy/blob/180fe9384a7cd4c51be1b26da453d299219e02ec/sympy/polys/numberfields/modules.py#L1146-L1163"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sympy.polys.numberfields.modules.ModuleElement.__init__" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>module</strong> : <a class="reference internal" href="#sympy.polys.numberfields.modules.Module" title="sympy.polys.numberfields.modules.Module"><code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code></a></p>
<blockquote>
<div><p>The module to which this element belongs.</p>
</div></blockquote>
<p><strong>col</strong> : <a class="reference internal" href="domainmatrix.html#sympy.polys.matrices.domainmatrix.DomainMatrix" title="sympy.polys.matrices.domainmatrix.DomainMatrix"><code class="xref py py-class docutils literal notranslate"><span class="pre">DomainMatrix</span></code></a> over <a class="reference internal" href="domainsref.html#zz"><span class="std std-ref">ZZ</span></a></p>
<blockquote>
<div><p>Column vector giving the numerators of the coefficients of this
element.</p>
</div></blockquote>
<p><strong>denom</strong> : int, optional (default=1)</p>
<blockquote>
<div><p>Denominator for the coefficients of this element.</p>
</div></blockquote>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sympy.polys.numberfields.modules.ModuleElement.__add__">
<span class="sig-name descname"><span class="pre">__add__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">other</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/sympy/sympy/blob/180fe9384a7cd4c51be1b26da453d299219e02ec/sympy/polys/numberfields/modules.py#L1365-L1395"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sympy.polys.numberfields.modules.ModuleElement.__add__" title="Permalink to this definition">¶</a></dt>
<dd><p>A <a class="reference internal" href="#sympy.polys.numberfields.modules.ModuleElement" title="sympy.polys.numberfields.modules.ModuleElement"><code class="xref py py-class docutils literal notranslate"><span class="pre">ModuleElement</span></code></a> can be added to a rational number, or to
another <a class="reference internal" href="#sympy.polys.numberfields.modules.ModuleElement" title="sympy.polys.numberfields.modules.ModuleElement"><code class="xref py py-class docutils literal notranslate"><span class="pre">ModuleElement</span></code></a>.</p>
<p class="rubric">Explanation</p>
<p>When the other summand is a rational number, it will be converted into
a <a class="reference internal" href="#sympy.polys.numberfields.modules.ModuleElement" title="sympy.polys.numberfields.modules.ModuleElement"><code class="xref py py-class docutils literal notranslate"><span class="pre">ModuleElement</span></code></a> (belonging to the first ancestor of this
module that starts with unity).</p>
<p>In all cases, the sum belongs to the nearest common ancestor (NCA) of
the modules of the two summands. If the NCA does not exist, we return
<code class="docutils literal notranslate"><span class="pre">NotImplemented</span></code>.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sympy.polys.numberfields.modules.ModuleElement.__mul__">
<span class="sig-name descname"><span class="pre">__mul__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">other</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/sympy/sympy/blob/180fe9384a7cd4c51be1b26da453d299219e02ec/sympy/polys/numberfields/modules.py#L1408-L1455"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sympy.polys.numberfields.modules.ModuleElement.__mul__" title="Permalink to this definition">¶</a></dt>
<dd><p>A <a class="reference internal" href="#sympy.polys.numberfields.modules.ModuleElement" title="sympy.polys.numberfields.modules.ModuleElement"><code class="xref py py-class docutils literal notranslate"><span class="pre">ModuleElement</span></code></a> can be multiplied by a rational number,
or by another <a class="reference internal" href="#sympy.polys.numberfields.modules.ModuleElement" title="sympy.polys.numberfields.modules.ModuleElement"><code class="xref py py-class docutils literal notranslate"><span class="pre">ModuleElement</span></code></a>.</p>
<p class="rubric">Explanation</p>
<p>When the multiplier is a rational number, the product is computed by
operating directly on the coefficients of this
<a class="reference internal" href="#sympy.polys.numberfields.modules.ModuleElement" title="sympy.polys.numberfields.modules.ModuleElement"><code class="xref py py-class docutils literal notranslate"><span class="pre">ModuleElement</span></code></a>.</p>
<p>When the multiplier is another <a class="reference internal" href="#sympy.polys.numberfields.modules.ModuleElement" title="sympy.polys.numberfields.modules.ModuleElement"><code class="xref py py-class docutils literal notranslate"><span class="pre">ModuleElement</span></code></a>, the product
will belong to the nearest common ancestor (NCA) of the modules of the
two operands, and that NCA must have a multiplication table. If the NCA
does not exist, we return <code class="docutils literal notranslate"><span class="pre">NotImplemented</span></code>. If the NCA does not have
a mult. table, <code class="docutils literal notranslate"><span class="pre">ClosureFailure</span></code> will be raised.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sympy.polys.numberfields.modules.ModuleElement.__mod__">
<span class="sig-name descname"><span class="pre">__mod__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">m</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/sympy/sympy/blob/180fe9384a7cd4c51be1b26da453d299219e02ec/sympy/polys/numberfields/modules.py#L1476-L1522"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sympy.polys.numberfields.modules.ModuleElement.__mod__" title="Permalink to this definition">¶</a></dt>
<dd><p>Reducing a <a class="reference internal" href="#sympy.polys.numberfields.modules.ModuleElement" title="sympy.polys.numberfields.modules.ModuleElement"><code class="xref py py-class docutils literal notranslate"><span class="pre">ModuleElement</span></code></a> mod an integer <em>m</em> reduces all
numerator coeffs mod <span class="math notranslate nohighlight">\(d m\)</span>, where <span class="math notranslate nohighlight">\(d\)</span> is the denominator of the
<a class="reference internal" href="#sympy.polys.numberfields.modules.ModuleElement" title="sympy.polys.numberfields.modules.ModuleElement"><code class="xref py py-class docutils literal notranslate"><span class="pre">ModuleElement</span></code></a>.</p>
<p class="rubric">Explanation</p>
<p>Recall that a <a class="reference internal" href="#sympy.polys.numberfields.modules.ModuleElement" title="sympy.polys.numberfields.modules.ModuleElement"><code class="xref py py-class docutils literal notranslate"><span class="pre">ModuleElement</span></code></a> <span class="math notranslate nohighlight">\(b\)</span> represents a
<span class="math notranslate nohighlight">\(\mathbb{Q}\)</span>-linear combination over the basis elements
<span class="math notranslate nohighlight">\(\{\beta_0, \beta_1, \ldots, \beta_{n-1}\}\)</span> of a module <span class="math notranslate nohighlight">\(B\)</span>. It uses a
common denominator <span class="math notranslate nohighlight">\(d\)</span>, so that the representation is in the form
<span class="math notranslate nohighlight">\(b=\frac{c_0 \beta_0 + c_1 \beta_1 + \cdots + c_{n-1} \beta_{n-1}}{d}\)</span>,
with <span class="math notranslate nohighlight">\(d\)</span> and all <span class="math notranslate nohighlight">\(c_i\)</span> in <span class="math notranslate nohighlight">\(\mathbb{Z}\)</span>, and <span class="math notranslate nohighlight">\(d &gt; 0\)</span>.</p>
<p>If we want to work modulo <span class="math notranslate nohighlight">\(m B\)</span>, this means we want to reduce the
coefficients of <span class="math notranslate nohighlight">\(b\)</span> mod <span class="math notranslate nohighlight">\(m\)</span>. We can think of reducing an arbitrary
rational number <span class="math notranslate nohighlight">\(r/s\)</span> mod <span class="math notranslate nohighlight">\(m\)</span> as adding or subtracting an integer
multiple of <span class="math notranslate nohighlight">\(m\)</span> so that the result is positive and less than <span class="math notranslate nohighlight">\(m\)</span>.
But this is equivalent to reducing <span class="math notranslate nohighlight">\(r\)</span> mod <span class="math notranslate nohighlight">\(m \cdot s\)</span>.</p>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sympy</span> <span class="kn">import</span> <span class="n">Poly</span><span class="p">,</span> <span class="n">cyclotomic_poly</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sympy.polys.numberfields.modules</span> <span class="kn">import</span> <span class="n">PowerBasis</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">T</span> <span class="o">=</span> <span class="n">Poly</span><span class="p">(</span><span class="n">cyclotomic_poly</span><span class="p">(</span><span class="mi">5</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">A</span> <span class="o">=</span> <span class="n">PowerBasis</span><span class="p">(</span><span class="n">T</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a</span> <span class="o">=</span> <span class="p">(</span><span class="n">A</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span> <span class="o">+</span> <span class="mi">15</span><span class="o">*</span><span class="n">A</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="o">//</span><span class="mi">2</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
<span class="go">[1, 15, 0, 0]/2</span>
</pre></div>
</div>
<p>Here, <code class="docutils literal notranslate"><span class="pre">a</span></code> represents the number <span class="math notranslate nohighlight">\(\frac{1 + 15\zeta}{2}\)</span>. If we reduce
mod 7,</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">a</span> <span class="o">%</span> <span class="mi">7</span><span class="p">)</span>
<span class="go">[1, 1, 0, 0]/2</span>
</pre></div>
</div>
<p>we get <span class="math notranslate nohighlight">\(\frac{1 + \zeta}{2}\)</span>. Effectively, we subtracted <span class="math notranslate nohighlight">\(7 \zeta\)</span>.
But it was achieved by reducing the numerator coefficients mod <span class="math notranslate nohighlight">\(14\)</span>.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="sympy.polys.numberfields.modules.ModuleElement.QQ_col">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">QQ_col</span></span><a class="headerlink" href="#sympy.polys.numberfields.modules.ModuleElement.QQ_col" title="Permalink to this definition">¶</a></dt>
<dd><p><a class="reference internal" href="domainmatrix.html#sympy.polys.matrices.domainmatrix.DomainMatrix" title="sympy.polys.matrices.domainmatrix.DomainMatrix"><code class="xref py py-class docutils literal notranslate"><span class="pre">DomainMatrix</span></code></a> over <a class="reference internal" href="domainsref.html#qq"><span class="std std-ref">QQ</span></a>, equal to
<code class="docutils literal notranslate"><span class="pre">self.col</span> <span class="pre">/</span> <span class="pre">self.denom</span></code>, and guaranteed to be dense.</p>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="#sympy.polys.numberfields.modules.Submodule.QQ_matrix" title="sympy.polys.numberfields.modules.Submodule.QQ_matrix"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Submodule.QQ_matrix</span></code></a></p>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sympy.polys.numberfields.modules.ModuleElement.column">
<span class="sig-name descname"><span class="pre">column</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">domain</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/sympy/sympy/blob/180fe9384a7cd4c51be1b26da453d299219e02ec/sympy/polys/numberfields/modules.py#L1211-L1215"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sympy.polys.numberfields.modules.ModuleElement.column" title="Permalink to this definition">¶</a></dt>
<dd><p>Get a copy of this element’s column, optionally converting to a domain.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sympy.polys.numberfields.modules.ModuleElement.equiv">
<span class="sig-name descname"><span class="pre">equiv</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">other</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/sympy/sympy/blob/180fe9384a7cd4c51be1b26da453d299219e02ec/sympy/polys/numberfields/modules.py#L1319-L1363"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sympy.polys.numberfields.modules.ModuleElement.equiv" title="Permalink to this definition">¶</a></dt>
<dd><p>A <a class="reference internal" href="#sympy.polys.numberfields.modules.ModuleElement" title="sympy.polys.numberfields.modules.ModuleElement"><code class="xref py py-class docutils literal notranslate"><span class="pre">ModuleElement</span></code></a> may test as equivalent to a rational
number or another <a class="reference internal" href="#sympy.polys.numberfields.modules.ModuleElement" title="sympy.polys.numberfields.modules.ModuleElement"><code class="xref py py-class docutils literal notranslate"><span class="pre">ModuleElement</span></code></a>, if they represent the
same algebraic number.</p>
<dl class="field-list">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>other</strong> : int, <a class="reference internal" href="domainsref.html#zz"><span class="std std-ref">ZZ</span></a>, <a class="reference internal" href="domainsref.html#qq"><span class="std std-ref">QQ</span></a>, <a class="reference internal" href="#sympy.polys.numberfields.modules.ModuleElement" title="sympy.polys.numberfields.modules.ModuleElement"><code class="xref py py-class docutils literal notranslate"><span class="pre">ModuleElement</span></code></a></p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>bool</p>
</dd>
<dt class="field-odd">Raises</dt>
<dd class="field-odd"><p><strong>UnificationFailed</strong></p>
<blockquote>
<div><p>If <code class="docutils literal notranslate"><span class="pre">self</span></code> and <code class="docutils literal notranslate"><span class="pre">other</span></code> do not share a common
<a class="reference internal" href="#sympy.polys.numberfields.modules.PowerBasis" title="sympy.polys.numberfields.modules.PowerBasis"><code class="xref py py-class docutils literal notranslate"><span class="pre">PowerBasis</span></code></a> ancestor.</p>
</div></blockquote>
</dd>
</dl>
<p class="rubric">Explanation</p>
<p>This method is intended to check equivalence only in those cases in
which it is easy to test; namely, when <em>other</em> is either a
<a class="reference internal" href="#sympy.polys.numberfields.modules.ModuleElement" title="sympy.polys.numberfields.modules.ModuleElement"><code class="xref py py-class docutils literal notranslate"><span class="pre">ModuleElement</span></code></a> that can be unified with this one (i.e. one
which shares a common <a class="reference internal" href="#sympy.polys.numberfields.modules.PowerBasis" title="sympy.polys.numberfields.modules.PowerBasis"><code class="xref py py-class docutils literal notranslate"><span class="pre">PowerBasis</span></code></a> ancestor), or else a
rational number (which is easy because every <a class="reference internal" href="#sympy.polys.numberfields.modules.PowerBasis" title="sympy.polys.numberfields.modules.PowerBasis"><code class="xref py py-class docutils literal notranslate"><span class="pre">PowerBasis</span></code></a>
represents every rational number).</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sympy.polys.numberfields.modules.ModuleElement.from_int_list">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">from_int_list</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">module</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">coeffs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">denom</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/sympy/sympy/blob/180fe9384a7cd4c51be1b26da453d299219e02ec/sympy/polys/numberfields/modules.py#L1194-L1201"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sympy.polys.numberfields.modules.ModuleElement.from_int_list" title="Permalink to this definition">¶</a></dt>
<dd><p>Make a <a class="reference internal" href="#sympy.polys.numberfields.modules.ModuleElement" title="sympy.polys.numberfields.modules.ModuleElement"><code class="xref py py-class docutils literal notranslate"><span class="pre">ModuleElement</span></code></a> from a list of ints (instead of a
column vector).</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sympy.polys.numberfields.modules.ModuleElement.is_compat">
<span class="sig-name descname"><span class="pre">is_compat</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">other</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/sympy/sympy/blob/180fe9384a7cd4c51be1b26da453d299219e02ec/sympy/polys/numberfields/modules.py#L1274-L1279"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sympy.polys.numberfields.modules.ModuleElement.is_compat" title="Permalink to this definition">¶</a></dt>
<dd><p>Test whether other is another <a class="reference internal" href="#sympy.polys.numberfields.modules.ModuleElement" title="sympy.polys.numberfields.modules.ModuleElement"><code class="xref py py-class docutils literal notranslate"><span class="pre">ModuleElement</span></code></a> with same
module.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="sympy.polys.numberfields.modules.ModuleElement.n">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">n</span></span><a class="headerlink" href="#sympy.polys.numberfields.modules.ModuleElement.n" title="Permalink to this definition">¶</a></dt>
<dd><p>The length of this element’s column.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sympy.polys.numberfields.modules.ModuleElement.over_power_basis">
<span class="sig-name descname"><span class="pre">over_power_basis</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference external" href="https://github.com/sympy/sympy/blob/180fe9384a7cd4c51be1b26da453d299219e02ec/sympy/polys/numberfields/modules.py#L1264-L1272"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sympy.polys.numberfields.modules.ModuleElement.over_power_basis" title="Permalink to this definition">¶</a></dt>
<dd><p>Transform into a <a class="reference internal" href="#sympy.polys.numberfields.modules.PowerBasisElement" title="sympy.polys.numberfields.modules.PowerBasisElement"><code class="xref py py-class docutils literal notranslate"><span class="pre">PowerBasisElement</span></code></a> over our
<a class="reference internal" href="#sympy.polys.numberfields.modules.PowerBasis" title="sympy.polys.numberfields.modules.PowerBasis"><code class="xref py py-class docutils literal notranslate"><span class="pre">PowerBasis</span></code></a> ancestor.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sympy.polys.numberfields.modules.ModuleElement.reduced">
<span class="sig-name descname"><span class="pre">reduced</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference external" href="https://github.com/sympy/sympy/blob/180fe9384a7cd4c51be1b26da453d299219e02ec/sympy/polys/numberfields/modules.py#L1171-L1183"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sympy.polys.numberfields.modules.ModuleElement.reduced" title="Permalink to this definition">¶</a></dt>
<dd><p>Produce a reduced version of this ModuleElement, i.e. one in which the
gcd of the denominator together with all numerator coefficients is 1.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sympy.polys.numberfields.modules.ModuleElement.reduced_mod_p">
<span class="sig-name descname"><span class="pre">reduced_mod_p</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">p</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/sympy/sympy/blob/180fe9384a7cd4c51be1b26da453d299219e02ec/sympy/polys/numberfields/modules.py#L1185-L1192"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sympy.polys.numberfields.modules.ModuleElement.reduced_mod_p" title="Permalink to this definition">¶</a></dt>
<dd><p>Produce a version of this <a class="reference internal" href="#sympy.polys.numberfields.modules.ModuleElement" title="sympy.polys.numberfields.modules.ModuleElement"><code class="xref py py-class docutils literal notranslate"><span class="pre">ModuleElement</span></code></a> in which all
numerator coefficients have been reduced mod <em>p</em>.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sympy.polys.numberfields.modules.ModuleElement.to_ancestor">
<span class="sig-name descname"><span class="pre">to_ancestor</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">anc</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/sympy/sympy/blob/180fe9384a7cd4c51be1b26da453d299219e02ec/sympy/polys/numberfields/modules.py#L1248-L1262"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sympy.polys.numberfields.modules.ModuleElement.to_ancestor" title="Permalink to this definition">¶</a></dt>
<dd><p>Transform into a <a class="reference internal" href="#sympy.polys.numberfields.modules.ModuleElement" title="sympy.polys.numberfields.modules.ModuleElement"><code class="xref py py-class docutils literal notranslate"><span class="pre">ModuleElement</span></code></a> belonging to a given
ancestor of this element’s module.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>anc</strong> : <a class="reference internal" href="#sympy.polys.numberfields.modules.Module" title="sympy.polys.numberfields.modules.Module"><code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sympy.polys.numberfields.modules.ModuleElement.to_parent">
<span class="sig-name descname"><span class="pre">to_parent</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference external" href="https://github.com/sympy/sympy/blob/180fe9384a7cd4c51be1b26da453d299219e02ec/sympy/polys/numberfields/modules.py#L1237-L1246"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sympy.polys.numberfields.modules.ModuleElement.to_parent" title="Permalink to this definition">¶</a></dt>
<dd><p>Transform into a <a class="reference internal" href="#sympy.polys.numberfields.modules.ModuleElement" title="sympy.polys.numberfields.modules.ModuleElement"><code class="xref py py-class docutils literal notranslate"><span class="pre">ModuleElement</span></code></a> belonging to the parent of
this element’s module.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sympy.polys.numberfields.modules.ModuleElement.unify">
<span class="sig-name descname"><span class="pre">unify</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">other</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/sympy/sympy/blob/180fe9384a7cd4c51be1b26da453d299219e02ec/sympy/polys/numberfields/modules.py#L1281-L1312"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sympy.polys.numberfields.modules.ModuleElement.unify" title="Permalink to this definition">¶</a></dt>
<dd><p>Try to make a compatible pair of <a class="reference internal" href="#sympy.polys.numberfields.modules.ModuleElement" title="sympy.polys.numberfields.modules.ModuleElement"><code class="xref py py-class docutils literal notranslate"><span class="pre">ModuleElement</span></code></a>, one
equivalent to this one, and one equivalent to the other.</p>
<dl class="field-list">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>Pair <code class="docutils literal notranslate"><span class="pre">(e1,</span> <span class="pre">e2)</span></code></p>
<blockquote>
<div><p>Each <code class="docutils literal notranslate"><span class="pre">ei</span></code> is a <a class="reference internal" href="#sympy.polys.numberfields.modules.ModuleElement" title="sympy.polys.numberfields.modules.ModuleElement"><code class="xref py py-class docutils literal notranslate"><span class="pre">ModuleElement</span></code></a>, they belong to the
same <a class="reference internal" href="#sympy.polys.numberfields.modules.Module" title="sympy.polys.numberfields.modules.Module"><code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code></a>, <code class="docutils literal notranslate"><span class="pre">e1</span></code> is equivalent to <code class="docutils literal notranslate"><span class="pre">self</span></code>, and
<code class="docutils literal notranslate"><span class="pre">e2</span></code> is equivalent to <code class="docutils literal notranslate"><span class="pre">other</span></code>.</p>
</div></blockquote>
</dd>
<dt class="field-even">Raises</dt>
<dd class="field-even"><p><strong>UnificationFailed</strong></p>
<blockquote>
<div><p>If <code class="docutils literal notranslate"><span class="pre">self</span></code> and <code class="docutils literal notranslate"><span class="pre">other</span></code> have no common ancestor module.</p>
</div></blockquote>
</dd>
</dl>
<p class="rubric">Explanation</p>
<p>We search for the nearest common ancestor module for the pair of
elements, and represent each one there.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="sympy.polys.numberfields.modules.PowerBasisElement">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">sympy.polys.numberfields.modules.</span></span><span class="sig-name descname"><span class="pre">PowerBasisElement</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">module</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">col</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">denom</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/sympy/sympy/blob/180fe9384a7cd4c51be1b26da453d299219e02ec/sympy/polys/numberfields/modules.py#L1525-L1561"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sympy.polys.numberfields.modules.PowerBasisElement" title="Permalink to this definition">¶</a></dt>
<dd><p>Subclass for <a class="reference internal" href="#sympy.polys.numberfields.modules.ModuleElement" title="sympy.polys.numberfields.modules.ModuleElement"><code class="xref py py-class docutils literal notranslate"><span class="pre">ModuleElement</span></code></a> instances whose module is a
<a class="reference internal" href="#sympy.polys.numberfields.modules.PowerBasis" title="sympy.polys.numberfields.modules.PowerBasis"><code class="xref py py-class docutils literal notranslate"><span class="pre">PowerBasis</span></code></a>.</p>
<dl class="py property">
<dt class="sig sig-object py" id="sympy.polys.numberfields.modules.PowerBasisElement.T">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">T</span></span><a class="headerlink" href="#sympy.polys.numberfields.modules.PowerBasisElement.T" title="Permalink to this definition">¶</a></dt>
<dd><p>Access the defining polynomial of the <a class="reference internal" href="#sympy.polys.numberfields.modules.PowerBasis" title="sympy.polys.numberfields.modules.PowerBasis"><code class="xref py py-class docutils literal notranslate"><span class="pre">PowerBasis</span></code></a>.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sympy.polys.numberfields.modules.PowerBasisElement.norm">
<span class="sig-name descname"><span class="pre">norm</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">T</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/sympy/sympy/blob/180fe9384a7cd4c51be1b26da453d299219e02ec/sympy/polys/numberfields/modules.py#L1545-L1550"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sympy.polys.numberfields.modules.PowerBasisElement.norm" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the norm of this number.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sympy.polys.numberfields.modules.PowerBasisElement.numerator">
<span class="sig-name descname"><span class="pre">numerator</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/sympy/sympy/blob/180fe9384a7cd4c51be1b26da453d299219e02ec/sympy/polys/numberfields/modules.py#L1536-L1539"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sympy.polys.numberfields.modules.PowerBasisElement.numerator" title="Permalink to this definition">¶</a></dt>
<dd><p>Obtain the numerator as a polynomial over <a class="reference internal" href="domainsref.html#zz"><span class="std std-ref">ZZ</span></a>.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sympy.polys.numberfields.modules.PowerBasisElement.poly">
<span class="sig-name descname"><span class="pre">poly</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/sympy/sympy/blob/180fe9384a7cd4c51be1b26da453d299219e02ec/sympy/polys/numberfields/modules.py#L1541-L1543"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sympy.polys.numberfields.modules.PowerBasisElement.poly" title="Permalink to this definition">¶</a></dt>
<dd><p>Obtain the number as a polynomial over <a class="reference internal" href="domainsref.html#qq"><span class="std std-ref">QQ</span></a>.</p>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="sympy.polys.numberfields.modules.make_mod_elt">
<span class="sig-prename descclassname"><span class="pre">sympy.polys.numberfields.modules.</span></span><span class="sig-name descname"><span class="pre">make_mod_elt</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">module</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">col</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">denom</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/sympy/sympy/blob/180fe9384a7cd4c51be1b26da453d299219e02ec/sympy/polys/numberfields/modules.py#L1125-L1134"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sympy.polys.numberfields.modules.make_mod_elt" title="Permalink to this definition">¶</a></dt>
<dd><p>Factory function which builds a <a class="reference internal" href="#sympy.polys.numberfields.modules.ModuleElement" title="sympy.polys.numberfields.modules.ModuleElement"><code class="xref py py-class docutils literal notranslate"><span class="pre">ModuleElement</span></code></a>, but ensures
that it is a <a class="reference internal" href="#sympy.polys.numberfields.modules.PowerBasisElement" title="sympy.polys.numberfields.modules.PowerBasisElement"><code class="xref py py-class docutils literal notranslate"><span class="pre">PowerBasisElement</span></code></a> if the module is a
<a class="reference internal" href="#sympy.polys.numberfields.modules.PowerBasis" title="sympy.polys.numberfields.modules.PowerBasis"><code class="xref py py-class docutils literal notranslate"><span class="pre">PowerBasis</span></code></a>.</p>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="sympy.polys.numberfields.modules.ModuleHomomorphism">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">sympy.polys.numberfields.modules.</span></span><span class="sig-name descname"><span class="pre">ModuleHomomorphism</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">domain</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">codomain</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mapping</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/sympy/sympy/blob/180fe9384a7cd4c51be1b26da453d299219e02ec/sympy/polys/numberfields/modules.py#L1564-L1662"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sympy.polys.numberfields.modules.ModuleHomomorphism" title="Permalink to this definition">¶</a></dt>
<dd><p>A homomorphism from one module to another.</p>
<dl class="py method">
<dt class="sig sig-object py" id="sympy.polys.numberfields.modules.ModuleHomomorphism.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">domain</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">codomain</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mapping</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/sympy/sympy/blob/180fe9384a7cd4c51be1b26da453d299219e02ec/sympy/polys/numberfields/modules.py#L1567-L1598"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sympy.polys.numberfields.modules.ModuleHomomorphism.__init__" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>domain</strong> : <a class="reference internal" href="#sympy.polys.numberfields.modules.Module" title="sympy.polys.numberfields.modules.Module"><code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code></a></p>
<blockquote>
<div><p>The domain of the mapping.</p>
</div></blockquote>
<p><strong>codomain</strong> : <a class="reference internal" href="#sympy.polys.numberfields.modules.Module" title="sympy.polys.numberfields.modules.Module"><code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code></a></p>
<blockquote>
<div><p>The codomain of the mapping.</p>
</div></blockquote>
<p><strong>mapping</strong> : callable</p>
<blockquote>
<div><p>An arbitrary callable is accepted, but should be chosen so as
to represent an actual module homomorphism. In particular, should
accept elements of <em>domain</em> and return elements of <em>codomain</em>.</p>
</div></blockquote>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sympy</span> <span class="kn">import</span> <span class="n">Poly</span><span class="p">,</span> <span class="n">cyclotomic_poly</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sympy.polys.numberfields.modules</span> <span class="kn">import</span> <span class="n">PowerBasis</span><span class="p">,</span> <span class="n">ModuleHomomorphism</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">T</span> <span class="o">=</span> <span class="n">Poly</span><span class="p">(</span><span class="n">cyclotomic_poly</span><span class="p">(</span><span class="mi">5</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">A</span> <span class="o">=</span> <span class="n">PowerBasis</span><span class="p">(</span><span class="n">T</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">B</span> <span class="o">=</span> <span class="n">A</span><span class="o">.</span><span class="n">submodule_from_gens</span><span class="p">([</span><span class="mi">2</span><span class="o">*</span><span class="n">A</span><span class="p">(</span><span class="n">j</span><span class="p">)</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">4</span><span class="p">)])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">phi</span> <span class="o">=</span> <span class="n">ModuleHomomorphism</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="n">B</span><span class="p">,</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="mi">6</span><span class="o">*</span><span class="n">x</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">phi</span><span class="o">.</span><span class="n">matrix</span><span class="p">())</span>  
<span class="go">DomainMatrix([[3, 0, 0, 0], [0, 3, 0, 0], [0, 0, 3, 0], [0, 0, 0, 3]], (4, 4), ZZ)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sympy.polys.numberfields.modules.ModuleHomomorphism.kernel">
<span class="sig-name descname"><span class="pre">kernel</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">modulus</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/sympy/sympy/blob/180fe9384a7cd4c51be1b26da453d299219e02ec/sympy/polys/numberfields/modules.py#L1628-L1662"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sympy.polys.numberfields.modules.ModuleHomomorphism.kernel" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute a Submodule representing the kernel of this homomorphism.</p>
<dl class="field-list">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>modulus</strong> : int, optional</p>
<blockquote>
<div><p>A positive prime number <span class="math notranslate nohighlight">\(p\)</span> if the kernel should be computed mod
<span class="math notranslate nohighlight">\(p\)</span>.</p>
</div></blockquote>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><a class="reference internal" href="#sympy.polys.numberfields.modules.Submodule" title="sympy.polys.numberfields.modules.Submodule"><code class="xref py py-class docutils literal notranslate"><span class="pre">Submodule</span></code></a></p>
<blockquote>
<div><p>This submodule’s generators span the kernel of this
homomorphism over <a class="reference internal" href="domainsref.html#zz"><span class="std std-ref">ZZ</span></a>, or else over <a class="reference internal" href="domainsref.html#gf-p"><span class="std std-ref">GF(p)</span></a> if a
modulus was given.</p>
</div></blockquote>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sympy.polys.numberfields.modules.ModuleHomomorphism.matrix">
<span class="sig-name descname"><span class="pre">matrix</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">modulus</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/sympy/sympy/blob/180fe9384a7cd4c51be1b26da453d299219e02ec/sympy/polys/numberfields/modules.py#L1600-L1626"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sympy.polys.numberfields.modules.ModuleHomomorphism.matrix" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the matrix of this homomorphism.</p>
<dl class="field-list">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>modulus</strong> : int, optional</p>
<blockquote>
<div><p>A positive prime number <span class="math notranslate nohighlight">\(p\)</span> if the matrix should be reduced mod
<span class="math notranslate nohighlight">\(p\)</span>.</p>
</div></blockquote>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><a class="reference internal" href="domainmatrix.html#sympy.polys.matrices.domainmatrix.DomainMatrix" title="sympy.polys.matrices.domainmatrix.DomainMatrix"><code class="xref py py-class docutils literal notranslate"><span class="pre">DomainMatrix</span></code></a></p>
<blockquote>
<div><p>The matrix is over <a class="reference internal" href="domainsref.html#zz"><span class="std std-ref">ZZ</span></a>, or else over <a class="reference internal" href="domainsref.html#gf-p"><span class="std std-ref">GF(p)</span></a> if a
modulus was given.</p>
</div></blockquote>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="sympy.polys.numberfields.modules.ModuleEndomorphism">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">sympy.polys.numberfields.modules.</span></span><span class="sig-name descname"><span class="pre">ModuleEndomorphism</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">domain</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mapping</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/sympy/sympy/blob/180fe9384a7cd4c51be1b26da453d299219e02ec/sympy/polys/numberfields/modules.py#L1665-L1682"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sympy.polys.numberfields.modules.ModuleEndomorphism" title="Permalink to this definition">¶</a></dt>
<dd><p>A homomorphism from one module to itself.</p>
<dl class="py method">
<dt class="sig sig-object py" id="sympy.polys.numberfields.modules.ModuleEndomorphism.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">domain</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mapping</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/sympy/sympy/blob/180fe9384a7cd4c51be1b26da453d299219e02ec/sympy/polys/numberfields/modules.py#L1668-L1682"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sympy.polys.numberfields.modules.ModuleEndomorphism.__init__" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>domain</strong> : <a class="reference internal" href="#sympy.polys.numberfields.modules.Module" title="sympy.polys.numberfields.modules.Module"><code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code></a></p>
<blockquote>
<div><p>The common domain and codomain of the mapping.</p>
</div></blockquote>
<p><strong>mapping</strong> : callable</p>
<blockquote>
<div><p>An arbitrary callable is accepted, but should be chosen so as
to represent an actual module endomorphism. In particular, should
accept and return elements of <em>domain</em>.</p>
</div></blockquote>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="sympy.polys.numberfields.modules.InnerEndomorphism">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">sympy.polys.numberfields.modules.</span></span><span class="sig-name descname"><span class="pre">InnerEndomorphism</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">domain</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">multiplier</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/sympy/sympy/blob/180fe9384a7cd4c51be1b26da453d299219e02ec/sympy/polys/numberfields/modules.py#L1685-L1704"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sympy.polys.numberfields.modules.InnerEndomorphism" title="Permalink to this definition">¶</a></dt>
<dd><p>An inner endomorphism on a module, i.e. the endomorphism corresponding to
multiplication by a fixed element.</p>
<dl class="py method">
<dt class="sig sig-object py" id="sympy.polys.numberfields.modules.InnerEndomorphism.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">domain</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">multiplier</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/sympy/sympy/blob/180fe9384a7cd4c51be1b26da453d299219e02ec/sympy/polys/numberfields/modules.py#L1691-L1704"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sympy.polys.numberfields.modules.InnerEndomorphism.__init__" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>domain</strong> : <a class="reference internal" href="#sympy.polys.numberfields.modules.Module" title="sympy.polys.numberfields.modules.Module"><code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code></a></p>
<blockquote>
<div><p>The domain and codomain of the endomorphism.</p>
</div></blockquote>
<p><strong>multiplier</strong> : <a class="reference internal" href="#sympy.polys.numberfields.modules.ModuleElement" title="sympy.polys.numberfields.modules.ModuleElement"><code class="xref py py-class docutils literal notranslate"><span class="pre">ModuleElement</span></code></a></p>
<blockquote>
<div><p>The element <span class="math notranslate nohighlight">\(a\)</span> defining the mapping as <span class="math notranslate nohighlight">\(x \mapsto a x\)</span>.</p>
</div></blockquote>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="sympy.polys.numberfields.modules.EndomorphismRing">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">sympy.polys.numberfields.modules.</span></span><span class="sig-name descname"><span class="pre">EndomorphismRing</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">domain</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/sympy/sympy/blob/180fe9384a7cd4c51be1b26da453d299219e02ec/sympy/polys/numberfields/modules.py#L1707-L1834"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sympy.polys.numberfields.modules.EndomorphismRing" title="Permalink to this definition">¶</a></dt>
<dd><p>The ring of endomorphisms on a module.</p>
<dl class="py method">
<dt class="sig sig-object py" id="sympy.polys.numberfields.modules.EndomorphismRing.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">domain</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/sympy/sympy/blob/180fe9384a7cd4c51be1b26da453d299219e02ec/sympy/polys/numberfields/modules.py#L1710-L1719"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sympy.polys.numberfields.modules.EndomorphismRing.__init__" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>domain</strong> : <a class="reference internal" href="#sympy.polys.numberfields.modules.Module" title="sympy.polys.numberfields.modules.Module"><code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code></a></p>
<blockquote>
<div><p>The domain and codomain of the endomorphisms.</p>
</div></blockquote>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sympy.polys.numberfields.modules.EndomorphismRing.inner_endomorphism">
<span class="sig-name descname"><span class="pre">inner_endomorphism</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">multiplier</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/sympy/sympy/blob/180fe9384a7cd4c51be1b26da453d299219e02ec/sympy/polys/numberfields/modules.py#L1721-L1737"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sympy.polys.numberfields.modules.EndomorphismRing.inner_endomorphism" title="Permalink to this definition">¶</a></dt>
<dd><p>Form an inner endomorphism belonging to this endomorphism ring.</p>
<dl class="field-list">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>multiplier</strong> : <a class="reference internal" href="#sympy.polys.numberfields.modules.ModuleElement" title="sympy.polys.numberfields.modules.ModuleElement"><code class="xref py py-class docutils literal notranslate"><span class="pre">ModuleElement</span></code></a></p>
<blockquote>
<div><p>Element <span class="math notranslate nohighlight">\(a\)</span> defining the inner endomorphism <span class="math notranslate nohighlight">\(x \mapsto a x\)</span>.</p>
</div></blockquote>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><a class="reference internal" href="#sympy.polys.numberfields.modules.InnerEndomorphism" title="sympy.polys.numberfields.modules.InnerEndomorphism"><code class="xref py py-class docutils literal notranslate"><span class="pre">InnerEndomorphism</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sympy.polys.numberfields.modules.EndomorphismRing.represent">
<span class="sig-name descname"><span class="pre">represent</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">element</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/sympy/sympy/blob/180fe9384a7cd4c51be1b26da453d299219e02ec/sympy/polys/numberfields/modules.py#L1739-L1834"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sympy.polys.numberfields.modules.EndomorphismRing.represent" title="Permalink to this definition">¶</a></dt>
<dd><p>Represent an element of this endomorphism ring, as a single column
vector.</p>
<dl class="field-list">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>element</strong> : <a class="reference internal" href="#sympy.polys.numberfields.modules.ModuleEndomorphism" title="sympy.polys.numberfields.modules.ModuleEndomorphism"><code class="xref py py-class docutils literal notranslate"><span class="pre">ModuleEndomorphism</span></code></a> belonging to this ring.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><a class="reference internal" href="domainmatrix.html#sympy.polys.matrices.domainmatrix.DomainMatrix" title="sympy.polys.matrices.domainmatrix.DomainMatrix"><code class="xref py py-class docutils literal notranslate"><span class="pre">DomainMatrix</span></code></a></p>
<blockquote>
<div><p>Column vector equalling the vertical stacking of all the columns
of the matrix that represents the given <em>element</em> as a mapping.</p>
</div></blockquote>
</dd>
</dl>
<p class="rubric">Explanation</p>
<p>Let <span class="math notranslate nohighlight">\(M\)</span> be a module, and <span class="math notranslate nohighlight">\(E\)</span> its ring of endomorphisms. Let <span class="math notranslate nohighlight">\(N\)</span> be
another module, and consider a homomorphism <span class="math notranslate nohighlight">\(\varphi: N \rightarrow E\)</span>.
In the event that <span class="math notranslate nohighlight">\(\varphi\)</span> is to be represented by a matrix <span class="math notranslate nohighlight">\(A\)</span>, each
column of <span class="math notranslate nohighlight">\(A\)</span> must represent an element of <span class="math notranslate nohighlight">\(E\)</span>. This is possible when
the elements of <span class="math notranslate nohighlight">\(E\)</span> are themselves representable as matrices, by
stacking the columns of such a matrix into a single column.</p>
<p>This method supports calculating such matrices <span class="math notranslate nohighlight">\(A\)</span>, by representing
an element of this endomorphism ring first as a matrix, and then
stacking that matrix’s columns into a single column.</p>
<p class="rubric">Examples</p>
<p>Note that in these examples we print matrix transposes, to make their
columns easier to inspect.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sympy</span> <span class="kn">import</span> <span class="n">Poly</span><span class="p">,</span> <span class="n">cyclotomic_poly</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sympy.polys.numberfields.modules</span> <span class="kn">import</span> <span class="n">PowerBasis</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sympy.polys.numberfields.modules</span> <span class="kn">import</span> <span class="n">ModuleHomomorphism</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">T</span> <span class="o">=</span> <span class="n">Poly</span><span class="p">(</span><span class="n">cyclotomic_poly</span><span class="p">(</span><span class="mi">5</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">M</span> <span class="o">=</span> <span class="n">PowerBasis</span><span class="p">(</span><span class="n">T</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">E</span> <span class="o">=</span> <span class="n">M</span><span class="o">.</span><span class="n">endomorphism_ring</span><span class="p">()</span>
</pre></div>
</div>
<p>Let <span class="math notranslate nohighlight">\(\zeta\)</span> be a primitive 5th root of unity, a generator of our field,
and consider the inner endomorphism <span class="math notranslate nohighlight">\(\tau\)</span> on the ring of integers,
induced by <span class="math notranslate nohighlight">\(\zeta\)</span>:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">zeta</span> <span class="o">=</span> <span class="n">M</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">tau</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">inner_endomorphism</span><span class="p">(</span><span class="n">zeta</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">tau</span><span class="o">.</span><span class="n">matrix</span><span class="p">()</span><span class="o">.</span><span class="n">transpose</span><span class="p">()</span>  
<span class="go">DomainMatrix(</span>
<span class="go">    [[0, 1, 0, 0], [0, 0, 1, 0], [0, 0, 0, 1], [-1, -1, -1, -1]],</span>
<span class="go">    (4, 4), ZZ)</span>
</pre></div>
</div>
<p>The matrix representation of <span class="math notranslate nohighlight">\(\tau\)</span> is as expected. The first column
shows that multiplying by <span class="math notranslate nohighlight">\(\zeta\)</span> carries <span class="math notranslate nohighlight">\(1\)</span> to <span class="math notranslate nohighlight">\(\zeta\)</span>, the second
column that it carries <span class="math notranslate nohighlight">\(\zeta\)</span> to <span class="math notranslate nohighlight">\(\zeta^2\)</span>, and so forth.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">represent</span></code> method of the endomorphism ring <code class="docutils literal notranslate"><span class="pre">E</span></code> stacks these
into a single column:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">E</span><span class="o">.</span><span class="n">represent</span><span class="p">(</span><span class="n">tau</span><span class="p">)</span><span class="o">.</span><span class="n">transpose</span><span class="p">()</span>  
<span class="go">DomainMatrix(</span>
<span class="go">    [[0, 1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1, -1, -1, -1, -1]],</span>
<span class="go">    (1, 16), ZZ)</span>
</pre></div>
</div>
<p>This is useful when we want to consider a homomorphism <span class="math notranslate nohighlight">\(\varphi\)</span> having
<code class="docutils literal notranslate"><span class="pre">E</span></code> as codomain:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">phi</span> <span class="o">=</span> <span class="n">ModuleHomomorphism</span><span class="p">(</span><span class="n">M</span><span class="p">,</span> <span class="n">E</span><span class="p">,</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">E</span><span class="o">.</span><span class="n">inner_endomorphism</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
</pre></div>
</div>
<p>and we want to compute the matrix of such a homomorphism:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">phi</span><span class="o">.</span><span class="n">matrix</span><span class="p">()</span><span class="o">.</span><span class="n">transpose</span><span class="p">()</span>  
<span class="go">DomainMatrix(</span>
<span class="go">    [[1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1],</span>
<span class="go">    [0, 1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1, -1, -1, -1, -1],</span>
<span class="go">    [0, 0, 1, 0, 0, 0, 0, 1, -1, -1, -1, -1, 1, 0, 0, 0],</span>
<span class="go">    [0, 0, 0, 1, -1, -1, -1, -1, 1, 0, 0, 0, 0, 1, 0, 0]],</span>
<span class="go">    (4, 16), ZZ)</span>
</pre></div>
</div>
<p>Note that the stacked matrix of <span class="math notranslate nohighlight">\(\tau\)</span> occurs as the second column in
this example. This is because <span class="math notranslate nohighlight">\(\zeta\)</span> is the second basis element of
<code class="docutils literal notranslate"><span class="pre">M</span></code>, and <span class="math notranslate nohighlight">\(\varphi(\zeta) = \tau\)</span>.</p>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="sympy.polys.numberfields.modules.find_min_poly">
<span class="sig-prename descclassname"><span class="pre">sympy.polys.numberfields.modules.</span></span><span class="sig-name descname"><span class="pre">find_min_poly</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">alpha</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">domain</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">powers</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/sympy/sympy/blob/180fe9384a7cd4c51be1b26da453d299219e02ec/sympy/polys/numberfields/modules.py#L1837-L1932"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sympy.polys.numberfields.modules.find_min_poly" title="Permalink to this definition">¶</a></dt>
<dd><p>Find a polynomial of least degree (not necessarily irreducible) satisfied
by an element of a finitely-generated ring with unity.</p>
<dl class="field-list">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>alpha</strong> : <a class="reference internal" href="#sympy.polys.numberfields.modules.ModuleElement" title="sympy.polys.numberfields.modules.ModuleElement"><code class="xref py py-class docutils literal notranslate"><span class="pre">ModuleElement</span></code></a></p>
<blockquote>
<div><p>The element whose min poly is to be found, and whose module has
multiplication and starts with unity.</p>
</div></blockquote>
<p><strong>domain</strong> : <a class="reference internal" href="domainsref.html#sympy.polys.domains.domain.Domain" title="sympy.polys.domains.domain.Domain"><code class="xref py py-class docutils literal notranslate"><span class="pre">Domain</span></code></a></p>
<blockquote>
<div><p>The desired domain of the polynomial.</p>
</div></blockquote>
<p><strong>x</strong> : <a class="reference internal" href="../core.html#sympy.core.symbol.Symbol" title="sympy.core.symbol.Symbol"><code class="xref py py-class docutils literal notranslate"><span class="pre">Symbol</span></code></a>, optional</p>
<blockquote>
<div><p>The desired variable for the polynomial.</p>
</div></blockquote>
<p><strong>powers</strong> : list, optional</p>
<blockquote>
<div><p>If desired, pass an empty list. The powers of <em>alpha</em> (as
<a class="reference internal" href="#sympy.polys.numberfields.modules.ModuleElement" title="sympy.polys.numberfields.modules.ModuleElement"><code class="xref py py-class docutils literal notranslate"><span class="pre">ModuleElement</span></code></a> instances) from the zeroth up to the degree
of the min poly will be recorded here, as we compute them.</p>
</div></blockquote>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><a class="reference internal" href="reference.html#sympy.polys.polytools.Poly" title="sympy.polys.polytools.Poly"><code class="xref py py-class docutils literal notranslate"><span class="pre">Poly</span></code></a>, <code class="docutils literal notranslate"><span class="pre">None</span></code></p>
<blockquote>
<div><p>The minimal polynomial for alpha, or <code class="docutils literal notranslate"><span class="pre">None</span></code> if no polynomial could be
found over the desired domain.</p>
</div></blockquote>
</dd>
<dt class="field-odd">Raises</dt>
<dd class="field-odd"><p><strong>MissingUnityError</strong></p>
<blockquote>
<div><p>If the module to which alpha belongs does not start with unity.</p>
</div></blockquote>
<p><strong>ClosureFailure</strong></p>
<blockquote>
<div><p>If the module to which alpha belongs is not closed under
multiplication.</p>
</div></blockquote>
</dd>
</dl>
<p class="rubric">Examples</p>
<p>For the <span class="math notranslate nohighlight">\(n\)</span>th cyclotomic field, <span class="math notranslate nohighlight">\(n\)</span> an odd prime, consider the quadratic
equation whose roots are the two periods of length <span class="math notranslate nohighlight">\((n-1)/2\)</span>. Article 356
of Gauss tells us that we should get <span class="math notranslate nohighlight">\(x^2 + x - (n-1)/4\)</span> or
<span class="math notranslate nohighlight">\(x^2 + x + (n+1)/4\)</span> according to whether <span class="math notranslate nohighlight">\(n\)</span> is 1 or 3 mod 4, respectively.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sympy</span> <span class="kn">import</span> <span class="n">Poly</span><span class="p">,</span> <span class="n">cyclotomic_poly</span><span class="p">,</span> <span class="n">primitive_root</span><span class="p">,</span> <span class="n">QQ</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sympy.abc</span> <span class="kn">import</span> <span class="n">x</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sympy.polys.numberfields.modules</span> <span class="kn">import</span> <span class="n">PowerBasis</span><span class="p">,</span> <span class="n">find_min_poly</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">n</span> <span class="o">=</span> <span class="mi">13</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">g</span> <span class="o">=</span> <span class="n">primitive_root</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">C</span> <span class="o">=</span> <span class="n">PowerBasis</span><span class="p">(</span><span class="n">Poly</span><span class="p">(</span><span class="n">cyclotomic_poly</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">x</span><span class="p">)))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ee</span> <span class="o">=</span> <span class="p">[</span><span class="n">g</span><span class="o">**</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">k</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span> <span class="o">%</span> <span class="n">n</span> <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">((</span><span class="n">n</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">//</span><span class="mi">2</span><span class="p">)]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">eta</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="n">C</span><span class="p">(</span><span class="n">e</span><span class="p">)</span> <span class="k">for</span> <span class="n">e</span> <span class="ow">in</span> <span class="n">ee</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">find_min_poly</span><span class="p">(</span><span class="n">eta</span><span class="p">,</span> <span class="n">QQ</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="n">x</span><span class="p">)</span><span class="o">.</span><span class="n">as_expr</span><span class="p">())</span>
<span class="go">x**2 + x - 3</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">n</span> <span class="o">=</span> <span class="mi">19</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">g</span> <span class="o">=</span> <span class="n">primitive_root</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">C</span> <span class="o">=</span> <span class="n">PowerBasis</span><span class="p">(</span><span class="n">Poly</span><span class="p">(</span><span class="n">cyclotomic_poly</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">x</span><span class="p">)))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ee</span> <span class="o">=</span> <span class="p">[</span><span class="n">g</span><span class="o">**</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">k</span><span class="o">+</span><span class="mi">2</span><span class="p">)</span> <span class="o">%</span> <span class="n">n</span> <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">((</span><span class="n">n</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">//</span><span class="mi">2</span><span class="p">)]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">eta</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="n">C</span><span class="p">(</span><span class="n">e</span><span class="p">)</span> <span class="k">for</span> <span class="n">e</span> <span class="ow">in</span> <span class="n">ee</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">find_min_poly</span><span class="p">(</span><span class="n">eta</span><span class="p">,</span> <span class="n">QQ</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="n">x</span><span class="p">)</span><span class="o">.</span><span class="n">as_expr</span><span class="p">())</span>
<span class="go">x**2 + x + 5</span>
</pre></div>
</div>
</dd></dl>

</section>
</section>
<section id="utilities">
<h3>Utilities<a class="headerlink" href="#utilities" title="Permalink to this headline">¶</a></h3>
<dl class="py function">
<dt class="sig sig-object py" id="sympy.polys.numberfields.utilities.is_rat">
<span class="sig-prename descclassname"><span class="pre">sympy.polys.numberfields.utilities.</span></span><span class="sig-name descname"><span class="pre">is_rat</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">c</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/sympy/sympy/blob/180fe9384a7cd4c51be1b26da453d299219e02ec/sympy/polys/numberfields/utilities.py#L16-L38"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sympy.polys.numberfields.utilities.is_rat" title="Permalink to this definition">¶</a></dt>
<dd><p>Test whether an argument is of an acceptable type to be used as a rational
number.</p>
<p class="rubric">Explanation</p>
<p>Returns <code class="docutils literal notranslate"><span class="pre">True</span></code> on any argument of type <code class="docutils literal notranslate"><span class="pre">int</span></code>, <a class="reference internal" href="domainsref.html#zz"><span class="std std-ref">ZZ</span></a>, or <a class="reference internal" href="domainsref.html#qq"><span class="std std-ref">QQ</span></a>.</p>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="#sympy.polys.numberfields.utilities.is_int" title="sympy.polys.numberfields.utilities.is_int"><code class="xref py py-obj docutils literal notranslate"><span class="pre">is_int</span></code></a></p>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="sympy.polys.numberfields.utilities.is_int">
<span class="sig-prename descclassname"><span class="pre">sympy.polys.numberfields.utilities.</span></span><span class="sig-name descname"><span class="pre">is_int</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">c</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/sympy/sympy/blob/180fe9384a7cd4c51be1b26da453d299219e02ec/sympy/polys/numberfields/utilities.py#L41-L59"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sympy.polys.numberfields.utilities.is_int" title="Permalink to this definition">¶</a></dt>
<dd><p>Test whether an argument is of an acceptable type to be used as an integer.</p>
<p class="rubric">Explanation</p>
<p>Returns <code class="docutils literal notranslate"><span class="pre">True</span></code> on any argument of type <code class="docutils literal notranslate"><span class="pre">int</span></code> or <a class="reference internal" href="domainsref.html#zz"><span class="std std-ref">ZZ</span></a>.</p>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="#sympy.polys.numberfields.utilities.is_rat" title="sympy.polys.numberfields.utilities.is_rat"><code class="xref py py-obj docutils literal notranslate"><span class="pre">is_rat</span></code></a></p>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="sympy.polys.numberfields.utilities.get_num_denom">
<span class="sig-prename descclassname"><span class="pre">sympy.polys.numberfields.utilities.</span></span><span class="sig-name descname"><span class="pre">get_num_denom</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">c</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/sympy/sympy/blob/180fe9384a7cd4c51be1b26da453d299219e02ec/sympy/polys/numberfields/utilities.py#L62-L74"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sympy.polys.numberfields.utilities.get_num_denom" title="Permalink to this definition">¶</a></dt>
<dd><p>Given any argument on which <a class="reference internal" href="#sympy.polys.numberfields.utilities.is_rat" title="sympy.polys.numberfields.utilities.is_rat"><code class="xref py py-func docutils literal notranslate"><span class="pre">is_rat()</span></code></a> is <code class="docutils literal notranslate"><span class="pre">True</span></code>, return the
numerator and denominator of this number.</p>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="#sympy.polys.numberfields.utilities.is_rat" title="sympy.polys.numberfields.utilities.is_rat"><code class="xref py py-obj docutils literal notranslate"><span class="pre">is_rat</span></code></a></p>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="sympy.polys.numberfields.utilities.extract_fundamental_discriminant">
<span class="sig-prename descclassname"><span class="pre">sympy.polys.numberfields.utilities.</span></span><span class="sig-name descname"><span class="pre">extract_fundamental_discriminant</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">a</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/sympy/sympy/blob/180fe9384a7cd4c51be1b26da453d299219e02ec/sympy/polys/numberfields/utilities.py#L77-L163"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sympy.polys.numberfields.utilities.extract_fundamental_discriminant" title="Permalink to this definition">¶</a></dt>
<dd><p>Extract a fundamental discriminant from an integer <em>a</em>.</p>
<dl class="field-list">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>a: int, must be 0 or 1 mod 4</strong></p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Pair <code class="docutils literal notranslate"><span class="pre">(D,</span> <span class="pre">F)</span></code>  of dictionaries.</p>
</dd>
<dt class="field-odd">Raises</dt>
<dd class="field-odd"><p><strong>ValueError</strong></p>
<blockquote>
<div><p>If <em>a</em> is not 0 or 1 mod 4.</p>
</div></blockquote>
</dd>
</dl>
<p class="rubric">Explanation</p>
<p>Given any rational integer <em>a</em> that is 0 or 1 mod 4, write <span class="math notranslate nohighlight">\(a = d f^2\)</span>,
where <span class="math notranslate nohighlight">\(d\)</span> is either 1 or a fundamental discriminant, and return a pair
of dictionaries <code class="docutils literal notranslate"><span class="pre">(D,</span> <span class="pre">F)</span></code> giving the prime factorizations of <span class="math notranslate nohighlight">\(d\)</span> and <span class="math notranslate nohighlight">\(f\)</span>
respectively, in the same format returned by <a class="reference internal" href="../ntheory.html#sympy.ntheory.factor_.factorint" title="sympy.ntheory.factor_.factorint"><code class="xref py py-func docutils literal notranslate"><span class="pre">factorint()</span></code></a>.</p>
<p>A fundamental discriminant <span class="math notranslate nohighlight">\(d\)</span> is different from unity, and is either
1 mod 4 and squarefree, or is 0 mod 4 and such that <span class="math notranslate nohighlight">\(d/4\)</span> is squarefree
and 2 or 3 mod 4. This is the same as being the discriminant of some
quadratic field.</p>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sympy.polys.numberfields.utilities</span> <span class="kn">import</span> <span class="n">extract_fundamental_discriminant</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">extract_fundamental_discriminant</span><span class="p">(</span><span class="o">-</span><span class="mi">432</span><span class="p">))</span>
<span class="go">({3: 1, -1: 1}, {2: 2, 3: 1})</span>
</pre></div>
</div>
<p>For comparison:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sympy</span> <span class="kn">import</span> <span class="n">factorint</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">factorint</span><span class="p">(</span><span class="o">-</span><span class="mi">432</span><span class="p">))</span>
<span class="go">{2: 4, 3: 3, -1: 1}</span>
</pre></div>
</div>
<p class="rubric">References</p>
<dl class="citation">
<dt class="label" id="r709"><span class="brackets"><a class="fn-backref" href="#id9">R709</a></span></dt>
<dd><p>Cohen, H. <em>A Course in Computational Algebraic Number Theory.</em>
(See Prop. 5.1.3)</p>
</dd>
</dl>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="sympy.polys.numberfields.utilities.AlgIntPowers">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">sympy.polys.numberfields.utilities.</span></span><span class="sig-name descname"><span class="pre">AlgIntPowers</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">T</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">modulus</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/sympy/sympy/blob/180fe9384a7cd4c51be1b26da453d299219e02ec/sympy/polys/numberfields/utilities.py#L167-L258"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sympy.polys.numberfields.utilities.AlgIntPowers" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the powers of an algebraic integer.</p>
<p class="rubric">Explanation</p>
<p>Given an algebraic integer <span class="math notranslate nohighlight">\(\theta\)</span> by its monic irreducible polynomial
<code class="docutils literal notranslate"><span class="pre">T</span></code> over <a class="reference internal" href="domainsref.html#zz"><span class="std std-ref">ZZ</span></a>, this class computes representations of arbitrarily
high powers of <span class="math notranslate nohighlight">\(\theta\)</span>, as <a class="reference internal" href="domainsref.html#zz"><span class="std std-ref">ZZ</span></a>-linear combinations over
<span class="math notranslate nohighlight">\(\{1, \theta, \ldots, \theta^{n-1}\}\)</span>, where <span class="math notranslate nohighlight">\(n = \deg(T)\)</span>.</p>
<p>The representations are computed using the linear recurrence relations for
powers of <span class="math notranslate nohighlight">\(\theta\)</span>, derived from the polynomial <code class="docutils literal notranslate"><span class="pre">T</span></code>. See [1], Sec. 4.2.2.</p>
<p>Optionally, the representations may be reduced with respect to a modulus.</p>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sympy</span> <span class="kn">import</span> <span class="n">Poly</span><span class="p">,</span> <span class="n">cyclotomic_poly</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sympy.polys.numberfields.utilities</span> <span class="kn">import</span> <span class="n">AlgIntPowers</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">T</span> <span class="o">=</span> <span class="n">Poly</span><span class="p">(</span><span class="n">cyclotomic_poly</span><span class="p">(</span><span class="mi">5</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">zeta_pow</span> <span class="o">=</span> <span class="n">AlgIntPowers</span><span class="p">(</span><span class="n">T</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">zeta_pow</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="go">[1, 0, 0, 0]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">zeta_pow</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
<span class="go">[0, 1, 0, 0]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">zeta_pow</span><span class="p">[</span><span class="mi">4</span><span class="p">])</span>  
<span class="go">[-1, -1, -1, -1]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">zeta_pow</span><span class="p">[</span><span class="mi">24</span><span class="p">])</span>  
<span class="go">[-1, -1, -1, -1]</span>
</pre></div>
</div>
<p class="rubric">References</p>
<dl class="citation">
<dt class="label" id="r710"><span class="brackets"><a class="fn-backref" href="#id10">R710</a></span></dt>
<dd><p>Cohen, H. <em>A Course in Computational Algebraic Number Theory.</em></p>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="sympy.polys.numberfields.utilities.AlgIntPowers.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">T</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">modulus</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/sympy/sympy/blob/180fe9384a7cd4c51be1b26da453d299219e02ec/sympy/polys/numberfields/utilities.py#L207-L224"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sympy.polys.numberfields.utilities.AlgIntPowers.__init__" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>T</strong> : <a class="reference internal" href="reference.html#sympy.polys.polytools.Poly" title="sympy.polys.polytools.Poly"><code class="xref py py-class docutils literal notranslate"><span class="pre">Poly</span></code></a></p>
<blockquote>
<div><p>The monic irreducible polynomial over <a class="reference internal" href="domainsref.html#zz"><span class="std std-ref">ZZ</span></a> defining the
algebraic integer.</p>
</div></blockquote>
<p><strong>modulus</strong> : int, None, optional</p>
<blockquote>
<div><p>If not <code class="docutils literal notranslate"><span class="pre">None</span></code>, all representations will be reduced w.r.t. this.</p>
</div></blockquote>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="sympy.polys.numberfields.utilities.coeff_search">
<span class="sig-prename descclassname"><span class="pre">sympy.polys.numberfields.utilities.</span></span><span class="sig-name descname"><span class="pre">coeff_search</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">m</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">R</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/sympy/sympy/blob/180fe9384a7cd4c51be1b26da453d299219e02ec/sympy/polys/numberfields/utilities.py#L261-L314"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sympy.polys.numberfields.utilities.coeff_search" title="Permalink to this definition">¶</a></dt>
<dd><p>Generate coefficients for searching through polynomials.</p>
<dl class="field-list">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>m</strong> : int</p>
<blockquote>
<div><p>Length of coeff list.</p>
</div></blockquote>
<p><strong>R</strong> : int</p>
<blockquote>
<div><p>Initial max abs val for coeffs (will increase as search proceeds).</p>
</div></blockquote>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>generator</p>
<blockquote>
<div><p>Infinite generator of lists of coefficients.</p>
</div></blockquote>
</dd>
</dl>
<p class="rubric">Explanation</p>
<p>Lead coeff is always non-negative. Explore all combinations with coeffs
bounded in absolute value before increasing the bound. Skip the all-zero
list, and skip any repeats. See examples.</p>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sympy.polys.numberfields.utilities</span> <span class="kn">import</span> <span class="n">coeff_search</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cs</span> <span class="o">=</span> <span class="n">coeff_search</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">C</span> <span class="o">=</span> <span class="p">[</span><span class="nb">next</span><span class="p">(</span><span class="n">cs</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">13</span><span class="p">)]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">C</span><span class="p">)</span>
<span class="go">[[1, 1], [1, 0], [1, -1], [0, 1], [2, 2], [2, 1], [2, 0], [2, -1], [2, -2],</span>
<span class="go"> [1, 2], [1, -2], [0, 2], [3, 3]]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="sympy.polys.numberfields.utilities.supplement_a_subspace">
<span class="sig-prename descclassname"><span class="pre">sympy.polys.numberfields.utilities.</span></span><span class="sig-name descname"><span class="pre">supplement_a_subspace</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">M</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/sympy/sympy/blob/180fe9384a7cd4c51be1b26da453d299219e02ec/sympy/polys/numberfields/utilities.py#L317-L401"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sympy.polys.numberfields.utilities.supplement_a_subspace" title="Permalink to this definition">¶</a></dt>
<dd><p>Extend a basis for a subspace to a basis for the whole space.</p>
<dl class="field-list">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>M</strong> : <a class="reference internal" href="domainmatrix.html#sympy.polys.matrices.domainmatrix.DomainMatrix" title="sympy.polys.matrices.domainmatrix.DomainMatrix"><code class="xref py py-class docutils literal notranslate"><span class="pre">DomainMatrix</span></code></a></p>
<blockquote>
<div><p>The columns give the basis for the subspace.</p>
</div></blockquote>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><a class="reference internal" href="domainmatrix.html#sympy.polys.matrices.domainmatrix.DomainMatrix" title="sympy.polys.matrices.domainmatrix.DomainMatrix"><code class="xref py py-class docutils literal notranslate"><span class="pre">DomainMatrix</span></code></a></p>
<blockquote>
<div><p>This matrix is invertible and its first <span class="math notranslate nohighlight">\(r\)</span> columns equal <em>M</em>.</p>
</div></blockquote>
</dd>
<dt class="field-odd">Raises</dt>
<dd class="field-odd"><p><strong>DMRankError</strong></p>
<blockquote>
<div><p>If <em>M</em> was not of maximal rank.</p>
</div></blockquote>
</dd>
</dl>
<p class="rubric">Explanation</p>
<p>Given an <span class="math notranslate nohighlight">\(n \times r\)</span> matrix <em>M</em> of rank <span class="math notranslate nohighlight">\(r\)</span> (so <span class="math notranslate nohighlight">\(r \leq n\)</span>), this function
computes an invertible <span class="math notranslate nohighlight">\(n \times n\)</span> matrix <span class="math notranslate nohighlight">\(B\)</span> such that the first <span class="math notranslate nohighlight">\(r\)</span>
columns of <span class="math notranslate nohighlight">\(B\)</span> equal <em>M</em>.</p>
<p>This operation can be interpreted as a way of extending a basis for a
subspace, to give a basis for the whole space.</p>
<p>To be precise, suppose you have an <span class="math notranslate nohighlight">\(n\)</span>-dimensional vector space <span class="math notranslate nohighlight">\(V\)</span>, with
basis <span class="math notranslate nohighlight">\(\{v_1, v_2, \ldots, v_n\}\)</span>, and an <span class="math notranslate nohighlight">\(r\)</span>-dimensional subspace <span class="math notranslate nohighlight">\(W\)</span> of
<span class="math notranslate nohighlight">\(V\)</span>, spanned by a basis <span class="math notranslate nohighlight">\(\{w_1, w_2, \ldots, w_r\}\)</span>, where the <span class="math notranslate nohighlight">\(w_j\)</span> are
given as linear combinations of the <span class="math notranslate nohighlight">\(v_i\)</span>. If the columns of <em>M</em> represent
the <span class="math notranslate nohighlight">\(w_j\)</span> as such linear combinations, then the columns of the matrix <span class="math notranslate nohighlight">\(B\)</span>
computed by this function give a new basis <span class="math notranslate nohighlight">\(\{u_1, u_2, \ldots, u_n\}\)</span> for
<span class="math notranslate nohighlight">\(V\)</span>, again relative to the <span class="math notranslate nohighlight">\(\{v_i\}\)</span> basis, and such that <span class="math notranslate nohighlight">\(u_j = w_j\)</span>
for <span class="math notranslate nohighlight">\(1 \leq j \leq r\)</span>.</p>
<p class="rubric">Examples</p>
<p>Note: The function works in terms of columns, so in these examples we
print matrix transposes in order to make the columns easier to inspect.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sympy.polys.matrices</span> <span class="kn">import</span> <span class="n">DM</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sympy</span> <span class="kn">import</span> <span class="n">QQ</span><span class="p">,</span> <span class="n">FF</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sympy.polys.numberfields.utilities</span> <span class="kn">import</span> <span class="n">supplement_a_subspace</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">M</span> <span class="o">=</span> <span class="n">DM</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">]],</span> <span class="n">QQ</span><span class="p">)</span><span class="o">.</span><span class="n">transpose</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">supplement_a_subspace</span><span class="p">(</span><span class="n">M</span><span class="p">)</span><span class="o">.</span><span class="n">to_Matrix</span><span class="p">()</span><span class="o">.</span><span class="n">transpose</span><span class="p">())</span>
<span class="go">Matrix([[1, 7, 0], [2, 3, 4], [1, 0, 0]])</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">M2</span> <span class="o">=</span> <span class="n">M</span><span class="o">.</span><span class="n">convert_to</span><span class="p">(</span><span class="n">FF</span><span class="p">(</span><span class="mi">7</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">M2</span><span class="o">.</span><span class="n">to_Matrix</span><span class="p">()</span><span class="o">.</span><span class="n">transpose</span><span class="p">())</span>
<span class="go">Matrix([[1, 0, 0], [2, 3, -3]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">supplement_a_subspace</span><span class="p">(</span><span class="n">M2</span><span class="p">)</span><span class="o">.</span><span class="n">to_Matrix</span><span class="p">()</span><span class="o">.</span><span class="n">transpose</span><span class="p">())</span>
<span class="go">Matrix([[1, 0, 0], [2, 3, -3], [0, 1, 0]])</span>
</pre></div>
</div>
<p class="rubric">References</p>
<dl class="citation">
<dt class="label" id="r711"><span class="brackets"><a class="fn-backref" href="#id11">R711</a></span></dt>
<dd><p>Cohen, H. <em>A Course in Computational Algebraic Number Theory</em>
(See Sec. 2.3.2.)</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="sympy.polys.numberfields.utilities.isolate">
<span class="sig-prename descclassname"><span class="pre">sympy.polys.numberfields.utilities.</span></span><span class="sig-name descname"><span class="pre">isolate</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">alg</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eps</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fast</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/sympy/sympy/blob/180fe9384a7cd4c51be1b26da453d299219e02ec/sympy/polys/numberfields/utilities.py#L404-L474"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sympy.polys.numberfields.utilities.isolate" title="Permalink to this definition">¶</a></dt>
<dd><p>Find a rational isolating interval for a real algebraic number.</p>
<dl class="field-list">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>alg</strong> : str, int, <a class="reference internal" href="../core.html#sympy.core.expr.Expr" title="sympy.core.expr.Expr"><code class="xref py py-class docutils literal notranslate"><span class="pre">Expr</span></code></a></p>
<blockquote>
<div><p>The algebraic number to be isolated. Must be a real number, to use this
particular function. However, see also <a class="reference internal" href="reference.html#sympy.polys.polytools.Poly.intervals" title="sympy.polys.polytools.Poly.intervals"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Poly.intervals()</span></code></a>,
which isolates complex roots when you pass <code class="docutils literal notranslate"><span class="pre">all=True</span></code>.</p>
</div></blockquote>
<p><strong>eps</strong> : positive element of <a class="reference internal" href="domainsref.html#qq"><span class="std std-ref">QQ</span></a>, None, optional (default=None)</p>
<blockquote>
<div><p>Precision to be passed to <a class="reference internal" href="reference.html#sympy.polys.polytools.Poly.refine_root" title="sympy.polys.polytools.Poly.refine_root"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Poly.refine_root()</span></code></a></p>
</div></blockquote>
<p><strong>fast</strong> : boolean, optional (default=False)</p>
<blockquote>
<div><p>Say whether fast refinement procedure should be used.
(Will be passed to <a class="reference internal" href="reference.html#sympy.polys.polytools.Poly.refine_root" title="sympy.polys.polytools.Poly.refine_root"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Poly.refine_root()</span></code></a>.)</p>
</div></blockquote>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Pair of rational numbers defining an isolating interval for the given</p>
<p>algebraic number.</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sympy</span> <span class="kn">import</span> <span class="n">isolate</span><span class="p">,</span> <span class="n">sqrt</span><span class="p">,</span> <span class="n">Rational</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">isolate</span><span class="p">(</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">2</span><span class="p">)))</span>  
<span class="go">(1, 2)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">isolate</span><span class="p">(</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span> <span class="n">eps</span><span class="o">=</span><span class="n">Rational</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">100</span><span class="p">)))</span>
<span class="go">(24/17, 17/12)</span>
</pre></div>
</div>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="reference.html#sympy.polys.polytools.Poly.intervals" title="sympy.polys.polytools.Poly.intervals"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Poly.intervals</span></code></a></p>
</div>
</dd></dl>

</section>
</section>
</section>


            <div class="clearer"></div>
          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
            <p class="logo"><a href="../../index.html">
              <img class="logo" src="../../_static/sympylogo.png" alt="Logo"/>
            </a></p>
  <h3><a href="../../index.html">Table of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">Number Fields</a><ul>
<li><a class="reference internal" href="#introduction">Introduction</a></li>
<li><a class="reference internal" href="#solving-the-main-problems">Solving the Main Problems</a><ul>
<li><a class="reference internal" href="#integral-basis">Integral Basis</a></li>
<li><a class="reference internal" href="#prime-decomposition">Prime Decomposition</a></li>
<li><a class="reference internal" href="#p-adic-valuation">p-adic Valuation</a></li>
<li><a class="reference internal" href="#finding-minimal-polynomials">Finding Minimal Polynomials</a></li>
<li><a class="reference internal" href="#the-subfield-problem">The Subfield Problem</a></li>
</ul>
</li>
<li><a class="reference internal" href="#internals">Internals</a><ul>
<li><a class="reference internal" href="#algebraic-number-fields">Algebraic number fields</a></li>
<li><a class="reference internal" href="#representing-algebraic-numbers">Representing algebraic numbers</a><ul>
<li><a class="reference internal" href="#as-number-field-elements">As number field elements</a></li>
<li><a class="reference internal" href="#as-elements-of-finitely-generated-modules">As elements of finitely-generated modules</a></li>
</ul>
</li>
<li><a class="reference internal" href="#module-sympy.polys.numberfields.modules">Finitely-generated modules</a><ul>
<li><a class="reference internal" href="#arithmetic-with-module-elements">Arithmetic with module elements</a><ul>
<li><a class="reference internal" href="#multiplication">Multiplication</a></li>
</ul>
</li>
<li><a class="reference internal" href="#module-homomorphisms">Module Homomorphisms</a></li>
<li><a class="reference internal" href="#class-reference">Class Reference</a></li>
</ul>
</li>
<li><a class="reference internal" href="#utilities">Utilities</a></li>
</ul>
</li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="domainmatrix.html"
                        title="previous chapter">Introducing the domainmatrix of the poly module</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="../printing.html"
                        title="next chapter">Printing</a></p>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="../../_sources/modules/polys/numberfields.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="../printing.html" title="Printing"
             >next</a> |</li>
        <li class="right" >
          <a href="domainmatrix.html" title="Introducing the domainmatrix of the poly module"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../../index.html">SymPy 1.10.dev documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="../../reference/index.html" >Reference</a> &#187;</li>
          <li class="nav-item nav-item-2"><a href="../index.html" >SymPy Modules Reference</a> &#187;</li>
          <li class="nav-item nav-item-3"><a href="index.html" >Polynomial Manipulation</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">Number Fields</a></li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; Copyright 2021 SymPy Development Team.
      Last updated on Nov 20, 2021.
      Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 4.3.0.
    </div>
  </body>
</html>