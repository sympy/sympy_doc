<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Calculus &mdash; SymPy 0.7.5-git documentation</title>
    
    <link rel="stylesheet" href="../../_static/default.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="http://live.sympy.org/static/live-core.css" type="text/css" />
    <link rel="stylesheet" href="http://live.sympy.org/static/live-autocomplete.css" type="text/css" />
    <link rel="stylesheet" href="http://live.sympy.org/static/live-sphinx.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../../',
        VERSION:     '0.7.5-git',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../_static/doctools.js"></script>
    <script type="text/javascript" src="https://c328740.ssl.cf1.rackcdn.com/mathjax/latest/MathJax.js?config=TeX-AMS_HTML-full"></script>
    <script type="text/javascript" src="http://live.sympy.org/static/utilities.js"></script>
    <script type="text/javascript" src="http://live.sympy.org/static/external/classy.js"></script>
    <script type="text/javascript" src="http://live.sympy.org/static/live-core.js"></script>
    <script type="text/javascript" src="http://live.sympy.org/static/live-autocomplete.js"></script>
    <script type="text/javascript" src="http://live.sympy.org/static/live-sphinx.js"></script>
    <script type="text/javascript" src="../../_static/sidebar.js"></script>
    <link rel="shortcut icon" href="../../_static/sympy-notailtext-favicon.ico"/>
    <link rel="top" title="SymPy 0.7.5-git documentation" href="../../index.html" />
    <link rel="up" title="SymPy Modules Reference" href="../index.html" />
    <link rel="next" title="Physics Module" href="../physics/index.html" />
    <link rel="prev" title="Parsing input" href="../parsing.html" /> 
  </head>
  <body>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="../physics/index.html" title="Physics Module"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="../parsing.html" title="Parsing input"
             accesskey="P">previous</a> |</li>
        <li><a href="../../index.html">SymPy 0.7.5-git documentation</a> &raquo;</li>
          <li><a href="../index.html" accesskey="U">SymPy Modules Reference</a> &raquo;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <div class="section" id="module-sympy.calculus">
<span id="calculus"></span><h1>Calculus<a class="headerlink" href="#module-sympy.calculus" title="Permalink to this headline">¶</a></h1>
<p>Some calculus-related methods waiting to find a better place in the
SymPy modules tree.</p>
<span class="target" id="module-sympy.calculus.euler"></span><dl class="function">
<dt id="sympy.calculus.euler.euler_equations">
<tt class="descclassname">sympy.calculus.euler.</tt><tt class="descname">euler_equations</tt><big>(</big><em>L</em>, <em>funcs=()</em>, <em>vars=()</em><big>)</big><a class="reference internal" href="../../_modules/sympy/calculus/euler.html#euler_equations"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#sympy.calculus.euler.euler_equations" title="Permalink to this definition">¶</a></dt>
<dd><p>Find the Euler-Lagrange equations for a given Lagrangian.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>L</strong> : Expr</p>
<blockquote>
<div><p>The Lagrangian that should be a function of the functions listed
in the second argument and their first derivatives.</p>
<p>For example, in the case of two functions (f(x,y), g(x,y)) and
two independent variables (x,y) the Lagrangian would have the form:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">L</span><span class="p">(</span><span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">),</span><span class="n">g</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">),</span><span class="n">df</span><span class="o">/</span><span class="n">dx</span><span class="p">,</span><span class="n">df</span><span class="o">/</span><span class="n">dy</span><span class="p">,</span><span class="n">dg</span><span class="o">/</span><span class="n">dx</span><span class="p">,</span><span class="n">dg</span><span class="o">/</span><span class="n">dy</span><span class="p">,</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">)</span>
</pre></div>
</div>
</div></blockquote>
<p><strong>funcs</strong> : Function or list/tuple of Functions</p>
<blockquote>
<div><p>The functions that the Lagrangian depends on. The Euler equations
are differential equations for each of these functions.</p>
</div></blockquote>
<p><strong>vars</strong> : Symbol or list/tuple of Symbols</p>
<blockquote>
<div><p>The Symbols that are the independent variables of the functions.</p>
</div></blockquote>
<p><strong>In many cases it is not necessary to provide anything, except the</strong> :</p>
<p><strong>Lagrangian, it will be autodetected (and an error raised if this</strong> :</p>
<p><strong>couldn&#8217;t be done).</strong> :</p>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>eqns</strong> : set of Eq</p>
<blockquote class="last">
<div><p>The set of differential equations, one for each function.</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
<p class="rubric">References</p>
<table class="docutils citation" frame="void" id="r1" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id1">[R1]</a></td><td><a class="reference external" href="http://en.wikipedia.org/wiki/Euler%E2%80%93Lagrange_equation">http://en.wikipedia.org/wiki/Euler%E2%80%93Lagrange_equation</a></td></tr>
</tbody>
</table>
<p class="rubric">Examples</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sympy</span> <span class="kn">import</span> <span class="n">Symbol</span><span class="p">,</span> <span class="n">Function</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sympy.calculus.euler</span> <span class="kn">import</span> <span class="n">euler_equations</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">x</span> <span class="o">=</span> <span class="n">Function</span><span class="p">(</span><span class="s">&#39;x&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t</span> <span class="o">=</span> <span class="n">Symbol</span><span class="p">(</span><span class="s">&#39;t&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">L</span> <span class="o">=</span> <span class="p">(</span><span class="n">x</span><span class="p">(</span><span class="n">t</span><span class="p">)</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">t</span><span class="p">))</span><span class="o">**</span><span class="mi">2</span><span class="o">/</span><span class="mi">2</span> <span class="o">-</span> <span class="n">x</span><span class="p">(</span><span class="n">t</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="o">/</span><span class="mi">2</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">euler_equations</span><span class="p">(</span><span class="n">L</span><span class="p">,</span> <span class="n">x</span><span class="p">(</span><span class="n">t</span><span class="p">),</span> <span class="n">t</span><span class="p">)</span>
<span class="go">set([-x(t) - Derivative(x(t), t, t) == 0])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">u</span> <span class="o">=</span> <span class="n">Function</span><span class="p">(</span><span class="s">&#39;u&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">x</span> <span class="o">=</span> <span class="n">Symbol</span><span class="p">(</span><span class="s">&#39;x&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">L</span> <span class="o">=</span> <span class="p">(</span><span class="n">u</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">t</span><span class="p">))</span><span class="o">**</span><span class="mi">2</span><span class="o">/</span><span class="mi">2</span> <span class="o">-</span> <span class="p">(</span><span class="n">u</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">x</span><span class="p">))</span><span class="o">**</span><span class="mi">2</span><span class="o">/</span><span class="mi">2</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">euler_equations</span><span class="p">(</span><span class="n">L</span><span class="p">,</span> <span class="n">u</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">x</span><span class="p">),</span> <span class="p">[</span><span class="n">t</span><span class="p">,</span> <span class="n">x</span><span class="p">])</span>
<span class="go">set([-Derivative(u(t, x), t, t) + Derivative(u(t, x), x, x) == 0])</span>
</pre></div>
</div>
</dd></dl>

<span class="target" id="module-sympy.calculus.singularities"></span><dl class="function">
<dt id="sympy.calculus.singularities.singularities">
<tt class="descclassname">sympy.calculus.singularities.</tt><tt class="descname">singularities</tt><big>(</big><em>expr</em>, <em>sym</em><big>)</big><a class="reference internal" href="../../_modules/sympy/calculus/singularities.html#singularities"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#sympy.calculus.singularities.singularities" title="Permalink to this definition">¶</a></dt>
<dd><p>Finds singularities for a function.
Currently supported functions are:
- univariate real rational functions</p>
<p class="rubric">References</p>
<table class="docutils citation" frame="void" id="r2" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id2">[R2]</a></td><td><a class="reference external" href="http://en.wikipedia.org/wiki/Mathematical_singularity">http://en.wikipedia.org/wiki/Mathematical_singularity</a></td></tr>
</tbody>
</table>
<p class="rubric">Examples</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sympy.calculus.singularities</span> <span class="kn">import</span> <span class="n">singularities</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sympy</span> <span class="kn">import</span> <span class="n">Symbol</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">x</span> <span class="o">=</span> <span class="n">Symbol</span><span class="p">(</span><span class="s">&#39;x&#39;</span><span class="p">,</span> <span class="n">real</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">singularities</span><span class="p">(</span><span class="n">x</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">x</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span>
<span class="go">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">singularities</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="p">(</span><span class="n">x</span> <span class="o">+</span> <span class="mi">1</span><span class="p">),</span> <span class="n">x</span><span class="p">)</span>
<span class="go">(-1,)</span>
</pre></div>
</div>
</dd></dl>

<span class="target" id="module-sympy.calculus.finite_diff"></span><div class="section" id="finite-difference-weights">
<h2>Finite difference weights<a class="headerlink" href="#finite-difference-weights" title="Permalink to this headline">¶</a></h2>
<p>This module implements an algorithm for efficient generation of finite
difference weights for ordinary differentials of functions for
derivatives from 0 (interpolation) up to arbitrary order.</p>
<p>The core algorithm is provided in the finite difference weight generating
function (finite_diff_weights), and two convenience functions are provided
for:</p>
<ul>
<li><dl class="first docutils">
<dt>estimating a derivative (or interpolate) directly from a series of points</dt>
<dd><p class="first last">is also provided (<tt class="docutils literal"><span class="pre">apply_finite_diff</span></tt>).</p>
</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt>making a finite difference approximation of a Derivative instance</dt>
<dd><p class="first last">(<tt class="docutils literal"><span class="pre">as_finite_diff</span></tt>).</p>
</dd>
</dl>
</li>
</ul>
<dl class="function">
<dt id="sympy.calculus.finite_diff.apply_finite_diff">
<tt class="descclassname">sympy.calculus.finite_diff.</tt><tt class="descname">apply_finite_diff</tt><big>(</big><em>order</em>, <em>x_list</em>, <em>y_list</em>, <em>x0</em><big>)</big><a class="reference internal" href="../../_modules/sympy/calculus/finite_diff.html#apply_finite_diff"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#sympy.calculus.finite_diff.apply_finite_diff" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates the finite difference approxiamtion of
the derivative of requested order at x0 from points
provided in x_list and y_list.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>order: int</strong> :</p>
<blockquote>
<div><p>order of derivative to approximate. 0 corresponds to interpolation.</p>
</div></blockquote>
<p><strong>x_list: sequence</strong> :</p>
<blockquote>
<div><p>Strictly monotonically increasing sequence of values for
the independent variable.</p>
</div></blockquote>
<p><strong>y_list: sequence</strong> :</p>
<blockquote>
<div><p>The function value at corresponding values for the independent
variable in x_list.</p>
</div></blockquote>
<p><strong>x0: Number or Symbol</strong> :</p>
<blockquote>
<div><p>At what value of the independent variable the derivative should be
evaluated.</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>sympy.core.add.Add or sympy.core.numbers.Number</strong> :</p>
<blockquote class="last">
<div><p>The finite difference expression approximating the requested
derivative order at x0.</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<p class="last"><a class="reference internal" href="#sympy.calculus.finite_diff.finite_diff_weights" title="sympy.calculus.finite_diff.finite_diff_weights"><tt class="xref py py-obj docutils literal"><span class="pre">sympy.calculus.finite_diff.finite_diff_weights</span></tt></a></p>
</div>
<p class="rubric">Notes</p>
<p>Order = 0 corresponds to interpolation.
Only supply so many points you think makes sense
to around x0 when extracting the derivative (the function
need to be well behaved within that region). Also beware
of Runge&#8217;s phenomenon.</p>
<p class="rubric">References</p>
<p>Fortran 90 implementation with Python interface for numerics: <a class="reference external" href="https://github.com/bjodah/finitediff">finitediff</a></p>
<p class="rubric">Examples</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sympy.calculus</span> <span class="kn">import</span> <span class="n">apply_finite_diff</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cube</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">arg</span><span class="p">:</span> <span class="p">(</span><span class="mf">1.0</span><span class="o">*</span><span class="n">arg</span><span class="p">)</span><span class="o">**</span><span class="mi">3</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">xlist</span> <span class="o">=</span> <span class="nb">range</span><span class="p">(</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">apply_finite_diff</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">xlist</span><span class="p">,</span> <span class="nb">map</span><span class="p">(</span><span class="n">cube</span><span class="p">,</span> <span class="n">xlist</span><span class="p">),</span> <span class="mi">2</span><span class="p">)</span> <span class="o">-</span> <span class="mi">12</span> 
<span class="go">-3.55271367880050e-15</span>
</pre></div>
</div>
<p>we see that the example above only contain rounding errors.
apply_finite_diff can also be used on more abstract objects:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sympy</span> <span class="kn">import</span> <span class="n">IndexedBase</span><span class="p">,</span> <span class="n">Idx</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sympy.calculus</span> <span class="kn">import</span> <span class="n">apply_finite_diff</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="nb">map</span><span class="p">(</span><span class="n">IndexedBase</span><span class="p">,</span> <span class="s">&#39;xy&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">i</span> <span class="o">=</span> <span class="n">Idx</span><span class="p">(</span><span class="s">&#39;i&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">x_list</span><span class="p">,</span> <span class="n">y_list</span> <span class="o">=</span> <span class="nb">zip</span><span class="p">(</span><span class="o">*</span><span class="p">[(</span><span class="n">x</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="n">j</span><span class="p">],</span> <span class="n">y</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="n">j</span><span class="p">])</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">)])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">apply_finite_diff</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">x_list</span><span class="p">,</span> <span class="n">y_list</span><span class="p">,</span> <span class="n">x</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
<span class="go">(-1 + (x[i + 1] - x[i])/(-x[i - 1] + x[i]))*y[i]/(x[i + 1] - x[i]) + (-x[i - 1] + x[i])*y[i + 1]/((-x[i - 1] + x[i + 1])*(x[i + 1] - x[i])) - (x[i + 1] - x[i])*y[i - 1]/((-x[i - 1] + x[i + 1])*(-x[i - 1] + x[i]))</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="sympy.calculus.finite_diff.as_finite_diff">
<tt class="descclassname">sympy.calculus.finite_diff.</tt><tt class="descname">as_finite_diff</tt><big>(</big><em>derivative</em>, <em>points=1</em>, <em>x0=None</em>, <em>wrt=None</em><big>)</big><a class="reference internal" href="../../_modules/sympy/calculus/finite_diff.html#as_finite_diff"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#sympy.calculus.finite_diff.as_finite_diff" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns an approximation of a derivative of a function in
the form of a finite difference formula. The expression is a
weighted sum of the function at a number of discrete values of
(one of) the independent variable(s).</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>derivative: a Derivative instance (needs to have an variables</strong> :</p>
<blockquote>
<div><p>and expr attribute).</p>
</div></blockquote>
<p><strong>points: sequence or coefficient, optional</strong> :</p>
<blockquote>
<div><p>If sequence: discrete values (length &gt;= order+1) of the
independent variable used for generating the finite
difference weights.
If it is a coefficient, it will be used as the step-size
for generating an equidistant sequence of length order+1
centered around x0. defult: 1 (step-size 1)</p>
</div></blockquote>
<p><strong>x0: number or Symbol, optional</strong> :</p>
<blockquote>
<div><p>the value of the independent variable (wrt) at which the
derivative is to be approximated. default: same as wrt</p>
</div></blockquote>
<p><strong>wrt: Symbol, optional</strong> :</p>
<blockquote class="last">
<div><p>&#8220;with respect to&#8221; the variable for which the (partial)
derivative is to be approximated for. If not provided it
is required that the Derivative is ordinary. default: None</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<p class="last"><a class="reference internal" href="#sympy.calculus.finite_diff.apply_finite_diff" title="sympy.calculus.finite_diff.apply_finite_diff"><tt class="xref py py-obj docutils literal"><span class="pre">sympy.calculus.finite_diff.apply_finite_diff</span></tt></a>, <a class="reference internal" href="#sympy.calculus.finite_diff.finite_diff_weights" title="sympy.calculus.finite_diff.finite_diff_weights"><tt class="xref py py-obj docutils literal"><span class="pre">sympy.calculus.finite_diff.finite_diff_weights</span></tt></a></p>
</div>
<p class="rubric">Examples</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sympy</span> <span class="kn">import</span> <span class="n">symbols</span><span class="p">,</span> <span class="n">Function</span><span class="p">,</span> <span class="n">exp</span><span class="p">,</span> <span class="n">sqrt</span><span class="p">,</span> <span class="n">Symbol</span><span class="p">,</span> <span class="n">as_finite_diff</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">x</span><span class="p">,</span> <span class="n">h</span> <span class="o">=</span> <span class="n">symbols</span><span class="p">(</span><span class="s">&#39;x h&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">f</span> <span class="o">=</span> <span class="n">Function</span><span class="p">(</span><span class="s">&#39;f&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">as_finite_diff</span><span class="p">(</span><span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
<span class="go">-f(x - 1/2) + f(x + 1/2)</span>
</pre></div>
</div>
<p>The default step size and number of points are 1 and <tt class="docutils literal"><span class="pre">order</span> <span class="pre">+</span> <span class="pre">1</span></tt>
respectively. We can change the step size by passing a symbol
as a parameter:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">as_finite_diff</span><span class="p">(</span><span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="n">h</span><span class="p">)</span>
<span class="go">-f(-h/2 + x)/h + f(h/2 + x)/h</span>
</pre></div>
</div>
<p>We can also specify the discretized values to be used in a sequence:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">as_finite_diff</span><span class="p">(</span><span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="p">[</span><span class="n">x</span><span class="p">,</span> <span class="n">x</span><span class="o">+</span><span class="n">h</span><span class="p">,</span> <span class="n">x</span><span class="o">+</span><span class="mi">2</span><span class="o">*</span><span class="n">h</span><span class="p">])</span>
<span class="go">-3*f(x)/(2*h) + 2*f(h + x)/h - f(2*h + x)/(2*h)</span>
</pre></div>
</div>
<p>The algorithm is not restricted to use equidistant spacing, nor
do we need to make the approximation around x0, but we can get
an expression estimating the derivative at an offset:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">e</span><span class="p">,</span> <span class="n">sq2</span> <span class="o">=</span> <span class="n">exp</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="n">sqrt</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">xl</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span><span class="o">-</span><span class="n">h</span><span class="p">,</span> <span class="n">x</span><span class="o">+</span><span class="n">h</span><span class="p">,</span> <span class="n">x</span><span class="o">+</span><span class="n">e</span><span class="o">*</span><span class="n">h</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">as_finite_diff</span><span class="p">(</span><span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="n">xl</span><span class="p">,</span> <span class="n">x</span><span class="o">+</span><span class="n">h</span><span class="o">*</span><span class="n">sq2</span><span class="p">)</span>
<span class="go">2*h*((h + sqrt(2)*h)/(2*h) - (-sqrt(2)*h + h)/(2*h))*f(E*h + x)/((-h + E*h)*(h + E*h)) + (-(-sqrt(2)*h + h)/(2*h) - (-sqrt(2)*h + E*h)/(2*h))*f(-h + x)/(h + E*h) + (-(h + sqrt(2)*h)/(2*h) + (-sqrt(2)*h + E*h)/(2*h))*f(h + x)/(-h + E*h)</span>
</pre></div>
</div>
<p>Partial derivatives are also supported:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">y</span> <span class="o">=</span> <span class="n">Symbol</span><span class="p">(</span><span class="s">&#39;y&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">d2fdxdy</span><span class="o">=</span><span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">)</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">as_finite_diff</span><span class="p">(</span><span class="n">d2fdxdy</span><span class="p">,</span> <span class="n">wrt</span><span class="o">=</span><span class="n">x</span><span class="p">)</span>
<span class="go">-f(x - 1/2, y) + f(x + 1/2, y)</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="sympy.calculus.finite_diff.finite_diff_weights">
<tt class="descclassname">sympy.calculus.finite_diff.</tt><tt class="descname">finite_diff_weights</tt><big>(</big><em>order</em>, <em>x_list</em>, <em>x0</em><big>)</big><a class="reference internal" href="../../_modules/sympy/calculus/finite_diff.html#finite_diff_weights"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#sympy.calculus.finite_diff.finite_diff_weights" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates the finite difference weights for an arbitrarily
spaced one-dimensional grid (x_list) for derivatives at &#8216;x0&#8217;
of order 0, 1, ..., up to &#8216;order&#8217; using a recursive formula.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>order</strong> : int</p>
<blockquote>
<div><p>Up to what derivative order weights should be calculated.
0 corresponds to interpolation.</p>
</div></blockquote>
<p><strong>x_list: sequence</strong> :</p>
<blockquote>
<div><p>Strictly monotonically increasing sequence of values for
the independent variable.</p>
</div></blockquote>
<p><strong>x0: Number or Symbol</strong> :</p>
<blockquote>
<div><p>At what value of the independent variable the finite difference
weights should be generated.</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>list</strong> :</p>
<blockquote class="last">
<div><p>A list of sublists, each corresponding to coefficients for
increasing derivative order, and each containing lists of
coefficients for increasing accuracy.</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<p class="last"><a class="reference internal" href="#sympy.calculus.finite_diff.apply_finite_diff" title="sympy.calculus.finite_diff.apply_finite_diff"><tt class="xref py py-obj docutils literal"><span class="pre">sympy.calculus.finite_diff.apply_finite_diff</span></tt></a></p>
</div>
<p class="rubric">Notes</p>
<p>If weights for a finite difference approximation
of the 3rd order derivative is wanted, weights for 0th, 1st
and 2nd order are calculated &#8220;for free&#8221;, so are formulae using
fewer and fewer of the paramters. This is something one can
take advantage of to save computational cost.</p>
<p class="rubric">References</p>
<table class="docutils citation" frame="void" id="r3" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id3">[R3]</a></td><td>Generation of Finite Difference Formulas on Arbitrarily Spaced
Grids, Bengt Fornberg; Mathematics of compuation; 51; 184;
(1988); 699-706; doi:10.1090/S0025-5718-1988-0935077-0</td></tr>
</tbody>
</table>
<p class="rubric">Examples</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sympy</span> <span class="kn">import</span> <span class="n">S</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sympy.calculus</span> <span class="kn">import</span> <span class="n">finite_diff_weights</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">finite_diff_weights</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="p">[</span><span class="o">-</span><span class="n">S</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="n">S</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="n">S</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="n">S</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="p">],</span> <span class="mi">0</span><span class="p">)</span>
<span class="go">[[[1, 0, 0, 0],</span>
<span class="go">[1/2, 1/2, 0, 0],</span>
<span class="go">[3/8, 3/4, -1/8, 0],</span>
<span class="go">[5/16, 15/16, -5/16, 1/16]],</span>
<span class="go">[[0, 0, 0, 0], [-1, 1, 0, 0], [-1, 1, 0, 0], [-23/24, 7/8, 1/8, -1/24]]]</span>
</pre></div>
</div>
<p>the result is two subslists, the first is for the 0:th derivative
(interpolation) and the second for the first derivative (we gave
1 as the parameter of order so this is why we get no list for
a higher order derivative). Each sublist contains the most accurate
formula in the end (all points used).</p>
<p>Beware of the offset in the lower accuracy formulae when looking at a
centered difference:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sympy</span> <span class="kn">import</span> <span class="n">S</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sympy.calculus</span> <span class="kn">import</span> <span class="n">finite_diff_weights</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">finite_diff_weights</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="p">[</span><span class="o">-</span><span class="n">S</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="n">S</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="n">S</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="n">S</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span>
<span class="gp">... </span>   <span class="n">S</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="n">S</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="p">],</span> <span class="mi">0</span><span class="p">)</span> 
<span class="go">[[[1, 0, 0, 0, 0, 0],</span>
<span class="go">  [-3/2, 5/2, 0, 0, 0, 0],</span>
<span class="go">  [3/8, -5/4, 15/8, 0, 0, 0],</span>
<span class="go">  [1/16, -5/16, 15/16, 5/16, 0, 0],</span>
<span class="go">  [3/128, -5/32, 45/64, 15/32, -5/128, 0],</span>
<span class="go">  [3/256, -25/256, 75/128, 75/128, -25/256, 3/256]],</span>
<span class="go"> [[0, 0, 0, 0, 0, 0],</span>
<span class="go">  [-1, 1, 0, 0, 0, 0],</span>
<span class="go">  [1, -3, 2, 0, 0, 0],</span>
<span class="go">  [1/24, -1/8, -7/8, 23/24, 0, 0],</span>
<span class="go">  [0, 1/24, -9/8, 9/8, -1/24, 0],</span>
<span class="go">  [-3/640, 25/384, -75/64, 75/64, -25/384, 3/640]]]</span>
</pre></div>
</div>
<p>The capability to generate weights at arbitrary points can be
used e.g. to minimize Runge&#8217;s phenomenon by using Chebyshev nodes:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sympy</span> <span class="kn">import</span> <span class="n">cos</span><span class="p">,</span> <span class="n">symbols</span><span class="p">,</span> <span class="n">pi</span><span class="p">,</span> <span class="n">simplify</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sympy.calculus</span> <span class="kn">import</span> <span class="n">finite_diff_weights</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">N</span><span class="p">,</span> <span class="p">(</span><span class="n">h</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span> <span class="o">=</span> <span class="mi">4</span><span class="p">,</span> <span class="n">symbols</span><span class="p">(</span><span class="s">&#39;h x&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">x_list</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span><span class="o">+</span><span class="n">h</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">i</span><span class="o">*</span><span class="n">pi</span><span class="o">/</span><span class="p">(</span><span class="n">N</span><span class="p">))</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">)]</span> <span class="c"># chebyshev nodes</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="n">x_list</span><span class="p">)</span>
<span class="go">[-h + x, -sqrt(2)*h/2 + x, x, sqrt(2)*h/2 + x, h + x]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mycoeffs</span> <span class="o">=</span> <span class="n">finite_diff_weights</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">x_list</span><span class="p">,</span> <span class="mi">0</span><span class="p">)[</span><span class="mi">1</span><span class="p">][</span><span class="mi">4</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">[</span><span class="n">simplify</span><span class="p">(</span><span class="n">c</span><span class="p">)</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span>  <span class="n">mycoeffs</span><span class="p">]</span> 
<span class="go">[(h**3/2 + h**2*x - 3*h*x**2 - 4*x**3)/h**4,</span>
<span class="go">(-sqrt(2)*h**3 - 4*h**2*x + 3*sqrt(2)*h*x**2 + 8*x**3)/h**4,</span>
<span class="go">6*x/h**2 - 8*x**3/h**4,</span>
<span class="go">(sqrt(2)*h**3 - 4*h**2*x - 3*sqrt(2)*h*x**2 + 8*x**3)/h**4,</span>
<span class="go">(-h**3/2 + h**2*x + 3*h*x**2 - 4*x**3)/h**4]</span>
</pre></div>
</div>
</dd></dl>

</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper">
            <p class="logo"><a href="../../index.html">
              <img class="logo" src="../../_static/sympylogo.png" alt="Logo"/>
            </a></p>
  <h3><a href="../../index.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">Calculus</a><ul>
<li><a class="reference internal" href="#finite-difference-weights">Finite difference weights</a></li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="../parsing.html"
                        title="previous chapter">Parsing input</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="../physics/index.html"
                        title="next chapter">Physics Module</a></p>
  <h3>This Page</h3>
  <ul class="this-page-menu">
    <li><a href="../../_sources/modules/calculus/index.txt"
           rel="nofollow">Show Source</a></li>
  </ul>
<div id="searchbox" style="display: none">
  <h3>Quick search</h3>
    <form class="search" action="../../search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="../physics/index.html" title="Physics Module"
             >next</a> |</li>
        <li class="right" >
          <a href="../parsing.html" title="Parsing input"
             >previous</a> |</li>
        <li><a href="../../index.html">SymPy 0.7.5-git documentation</a> &raquo;</li>
          <li><a href="../index.html" >SymPy Modules Reference</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer">
        &copy; Copyright 2014 SymPy Development Team.
      Last updated on May 06, 2014.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.2.1.
    </div>
  </body>
</html>