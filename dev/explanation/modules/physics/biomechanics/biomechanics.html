<!doctype html>
<html class="no-js" lang="en" data-content_root="../../../../">
  <head><meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width,initial-scale=1"/>
    <meta name="color-scheme" content="light dark"><meta name="viewport" content="width=device-width, initial-scale=1" />
<link rel="index" title="Index" href="../../../../genindex.html" /><link rel="search" title="Search" href="../../../../search.html" /><link rel="next" title="SymPy Special Topics" href="../../../special_topics/index.html" /><link rel="prev" title="Biomechanics" href="index.html" />
        <link rel="canonical" href="https://docs.sympy.org/latest/explanation/modules/physics/biomechanics/biomechanics.html" />

    <link rel="shortcut icon" href="../../../../_static/sympy-notailtext-favicon.ico"/><!-- Generated with Sphinx 8.1.3 and Furo 2024.08.06 -->
        <title>Introduction to Biomechanical Modeling - SymPy 1.14.dev documentation</title>
      <link rel="stylesheet" type="text/css" href="../../../../_static/pygments.css?v=16cf08d2" />
    <link rel="stylesheet" type="text/css" href="../../../../_static/styles/furo.css?v=354aac6f" />
    <link rel="stylesheet" type="text/css" href="../../../../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../../../../_static/graphviz.css?v=4ae1632d" />
    <link rel="stylesheet" type="text/css" href="../../../../_static/plot_directive.css" />
    <link rel="stylesheet" type="text/css" href="../../../../_static/styles/furo-extensions.css?v=302659d7" />
    <link rel="stylesheet" type="text/css" href="../../../../_static/custom.css?v=30c876b7" />
    
    


<style>
  body {
    --color-code-background: #eeffcc;
  --color-code-foreground: black;
  --color-brand-primary: #52833A;
  --color-brand-content: #307748;
  --color-sidebar-background: #3B5526;
  --color-sidebar-background-border: var(--color-background-primary);
  --color-sidebar-link-text: #FFFFFF;
  --color-sidebar-brand-text: var(--color-sidebar-link-text--top-level);
  --color-sidebar-link-text--top-level: #FFFFFF;
  --color-sidebar-item-background--hover: var(--color-brand-primary);
  --color-sidebar-item-expander-background--hover: var(--color-brand-primary);
  --color-link-underline--hover: var(--color-link);
  --color-api-keyword: #000000bd;
  --color-api-name: var(--color-brand-content);
  --color-api-pre-name: var(--color-brand-content);
  --api-font-size: var(--font-size--normal);
  --color-foreground-secondary: #53555B;
  --color-admonition-title-background--seealso: #CCCCCC;
  --color-admonition-title--seealso: black;
  --color-admonition-title-background--note: #CCCCCC;
  --color-admonition-title--note: black;
  --color-admonition-title-background--warning: var(--color-problematic);
  --color-admonition-title--warning: white;
  --admonition-font-size: var(--font-size--normal);
  --admonition-title-font-size: var(--font-size--normal);
  --color-code-background: hsl(80deg 100% 95%);
  --code-font-size: var(--font-size--small);
  --font-stack--monospace: DejaVu Sans Mono,"SFMono-Regular",Menlo,Consolas,Monaco,Liberation Mono,Lucida Console,monospace;;
  
  }
  @media not print {
    body[data-theme="dark"] {
      --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  --color-brand-primary: #33CB33;
  --color-brand-content: #1DBD1D;
  --color-sidebar-background: #3B5526;
  --color-sidebar-background-border: var(--color-background-primary);
  --color-sidebar-link-text: #FFFFFF;
  --color-sidebar-brand-text: var(--color-sidebar-link-text--top-level);
  --color-sidebar-link-text--top-level: #FFFFFF;
  --color-sidebar-item-background--hover: #52833A;
  --color-sidebar-item-expander-background--hover: #52833A;
  --color-link-underline--hover: var(--color-link);
  --color-api-keyword: #FFFFFFbd;
  --color-api-name: var(--color-brand-content);
  --color-api-pre-name: var(--color-brand-content);
  --api-font-size: var(--font-size--normal);
  --color-foreground-secondary: #9DA1AC;
  --color-admonition-title-background--seealso: #555555;
  --color-admonition-title--seealso: black;
  --color-admonition-title-background--note: #555555;
  --color-admonition-title--note: black;
  --color-admonition-title-background--warning: var(--color-problematic);
  --color-admonition-title--warning: white;
  --admonition-font-size: var(--font-size--normal);
  --admonition-title-font-size: var(--font-size--normal);
  --color-code-background: hsl(80deg 100% 95%);
  --code-font-size: var(--font-size--small);
  --font-stack--monospace: DejaVu Sans Mono,"SFMono-Regular",Menlo,Consolas,Monaco,Liberation Mono,Lucida Console,monospace;;
  --color-api-overall: #FFFFFF90;
  --color-api-paren: #FFFFFF90;
  --color-problematic: #B30000;
  
    }
    @media (prefers-color-scheme: dark) {
      body:not([data-theme="light"]) {
        --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  --color-brand-primary: #33CB33;
  --color-brand-content: #1DBD1D;
  --color-sidebar-background: #3B5526;
  --color-sidebar-background-border: var(--color-background-primary);
  --color-sidebar-link-text: #FFFFFF;
  --color-sidebar-brand-text: var(--color-sidebar-link-text--top-level);
  --color-sidebar-link-text--top-level: #FFFFFF;
  --color-sidebar-item-background--hover: #52833A;
  --color-sidebar-item-expander-background--hover: #52833A;
  --color-link-underline--hover: var(--color-link);
  --color-api-keyword: #FFFFFFbd;
  --color-api-name: var(--color-brand-content);
  --color-api-pre-name: var(--color-brand-content);
  --api-font-size: var(--font-size--normal);
  --color-foreground-secondary: #9DA1AC;
  --color-admonition-title-background--seealso: #555555;
  --color-admonition-title--seealso: black;
  --color-admonition-title-background--note: #555555;
  --color-admonition-title--note: black;
  --color-admonition-title-background--warning: var(--color-problematic);
  --color-admonition-title--warning: white;
  --admonition-font-size: var(--font-size--normal);
  --admonition-title-font-size: var(--font-size--normal);
  --color-code-background: hsl(80deg 100% 95%);
  --code-font-size: var(--font-size--small);
  --font-stack--monospace: DejaVu Sans Mono,"SFMono-Regular",Menlo,Consolas,Monaco,Liberation Mono,Lucida Console,monospace;;
  --color-api-overall: #FFFFFF90;
  --color-api-paren: #FFFFFF90;
  --color-problematic: #B30000;
  
      }
    }
  }
</style></head>
  <body>
    
    <script>
      document.body.dataset.theme = localStorage.getItem("theme") || "auto";
    </script>
    

<svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
  <symbol id="svg-toc" viewBox="0 0 24 24">
    <title>Contents</title>
    <svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 1024 1024">
      <path d="M408 442h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8zm-8 204c0 4.4 3.6 8 8 8h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56zm504-486H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0 632H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM115.4 518.9L271.7 642c5.8 4.6 14.4.5 14.4-6.9V388.9c0-7.4-8.5-11.5-14.4-6.9L115.4 505.1a8.74 8.74 0 0 0 0 13.8z"/>
    </svg>
  </symbol>
  <symbol id="svg-menu" viewBox="0 0 24 24">
    <title>Menu</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-menu">
      <line x1="3" y1="12" x2="21" y2="12"></line>
      <line x1="3" y1="6" x2="21" y2="6"></line>
      <line x1="3" y1="18" x2="21" y2="18"></line>
    </svg>
  </symbol>
  <symbol id="svg-arrow-right" viewBox="0 0 24 24">
    <title>Expand</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-chevron-right">
      <polyline points="9 18 15 12 9 6"></polyline>
    </svg>
  </symbol>
  <symbol id="svg-sun" viewBox="0 0 24 24">
    <title>Light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="feather-sun">
      <circle cx="12" cy="12" r="5"></circle>
      <line x1="12" y1="1" x2="12" y2="3"></line>
      <line x1="12" y1="21" x2="12" y2="23"></line>
      <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
      <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
      <line x1="1" y1="12" x2="3" y2="12"></line>
      <line x1="21" y1="12" x2="23" y2="12"></line>
      <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
      <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
    </svg>
  </symbol>
  <symbol id="svg-moon" viewBox="0 0 24 24">
    <title>Dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-moon">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M12 3c.132 0 .263 0 .393 0a7.5 7.5 0 0 0 7.92 12.446a9 9 0 1 1 -8.313 -12.454z" />
    </svg>
  </symbol>
  <symbol id="svg-sun-with-moon" viewBox="0 0 24 24">
    <title>Auto light/dark, in light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round"
      class="icon-custom-derived-from-feather-sun-and-tabler-moon">
      <path style="opacity: 50%" d="M 5.411 14.504 C 5.471 14.504 5.532 14.504 5.591 14.504 C 3.639 16.319 4.383 19.569 6.931 20.352 C 7.693 20.586 8.512 20.551 9.25 20.252 C 8.023 23.207 4.056 23.725 2.11 21.184 C 0.166 18.642 1.702 14.949 4.874 14.536 C 5.051 14.512 5.231 14.5 5.411 14.5 L 5.411 14.504 Z"/>
      <line x1="14.5" y1="3.25" x2="14.5" y2="1.25"/>
      <line x1="14.5" y1="15.85" x2="14.5" y2="17.85"/>
      <line x1="10.044" y1="5.094" x2="8.63" y2="3.68"/>
      <line x1="19" y1="14.05" x2="20.414" y2="15.464"/>
      <line x1="8.2" y1="9.55" x2="6.2" y2="9.55"/>
      <line x1="20.8" y1="9.55" x2="22.8" y2="9.55"/>
      <line x1="10.044" y1="14.006" x2="8.63" y2="15.42"/>
      <line x1="19" y1="5.05" x2="20.414" y2="3.636"/>
      <circle cx="14.5" cy="9.55" r="3.6"/>
    </svg>
  </symbol>
  <symbol id="svg-moon-with-sun" viewBox="0 0 24 24">
    <title>Auto light/dark, in dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round"
      class="icon-custom-derived-from-feather-sun-and-tabler-moon">
      <path d="M 8.282 7.007 C 8.385 7.007 8.494 7.007 8.595 7.007 C 5.18 10.184 6.481 15.869 10.942 17.24 C 12.275 17.648 13.706 17.589 15 17.066 C 12.851 22.236 5.91 23.143 2.505 18.696 C -0.897 14.249 1.791 7.786 7.342 7.063 C 7.652 7.021 7.965 7 8.282 7 L 8.282 7.007 Z"/>
      <line style="opacity: 50%" x1="18" y1="3.705" x2="18" y2="2.5"/>
      <line style="opacity: 50%" x1="18" y1="11.295" x2="18" y2="12.5"/>
      <line style="opacity: 50%" x1="15.316" y1="4.816" x2="14.464" y2="3.964"/>
      <line style="opacity: 50%" x1="20.711" y1="10.212" x2="21.563" y2="11.063"/>
      <line style="opacity: 50%" x1="14.205" y1="7.5" x2="13.001" y2="7.5"/>
      <line style="opacity: 50%" x1="21.795" y1="7.5" x2="23" y2="7.5"/>
      <line style="opacity: 50%" x1="15.316" y1="10.184" x2="14.464" y2="11.036"/>
      <line style="opacity: 50%" x1="20.711" y1="4.789" x2="21.563" y2="3.937"/>
      <circle style="opacity: 50%" cx="18" cy="7.5" r="2.169"/>
    </svg>
  </symbol>
  <symbol id="svg-pencil" viewBox="0 0 24 24">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-pencil-code">
      <path d="M4 20h4l10.5 -10.5a2.828 2.828 0 1 0 -4 -4l-10.5 10.5v4" />
      <path d="M13.5 6.5l4 4" />
      <path d="M20 21l2 -2l-2 -2" />
      <path d="M17 17l-2 2l2 2" />
    </svg>
  </symbol>
  <symbol id="svg-eye" viewBox="0 0 24 24">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-eye-code">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M10 12a2 2 0 1 0 4 0a2 2 0 0 0 -4 0" />
      <path
        d="M11.11 17.958c-3.209 -.307 -5.91 -2.293 -8.11 -5.958c2.4 -4 5.4 -6 9 -6c3.6 0 6.6 2 9 6c-.21 .352 -.427 .688 -.647 1.008" />
      <path d="M20 21l2 -2l-2 -2" />
      <path d="M17 17l-2 2l2 2" />
    </svg>
  </symbol>
</svg>

<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation">
<input type="checkbox" class="sidebar-toggle" name="__toc" id="__toc">
<label class="overlay sidebar-overlay" for="__navigation">
  <div class="visually-hidden">Hide navigation sidebar</div>
</label>
<label class="overlay toc-overlay" for="__toc">
  <div class="visually-hidden">Hide table of contents sidebar</div>
</label>

<a class="skip-to-content muted-link" href="#furo-main-content">Skip to content</a>



<div class="page">
  <header class="mobile-header">
    <div class="header-left">
      <label class="nav-overlay-icon" for="__navigation">
        <div class="visually-hidden">Toggle site navigation sidebar</div>
        <i class="icon"><svg><use href="#svg-menu"></use></svg></i>
      </label>
    </div>
    <div class="header-center">
      <a href="../../../../index.html"><div class="brand">SymPy 1.14.dev documentation</div></a>
    </div>
    <div class="header-right">
      <div class="theme-toggle-container theme-toggle-header">
        <button class="theme-toggle">
          <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
          <svg class="theme-icon-when-auto-light"><use href="#svg-sun-with-moon"></use></svg>
          <svg class="theme-icon-when-auto-dark"><use href="#svg-moon-with-sun"></use></svg>
          <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
          <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
        </button>
      </div>
      <label class="toc-overlay-icon toc-header-icon" for="__toc">
        <div class="visually-hidden">Toggle table of contents sidebar</div>
        <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
      </label>
    </div>
  </header>
  <aside class="sidebar-drawer">
    <div class="sidebar-container">
      
      <div class="sidebar-sticky"><div class="sidebar-scroll"><a class="sidebar-brand" href="../../../../index.html">
  
  <div class="sidebar-logo-container">
    <img class="sidebar-logo" src="../../../../_static/sympylogo.png" alt="Logo"/>
  </div>
  
  <span class="sidebar-brand-text">SymPy 1.14.dev documentation</span>
  
</a><form class="sidebar-search-container" method="get" action="../../../../search.html" role="search">
  <input class="sidebar-search" placeholder="Search" name="q" aria-label="Search">
  <input type="hidden" name="check_keywords" value="yes">
  <input type="hidden" name="area" value="default">
</form>
<div id="searchbox"></div><div class="sidebar-tree">
  <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../../../install.html">Installation</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../../../tutorials/index.html">Tutorials</a><input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" role="switch" type="checkbox"/><label for="toctree-checkbox-1"><div class="visually-hidden">Toggle navigation of Tutorials</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../../../tutorials/intro-tutorial/index.html">Introductory Tutorial</a><input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" role="switch" type="checkbox"/><label for="toctree-checkbox-2"><div class="visually-hidden">Toggle navigation of Introductory Tutorial</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../../tutorials/intro-tutorial/preliminaries.html">Preliminaries</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../tutorials/intro-tutorial/intro.html">Introduction</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../tutorials/intro-tutorial/gotchas.html">Gotchas</a></li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../../../../tutorials/intro-tutorial/features.html">SymPy Features</a><input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" role="switch" type="checkbox"/><label for="toctree-checkbox-3"><div class="visually-hidden">Toggle navigation of SymPy Features</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../../tutorials/intro-tutorial/basic_operations.html">Basic Operations</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../tutorials/intro-tutorial/printing.html">Printing</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../tutorials/intro-tutorial/simplification.html">Simplification</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../tutorials/intro-tutorial/calculus.html">Calculus</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../tutorials/intro-tutorial/solvers.html">Solvers</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../tutorials/intro-tutorial/matrices.html">Matrices</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../tutorials/intro-tutorial/manipulation.html">Advanced Expression Manipulation</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../../tutorials/intro-tutorial/next.html">What’s Next</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../../../tutorials/physics/index.html">Physics Tutorials</a><input class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" role="switch" type="checkbox"/><label for="toctree-checkbox-4"><div class="visually-hidden">Toggle navigation of Physics Tutorials</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3 has-children"><a class="reference internal" href="../../../../tutorials/physics/biomechanics/index.html">Biomechanics Tutorials</a><input class="toctree-checkbox" id="toctree-checkbox-5" name="toctree-checkbox-5" role="switch" type="checkbox"/><label for="toctree-checkbox-5"><div class="visually-hidden">Toggle navigation of Biomechanics Tutorials</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../../tutorials/physics/biomechanics/biomechanical-model-example.html">Biomechanical Model Example</a></li>
</ul>
</li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../../../../tutorials/physics/mechanics/index.html">Mechanics Tutorials</a><input class="toctree-checkbox" id="toctree-checkbox-6" name="toctree-checkbox-6" role="switch" type="checkbox"/><label for="toctree-checkbox-6"><div class="visually-hidden">Toggle navigation of Mechanics Tutorials</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../../tutorials/physics/mechanics/duffing-example.html">Duffing Oscillator with a Pendulum</a></li>
<li class="toctree-l4 has-children"><a class="reference internal" href="../../../../tutorials/physics/mechanics/rollingdisc_example.html">A rolling disc</a><input class="toctree-checkbox" id="toctree-checkbox-7" name="toctree-checkbox-7" role="switch" type="checkbox"/><label for="toctree-checkbox-7"><div class="visually-hidden">Toggle navigation of A rolling disc</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l5"><a class="reference internal" href="../../../../tutorials/physics/mechanics/rollingdisc_example_kane.html">A rolling disc, with Kane’s method</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../../../tutorials/physics/mechanics/rollingdisc_example_kane_constraints.html">A rolling disc, with Kane’s method and constraint forces</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../../../tutorials/physics/mechanics/rollingdisc_example_lagrange.html">A rolling disc using Lagrange’s Method</a></li>
</ul>
</li>
<li class="toctree-l4"><a class="reference internal" href="../../../../tutorials/physics/mechanics/multi_degree_freedom_holonomic_system.html">Multi Degree of Freedom Holonomic System</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../tutorials/physics/mechanics/lin_pend_nonmin_example.html">Nonminimal Coordinates Pendulum</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../tutorials/physics/mechanics/four_bar_linkage_example.html">A four bar linkage</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../tutorials/physics/mechanics/bicycle_example.html">Linearized Carvallo-Whipple Bicycle Model</a></li>
</ul>
</li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../../../../tutorials/physics/control/index.html">Control Tutorials</a><input class="toctree-checkbox" id="toctree-checkbox-8" name="toctree-checkbox-8" role="switch" type="checkbox"/><label for="toctree-checkbox-8"><div class="visually-hidden">Toggle navigation of Control Tutorials</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../../tutorials/physics/control/control_problems.html">Control Package Examples</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../tutorials/physics/control/electrical_problems.html">Electrical Problems using StateSpace</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../tutorials/physics/control/mechanics_problems.html">Mechanics Problems using StateSpace</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../../../guides/index.html">How-to Guides</a><input class="toctree-checkbox" id="toctree-checkbox-9" name="toctree-checkbox-9" role="switch" type="checkbox"/><label for="toctree-checkbox-9"><div class="visually-hidden">Toggle navigation of How-to Guides</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../../guides/assumptions.html">Assumptions</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../guides/booleans.html">Symbolic and fuzzy booleans</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../guides/custom-functions.html">Writing Custom Functions</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../guides/physics/index.html">Physics</a></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../../../guides/solving/index.html">Solve Equations</a><input class="toctree-checkbox" id="toctree-checkbox-10" name="toctree-checkbox-10" role="switch" type="checkbox"/><label for="toctree-checkbox-10"><div class="visually-hidden">Toggle navigation of Solve Equations</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../../guides/solving/solving-guidance.html">Solving Guidance</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../guides/solving/solve-equation-algebraically.html">Solve an Equation Algebraically</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../guides/solving/solve-system-of-equations-algebraically.html">Solve a System of Equations Algebraically</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../guides/solving/solve-numerically.html">Solve One or a System of Equations Numerically</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../guides/solving/solve-ode.html">Solve an Ordinary Differential Equation (ODE) Algebraically</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../guides/solving/find-roots-polynomial.html">Find the Roots of a Polynomial Algebraically or Numerically</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../guides/solving/solve-matrix-equation.html">Solve a Matrix Equation Algebraically</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../guides/solving/reduce-inequalities-algebraically.html">Reduce One or a System of Inequalities for a Single Variable Algebraically</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../guides/solving/solve-diophantine-equation.html">Solve a Diophantine Equation Algebraically</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../../guides/logo.html">SymPy Logo</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../citing.html">Citing SymPy</a></li>
</ul>
</li>
<li class="toctree-l1 current has-children"><a class="reference internal" href="../../../index.html">Explanations</a><input checked="" class="toctree-checkbox" id="toctree-checkbox-11" name="toctree-checkbox-11" role="switch" type="checkbox"/><label for="toctree-checkbox-11"><div class="visually-hidden">Toggle navigation of Explanations</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../../../best-practices.html">Best Practices</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../gotchas.html">Gotchas and Pitfalls</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../solve_output.html">Solve Output by Type</a></li>
<li class="toctree-l2 current has-children"><a class="reference internal" href="../index.html">Physics</a><input checked="" class="toctree-checkbox" id="toctree-checkbox-12" name="toctree-checkbox-12" role="switch" type="checkbox"/><label for="toctree-checkbox-12"><div class="visually-hidden">Toggle navigation of Physics</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul class="current">
<li class="toctree-l3 has-children"><a class="reference internal" href="../vector/index.html">Vector</a><input class="toctree-checkbox" id="toctree-checkbox-13" name="toctree-checkbox-13" role="switch" type="checkbox"/><label for="toctree-checkbox-13"><div class="visually-hidden">Toggle navigation of Vector</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../vector/vectors/vectors.html">Vector &amp; ReferenceFrame</a></li>
<li class="toctree-l4"><a class="reference internal" href="../vector/kinematics/kinematics.html">Vector: Kinematics</a></li>
<li class="toctree-l4"><a class="reference internal" href="../vector/fields.html">Scalar and Vector Field Functionality</a></li>
<li class="toctree-l4"><a class="reference internal" href="../vector/advanced.html">Potential Issues/Advanced Topics/Future Features in Physics/Vector Module</a></li>
</ul>
</li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../mechanics/index.html">Classical Mechanics</a><input class="toctree-checkbox" id="toctree-checkbox-14" name="toctree-checkbox-14" role="switch" type="checkbox"/><label for="toctree-checkbox-14"><div class="visually-hidden">Toggle navigation of Classical Mechanics</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../mechanics/masses.html">Masses, Inertias, Particles and Rigid Bodies in Physics/Mechanics</a></li>
<li class="toctree-l4"><a class="reference internal" href="../mechanics/kane.html">Kane’s Method in Physics/Mechanics</a></li>
<li class="toctree-l4"><a class="reference internal" href="../mechanics/lagrange.html">Lagrange’s Method in Physics/Mechanics</a></li>
<li class="toctree-l4"><a class="reference internal" href="../mechanics/joints.html">Joints Framework in Physics/Mechanics</a></li>
<li class="toctree-l4"><a class="reference internal" href="../mechanics/symsystem.html">Symbolic Systems in Physics/Mechanics</a></li>
<li class="toctree-l4"><a class="reference internal" href="../mechanics/linearize.html">Linearization in Physics/Mechanics</a></li>
<li class="toctree-l4"><a class="reference internal" href="../mechanics/reference.html">References for Physics/Mechanics</a></li>
<li class="toctree-l4"><a class="reference internal" href="../mechanics/autolev_parser.html">Autolev Parser</a></li>
<li class="toctree-l4"><a class="reference internal" href="../mechanics/sympy_mechanics_for_autolev_users.html">SymPy Mechanics for Autolev Users</a></li>
<li class="toctree-l4"><a class="reference internal" href="../mechanics/advanced.html">Potential Issues/Advanced Topics/Future Features in Physics/Mechanics</a></li>
</ul>
</li>
<li class="toctree-l3 current has-children"><a class="reference internal" href="index.html">Biomechanics</a><input checked="" class="toctree-checkbox" id="toctree-checkbox-15" name="toctree-checkbox-15" role="switch" type="checkbox"/><label for="toctree-checkbox-15"><div class="visually-hidden">Toggle navigation of Biomechanics</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul class="current">
<li class="toctree-l4 current current-page"><a class="current reference internal" href="#">Introduction to Biomechanical Modeling</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../../special_topics/index.html">SymPy Special Topics</a><input class="toctree-checkbox" id="toctree-checkbox-16" name="toctree-checkbox-16" role="switch" type="checkbox"/><label for="toctree-checkbox-16"><div class="visually-hidden">Toggle navigation of SymPy Special Topics</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../special_topics/finite_diff_derivatives.html">Finite Difference Approximations to Derivatives</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../special_topics/classification.html">Classification of SymPy objects</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../active-deprecations.html">List of active deprecations</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../glossary.html">Glossary</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../../../reference/index.html">API Reference</a><input class="toctree-checkbox" id="toctree-checkbox-17" name="toctree-checkbox-17" role="switch" type="checkbox"/><label for="toctree-checkbox-17"><div class="visually-hidden">Toggle navigation of API Reference</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../../../reference/public/basics/index.html">Basics</a><input class="toctree-checkbox" id="toctree-checkbox-18" name="toctree-checkbox-18" role="switch" type="checkbox"/><label for="toctree-checkbox-18"><div class="visually-hidden">Toggle navigation of Basics</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3 has-children"><a class="reference internal" href="../../../../modules/assumptions/index.html">Assumptions</a><input class="toctree-checkbox" id="toctree-checkbox-19" name="toctree-checkbox-19" role="switch" type="checkbox"/><label for="toctree-checkbox-19"><div class="visually-hidden">Toggle navigation of Assumptions</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../../modules/assumptions/ask.html">Ask</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../modules/assumptions/assume.html">Assume</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../modules/assumptions/refine.html">Refine</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../modules/assumptions/predicates.html">Predicates</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../../modules/calculus/index.html">Calculus</a></li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../../../../modules/combinatorics/index.html">Combinatorics</a><input class="toctree-checkbox" id="toctree-checkbox-20" name="toctree-checkbox-20" role="switch" type="checkbox"/><label for="toctree-checkbox-20"><div class="visually-hidden">Toggle navigation of Combinatorics</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../../modules/combinatorics/partitions.html">Partitions</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../modules/combinatorics/permutations.html">Permutations</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../modules/combinatorics/perm_groups.html">Permutation Groups</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../modules/combinatorics/polyhedron.html">Polyhedron</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../modules/combinatorics/prufer.html">Prufer Sequences</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../modules/combinatorics/subsets.html">Subsets</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../modules/combinatorics/graycode.html">Gray Code</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../modules/combinatorics/named_groups.html">Named Groups</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../modules/combinatorics/galois.html">Galois Groups</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../modules/combinatorics/group_numbers.html">Number of groups</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../modules/combinatorics/util.html">Utilities</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../modules/combinatorics/group_constructs.html">Group constructors</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../modules/combinatorics/testutil.html">Test Utilities</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../modules/combinatorics/tensor_can.html">Tensor Canonicalization</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../modules/combinatorics/fp_groups.html">Finitely Presented Groups</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../modules/combinatorics/pc_groups.html">Polycyclic Groups</a></li>
</ul>
</li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../../../../modules/functions/index.html">Functions</a><input class="toctree-checkbox" id="toctree-checkbox-21" name="toctree-checkbox-21" role="switch" type="checkbox"/><label for="toctree-checkbox-21"><div class="visually-hidden">Toggle navigation of Functions</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../../modules/functions/elementary.html">Elementary</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../modules/functions/combinatorial.html">Combinatorial</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../modules/functions/combinatorial.html#enumeration">Enumeration</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../modules/functions/special.html">Special</a></li>
</ul>
</li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../../../../modules/integrals/index.html">Integrals</a><input class="toctree-checkbox" id="toctree-checkbox-22" name="toctree-checkbox-22" role="switch" type="checkbox"/><label for="toctree-checkbox-22"><div class="visually-hidden">Toggle navigation of Integrals</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../../modules/integrals/g-functions.html">Computing Integrals using Meijer G-Functions</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../modules/integrals/integrals.html">Integrals</a></li>
</ul>
</li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../../../../modules/series/index.html">Series</a><input class="toctree-checkbox" id="toctree-checkbox-23" name="toctree-checkbox-23" role="switch" type="checkbox"/><label for="toctree-checkbox-23"><div class="visually-hidden">Toggle navigation of Series</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../../modules/series/series.html">Series Expansions</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../modules/series/sequences.html">Sequences</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../modules/series/fourier.html">Fourier Series</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../modules/series/formal.html">Formal Power Series</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../modules/series/limitseq.html">Limits of Sequences</a></li>
</ul>
</li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../../../../modules/simplify/index.html">Simplify</a><input class="toctree-checkbox" id="toctree-checkbox-24" name="toctree-checkbox-24" role="switch" type="checkbox"/><label for="toctree-checkbox-24"><div class="visually-hidden">Toggle navigation of Simplify</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../../modules/simplify/simplify.html">Simplify</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../modules/simplify/hyperexpand.html">Hypergeometric Expansion</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../modules/simplify/fu.html">Hongguang Fu’s Trigonometric Simplification</a></li>
</ul>
</li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../../../../modules/solvers/index.html">Solvers</a><input class="toctree-checkbox" id="toctree-checkbox-25" name="toctree-checkbox-25" role="switch" type="checkbox"/><label for="toctree-checkbox-25"><div class="visually-hidden">Toggle navigation of Solvers</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../../modules/solvers/diophantine.html">Diophantine</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../modules/solvers/inequalities.html">Inequality Solvers</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../modules/solvers/ode.html">ODE</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../modules/solvers/pde.html">PDE</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../modules/solvers/solvers.html">Solvers</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../modules/solvers/solveset.html">Solveset</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../../modules/abc.html">abc</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../modules/algebras.html">Algebras</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../modules/concrete.html">Concrete</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../modules/core.html">Core</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../modules/discrete.html">Discrete</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../modules/evalf.html">Numerical Evaluation</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../modules/numeric-computation.html">Numeric Computation</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../modules/rewriting.html">Term Rewriting</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../../../reference/public/codegeneration/index.html">Code Generation</a><input class="toctree-checkbox" id="toctree-checkbox-26" name="toctree-checkbox-26" role="switch" type="checkbox"/><label for="toctree-checkbox-26"><div class="visually-hidden">Toggle navigation of Code Generation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../../modules/codegen.html">Code Generation</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../../../reference/public/logic/index.html">Logic</a><input class="toctree-checkbox" id="toctree-checkbox-27" name="toctree-checkbox-27" role="switch" type="checkbox"/><label for="toctree-checkbox-27"><div class="visually-hidden">Toggle navigation of Logic</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../../modules/logic.html">Logic</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../modules/sets.html">Sets</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../../../reference/public/matrices/index.html">Matrices</a><input class="toctree-checkbox" id="toctree-checkbox-28" name="toctree-checkbox-28" role="switch" type="checkbox"/><label for="toctree-checkbox-28"><div class="visually-hidden">Toggle navigation of Matrices</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3 has-children"><a class="reference internal" href="../../../../modules/matrices/index.html">Matrices</a><input class="toctree-checkbox" id="toctree-checkbox-29" name="toctree-checkbox-29" role="switch" type="checkbox"/><label for="toctree-checkbox-29"><div class="visually-hidden">Toggle navigation of Matrices</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../../modules/matrices/matrices.html">Matrices (linear algebra)</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../modules/matrices/kind.html">Matrix Kind</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../modules/matrices/dense.html">Dense Matrices</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../modules/matrices/sparse.html">Sparse Matrices</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../modules/matrices/sparsetools.html">Sparse Tools</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../modules/matrices/immutablematrices.html">Immutable Matrices</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../modules/matrices/expressions.html">Matrix Expressions</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../modules/matrices/normalforms.html">Matrix Normal Forms</a></li>
</ul>
</li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../../../../modules/tensor/index.html">Tensor</a><input class="toctree-checkbox" id="toctree-checkbox-30" name="toctree-checkbox-30" role="switch" type="checkbox"/><label for="toctree-checkbox-30"><div class="visually-hidden">Toggle navigation of Tensor</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../../modules/tensor/array.html">N-dim array</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../modules/tensor/array_expressions.html">N-dim array expressions</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../modules/tensor/indexed.html">Indexed Objects</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../modules/tensor/index_methods.html">Methods</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../modules/tensor/tensor.html">Tensor</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../modules/tensor/toperators.html">Tensor Operators</a></li>
</ul>
</li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../../../../modules/vector/index.html">Vector</a><input class="toctree-checkbox" id="toctree-checkbox-31" name="toctree-checkbox-31" role="switch" type="checkbox"/><label for="toctree-checkbox-31"><div class="visually-hidden">Toggle navigation of Vector</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../../modules/vector/intro.html">Introduction</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../modules/vector/basics.html">Basic Implementation details</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../modules/vector/coordsys.html">More about Coordinate Systems</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../modules/vector/fields.html">Scalar and Vector Field Functionality</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../modules/vector/examples.html">General examples of usage</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../modules/vector/vector_integration.html">Applications of Vector Integrals</a></li>
<li class="toctree-l4 has-children"><a class="reference internal" href="../../../../modules/vector/api/index.html">Vector API</a><input class="toctree-checkbox" id="toctree-checkbox-32" name="toctree-checkbox-32" role="switch" type="checkbox"/><label for="toctree-checkbox-32"><div class="visually-hidden">Toggle navigation of Vector API</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l5"><a class="reference internal" href="../../../../modules/vector/api/classes.html">Essential Classes in sympy.vector (docstrings)</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../../../modules/vector/api/orienterclasses.html">Orienter classes (docstrings)</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../../../modules/vector/api/vectorfunctions.html">Essential Functions in sympy.vector (docstrings)</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../../../reference/public/numbertheory/index.html">Number Theory</a><input class="toctree-checkbox" id="toctree-checkbox-33" name="toctree-checkbox-33" role="switch" type="checkbox"/><label for="toctree-checkbox-33"><div class="visually-hidden">Toggle navigation of Number Theory</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../../modules/ntheory.html">Number Theory</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../../../reference/public/physics/index.html">Physics</a><input class="toctree-checkbox" id="toctree-checkbox-34" name="toctree-checkbox-34" role="switch" type="checkbox"/><label for="toctree-checkbox-34"><div class="visually-hidden">Toggle navigation of Physics</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3 has-children"><a class="reference internal" href="../../../../modules/physics/vector/api/index.html">Physics Vector API</a><input class="toctree-checkbox" id="toctree-checkbox-35" name="toctree-checkbox-35" role="switch" type="checkbox"/><label for="toctree-checkbox-35"><div class="visually-hidden">Toggle navigation of Physics Vector API</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../../modules/physics/vector/api/classes.html">Essential Classes</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../modules/physics/vector/api/kinematics.html">Kinematics (Docstrings)</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../modules/physics/vector/api/printing.html">Printing (Docstrings)</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../modules/physics/vector/api/functions.html">Essential Functions (Docstrings)</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../modules/physics/vector/api/fieldfunctions.html">Docstrings for basic field functions</a></li>
</ul>
</li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../../../../modules/physics/mechanics/api/index.html">Mechanics API Reference</a><input class="toctree-checkbox" id="toctree-checkbox-36" name="toctree-checkbox-36" role="switch" type="checkbox"/><label for="toctree-checkbox-36"><div class="visually-hidden">Toggle navigation of Mechanics API Reference</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../../modules/physics/mechanics/api/part_bod.html">Bodies, Inertias, Loads &amp; Other Functions (Docstrings)</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../modules/physics/mechanics/api/kane_lagrange.html">Kane’s Method &amp; Lagrange’s Method (Docstrings)</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../modules/physics/mechanics/api/joint.html">Joints Framework (Docstrings)</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../modules/physics/mechanics/api/system.html">System (Docstrings)</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../modules/physics/mechanics/api/linearize.html">Linearization (Docstrings)</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../modules/physics/mechanics/api/expr_manip.html">Expression Manipulation (Docstrings)</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../modules/physics/mechanics/api/printing.html">Printing (Docstrings)</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../modules/physics/mechanics/api/pathway.html">Pathway (Docstrings)</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../modules/physics/mechanics/api/actuator.html">Actuator (Docstrings)</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../modules/physics/mechanics/api/wrapping_geometry.html">Wrapping Geometry (Docstrings)</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../modules/physics/mechanics/api/deprecated_classes.html">Deprecated Classes (Docstrings)</a></li>
</ul>
</li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../../../../modules/physics/biomechanics/api/index.html">Biomechanics API Reference</a><input class="toctree-checkbox" id="toctree-checkbox-37" name="toctree-checkbox-37" role="switch" type="checkbox"/><label for="toctree-checkbox-37"><div class="visually-hidden">Toggle navigation of Biomechanics API Reference</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../../modules/physics/biomechanics/api/musculotendon.html">Musculotendon (Docstrings)</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../modules/physics/biomechanics/api/activation.html">Activation (Docstrings)</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../modules/physics/biomechanics/api/curve.html">Curve (Docstrings)</a></li>
</ul>
</li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../../../../modules/physics/control/index.html">Control</a><input class="toctree-checkbox" id="toctree-checkbox-38" name="toctree-checkbox-38" role="switch" type="checkbox"/><label for="toctree-checkbox-38"><div class="visually-hidden">Toggle navigation of Control</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../../modules/physics/control/control.html">Control</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../modules/physics/control/lti.html">Control API</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../modules/physics/control/control_plots.html">Control System Plots</a></li>
</ul>
</li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../../../../modules/physics/optics/index.html">Optics</a><input class="toctree-checkbox" id="toctree-checkbox-39" name="toctree-checkbox-39" role="switch" type="checkbox"/><label for="toctree-checkbox-39"><div class="visually-hidden">Toggle navigation of Optics</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../../modules/physics/optics/gaussopt.html">Gaussian Optics</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../modules/physics/optics/medium.html">Medium</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../modules/physics/optics/polarization.html">Polarization</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../modules/physics/optics/utils.html">Utilities</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../modules/physics/optics/waves.html">Waves</a></li>
</ul>
</li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../../../../modules/physics/units/index.html">Unit Systems</a><input class="toctree-checkbox" id="toctree-checkbox-40" name="toctree-checkbox-40" role="switch" type="checkbox"/><label for="toctree-checkbox-40"><div class="visually-hidden">Toggle navigation of Unit Systems</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../../modules/physics/units/philosophy.html">Philosophy behind unit systems</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../modules/physics/units/examples.html">More examples</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../modules/physics/units/dimensions.html">Dimensions and dimension systems</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../modules/physics/units/prefixes.html">Unit prefixes</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../modules/physics/units/unitsystem.html">Units and unit systems</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../modules/physics/units/quantities.html">Physical quantities</a></li>
</ul>
</li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../../../../modules/physics/continuum_mechanics/index.html">Continuum Mechanics</a><input class="toctree-checkbox" id="toctree-checkbox-41" name="toctree-checkbox-41" role="switch" type="checkbox"/><label for="toctree-checkbox-41"><div class="visually-hidden">Toggle navigation of Continuum Mechanics</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../../modules/physics/continuum_mechanics/beam.html">Beam (Docstrings)</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../modules/physics/continuum_mechanics/beam_problems.html">Solving Beam Bending Problems using Singularity Functions</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../modules/physics/continuum_mechanics/truss.html">Truss (Docstrings)</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../modules/physics/continuum_mechanics/cable.html">Cable (Docstrings)</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../modules/physics/continuum_mechanics/arches.html">Arch (Docstrings)</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../../modules/physics/hep/index.html">High Energy Physics</a></li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../../../../modules/physics/quantum/index.html">Quantum Mechanics</a><input class="toctree-checkbox" id="toctree-checkbox-42" name="toctree-checkbox-42" role="switch" type="checkbox"/><label for="toctree-checkbox-42"><div class="visually-hidden">Toggle navigation of Quantum Mechanics</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../../modules/physics/quantum/anticommutator.html">Anticommutator</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../modules/physics/quantum/cg.html">Clebsch-Gordan Coefficients</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../modules/physics/quantum/commutator.html">Commutator</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../modules/physics/quantum/constants.html">Constants</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../modules/physics/quantum/dagger.html">Dagger</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../modules/physics/quantum/innerproduct.html">Inner Product</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../modules/physics/quantum/tensorproduct.html">Tensor Product</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../modules/physics/quantum/cartesian.html">Cartesian Operators and States</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../modules/physics/quantum/hilbert.html">Hilbert Space</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../modules/physics/quantum/operator.html">Operator</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../modules/physics/quantum/operatorset.html">Operator/State Helper Functions</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../modules/physics/quantum/qapply.html">Qapply</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../modules/physics/quantum/represent.html">Represent</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../modules/physics/quantum/spin.html">Spin</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../modules/physics/quantum/state.html">State</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../modules/physics/quantum/circuitplot.html">Circuit Plot</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../modules/physics/quantum/gate.html">Gates</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../modules/physics/quantum/grover.html">Grover’s Algorithm</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../modules/physics/quantum/qft.html">QFT</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../modules/physics/quantum/qubit.html">Qubit</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../modules/physics/quantum/shor.html">Shor’s Algorithm</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../modules/physics/quantum/piab.html">Particle in a Box</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../../modules/physics/hydrogen.html">Hydrogen Wavefunctions</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../modules/physics/matrices.html">Matrices</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../modules/physics/paulialgebra.html">Pauli Algebra</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../modules/physics/qho_1d.html">Quantum Harmonic Oscillator in 1-D</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../modules/physics/secondquant.html">Second Quantization</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../modules/physics/sho.html">Quantum Harmonic Oscillator in 3-D</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../modules/physics/wigner.html">Wigner Symbols</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../../../reference/public/utilities/index.html">Utilities</a><input class="toctree-checkbox" id="toctree-checkbox-43" name="toctree-checkbox-43" role="switch" type="checkbox"/><label for="toctree-checkbox-43"><div class="visually-hidden">Toggle navigation of Utilities</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3 has-children"><a class="reference internal" href="../../../../modules/testing/index.html">Testing</a><input class="toctree-checkbox" id="toctree-checkbox-44" name="toctree-checkbox-44" role="switch" type="checkbox"/><label for="toctree-checkbox-44"><div class="visually-hidden">Toggle navigation of Testing</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../../modules/testing/pytest.html">pytest</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../modules/testing/randtest.html">Randomised Testing</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../modules/testing/runtests.html">Run Tests</a></li>
</ul>
</li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../../../../modules/utilities/index.html">Utilities</a><input class="toctree-checkbox" id="toctree-checkbox-45" name="toctree-checkbox-45" role="switch" type="checkbox"/><label for="toctree-checkbox-45"><div class="visually-hidden">Toggle navigation of Utilities</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../../modules/utilities/autowrap.html">Autowrap Module</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../modules/utilities/codegen.html">Codegen</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../modules/utilities/decorator.html">Decorator</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../modules/utilities/enumerative.html">Enumerative</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../modules/utilities/exceptions.html">Exceptions and Warnings</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../modules/utilities/iterables.html">Iterables</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../modules/utilities/lambdify.html">Lambdify</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../modules/utilities/memoization.html">Memoization</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../modules/utilities/misc.html">Miscellaneous</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../modules/utilities/source.html">Source Code Inspection</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../modules/utilities/timeutils.html">Timing Utilities</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../../modules/interactive.html">Interactive</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../modules/parsing.html">Parsing</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../modules/printing.html">Printing</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../../../reference/public/topics/index.html">Topics</a><input class="toctree-checkbox" id="toctree-checkbox-46" name="toctree-checkbox-46" role="switch" type="checkbox"/><label for="toctree-checkbox-46"><div class="visually-hidden">Toggle navigation of Topics</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3 has-children"><a class="reference internal" href="../../../../modules/geometry/index.html">Geometry</a><input class="toctree-checkbox" id="toctree-checkbox-47" name="toctree-checkbox-47" role="switch" type="checkbox"/><label for="toctree-checkbox-47"><div class="visually-hidden">Toggle navigation of Geometry</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../../modules/geometry/entities.html">Entities</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../modules/geometry/utils.html">Utils</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../modules/geometry/points.html">Points</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../modules/geometry/lines.html">Lines</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../modules/geometry/curves.html">Curves</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../modules/geometry/ellipses.html">Ellipses</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../modules/geometry/polygons.html">Polygons</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../modules/geometry/plane.html">Plane</a></li>
</ul>
</li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../../../../modules/holonomic/index.html">Holonomic</a><input class="toctree-checkbox" id="toctree-checkbox-48" name="toctree-checkbox-48" role="switch" type="checkbox"/><label for="toctree-checkbox-48"><div class="visually-hidden">Toggle navigation of Holonomic</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../../modules/holonomic/about.html">About Holonomic Functions</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../modules/holonomic/represent.html">Representation of holonomic functions in SymPy</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../modules/holonomic/operations.html">Operations on holonomic functions</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../modules/holonomic/convert.html">Converting other representations to holonomic</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../modules/holonomic/uses.html">Uses and Current limitations</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../modules/holonomic/internal.html">Internal API</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../../modules/liealgebras/index.html">Lie Algebra</a></li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../../../../modules/polys/index.html">Polynomial Manipulation</a><input class="toctree-checkbox" id="toctree-checkbox-49" name="toctree-checkbox-49" role="switch" type="checkbox"/><label for="toctree-checkbox-49"><div class="visually-hidden">Toggle navigation of Polynomial Manipulation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../../modules/polys/basics.html">Basic functionality of the module</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../modules/polys/wester.html">Examples from Wester’s Article</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../modules/polys/reference.html">Polynomials Manipulation Module Reference</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../modules/polys/agca.html">AGCA - Algebraic Geometry and Commutative Algebra Module</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../modules/polys/domainsintro.html">Introducing the Domains of the poly module</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../modules/polys/domainsref.html">Reference docs for the Poly Domains</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../modules/polys/internals.html">Internals of the Polynomial Manipulation Module</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../modules/polys/ringseries.html">Series Manipulation using Polynomials</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../modules/polys/literature.html">Literature</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../modules/polys/solvers.html">Poly solvers</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../modules/polys/domainmatrix.html">Introducing the domainmatrix of the poly module</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../modules/polys/numberfields.html">Number Fields</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../../modules/categories.html">Category Theory</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../modules/crypto.html">Cryptography</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../modules/diffgeom.html">Differential Geometry</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../modules/plotting.html">Plotting</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../modules/stats.html">Stats</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../../../contributing/index.html">Contributing</a><input class="toctree-checkbox" id="toctree-checkbox-50" name="toctree-checkbox-50" role="switch" type="checkbox"/><label for="toctree-checkbox-50"><div class="visually-hidden">Toggle navigation of Contributing</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../../contributing/introduction-to-contributing.html">Introduction to Contributing</a></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../../../contributing/new-contributors-guide/index.html">Guide for New Contributors</a><input class="toctree-checkbox" id="toctree-checkbox-51" name="toctree-checkbox-51" role="switch" type="checkbox"/><label for="toctree-checkbox-51"><div class="visually-hidden">Toggle navigation of Guide for New Contributors</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../../contributing/new-contributors-guide/dev-setup.html">Setup Development Environment</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../contributing/new-contributors-guide/workflow-process.html">Development Workflow Process</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../contributing/new-contributors-guide/writing-tests.html">Writing Tests</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../contributing/new-contributors-guide/build-docs.html">Building the Documentation</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../../contributing/dependencies.html">Dependencies</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../contributing/debug.html">Debugging</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../contributing/docstring.html">Docstrings Style Guide</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../contributing/documentation-style-guide.html">Documentation Style Guide</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../contributing/deprecations.html">Deprecation Policy</a></li>
</ul>
</li>
</ul>

</div><!-- Versions Menu. In order to work, there should be a file called versions.json one level up from the documentation listing the "dev" and "latest" version numbers, like
{
    "latest": "1.10",
    "dev": "1.11.dev"
}
-->
<div class="sidebar-tree sidebar-versions">
  <h5 class="versions-header">Documentation Version</h4>
</div>

<!-- Make sure jquery is loaded (we would put this as a separate .js, but it uses jinja templates in some of the variables) -->
<script src="../../../../_static/jquery.js"></script>
<script>
  var versions_json_loc = "../../../../../versions.json";

  function add_version_menu(json_loc) {
      var menu = document.createElement("ul");
      var thisversion = "dev"
      $.getJSON(json_loc, function(versions) {
          for (var key in versions) {
              if (key != "latest" && key != "dev") {
                  console.error("Invalid key in versions.json", key);
              } else {
                  var version = document.createElement("li")
                  version.className = "sidebar-versions-l1 sidebar-versions-" + key + "-l1";
                  if (key == thisversion){
                      version.className += " current-version";
                  }
                  var a = document.createElement("a");
                  a.className = "reference internal";
                  a.innerHTML = "SymPy " + versions[key] + " (" + key + " version)";
                  a.title = key + " version";
                  a.href = "https://docs.sympy.org/" + key + "/explanation/modules/physics/biomechanics/biomechanics.html";
                  version.appendChild(a);
                  menu.appendChild(version);
              }
          }
      }).done(function() {
          console.log("versions.json read successfully");
      }).fail(function() {
          var version = document.createElement("li")
          version.className = "sidebar-versions-l1 sidebar-versions-latest-l1";
          var d = document.createElement("div");
          d.className = "versions-not-found"
          d.innerHTML = "Other Versions Not Found";
          d.title = "The version selection menu is only available for the documentation published on docs.sympy.org";
          version.appendChild(d);
          menu.appendChild(version);
          console.error("Could not read versions.json");
      }).always(function() {
          $(".sidebar-versions").append(menu)
      });
  };

  $( document ).ready( add_version_menu(versions_json_loc));
</script></div>
      </div>
      
    </div>
  </aside>
  <div class="main">
    <div class="content">
      <div class="article-container">
        <a href="#" class="back-to-top muted-link">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
            <path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12z"></path>
          </svg>
          <span>Back to top</span>
        </a>
        <div class="content-icon-container">
          <div class="view-this-page">
  <a class="muted-link" href="../../../../_sources/explanation/modules/physics/biomechanics/biomechanics.rst.txt" title="View this page">
    <svg><use href="#svg-eye"></use></svg>
    <span class="visually-hidden">View this page</span>
  </a>
</div>
<div class="theme-toggle-container theme-toggle-content">
            <button class="theme-toggle">
              <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
              <svg class="theme-icon-when-auto-light"><use href="#svg-sun-with-moon"></use></svg>
              <svg class="theme-icon-when-auto-dark"><use href="#svg-moon-with-sun"></use></svg>
              <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
              <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
            </button>
          </div>
          <label class="toc-overlay-icon toc-content-icon" for="__toc">
            <div class="visually-hidden">Toggle table of contents sidebar</div>
            <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
          </label>
        </div>
        <article role="main" id="furo-main-content">
          <section id="introduction-to-biomechanical-modeling">
<span id="biomechanics-tutorial"></span><h1>Introduction to Biomechanical Modeling<a class="headerlink" href="#introduction-to-biomechanical-modeling" title="Link to this heading">¶</a></h1>
<p><a class="reference internal" href="../../../../modules/physics/biomechanics/api/index.html#module-sympy.physics.biomechanics" title="sympy.physics.biomechanics"><code class="xref py py-obj docutils literal notranslate"><span class="pre">sympy.physics.biomechanics</span></code></a> provides features to enhance models created
using <a class="reference internal" href="../../../../modules/physics/mechanics/api/index.html#module-sympy.physics.mechanics" title="sympy.physics.mechanics"><code class="xref py py-obj docutils literal notranslate"><span class="pre">sympy.physics.mechanics</span></code></a> with force producing elements that model
muscles and tendons. In this tutorial, we will introduce the features of this
module.</p>
<p>The initial primary purpose of the biomechanics package is to introduce tools
for modeling the forces produced by <a class="reference external" href="https://en.wikipedia.org/wiki/Hill%27s_muscle_model">Hill-type muscle models</a>. These models
generate forces applied to the skeletal structure of an organism based on the
contraction state of the muscle coupled with the passive stretch of tendons. In
this tutorial, we introduce the elements that make up a musculotendon model and
then demonstrate it in operation with a specific implementation, the
<a class="reference internal" href="../../../../modules/physics/biomechanics/api/musculotendon.html#sympy.physics.biomechanics.musculotendon.MusculotendonDeGroote2016" title="sympy.physics.biomechanics.musculotendon.MusculotendonDeGroote2016"><code class="xref py py-obj docutils literal notranslate"><span class="pre">MusculotendonDeGroote2016</span></code></a> model.</p>
<section id="loads">
<h2>Loads<a class="headerlink" href="#loads" title="Link to this heading">¶</a></h2>
<p><a class="reference internal" href="../../../../modules/physics/mechanics/api/index.html#module-sympy.physics.mechanics" title="sympy.physics.mechanics"><code class="xref py py-obj docutils literal notranslate"><span class="pre">sympy.physics.mechanics</span></code></a> includes two types of loads:
<a class="reference internal" href="../../../../modules/physics/mechanics/api/part_bod.html#sympy.physics.mechanics.loads.Force" title="sympy.physics.mechanics.loads.Force"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Force</span></code></a> and
<a class="reference internal" href="../../../../modules/physics/mechanics/api/part_bod.html#sympy.physics.mechanics.loads.Torque" title="sympy.physics.mechanics.loads.Torque"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Torque</span></code></a>. Forces represent bound vector
quantities that act directed along a line of action and torques are unbound
vectors which represent the resulting torque of a couple from a set of forces.</p>
<p>An example of very common force model is a linear spring and linear damper in
parallel. The force acting on a particle of mass <span class="math notranslate nohighlight">\(m\)</span> with 1D motion
described by generalized coordinate <span class="math notranslate nohighlight">\(x(t)\)</span>  with linear spring and damper
coefficients <span class="math notranslate nohighlight">\(k\)</span> and <span class="math notranslate nohighlight">\(c\)</span> has the familiar equation of motion:</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[m \ddot{x} = \sum F = -kx - c\dot{x}\]</div>
</div>
<p>In SymPy, we can formulate the force acting on the particle <span class="math notranslate nohighlight">\(P\)</span> that has
motion in reference frame <span class="math notranslate nohighlight">\(N\)</span> and position relative to point <span class="math notranslate nohighlight">\(O\)</span>
fixed in <span class="math notranslate nohighlight">\(N\)</span> like so:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">sympy</span> <span class="k">as</span> <span class="nn">sm</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">sympy.physics.mechanics</span> <span class="k">as</span> <span class="nn">me</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">k</span><span class="p">,</span> <span class="n">c</span> <span class="o">=</span> <span class="n">sm</span><span class="o">.</span><span class="n">symbols</span><span class="p">(</span><span class="s1">&#39;k, c&#39;</span><span class="p">,</span> <span class="n">real</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">nonnegative</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">x</span> <span class="o">=</span> <span class="n">me</span><span class="o">.</span><span class="n">dynamicsymbols</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="n">real</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">N</span> <span class="o">=</span> <span class="n">me</span><span class="o">.</span><span class="n">ReferenceFrame</span><span class="p">(</span><span class="s1">&#39;N&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">O</span><span class="p">,</span> <span class="n">P</span> <span class="o">=</span> <span class="n">me</span><span class="o">.</span><span class="n">Point</span><span class="p">(</span><span class="s1">&#39;O&#39;</span><span class="p">),</span> <span class="n">me</span><span class="o">.</span><span class="n">Point</span><span class="p">(</span><span class="s1">&#39;P&#39;</span><span class="p">)</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">P</span><span class="o">.</span><span class="n">set_pos</span><span class="p">(</span><span class="n">O</span><span class="p">,</span> <span class="n">x</span><span class="o">*</span><span class="n">N</span><span class="o">.</span><span class="n">x</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">P</span><span class="o">.</span><span class="n">set_vel</span><span class="p">(</span><span class="n">N</span><span class="p">,</span> <span class="n">x</span><span class="o">.</span><span class="n">diff</span><span class="p">()</span><span class="o">*</span><span class="n">N</span><span class="o">.</span><span class="n">x</span><span class="p">)</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">force_on_P</span> <span class="o">=</span> <span class="n">me</span><span class="o">.</span><span class="n">Force</span><span class="p">(</span><span class="n">P</span><span class="p">,</span> <span class="o">-</span><span class="n">k</span><span class="o">*</span><span class="n">P</span><span class="o">.</span><span class="n">pos_from</span><span class="p">(</span><span class="n">O</span><span class="p">)</span> <span class="o">-</span> <span class="n">c</span><span class="o">*</span><span class="n">P</span><span class="o">.</span><span class="n">vel</span><span class="p">(</span><span class="n">N</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">force_on_P</span>
<span class="go">(P, (-c*Derivative(x(t), t) - k*x(t))*N.x)</span>
</pre></div>
</div>
<p>and there would be an equal and opposite force acting on <span class="math notranslate nohighlight">\(O\)</span>:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">force_on_O</span> <span class="o">=</span> <span class="n">me</span><span class="o">.</span><span class="n">Force</span><span class="p">(</span><span class="n">O</span><span class="p">,</span> <span class="n">k</span><span class="o">*</span><span class="n">P</span><span class="o">.</span><span class="n">pos_from</span><span class="p">(</span><span class="n">O</span><span class="p">)</span> <span class="o">+</span> <span class="n">c</span><span class="o">*</span><span class="n">P</span><span class="o">.</span><span class="n">vel</span><span class="p">(</span><span class="n">N</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">force_on_O</span>
<span class="go">(O, (c*Derivative(x(t), t) + k*x(t))*N.x)</span>
</pre></div>
</div>
<p>Forces that a single muscle and tendon applies to a set of rigid bodies will
be the primary output of the musculotendon models developed further in this
tutorial.</p>
</section>
<section id="pathways">
<h2>Pathways<a class="headerlink" href="#pathways" title="Link to this heading">¶</a></h2>
<p>Muscles and their associated tendons wrap around the moving skeletal system, as
well as other muscles and organs. This imposes the challenge of determining the
lines of action of the forces that the muscle and tendon produce on the
skeleton and organs it touches. We have introduced the
<a class="reference internal" href="../../../../modules/physics/mechanics/api/pathway.html#module-sympy.physics.mechanics.pathway" title="sympy.physics.mechanics.pathway"><code class="xref py py-obj docutils literal notranslate"><span class="pre">pathway</span></code></a> module to help manage the specification
of the geometric relationships to the forces’ lines of action.</p>
<p>The spring-damper example above has the simplest line of action definition so
we can use a <a class="reference internal" href="../../../../modules/physics/mechanics/api/pathway.html#sympy.physics.mechanics.pathway.LinearPathway" title="sympy.physics.mechanics.pathway.LinearPathway"><code class="xref py py-obj docutils literal notranslate"><span class="pre">LinearPathway</span></code></a> to establish
that line of action. First provide the two endpoints where the force will have
equal and opposite application to and the distance between the points and the
relative speed between the two points are calculated by the pathway with
<a class="reference internal" href="../../../../modules/physics/mechanics/api/pathway.html#sympy.physics.mechanics.pathway.LinearPathway.length" title="sympy.physics.mechanics.pathway.LinearPathway.length"><code class="xref py py-obj docutils literal notranslate"><span class="pre">length</span></code></a> and
<a class="reference internal" href="../../../../modules/physics/mechanics/api/pathway.html#sympy.physics.mechanics.pathway.LinearPathway.extension_velocity" title="sympy.physics.mechanics.pathway.LinearPathway.extension_velocity"><code class="xref py py-obj docutils literal notranslate"><span class="pre">extension_velocity</span></code></a>. Note
that a positive speed implies the points are moving away from each other. Also
note that the formulation handles the case where <span class="math notranslate nohighlight">\(x\)</span> is positive or
negative.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">lpathway</span> <span class="o">=</span> <span class="n">me</span><span class="o">.</span><span class="n">LinearPathway</span><span class="p">(</span><span class="n">O</span><span class="p">,</span> <span class="n">P</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">lpathway</span>
<span class="go">LinearPathway(O, P)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">lpathway</span><span class="o">.</span><span class="n">length</span>
<span class="go">Abs(x(t))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">lpathway</span><span class="o">.</span><span class="n">extension_velocity</span>
<span class="go">sign(x(t))*Derivative(x(t), t)</span>
</pre></div>
</div>
<p>The <a class="reference internal" href="../../../../modules/physics/mechanics/api/pathway.html#sympy.physics.mechanics.pathway.LinearPathway.to_loads" title="sympy.physics.mechanics.pathway.LinearPathway.to_loads"><code class="xref py py-obj docutils literal notranslate"><span class="pre">to_loads</span></code></a> method then
takes the magnitude of a force with a sign convention that positive magnitudes
push the two points away from each other and returns a list of all forces
acting on the two points.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">pprint</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pprint</span><span class="o">.</span><span class="n">pprint</span><span class="p">(</span><span class="n">lpathway</span><span class="o">.</span><span class="n">to_loads</span><span class="p">(</span><span class="o">-</span><span class="n">k</span><span class="o">*</span><span class="n">x</span> <span class="o">-</span> <span class="n">k</span><span class="o">*</span><span class="n">x</span><span class="o">.</span><span class="n">diff</span><span class="p">()))</span>
<span class="go">[Force(point=O, force=(k*x(t) + k*Derivative(x(t), t))*x(t)/Abs(x(t))*N.x),</span>
<span class="go"> Force(point=P, force=(-k*x(t) - k*Derivative(x(t), t))*x(t)/Abs(x(t))*N.x)]</span>
</pre></div>
</div>
<p>Pathways can be constructed with any arbitrary geometry and any number of
interconnected particles and rigid bodies. An example, a more complicated
pathway is an <a class="reference internal" href="../../../../modules/physics/mechanics/api/pathway.html#sympy.physics.mechanics.pathway.ObstacleSetPathway" title="sympy.physics.mechanics.pathway.ObstacleSetPathway"><code class="xref py py-obj docutils literal notranslate"><span class="pre">ObstacleSetPathway</span></code></a>. You
can specify any number of intermediate points between the two pathway endpoints
which the actuation path of the forces will follow along. For example, if we
introduce two points fixed in <span class="math notranslate nohighlight">\(N\)</span> then the force will act along a set of
linear segments connecting <span class="math notranslate nohighlight">\(O\)</span> to <span class="math notranslate nohighlight">\(Q\)</span> to <span class="math notranslate nohighlight">\(R\)</span> then to
<span class="math notranslate nohighlight">\(P\)</span>. Each of the four points will experience resultant forces. For
simplicity we show the effect of only the spring force.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">Q</span><span class="p">,</span> <span class="n">R</span> <span class="o">=</span> <span class="n">me</span><span class="o">.</span><span class="n">Point</span><span class="p">(</span><span class="s1">&#39;Q&#39;</span><span class="p">),</span> <span class="n">me</span><span class="o">.</span><span class="n">Point</span><span class="p">(</span><span class="s1">&#39;R&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Q</span><span class="o">.</span><span class="n">set_pos</span><span class="p">(</span><span class="n">O</span><span class="p">,</span> <span class="mi">1</span><span class="o">*</span><span class="n">N</span><span class="o">.</span><span class="n">y</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">R</span><span class="o">.</span><span class="n">set_pos</span><span class="p">(</span><span class="n">O</span><span class="p">,</span> <span class="mi">1</span><span class="o">*</span><span class="n">N</span><span class="o">.</span><span class="n">x</span> <span class="o">+</span> <span class="mi">1</span><span class="o">*</span><span class="n">N</span><span class="o">.</span><span class="n">y</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">opathway</span> <span class="o">=</span> <span class="n">me</span><span class="o">.</span><span class="n">ObstacleSetPathway</span><span class="p">(</span><span class="n">O</span><span class="p">,</span> <span class="n">Q</span><span class="p">,</span> <span class="n">R</span><span class="p">,</span> <span class="n">P</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">opathway</span><span class="o">.</span><span class="n">length</span>
<span class="go">sqrt((x(t) - 1)**2 + 1) + 2</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">opathway</span><span class="o">.</span><span class="n">extension_velocity</span>
<span class="go">(x(t) - 1)*Derivative(x(t), t)/sqrt((x(t) - 1)**2 + 1)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pprint</span><span class="o">.</span><span class="n">pprint</span><span class="p">(</span><span class="n">opathway</span><span class="o">.</span><span class="n">to_loads</span><span class="p">(</span><span class="o">-</span><span class="n">k</span><span class="o">*</span><span class="n">opathway</span><span class="o">.</span><span class="n">length</span><span class="p">))</span>
<span class="go">[Force(point=O, force=k*(sqrt((x(t) - 1)**2 + 1) + 2)*N.y),</span>
<span class="go"> Force(point=Q, force=- k*(sqrt((x(t) - 1)**2 + 1) + 2)*N.y),</span>
<span class="go"> Force(point=Q, force=k*(sqrt((x(t) - 1)**2 + 1) + 2)*N.x),</span>
<span class="go"> Force(point=R, force=- k*(sqrt((x(t) - 1)**2 + 1) + 2)*N.x),</span>
<span class="go"> Force(point=R, force=k*(sqrt((x(t) - 1)**2 + 1) + 2)*(x(t) - 1)/sqrt((x(t) - 1)**2 + 1)*N.x - k*(sqrt((x(t) - 1)**2 + 1) + 2)/sqrt((x(t) - 1)**2 + 1)*N.y),</span>
<span class="go"> Force(point=P, force=- k*(sqrt((x(t) - 1)**2 + 1) + 2)*(x(t) - 1)/sqrt((x(t) - 1)**2 + 1)*N.x + k*(sqrt((x(t) - 1)**2 + 1) + 2)/sqrt((x(t) - 1)**2 + 1)*N.y)]</span>
</pre></div>
</div>
<p>If you set <span class="math notranslate nohighlight">\(x=1\)</span>, it is a bit easier to see that the collection of forces
are correct:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">load</span> <span class="ow">in</span> <span class="n">opathway</span><span class="o">.</span><span class="n">to_loads</span><span class="p">(</span><span class="o">-</span><span class="n">k</span><span class="o">*</span><span class="n">opathway</span><span class="o">.</span><span class="n">length</span><span class="p">):</span>
<span class="gp">... </span>    <span class="n">pprint</span><span class="o">.</span><span class="n">pprint</span><span class="p">(</span><span class="n">me</span><span class="o">.</span><span class="n">Force</span><span class="p">(</span><span class="n">load</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">load</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">subs</span><span class="p">({</span><span class="n">x</span><span class="p">:</span> <span class="mi">1</span><span class="p">})))</span>
<span class="go">Force(point=O, force=3*k*N.y)</span>
<span class="go">Force(point=Q, force=- 3*k*N.y)</span>
<span class="go">Force(point=Q, force=3*k*N.x)</span>
<span class="go">Force(point=R, force=- 3*k*N.x)</span>
<span class="go">Force(point=R, force=- 3*k*N.y)</span>
<span class="go">Force(point=P, force=3*k*N.y)</span>
</pre></div>
</div>
<p>You can create your own pathways by sub-classing
<a class="reference internal" href="../../../../modules/physics/mechanics/api/pathway.html#sympy.physics.mechanics.pathway.PathwayBase" title="sympy.physics.mechanics.pathway.PathwayBase"><code class="xref py py-obj docutils literal notranslate"><span class="pre">PathwayBase</span></code></a>.</p>
</section>
<section id="wrapping-geometries">
<h2>Wrapping Geometries<a class="headerlink" href="#wrapping-geometries" title="Link to this heading">¶</a></h2>
<p>It is common for muscles to wrap over bones, tissue, or organs. We have
introduced wrapping geometries and associated wrapping pathways to help manage
their complexities. For example, if two pathway endpoints lie on the surface of
a cylinder the forces act along lines that are tangent to the geodesic
connecting the two points at the endpoints. The
<a class="reference internal" href="../../../../modules/physics/mechanics/api/wrapping_geometry.html#sympy.physics.mechanics.wrapping_geometry.WrappingCylinder" title="sympy.physics.mechanics.wrapping_geometry.WrappingCylinder"><code class="xref py py-obj docutils literal notranslate"><span class="pre">WrappingCylinder</span></code></a> object
calculates the complex geometry for the pathway. A
<a class="reference internal" href="../../../../modules/physics/mechanics/api/pathway.html#sympy.physics.mechanics.pathway.WrappingPathway" title="sympy.physics.mechanics.pathway.WrappingPathway"><code class="xref py py-obj docutils literal notranslate"><span class="pre">WrappingPathway</span></code></a> then uses the geometry
to construct the forces. A spring force along this pathway is constructed
below:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">r</span> <span class="o">=</span> <span class="n">sm</span><span class="o">.</span><span class="n">symbols</span><span class="p">(</span><span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">real</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">nonegative</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">theta</span> <span class="o">=</span> <span class="n">me</span><span class="o">.</span><span class="n">dynamicsymbols</span><span class="p">(</span><span class="s1">&#39;theta&#39;</span><span class="p">,</span> <span class="n">real</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">O</span><span class="p">,</span> <span class="n">P</span><span class="p">,</span> <span class="n">Q</span> <span class="o">=</span> <span class="n">sm</span><span class="o">.</span><span class="n">symbols</span><span class="p">(</span><span class="s1">&#39;O, P, Q&#39;</span><span class="p">,</span> <span class="bp">cls</span><span class="o">=</span><span class="n">me</span><span class="o">.</span><span class="n">Point</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">A</span> <span class="o">=</span> <span class="n">me</span><span class="o">.</span><span class="n">ReferenceFrame</span><span class="p">(</span><span class="s1">&#39;A&#39;</span><span class="p">)</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">A</span><span class="o">.</span><span class="n">orient_axis</span><span class="p">(</span><span class="n">N</span><span class="p">,</span> <span class="n">theta</span><span class="p">,</span> <span class="n">N</span><span class="o">.</span><span class="n">z</span><span class="p">)</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">P</span><span class="o">.</span><span class="n">set_pos</span><span class="p">(</span><span class="n">O</span><span class="p">,</span> <span class="n">r</span><span class="o">*</span><span class="n">N</span><span class="o">.</span><span class="n">x</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Q</span><span class="o">.</span><span class="n">set_pos</span><span class="p">(</span><span class="n">O</span><span class="p">,</span> <span class="n">N</span><span class="o">.</span><span class="n">z</span> <span class="o">+</span> <span class="n">r</span><span class="o">*</span><span class="n">A</span><span class="o">.</span><span class="n">x</span><span class="p">)</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">cyl</span> <span class="o">=</span> <span class="n">me</span><span class="o">.</span><span class="n">WrappingCylinder</span><span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="n">O</span><span class="p">,</span> <span class="n">N</span><span class="o">.</span><span class="n">z</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">wpathway</span> <span class="o">=</span> <span class="n">me</span><span class="o">.</span><span class="n">WrappingPathway</span><span class="p">(</span><span class="n">P</span><span class="p">,</span> <span class="n">Q</span><span class="p">,</span> <span class="n">cyl</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pprint</span><span class="o">.</span><span class="n">pprint</span><span class="p">(</span><span class="n">wpathway</span><span class="o">.</span><span class="n">to_loads</span><span class="p">(</span><span class="o">-</span><span class="n">k</span><span class="o">*</span><span class="n">wpathway</span><span class="o">.</span><span class="n">length</span><span class="p">))</span>
<span class="go">[Force(point=P, force=- k*r*Abs(theta(t))*N.y - k*N.z),</span>
<span class="go"> Force(point=Q, force=k*N.z + k*r*Abs(theta(t))*A.y),</span>
<span class="go"> Force(point=O, force=k*r*Abs(theta(t))*N.y - k*r*Abs(theta(t))*A.y)]</span>
</pre></div>
</div>
</section>
<section id="actuators">
<h2>Actuators<a class="headerlink" href="#actuators" title="Link to this heading">¶</a></h2>
<p>Models of multibody systems commonly have time varying inputs in the form of
the magnitudes of forces or torques. In many cases, these specified inputs may
be derived from the state of the system or even from the output of another
dynamic system. The <a class="reference internal" href="../../../../modules/physics/mechanics/api/actuator.html#module-sympy.physics.mechanics.actuator" title="sympy.physics.mechanics.actuator"><code class="xref py py-obj docutils literal notranslate"><span class="pre">actuator</span></code></a> module includes
classes to help manage the creation of such models of force and torque inputs.
An actuator is intended to represent a real physical component. For example,
the spring-damper force from above can be created by sub-classing
<a class="reference internal" href="../../../../modules/physics/mechanics/api/actuator.html#sympy.physics.mechanics.actuator.ActuatorBase" title="sympy.physics.mechanics.actuator.ActuatorBase"><code class="xref py py-obj docutils literal notranslate"><span class="pre">ActuatorBase</span></code></a> and implementing a method
that generates the loads associated with that spring-damper actuator.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">N</span> <span class="o">=</span> <span class="n">me</span><span class="o">.</span><span class="n">ReferenceFrame</span><span class="p">(</span><span class="s1">&#39;N&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">O</span><span class="p">,</span> <span class="n">P</span> <span class="o">=</span> <span class="n">me</span><span class="o">.</span><span class="n">Point</span><span class="p">(</span><span class="s1">&#39;O&#39;</span><span class="p">),</span> <span class="n">me</span><span class="o">.</span><span class="n">Point</span><span class="p">(</span><span class="s1">&#39;P&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">P</span><span class="o">.</span><span class="n">set_pos</span><span class="p">(</span><span class="n">O</span><span class="p">,</span> <span class="n">x</span><span class="o">*</span><span class="n">N</span><span class="o">.</span><span class="n">x</span><span class="p">)</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="k">class</span> <span class="nc">SpringDamper</span><span class="p">(</span><span class="n">me</span><span class="o">.</span><span class="n">ActuatorBase</span><span class="p">):</span>
<span class="gp">...</span>
<span class="gp">... </span>    <span class="c1"># positive x spring is in tension</span>
<span class="gp">... </span>    <span class="c1"># negative x spring is in compression</span>
<span class="gp">... </span>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">P1</span><span class="p">,</span> <span class="n">P2</span><span class="p">,</span> <span class="n">spring_constant</span><span class="p">,</span> <span class="n">damper_constant</span><span class="p">):</span>
<span class="gp">... </span>        <span class="bp">self</span><span class="o">.</span><span class="n">P1</span> <span class="o">=</span> <span class="n">P1</span>
<span class="gp">... </span>        <span class="bp">self</span><span class="o">.</span><span class="n">P2</span> <span class="o">=</span> <span class="n">P2</span>
<span class="gp">... </span>        <span class="bp">self</span><span class="o">.</span><span class="n">k</span> <span class="o">=</span> <span class="n">spring_constant</span>
<span class="gp">... </span>        <span class="bp">self</span><span class="o">.</span><span class="n">c</span> <span class="o">=</span> <span class="n">damper_constant</span>
<span class="gp">...</span>
<span class="gp">... </span>    <span class="k">def</span> <span class="nf">to_loads</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="gp">... </span>        <span class="n">x</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">P2</span><span class="o">.</span><span class="n">pos_from</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">P1</span><span class="p">)</span><span class="o">.</span><span class="n">magnitude</span><span class="p">()</span>
<span class="gp">... </span>        <span class="n">v</span> <span class="o">=</span> <span class="n">x</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">me</span><span class="o">.</span><span class="n">dynamicsymbols</span><span class="o">.</span><span class="n">_t</span><span class="p">)</span>
<span class="gp">... </span>        <span class="n">dir_vec</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">P2</span><span class="o">.</span><span class="n">pos_from</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">P1</span><span class="p">)</span><span class="o">.</span><span class="n">normalize</span><span class="p">()</span>
<span class="gp">... </span>        <span class="n">force_P1</span> <span class="o">=</span> <span class="n">me</span><span class="o">.</span><span class="n">Force</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">P1</span><span class="p">,</span>
<span class="gp">... </span>                            <span class="bp">self</span><span class="o">.</span><span class="n">k</span><span class="o">*</span><span class="n">x</span><span class="o">*</span><span class="n">dir_vec</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">c</span><span class="o">*</span><span class="n">v</span><span class="o">*</span><span class="n">dir_vec</span><span class="p">)</span>
<span class="gp">... </span>        <span class="n">force_P2</span> <span class="o">=</span> <span class="n">me</span><span class="o">.</span><span class="n">Force</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">P2</span><span class="p">,</span>
<span class="gp">... </span>                            <span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">k</span><span class="o">*</span><span class="n">x</span><span class="o">*</span><span class="n">dir_vec</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">c</span><span class="o">*</span><span class="n">v</span><span class="o">*</span><span class="n">dir_vec</span><span class="p">)</span>
<span class="gp">... </span>        <span class="k">return</span> <span class="p">[</span><span class="n">force_P1</span><span class="p">,</span> <span class="n">force_P2</span><span class="p">]</span>
<span class="gp">...</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">spring_damper</span> <span class="o">=</span> <span class="n">SpringDamper</span><span class="p">(</span><span class="n">O</span><span class="p">,</span> <span class="n">P</span><span class="p">,</span> <span class="n">k</span><span class="p">,</span> <span class="n">c</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pprint</span><span class="o">.</span><span class="n">pprint</span><span class="p">(</span><span class="n">spring_damper</span><span class="o">.</span><span class="n">to_loads</span><span class="p">())</span>
<span class="go">[Force(point=O, force=(c*x(t)*sign(x(t))*Derivative(x(t), t)/Abs(x(t)) + k*x(t))*N.x),</span>
<span class="go"> Force(point=P, force=(-c*x(t)*sign(x(t))*Derivative(x(t), t)/Abs(x(t)) - k*x(t))*N.x)]</span>
</pre></div>
</div>
<p>There is also a <a class="reference internal" href="../../../../modules/physics/mechanics/api/actuator.html#sympy.physics.mechanics.actuator.ForceActuator" title="sympy.physics.mechanics.actuator.ForceActuator"><code class="xref py py-obj docutils literal notranslate"><span class="pre">ForceActuator</span></code></a> that
allows seamless integration with pathway objects. You only need to set the
<code class="docutils literal notranslate"><span class="pre">.force</span></code> attribute in initialization in the sub-class.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="k">class</span> <span class="nc">SpringDamper</span><span class="p">(</span><span class="n">me</span><span class="o">.</span><span class="n">ForceActuator</span><span class="p">):</span>
<span class="gp">...</span>
<span class="gp">... </span>    <span class="c1"># positive x spring is in tension</span>
<span class="gp">... </span>    <span class="c1"># negative x spring is in compression</span>
<span class="gp">... </span>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">pathway</span><span class="p">,</span> <span class="n">spring_constant</span><span class="p">,</span> <span class="n">damper_constant</span><span class="p">):</span>
<span class="gp">... </span>        <span class="bp">self</span><span class="o">.</span><span class="n">pathway</span> <span class="o">=</span> <span class="n">pathway</span>
<span class="gp">... </span>        <span class="bp">self</span><span class="o">.</span><span class="n">force</span> <span class="o">=</span> <span class="p">(</span><span class="o">-</span><span class="n">spring_constant</span><span class="o">*</span><span class="n">pathway</span><span class="o">.</span><span class="n">length</span> <span class="o">-</span>
<span class="gp">... </span>                      <span class="n">damper_constant</span><span class="o">*</span><span class="n">pathway</span><span class="o">.</span><span class="n">extension_velocity</span><span class="p">)</span>
<span class="gp">...</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">spring_damper2</span> <span class="o">=</span> <span class="n">SpringDamper</span><span class="p">(</span><span class="n">lpathway</span><span class="p">,</span> <span class="n">k</span><span class="p">,</span> <span class="n">c</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pprint</span><span class="o">.</span><span class="n">pprint</span><span class="p">(</span><span class="n">spring_damper2</span><span class="o">.</span><span class="n">to_loads</span><span class="p">())</span>
<span class="go">[Force(point=O, force=(c*sign(x(t))*Derivative(x(t), t) + k*Abs(x(t)))*x(t)/Abs(x(t))*N.x),</span>
<span class="go"> Force(point=P, force=(-c*sign(x(t))*Derivative(x(t), t) - k*Abs(x(t)))*x(t)/Abs(x(t))*N.x)]</span>
</pre></div>
</div>
<p>This then makes it easy to apply a spring-damper force to other pathways, e.g.:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">spring_damper3</span> <span class="o">=</span> <span class="n">SpringDamper</span><span class="p">(</span><span class="n">wpathway</span><span class="p">,</span> <span class="n">k</span><span class="p">,</span> <span class="n">c</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pprint</span><span class="o">.</span><span class="n">pprint</span><span class="p">(</span><span class="n">spring_damper3</span><span class="o">.</span><span class="n">to_loads</span><span class="p">())</span>
<span class="go">[Force(point=P, force=r*(-c*r**2*theta(t)*Derivative(theta(t), t)/sqrt(r**2*theta(t)**2 + 1) - k*sqrt(r**2*theta(t)**2 + 1))*Abs(theta(t))/sqrt(r**2*theta(t)**2 + 1)*N.y + (-c*r**2*theta(t)*Derivative(theta(t), t)/sqrt(r**2*theta(t)**2 + 1) - k*sqrt(r**2*theta(t)**2 + 1))/sqrt(r**2*theta(t)**2 + 1)*N.z),</span>
<span class="go"> Force(point=Q, force=- (-c*r**2*theta(t)*Derivative(theta(t), t)/sqrt(r**2*theta(t)**2 + 1) - k*sqrt(r**2*theta(t)**2 + 1))/sqrt(r**2*theta(t)**2 + 1)*N.z - r*(-c*r**2*theta(t)*Derivative(theta(t), t)/sqrt(r**2*theta(t)**2 + 1) - k*sqrt(r**2*theta(t)**2 + 1))*Abs(theta(t))/sqrt(r**2*theta(t)**2 + 1)*A.y),</span>
<span class="go"> Force(point=O, force=- r*(-c*r**2*theta(t)*Derivative(theta(t), t)/sqrt(r**2*theta(t)**2 + 1) - k*sqrt(r**2*theta(t)**2 + 1))*Abs(theta(t))/sqrt(r**2*theta(t)**2 + 1)*N.y + r*(-c*r**2*theta(t)*Derivative(theta(t), t)/sqrt(r**2*theta(t)**2 + 1) - k*sqrt(r**2*theta(t)**2 + 1))*Abs(theta(t))/sqrt(r**2*theta(t)**2 + 1)*A.y)]</span>
</pre></div>
</div>
</section>
<section id="activation-dynamics">
<h2>Activation Dynamics<a class="headerlink" href="#activation-dynamics" title="Link to this heading">¶</a></h2>
<p>Musculotendon models are able to produce an active contractile force when they
are activated. Biologically, this occurs when <span class="math notranslate nohighlight">\(\textrm{Ca}^{2+}\)</span> ions are
present among the muscle fibers at a sufficient concentration that they start
to voluntarily contract. This state of voluntary contraction is “activation”. In
biomechanical models it is typically given the symbol <span class="math notranslate nohighlight">\(a(t)\)</span>, which is
treated as a normalized quantity in the range <span class="math notranslate nohighlight">\([0, 1]\)</span>.</p>
<p>An organism does not directly control the concentration of these
<span class="math notranslate nohighlight">\(\textrm{Ca}^{2+}\)</span> ions in its muscles, instead its nervous system,
controlled by its brain, sends an electrical signal to a muscle which causes
<span class="math notranslate nohighlight">\(\textrm{Ca}^{2+}\)</span> ions to be released. These diffuse and increase in
concentration throughout the muscle leading to activation. An electrical signal
transmitted to a muscle stimulating contraction is an “excitation”. In
biomechanical models it is usually given the symbol <span class="math notranslate nohighlight">\(e(t)\)</span>, which is also
treated as a normalized quantity in the range <span class="math notranslate nohighlight">\([0, 1]\)</span>.</p>
<p>The relationship between the excitation input and the activation state is known
as activation dynamics. Because activation dynamics are so common in
biomechanical models, SymPy provides the
<a class="reference internal" href="../../../../modules/physics/biomechanics/api/activation.html#module-sympy.physics.biomechanics.activation" title="sympy.physics.biomechanics.activation"><code class="xref py py-obj docutils literal notranslate"><span class="pre">activation</span></code></a> module, which contains
implementations for some common models of activation dynamics. These are
zeroth-order activation dynamics and first-order activation dynamics based on
the equations from the paper by <a class="reference internal" href="../../../../tutorials/physics/biomechanics/biomechanical-model-example.html#degroote2016" id="id1"><span>[DeGroote2016]</span></a>. Below we will work through
manually implementing these models and then show how these relate to the classes
provided by SymPy.</p>
<section id="zeroth-order">
<h3>Zeroth-Order<a class="headerlink" href="#zeroth-order" title="Link to this heading">¶</a></h3>
<p>The simplest possible model of activation dynamics is to assume that diffusion
of <span class="math notranslate nohighlight">\(\textrm{Ca}^{2+}\)</span> ions is instantaneous. Mathematically this gives us
<span class="math notranslate nohighlight">\(a(t) = e(t)\)</span>, a zeroth-order ordinary differential equation.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">e</span> <span class="o">=</span> <span class="n">me</span><span class="o">.</span><span class="n">dynamicsymbols</span><span class="p">(</span><span class="s1">&#39;e&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">e</span>
<span class="go">e(t)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a</span> <span class="o">=</span> <span class="n">e</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a</span>
<span class="go">e(t)</span>
</pre></div>
</div>
<p>Alternatively, you could give <span class="math notranslate nohighlight">\(a(t)\)</span> its own
<a class="reference internal" href="../../../../modules/physics/vector/api/functions.html#sympy.physics.vector.dynamicsymbols" title="sympy.physics.vector.dynamicsymbols"><code class="xref py py-obj docutils literal notranslate"><span class="pre">dynamicsymbols</span></code></a> and use a substitution to replace
this with <span class="math notranslate nohighlight">\(e(t)\)</span> in any equation.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">a</span> <span class="o">=</span> <span class="n">me</span><span class="o">.</span><span class="n">dynamicsymbols</span><span class="p">(</span><span class="s1">&#39;a&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">zeroth_order_activation</span> <span class="o">=</span> <span class="p">{</span><span class="n">a</span><span class="p">:</span> <span class="n">e</span><span class="p">}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span><span class="n">zeroth_order_activation</span><span class="p">)</span>
<span class="go">e(t)</span>
</pre></div>
</div>
<p>SymPy provides the class
<a class="reference internal" href="../../../../modules/physics/biomechanics/api/activation.html#sympy.physics.biomechanics.activation.ZerothOrderActivation" title="sympy.physics.biomechanics.activation.ZerothOrderActivation"><code class="xref py py-obj docutils literal notranslate"><span class="pre">ZerothOrderActivation</span></code></a> in the
<a class="reference internal" href="../../../../modules/physics/biomechanics/api/activation.html#module-sympy.physics.biomechanics.activation" title="sympy.physics.biomechanics.activation"><code class="xref py py-obj docutils literal notranslate"><span class="pre">activation</span></code></a> module. This class must be
instantiated with a single argument, <code class="docutils literal notranslate"><span class="pre">name</span></code>, which associates a name with the
instance. This name should be unique per instance.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sympy.physics.biomechanics</span> <span class="kn">import</span> <span class="n">ZerothOrderActivation</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">actz</span> <span class="o">=</span> <span class="n">ZerothOrderActivation</span><span class="p">(</span><span class="s1">&#39;zeroth&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">actz</span>
<span class="go">ZerothOrderActivation(&#39;zeroth&#39;)</span>
</pre></div>
</div>
<p>The argument passed to <span class="math notranslate nohighlight">\(name\)</span> tries to help ensures that the
automatically-created <a class="reference internal" href="../../../../modules/physics/vector/api/functions.html#sympy.physics.vector.dynamicsymbols" title="sympy.physics.vector.dynamicsymbols"><code class="xref py py-obj docutils literal notranslate"><span class="pre">dynamicsymbols</span></code></a> for
<span class="math notranslate nohighlight">\(e(t)\)</span> and <span class="math notranslate nohighlight">\(a(t)\)</span> are unique betweem instances.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">actz</span><span class="o">.</span><span class="n">excitation</span>
<span class="go">e_zeroth(t)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">actz</span><span class="o">.</span><span class="n">activation</span>
<span class="go">e_zeroth(t)</span>
</pre></div>
</div>
<p><a class="reference internal" href="../../../../modules/physics/biomechanics/api/activation.html#sympy.physics.biomechanics.activation.ZerothOrderActivation" title="sympy.physics.biomechanics.activation.ZerothOrderActivation"><code class="xref py py-obj docutils literal notranslate"><span class="pre">ZerothOrderActivation</span></code></a> subclasses
<a class="reference internal" href="../../../../modules/physics/biomechanics/api/activation.html#sympy.physics.biomechanics.activation.ActivationBase" title="sympy.physics.biomechanics.activation.ActivationBase"><code class="xref py py-obj docutils literal notranslate"><span class="pre">ActivationBase</span></code></a>, which provides a
consistent interface for all concrete classes of activation dynamics. This
includes a method to inspect the ordinary differential equation(s) associated
with the model. As zeroth-order activation dynamics correspond to a zeroth-order
ordinary differential equation, this returns an empty column matrix.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">actz</span><span class="o">.</span><span class="n">rhs</span><span class="p">()</span>
<span class="go">Matrix(0, 1, [])</span>
</pre></div>
</div>
</section>
<section id="first-order">
<h3>First-Order<a class="headerlink" href="#first-order" title="Link to this heading">¶</a></h3>
<p>In practice the diffusion and concentration increase of
<span class="math notranslate nohighlight">\(\textrm{Ca}^{2+}\)</span> ions is not instantaneous. In a real biological
muscle, a step increase in excitation will lead to a smooth and gradual
increase in activation. <a class="reference internal" href="../../../../tutorials/physics/biomechanics/biomechanical-model-example.html#degroote2016" id="id2"><span>[DeGroote2016]</span></a> model this using a first-order
ordinary differential equation:</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[\begin{split}\frac{da}{dt} &amp;= \left( \frac{1}{\tau_a \left(1 + 3a(t)\right)} (1 + 2f) + \frac{1 + 3a(t)}{4\tau_d} (1 - 2f) \right) \left(e(t) - a(t) \right) \\
f &amp;= \frac{1}{2} \tanh{\left(b \left(e(t) -a(t)\right)\right)}\end{split}\]</div>
</div>
<p>where <span class="math notranslate nohighlight">\(\tau_a\)</span> is the time constant for activation, <span class="math notranslate nohighlight">\(\tau_d\)</span> is the
time constant for deactivation, and <span class="math notranslate nohighlight">\(b\)</span> is a smoothing coefficient.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">tau_a</span><span class="p">,</span> <span class="n">tau_d</span><span class="p">,</span> <span class="n">b</span> <span class="o">=</span> <span class="n">sm</span><span class="o">.</span><span class="n">symbols</span><span class="p">(</span><span class="s1">&#39;tau_a, tau_d, b&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">f</span> <span class="o">=</span> <span class="n">sm</span><span class="o">.</span><span class="n">tanh</span><span class="p">(</span><span class="n">b</span><span class="o">*</span><span class="p">(</span><span class="n">e</span> <span class="o">-</span> <span class="n">a</span><span class="p">))</span><span class="o">/</span><span class="mi">2</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dadt</span> <span class="o">=</span> <span class="p">((</span><span class="mi">1</span><span class="o">/</span><span class="p">(</span><span class="n">tau_a</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="mi">3</span><span class="o">*</span><span class="n">a</span><span class="p">)))</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">f</span><span class="p">)</span> <span class="o">+</span> <span class="p">((</span><span class="mi">1</span> <span class="o">+</span> <span class="mi">3</span><span class="o">*</span><span class="n">a</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="mi">4</span><span class="o">*</span><span class="n">tau_d</span><span class="p">))</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">f</span><span class="p">))</span><span class="o">*</span><span class="p">(</span><span class="n">e</span> <span class="o">-</span> <span class="n">a</span><span class="p">)</span>
</pre></div>
</div>
<p>This first-order ordinary differential equation can then be used to propagate
the state <span class="math notranslate nohighlight">\(a(t)\)</span> under the input <span class="math notranslate nohighlight">\(e(t)\)</span> in a simulation.</p>
<p>Like before, SymPy provides the class
<a class="reference internal" href="../../../../modules/physics/biomechanics/api/activation.html#sympy.physics.biomechanics.activation.FirstOrderActivationDeGroote2016" title="sympy.physics.biomechanics.activation.FirstOrderActivationDeGroote2016"><code class="xref py py-obj docutils literal notranslate"><span class="pre">FirstOrderActivationDeGroote2016</span></code></a>
in the <a class="reference internal" href="../../../../modules/physics/biomechanics/api/activation.html#module-sympy.physics.biomechanics.activation" title="sympy.physics.biomechanics.activation"><code class="xref py py-obj docutils literal notranslate"><span class="pre">activation</span></code></a> module. This class is
another subclass of <a class="reference internal" href="../../../../modules/physics/biomechanics/api/activation.html#sympy.physics.biomechanics.activation.ActivationBase" title="sympy.physics.biomechanics.activation.ActivationBase"><code class="xref py py-obj docutils literal notranslate"><span class="pre">ActivationBase</span></code></a>
and uses the model for first-order activation dynamics from <a class="reference internal" href="../../../../tutorials/physics/biomechanics/biomechanical-model-example.html#degroote2016" id="id3"><span>[DeGroote2016]</span></a>
defined above. This class must be instantiated with four arguments: a name, and
three sympifiable objects to represent the three constants <span class="math notranslate nohighlight">\(\tau_a\)</span>,
<span class="math notranslate nohighlight">\(\tau_d\)</span>, and <span class="math notranslate nohighlight">\(b\)</span>.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sympy.physics.biomechanics</span> <span class="kn">import</span> <span class="n">FirstOrderActivationDeGroote2016</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">actf</span> <span class="o">=</span> <span class="n">FirstOrderActivationDeGroote2016</span><span class="p">(</span><span class="s1">&#39;first&#39;</span><span class="p">,</span> <span class="n">tau_a</span><span class="p">,</span> <span class="n">tau_d</span><span class="p">,</span> <span class="n">b</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">actf</span><span class="o">.</span><span class="n">excitation</span>
<span class="go">e_first(t)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">actf</span><span class="o">.</span><span class="n">activation</span>
<span class="go">a_first(t)</span>
</pre></div>
</div>
<p>The first-order ordinary differential equation can be accessed as before, but
this time a length-1 column vector is returned.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">actf</span><span class="o">.</span><span class="n">rhs</span><span class="p">()</span>
<span class="go">Matrix([[((1/2 - tanh(b*(-a_first(t) + e_first(t)))/2)*(3*a_first(t)/2 + 1/2)/tau_d + (tanh(b*(-a_first(t) + e_first(t)))/2 + 1/2)/(tau_a*(3*a_first(t)/2 + 1/2)))*(-a_first(t) + e_first(t))]])</span>
</pre></div>
</div>
<p>You can also instantiate the class with the suggested values for each of the
constants. These are: <span class="math notranslate nohighlight">\(\tau_a = 0.015\)</span>, <span class="math notranslate nohighlight">\(\tau_d = 0.060\)</span>, and
<span class="math notranslate nohighlight">\(b = 10.0\)</span>.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">actf2</span> <span class="o">=</span> <span class="n">FirstOrderActivationDeGroote2016</span><span class="o">.</span><span class="n">with_defaults</span><span class="p">(</span><span class="s1">&#39;first&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">actf2</span><span class="o">.</span><span class="n">rhs</span><span class="p">()</span>
<span class="go">Matrix([[((1/2 - tanh(10.0*a_first(t) - 10.0*e_first(t))/2)/(0.0225*a_first(t) + 0.0075) + 16.6666666666667*(3*a_first(t)/2 + 1/2)*(tanh(10.0*a_first(t) - 10.0*e_first(t))/2 + 1/2))*(-a_first(t) + e_first(t))]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">constants</span> <span class="o">=</span> <span class="p">{</span><span class="n">tau_a</span><span class="p">:</span> <span class="n">sm</span><span class="o">.</span><span class="n">Float</span><span class="p">(</span><span class="s1">&#39;0.015&#39;</span><span class="p">),</span> <span class="n">tau_d</span><span class="p">:</span> <span class="n">sm</span><span class="o">.</span><span class="n">Float</span><span class="p">(</span><span class="s1">&#39;0.060&#39;</span><span class="p">),</span> <span class="n">b</span><span class="p">:</span> <span class="n">sm</span><span class="o">.</span><span class="n">Float</span><span class="p">(</span><span class="s1">&#39;10.0&#39;</span><span class="p">)}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">actf</span><span class="o">.</span><span class="n">rhs</span><span class="p">()</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span><span class="n">constants</span><span class="p">)</span>
<span class="go">Matrix([[(66.6666666666667*(1/2 - tanh(10.0*a_first(t) - 10.0*e_first(t))/2)/(3*a_first(t)/2 + 1/2) + 16.6666666666667*(3*a_first(t)/2 + 1/2)*(tanh(10.0*a_first(t) - 10.0*e_first(t))/2 + 1/2))*(-a_first(t) + e_first(t))]])</span>
</pre></div>
</div>
</section>
<section id="custom">
<h3>Custom<a class="headerlink" href="#custom" title="Link to this heading">¶</a></h3>
<p>To create your own custom models of activation dynamics, you can subclass
<a class="reference internal" href="../../../../modules/physics/biomechanics/api/activation.html#sympy.physics.biomechanics.activation.ActivationBase" title="sympy.physics.biomechanics.activation.ActivationBase"><code class="xref py py-obj docutils literal notranslate"><span class="pre">ActivationBase</span></code></a> and override the
abstract methods. The concrete class will then conform to the expected API and
integrate automatically with the rest of <a class="reference internal" href="../../../../modules/physics/mechanics/api/index.html#module-sympy.physics.mechanics" title="sympy.physics.mechanics"><code class="xref py py-obj docutils literal notranslate"><span class="pre">sympy.physics.mechanics</span></code></a> and
<a class="reference internal" href="../../../../modules/physics/biomechanics/api/index.html#module-sympy.physics.biomechanics" title="sympy.physics.biomechanics"><code class="xref py py-obj docutils literal notranslate"><span class="pre">sympy.physics.biomechanics</span></code></a>.</p>
</section>
</section>
<section id="musculotendon-curves">
<h2>Musculotendon Curves<a class="headerlink" href="#musculotendon-curves" title="Link to this heading">¶</a></h2>
<p>Over the years many different configurations of Hill-type muscle models have
been published containing different combinations of elements in series and in
parallel. We’ll consider a very common version of the model that has the tendon
modeled as an element in series with muscle fibers, which are in turn modeled as
three elements in parallel: an elastic element, a contractile element, and a
damper.</p>
<figure class="align-default" id="id17">
<span id="fig-hill-type-muscle-model"></span><img alt="../../../../_images/hill-type-muscle-model.svg" src="../../../../_images/hill-type-muscle-model.svg" />
<figcaption>
<p><span class="caption-text">Schematic showing the four-element Hill-type muscle model. <span class="math notranslate nohighlight">\(SE\)</span> is the
series element representing the tendon, <span class="math notranslate nohighlight">\(CE\)</span> is the contractile
element, <span class="math notranslate nohighlight">\(EE\)</span> is the parallel element representing the elasticity of
the muscle fibers, and <span class="math notranslate nohighlight">\(DE\)</span> is the damper.</span><a class="headerlink" href="#id17" title="Link to this image">¶</a></p>
</figcaption>
</figure>
<p>Each of these components typically has a characteristic curve describing it. The
following sub-sections will describe and implement the characteristic curves
described in the paper by <a class="reference internal" href="../../../../tutorials/physics/biomechanics/biomechanical-model-example.html#degroote2016" id="id4"><span>[DeGroote2016]</span></a>.</p>
<section id="tendon-force-length">
<h3>Tendon Force-Length<a class="headerlink" href="#tendon-force-length" title="Link to this heading">¶</a></h3>
<p>It is common to model tendons as both rigid (inextensible) and elastic elements.
If the tendon is being treated as rigid, the tendon length does not change and
the length of the muscle fibers change directly with changes in musculotendon
length. A rigid tendon will not have an associated characteristic curve; it does
not have any force-producing capabilities itself and just directly transmits the
force produced by the muscle fibers.</p>
<p>If the tendon is elastic, it is commonly modeled as a nonlinear spring. We
therefore have our first characteristic curve, the tendon force-length curve,
which is a function of normalized tendon length:</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[\tilde{l}^T = \frac{l^T}{l^T_{slack}}\]</div>
</div>
<p>where <span class="math notranslate nohighlight">\(l^T\)</span> is tendon length, and <span class="math notranslate nohighlight">\(l^T_{slack}\)</span> is the “tendon slack
length”, a constant representing the tendon length under no force.
Characteristic musculotendon curves are parameterized in terms of “normalized”
(or “dimensionless”) quantities such as <span class="math notranslate nohighlight">\(\tilde{l}^T\)</span> because these curves
apply generically to all muscle fibers and tendons. Their properties can be
adjusted to model a specific musculotendon by selecting different values for the
constants. In the case of the tendon force-length characteristic, this is done
by tuning <span class="math notranslate nohighlight">\(l^T_{slack}\)</span>. Shorter values for this constant result in a
stiffer tendon.</p>
<p>The equation for the tendon force-length curve
<span class="math notranslate nohighlight">\(fl^T\left(\tilde{l}^T\right)\)</span> from <a class="reference internal" href="../../../../tutorials/physics/biomechanics/biomechanical-model-example.html#degroote2016" id="id5"><span>[DeGroote2016]</span></a> is:</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[fl^T\left(\tilde{l}^T\right) = c_0 \exp{c_3 \left( \tilde{l}^T - c_1 \right)} - c_2\]</div>
</div>
<p>To implement this in SymPy we need a time-varying dynamic symbol representing
<span class="math notranslate nohighlight">\(\tilde{l}^T\)</span> and four symbols representing the four constants.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">l_T_tilde</span> <span class="o">=</span> <span class="n">me</span><span class="o">.</span><span class="n">dynamicsymbols</span><span class="p">(</span><span class="s1">&#39;l_T_tilde&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">c0</span><span class="p">,</span> <span class="n">c1</span><span class="p">,</span> <span class="n">c2</span><span class="p">,</span> <span class="n">c3</span> <span class="o">=</span> <span class="n">sm</span><span class="o">.</span><span class="n">symbols</span><span class="p">(</span><span class="s1">&#39;c0, c1, c2, c3&#39;</span><span class="p">)</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">fl_T</span> <span class="o">=</span> <span class="n">c0</span><span class="o">*</span><span class="n">sm</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">c3</span><span class="o">*</span><span class="p">(</span><span class="n">l_T_tilde</span> <span class="o">-</span> <span class="n">c1</span><span class="p">))</span> <span class="o">-</span> <span class="n">c2</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fl_T</span>
<span class="go">c0*exp(c3*(-c1 + l_T_tilde(t))) - c2</span>
</pre></div>
</div>
<p>Alternatively, we could define this in terms of <span class="math notranslate nohighlight">\(l^T\)</span> and
<span class="math notranslate nohighlight">\(l^T_{slack}\)</span>.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">l_T</span> <span class="o">=</span> <span class="n">me</span><span class="o">.</span><span class="n">dynamicsymbols</span><span class="p">(</span><span class="s1">&#39;l_T&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">l_T_slack</span> <span class="o">=</span> <span class="n">sm</span><span class="o">.</span><span class="n">symbols</span><span class="p">(</span><span class="s1">&#39;l_T_slack&#39;</span><span class="p">)</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">fl_T</span> <span class="o">=</span> <span class="n">c0</span><span class="o">*</span><span class="n">sm</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">c3</span><span class="o">*</span><span class="p">(</span><span class="n">l_T</span><span class="o">/</span><span class="n">l_T_slack</span> <span class="o">-</span> <span class="n">c1</span><span class="p">))</span> <span class="o">-</span> <span class="n">c2</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fl_T</span>
<span class="go">c0*exp(c3*(-c1 + l_T(t)/l_T_slack)) - c2</span>
</pre></div>
</div>
<p>The <a class="reference internal" href="../../../../modules/physics/biomechanics/api/index.html#module-sympy.physics.biomechanics" title="sympy.physics.biomechanics"><code class="xref py py-obj docutils literal notranslate"><span class="pre">biomechanics</span></code></a> module in SymPy provides a class for
this exact curve,
<a class="reference internal" href="../../../../modules/physics/biomechanics/api/curve.html#sympy.physics.biomechanics.curve.TendonForceLengthDeGroote2016" title="sympy.physics.biomechanics.curve.TendonForceLengthDeGroote2016"><code class="xref py py-obj docutils literal notranslate"><span class="pre">TendonForceLengthDeGroote2016</span></code></a>. It can
be instantiated with five arguments. The first argument is <span class="math notranslate nohighlight">\(\tilde{l}^T\)</span>,
which need not necessarily be a symbol; it could be an expression. The further
four arguments are all constants. It is intended that these will be constants,
or sympifiable numerical values.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sympy.physics.biomechanics</span> <span class="kn">import</span> <span class="n">TendonForceLengthDeGroote2016</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">fl_T2</span> <span class="o">=</span> <span class="n">TendonForceLengthDeGroote2016</span><span class="p">(</span><span class="n">l_T</span><span class="o">/</span><span class="n">l_T_slack</span><span class="p">,</span> <span class="n">c0</span><span class="p">,</span> <span class="n">c1</span><span class="p">,</span> <span class="n">c2</span><span class="p">,</span> <span class="n">c3</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fl_T2</span>
<span class="go">TendonForceLengthDeGroote2016(l_T(t)/l_T_slack, c0, c1, c2, c3)</span>
</pre></div>
</div>
<p>This class is a subclass of <a class="reference internal" href="../../../../modules/core.html#sympy.core.function.Function" title="sympy.core.function.Function"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Function</span></code></a> and so
implements usual SymPy methods for substitution, evaluation, differentiation
etc. The
<a class="reference internal" href="../../../../modules/physics/biomechanics/api/curve.html#sympy.physics.biomechanics.curve.TendonForceLengthDeGroote2016.doit" title="sympy.physics.biomechanics.curve.TendonForceLengthDeGroote2016.doit"><code class="xref py py-obj docutils literal notranslate"><span class="pre">doit</span></code></a>
method allows the equation of the curve to be accessed.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">fl_T2</span><span class="o">.</span><span class="n">doit</span><span class="p">()</span>
<span class="go">c0*exp(c3*(-c1 + l_T(t)/l_T_slack)) - c2</span>
</pre></div>
</div>
<p>The class provides an alternate constructor that allows it to be constucted
prepopulated with the values for the constants recommended in <a class="reference internal" href="../../../../tutorials/physics/biomechanics/biomechanical-model-example.html#degroote2016" id="id6"><span>[DeGroote2016]</span></a>.
This takes a single argument, again corresponding to <span class="math notranslate nohighlight">\(\tilde{l}^T\)</span>, which
can against either be a symbol or expression.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">fl_T3</span> <span class="o">=</span> <span class="n">TendonForceLengthDeGroote2016</span><span class="o">.</span><span class="n">with_defaults</span><span class="p">(</span><span class="n">l_T</span><span class="o">/</span><span class="n">l_T_slack</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fl_T3</span>
<span class="go">TendonForceLengthDeGroote2016(l_T(t)/l_T_slack, 0.2, 0.995, 0.25, 33.93669377311689)</span>
</pre></div>
</div>
<p>In the above the constants have been replaced with instances of SymPy numeric
types like <a class="reference internal" href="../../../../modules/core.html#sympy.core.numbers.Float" title="sympy.core.numbers.Float"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Float</span></code></a>.</p>
<p>The <a class="reference internal" href="../../../../modules/physics/biomechanics/api/curve.html#sympy.physics.biomechanics.curve.TendonForceLengthDeGroote2016" title="sympy.physics.biomechanics.curve.TendonForceLengthDeGroote2016"><code class="xref py py-obj docutils literal notranslate"><span class="pre">TendonForceLengthDeGroote2016</span></code></a> class
also supports code generation, so seamlessly integrates with SymPy’s code
printers. To visualize this curve, we can use
<a class="reference internal" href="../../../../modules/utilities/lambdify.html#sympy.utilities.lambdify.lambdify" title="sympy.utilities.lambdify.lambdify"><code class="xref py py-obj docutils literal notranslate"><span class="pre">lambdify</span></code></a> on an instance of the function, which
will create a callable to evaluate it for a given value of <span class="math notranslate nohighlight">\(\tilde{l}^T\)</span>.
Sensible values for <span class="math notranslate nohighlight">\(\tilde{l}^T\)</span> fall within the range
<span class="math notranslate nohighlight">\([0.95, 1.05]\)</span>, which we will plot below.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sympy.physics.biomechanics</span> <span class="kn">import</span> <span class="n">TendonForceLengthDeGroote2016</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">l_T_tilde</span> <span class="o">=</span> <span class="n">me</span><span class="o">.</span><span class="n">dynamicsymbols</span><span class="p">(</span><span class="s1">&#39;l_T_tilde&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fl_T</span> <span class="o">=</span> <span class="n">TendonForceLengthDeGroote2016</span><span class="o">.</span><span class="n">with_defaults</span><span class="p">(</span><span class="n">l_T_tilde</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fl_T_callable</span> <span class="o">=</span> <span class="n">sm</span><span class="o">.</span><span class="n">lambdify</span><span class="p">(</span><span class="n">l_T_tilde</span><span class="p">,</span> <span class="n">fl_T</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">l_T_tilde_num</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mf">0.95</span><span class="p">,</span> <span class="mf">1.05</span><span class="p">)</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">_</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">l_T_tilde_num</span><span class="p">,</span> <span class="n">fl_T_callable</span><span class="p">(</span><span class="n">l_T_tilde_num</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">_</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Normalized tendon length&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">_</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Normalized tendon force-length&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>(<a class="reference download internal" download="" href="../../../../_downloads/c19ad35e2a571add7ef407bac7d2bd0b/biomechanics-11.png"><code class="xref download docutils literal notranslate"><span class="pre">png</span></code></a>, <a class="reference download internal" download="" href="../../../../_downloads/1e5f2dc44de4f86dab12c9ac43381d0c/biomechanics-11.hires.png"><code class="xref download docutils literal notranslate"><span class="pre">hires.png</span></code></a>, <a class="reference download internal" download="" href="../../../../_downloads/5271bad998891ddd195bf7ea0e44d844/biomechanics-11.pdf"><code class="xref download docutils literal notranslate"><span class="pre">pdf</span></code></a>)</p>
<figure class="align-default">
<img alt="../../../../_images/biomechanics-11.png" class="plot-directive" src="../../../../_images/biomechanics-11.png" />
</figure>
<p>When deriving the equations describing the musculotendon dynamics of models with
elastic tendons, it can be useful to know the inverse of the tendon force-length
characteristic curve. The curve defined in <a class="reference internal" href="../../../../tutorials/physics/biomechanics/biomechanical-model-example.html#degroote2016" id="id7"><span>[DeGroote2016]</span></a> is analytically
invertible, which means that we can directly determine
<span class="math notranslate nohighlight">\(\tilde{l}^T = \left[fl^T\left(\tilde{l}^T\right)\right]^{-1}\)</span> for a given
value of <span class="math notranslate nohighlight">\(fl^T\left(\tilde{l}^T\right)\)</span>.</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[\tilde{l}^T = \left[fl^T\left(\tilde{l}^T\right)\right]^{-1} = \frac{\log{\frac{fl^T + c_2}{c_0}}}{c_3} + c_1\]</div>
</div>
<p>There is also a class for this in <a class="reference internal" href="../../../../modules/physics/biomechanics/api/index.html#module-sympy.physics.biomechanics" title="sympy.physics.biomechanics"><code class="xref py py-obj docutils literal notranslate"><span class="pre">biomechanics</span></code></a>,
<a class="reference internal" href="../../../../modules/physics/biomechanics/api/curve.html#sympy.physics.biomechanics.curve.TendonForceLengthInverseDeGroote2016" title="sympy.physics.biomechanics.curve.TendonForceLengthInverseDeGroote2016"><code class="xref py py-obj docutils literal notranslate"><span class="pre">TendonForceLengthInverseDeGroote2016</span></code></a>,
which behaves identically to
<a class="reference internal" href="../../../../modules/physics/biomechanics/api/curve.html#sympy.physics.biomechanics.curve.TendonForceLengthDeGroote2016" title="sympy.physics.biomechanics.curve.TendonForceLengthDeGroote2016"><code class="xref py py-obj docutils literal notranslate"><span class="pre">TendonForceLengthDeGroote2016</span></code></a>. It can
be instantiated with five parameters, the first for <span class="math notranslate nohighlight">\(fl^T\)</span> followed by
four constants, or by using the alternate constructor with a single argument for
<span class="math notranslate nohighlight">\(fl^T\)</span>.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sympy.physics.biomechanics</span> <span class="kn">import</span> <span class="n">TendonForceLengthInverseDeGroote2016</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">fl_T_sym</span> <span class="o">=</span><span class="n">me</span><span class="o">.</span><span class="n">dynamicsymbols</span><span class="p">(</span><span class="s1">&#39;fl_T&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fl_T_inv</span> <span class="o">=</span> <span class="n">TendonForceLengthInverseDeGroote2016</span><span class="p">(</span><span class="n">fl_T_sym</span><span class="p">,</span> <span class="n">c0</span><span class="p">,</span> <span class="n">c1</span><span class="p">,</span> <span class="n">c2</span><span class="p">,</span> <span class="n">c3</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fl_T_inv</span>
<span class="go">TendonForceLengthInverseDeGroote2016(fl_T(t), c0, c1, c2, c3)</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">fl_T_inv2</span> <span class="o">=</span> <span class="n">TendonForceLengthInverseDeGroote2016</span><span class="o">.</span><span class="n">with_defaults</span><span class="p">(</span><span class="n">fl_T_sym</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fl_T_inv2</span>
<span class="go">TendonForceLengthInverseDeGroote2016(fl_T(t), 0.2, 0.995, 0.25, 33.93669377311689)</span>
</pre></div>
</div>
</section>
<section id="fiber-passive-force-length">
<h3>Fiber Passive Force-Length<a class="headerlink" href="#fiber-passive-force-length" title="Link to this heading">¶</a></h3>
<p>The first element used to model the muscle fibers is the fiber passive
force- length. This is essentially another nonlinear spring representing the
elastic properties of the muscle fibers. The characteristic curve describing
this element is a function of normalized muscle fiber length:</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[\tilde{l}^M = \frac{l^M}{l^M_{opt}}\]</div>
</div>
<p>where <span class="math notranslate nohighlight">\(l^M\)</span> is muscle fiber length, and <span class="math notranslate nohighlight">\(l^M_{opt}\)</span> is the “optimal
fiber length, a constant representing the muscle fiber length at which it
produces no passive-elastic force (it is also the muscle fiber length at which
it can produce maximum active force). Like with tuning <span class="math notranslate nohighlight">\(l^T_{slack}\)</span> to
change the stiffness properties of a modeled tendon via the tendon force-length
characteristic, we can adjust <span class="math notranslate nohighlight">\(l^M_{opt}\)</span> to change the passive properties
of the muscle fibers; decreasing <span class="math notranslate nohighlight">\(l^M_{opt}\)</span> will make modeled muscle
fibers stiffer.</p>
<p>The equation for the fiber passive force-length curve
<span class="math notranslate nohighlight">\(fl^M_{pas}\left(\tilde{l}^M\right)\)</span> from <a class="reference internal" href="../../../../tutorials/physics/biomechanics/biomechanical-model-example.html#degroote2016" id="id8"><span>[DeGroote2016]</span></a> is:</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[fl^M_{pas} = \frac{\frac{\exp{c_1 \left(\tilde{l^M} - 1\right)}}{c_0} - 1}{\exp{c_1} - 1}\]</div>
</div>
<p>Similarly to before, to implement this in SymPy we need a time-varying dynamic
symbol representing <span class="math notranslate nohighlight">\(\tilde{l}^M\)</span> and two symbols representing the two
constants.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">l_M_tilde</span> <span class="o">=</span> <span class="n">me</span><span class="o">.</span><span class="n">dynamicsymbols</span><span class="p">(</span><span class="s1">&#39;l_M_tilde&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">c0</span><span class="p">,</span> <span class="n">c1</span> <span class="o">=</span> <span class="n">sm</span><span class="o">.</span><span class="n">symbols</span><span class="p">(</span><span class="s1">&#39;c0, c1&#39;</span><span class="p">)</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">fl_M_pas</span> <span class="o">=</span> <span class="p">(</span><span class="n">sm</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">c1</span><span class="o">*</span><span class="p">(</span><span class="n">l_M_tilde</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="n">c0</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">sm</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">c1</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fl_M_pas</span>
<span class="go">(exp(c1*(l_M_tilde(t) - 1)/c0) - 1)/(exp(c1) - 1)</span>
</pre></div>
</div>
<p>Alternatively, we could define this in terms of <span class="math notranslate nohighlight">\(l^M\)</span> and
<span class="math notranslate nohighlight">\(l^M_{opt}\)</span>.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">l_M</span> <span class="o">=</span> <span class="n">me</span><span class="o">.</span><span class="n">dynamicsymbols</span><span class="p">(</span><span class="s1">&#39;l_M&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">l_M_opt</span> <span class="o">=</span> <span class="n">sm</span><span class="o">.</span><span class="n">symbols</span><span class="p">(</span><span class="s1">&#39;l_M_opt&#39;</span><span class="p">)</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">fl_M_pas2</span> <span class="o">=</span> <span class="p">(</span><span class="n">sm</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">c1</span><span class="o">*</span><span class="p">(</span><span class="n">l_M</span><span class="o">/</span><span class="n">l_M_opt</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="n">c0</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">sm</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">c1</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fl_M_pas2</span>
<span class="go">(exp(c1*(-1 + l_M(t)/l_M_opt)/c0) - 1)/(exp(c1) - 1)</span>
</pre></div>
</div>
<p>Again, the <a class="reference internal" href="../../../../modules/physics/biomechanics/api/index.html#module-sympy.physics.biomechanics" title="sympy.physics.biomechanics"><code class="xref py py-obj docutils literal notranslate"><span class="pre">biomechanics</span></code></a> module in SymPy provides a class
for this exact curve,
<a class="reference internal" href="../../../../modules/physics/biomechanics/api/curve.html#sympy.physics.biomechanics.curve.FiberForceLengthPassiveDeGroote2016" title="sympy.physics.biomechanics.curve.FiberForceLengthPassiveDeGroote2016"><code class="xref py py-obj docutils literal notranslate"><span class="pre">FiberForceLengthPassiveDeGroote2016</span></code></a>. It
can be instantiated with three arguments. The first argument is
<span class="math notranslate nohighlight">\(\tilde{l}^M\)</span>, which need not necessarily be a symbol and can be an
expression. The further two arguments are both constants. It is intended that
these will be constants, or sympifiable numerical values.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sympy.physics.biomechanics</span> <span class="kn">import</span> <span class="n">FiberForceLengthPassiveDeGroote2016</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">fl_M_pas2</span> <span class="o">=</span> <span class="n">FiberForceLengthPassiveDeGroote2016</span><span class="p">(</span><span class="n">l_M</span><span class="o">/</span><span class="n">l_M_opt</span><span class="p">,</span> <span class="n">c0</span><span class="p">,</span> <span class="n">c1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fl_M_pas2</span>
<span class="go">FiberForceLengthPassiveDeGroote2016(l_M(t)/l_M_opt, c0, c1)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fl_M_pas2</span><span class="o">.</span><span class="n">doit</span><span class="p">()</span>
<span class="go">(exp(c1*(-1 + l_M(t)/l_M_opt)/c0) - 1)/(exp(c1) - 1)</span>
</pre></div>
</div>
<p>Using the alternate constructor, which takes a single parameter for
<span class="math notranslate nohighlight">\(\tilde{l}^M\)</span>, we can create an instance prepopulated with the values for
the constants recommended in <a class="reference internal" href="../../../../tutorials/physics/biomechanics/biomechanical-model-example.html#degroote2016" id="id9"><span>[DeGroote2016]</span></a>.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">fl_M_pas3</span> <span class="o">=</span> <span class="n">FiberForceLengthPassiveDeGroote2016</span><span class="o">.</span><span class="n">with_defaults</span><span class="p">(</span><span class="n">l_M</span><span class="o">/</span><span class="n">l_M_opt</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fl_M_pas3</span>
<span class="go">FiberForceLengthPassiveDeGroote2016(l_M(t)/l_M_opt, 0.6, 4.0)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fl_M_pas3</span><span class="o">.</span><span class="n">doit</span><span class="p">()</span>
<span class="go">2.37439874427164e-5*exp(6.66666666666667*l_M(t)/l_M_opt) - 0.0186573603637741</span>
</pre></div>
</div>
<p>Sensible values for <span class="math notranslate nohighlight">\(\tilde{l}^M\)</span> fall
within the range <span class="math notranslate nohighlight">\([0.0, 2.0]\)</span>, which we will plot below.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sympy.physics.biomechanics</span> <span class="kn">import</span> <span class="n">FiberForceLengthPassiveDeGroote2016</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">l_M_tilde</span> <span class="o">=</span> <span class="n">me</span><span class="o">.</span><span class="n">dynamicsymbols</span><span class="p">(</span><span class="s1">&#39;l_M_tilde&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fl_M_pas</span> <span class="o">=</span> <span class="n">FiberForceLengthPassiveDeGroote2016</span><span class="o">.</span><span class="n">with_defaults</span><span class="p">(</span><span class="n">l_M_tilde</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fl_M_pas_callable</span> <span class="o">=</span> <span class="n">sm</span><span class="o">.</span><span class="n">lambdify</span><span class="p">(</span><span class="n">l_M_tilde</span><span class="p">,</span> <span class="n">fl_M_pas</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">l_M_tilde_num</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">2.0</span><span class="p">)</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">_</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">l_M_tilde_num</span><span class="p">,</span> <span class="n">fl_M_pas_callable</span><span class="p">(</span><span class="n">l_M_tilde_num</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">_</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Normalized fiber length&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">_</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Normalized fiber passive force-length&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>(<a class="reference download internal" download="" href="../../../../_downloads/fd54aa94ffa7aa1e7928550d68c5122f/biomechanics-12.png"><code class="xref download docutils literal notranslate"><span class="pre">png</span></code></a>, <a class="reference download internal" download="" href="../../../../_downloads/75ab8091a8cadc275cf15e2a4cb80d9c/biomechanics-12.hires.png"><code class="xref download docutils literal notranslate"><span class="pre">hires.png</span></code></a>, <a class="reference download internal" download="" href="../../../../_downloads/68bf3baa5f6498f8399b26d3d85ce17a/biomechanics-12.pdf"><code class="xref download docutils literal notranslate"><span class="pre">pdf</span></code></a>)</p>
<figure class="align-default">
<img alt="../../../../_images/biomechanics-12.png" class="plot-directive" src="../../../../_images/biomechanics-12.png" />
</figure>
<p>The inverse of the fiber passive force-length characteristic curve is sometimes
required when formulating musculotendon dynamics. The equation for this curve
from <a class="reference internal" href="../../../../tutorials/physics/biomechanics/biomechanical-model-example.html#degroote2016" id="id10"><span>[DeGroote2016]</span></a> is again analytically invertible.</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[\tilde{l}^M = \left[fl^M_{pas}\right]^{-1} = \frac{c_0 \log{\left(\exp{c_1} - 1\right)fl^M_{pas} + 1}}{c_1} + 1\]</div>
</div>
<p>There is also a class for this in <a class="reference internal" href="../../../../modules/physics/biomechanics/api/index.html#module-sympy.physics.biomechanics" title="sympy.physics.biomechanics"><code class="xref py py-obj docutils literal notranslate"><span class="pre">biomechanics</span></code></a>,
<a class="reference internal" href="../../../../modules/physics/biomechanics/api/curve.html#sympy.physics.biomechanics.curve.FiberForceLengthPassiveInverseDeGroote2016" title="sympy.physics.biomechanics.curve.FiberForceLengthPassiveInverseDeGroote2016"><code class="xref py py-obj docutils literal notranslate"><span class="pre">FiberForceLengthPassiveInverseDeGroote2016</span></code></a>.
It can be instantiated with three parameters, the first for <span class="math notranslate nohighlight">\(fl^M\)</span>
followed by a pair of constants, or by using the alternate constructor with a
single argument for <span class="math notranslate nohighlight">\(\tilde{l}^M\)</span>.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sympy.physics.biomechanics</span> <span class="kn">import</span> <span class="n">FiberForceLengthPassiveInverseDeGroote2016</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">fl_M_pas_sym</span> <span class="o">=</span><span class="n">me</span><span class="o">.</span><span class="n">dynamicsymbols</span><span class="p">(</span><span class="s1">&#39;fl_M_pas&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fl_M_pas_inv</span> <span class="o">=</span> <span class="n">FiberForceLengthPassiveInverseDeGroote2016</span><span class="p">(</span><span class="n">fl_M_pas_sym</span><span class="p">,</span> <span class="n">c0</span><span class="p">,</span> <span class="n">c1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fl_M_pas_inv</span>
<span class="go">FiberForceLengthPassiveInverseDeGroote2016(fl_M_pas(t), c0, c1)</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">fl_M_pas_inv2</span> <span class="o">=</span> <span class="n">FiberForceLengthPassiveInverseDeGroote2016</span><span class="o">.</span><span class="n">with_defaults</span><span class="p">(</span><span class="n">fl_M_pas_sym</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fl_M_pas_inv2</span>
<span class="go">FiberForceLengthPassiveInverseDeGroote2016(fl_M_pas(t), 0.6, 4.0)</span>
</pre></div>
</div>
</section>
<section id="fiber-active-force-length">
<h3>Fiber Active Force-Length<a class="headerlink" href="#fiber-active-force-length" title="Link to this heading">¶</a></h3>
<p>When a muscle is activated, it contracts to produce a force. This phenomenom is
modeled by the contractile element in the parallel fiber component of the
musculotendon model. The amount of force that the fibers can produce is a
function of the instantaneous length of the fibers. The characteristic curve
describing the fiber active force-length curve is again parameterized by
<span class="math notranslate nohighlight">\(\tilde{l}^M\)</span>. This curve is “bell-shaped”. For very small and very large
values of <span class="math notranslate nohighlight">\(\tilde{l}^M\)</span>, the active fiber force-length tends to zero. The
peak active fiber force-length occurs when <span class="math notranslate nohighlight">\(\tilde{l}^M = l^M_{opt}\)</span> and
gives a value of <span class="math notranslate nohighlight">\(0.0\)</span>.</p>
<p>The equation for the fiber active force-length curve
<span class="math notranslate nohighlight">\(fl^M_{act}\left(\tilde{l}^M\right)\)</span> from <a class="reference internal" href="../../../../tutorials/physics/biomechanics/biomechanical-model-example.html#degroote2016" id="id11"><span>[DeGroote2016]</span></a> is:</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[fl^M_{act}\left(\tilde{l}^M\right) = c_0 \exp{-\frac{1}{2}\left(\frac{\tilde{l}^M - c_1}{\left(c_2 + c_3 \tilde{l}^M\right)}\right)^2}
     + c_4 \exp{-\frac{1}{2}\left(\frac{\tilde{l}^M - c_5}{\left(c_6 + c_7 \tilde{l}^M\right)}\right)^2}
     + c_8 \exp{-\frac{1}{2}\left(\frac{\tilde{l}^M - c_9}{\left(c_{10} + c_{11} \tilde{l}^M\right)}\right)^2}\]</div>
</div>
<p>To implement this in SymPy we need a time-varying dynamic symbol representing
<span class="math notranslate nohighlight">\(\tilde{l}^M\)</span> and twelve symbols representing the twelve constants.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">constants</span> <span class="o">=</span> <span class="n">sm</span><span class="o">.</span><span class="n">symbols</span><span class="p">(</span><span class="s1">&#39;c0:12&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">c0</span><span class="p">,</span> <span class="n">c1</span><span class="p">,</span> <span class="n">c2</span><span class="p">,</span> <span class="n">c3</span><span class="p">,</span> <span class="n">c4</span><span class="p">,</span> <span class="n">c5</span><span class="p">,</span> <span class="n">c6</span><span class="p">,</span> <span class="n">c7</span><span class="p">,</span> <span class="n">c8</span><span class="p">,</span> <span class="n">c9</span><span class="p">,</span> <span class="n">c10</span><span class="p">,</span> <span class="n">c11</span> <span class="o">=</span> <span class="n">constants</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">fl_M_act</span> <span class="o">=</span> <span class="p">(</span><span class="n">c0</span><span class="o">*</span><span class="n">sm</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="p">(((</span><span class="n">l_M_tilde</span> <span class="o">-</span> <span class="n">c1</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">c2</span> <span class="o">+</span> <span class="n">c3</span><span class="o">*</span><span class="n">l_M_tilde</span><span class="p">))</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span> <span class="o">+</span> <span class="n">c4</span><span class="o">*</span><span class="n">sm</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="p">(((</span><span class="n">l_M_tilde</span> <span class="o">-</span> <span class="n">c5</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">c6</span> <span class="o">+</span> <span class="n">c7</span><span class="o">*</span><span class="n">l_M_tilde</span><span class="p">))</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span> <span class="o">+</span> <span class="n">c8</span><span class="o">*</span><span class="n">sm</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="p">(((</span><span class="n">l_M_tilde</span> <span class="o">-</span> <span class="n">c9</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">c10</span> <span class="o">+</span> <span class="n">c11</span><span class="o">*</span><span class="n">l_M_tilde</span><span class="p">))</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fl_M_act</span>
<span class="go">c0*exp(-(-c1 + l_M_tilde(t))**2/(2*(c2 + c3*l_M_tilde(t))**2)) + c4*exp(-(-c5 + l_M_tilde(t))**2/(2*(c6 + c7*l_M_tilde(t))**2)) + c8*exp(-(-c9 + l_M_tilde(t))**2/(2*(c10 + c11*l_M_tilde(t))**2))</span>
</pre></div>
</div>
<p>The SymPy-provided class for this exact curve is
<a class="reference internal" href="../../../../modules/physics/biomechanics/api/curve.html#sympy.physics.biomechanics.curve.FiberForceLengthActiveDeGroote2016" title="sympy.physics.biomechanics.curve.FiberForceLengthActiveDeGroote2016"><code class="xref py py-obj docutils literal notranslate"><span class="pre">FiberForceLengthActiveDeGroote2016</span></code></a>. It
can be instantiated with thirteen arguments. The first argument is
<span class="math notranslate nohighlight">\(\tilde{l}^M\)</span>, which need not necessarily be a symbol and can be an
expression. The further twelve arguments are all constants. It is intended that
these will be constants, or sympifiable numerical values.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sympy.physics.biomechanics</span> <span class="kn">import</span> <span class="n">FiberForceLengthActiveDeGroote2016</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">fl_M_act2</span> <span class="o">=</span> <span class="n">FiberForceLengthActiveDeGroote2016</span><span class="p">(</span><span class="n">l_M</span><span class="o">/</span><span class="n">l_M_opt</span><span class="p">,</span> <span class="o">*</span><span class="n">constants</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fl_M_act2</span>
<span class="go">FiberForceLengthActiveDeGroote2016(l_M(t)/l_M_opt, c0, c1, c2, c3, c4, c5, c6, c7, c8, c9, c10, c11)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fl_M_act2</span><span class="o">.</span><span class="n">doit</span><span class="p">()</span>
<span class="go">c0*exp(-(-c1 + l_M(t)/l_M_opt)**2/(2*(c2 + c3*l_M(t)/l_M_opt)**2)) + c4*exp(-(-c5 + l_M(t)/l_M_opt)**2/(2*(c6 + c7*l_M(t)/l_M_opt)**2)) + c8*exp(-(-c9 + l_M(t)/l_M_opt)**2/(2*(c10 + c11*l_M(t)/l_M_opt)**2))</span>
</pre></div>
</div>
<p>Using the alternate constructor, which takes a single parameter for
<span class="math notranslate nohighlight">\(\tilde{l}^M\)</span>, we can create an instance prepopulated with the values for
the constants recommended in <a class="reference internal" href="../../../../tutorials/physics/biomechanics/biomechanical-model-example.html#degroote2016" id="id12"><span>[DeGroote2016]</span></a>.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">fl_M_act3</span> <span class="o">=</span> <span class="n">FiberForceLengthActiveDeGroote2016</span><span class="o">.</span><span class="n">with_defaults</span><span class="p">(</span><span class="n">l_M</span><span class="o">/</span><span class="n">l_M_opt</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fl_M_act3</span>
<span class="go">FiberForceLengthActiveDeGroote2016(l_M(t)/l_M_opt, 0.814, 1.06, 0.162, 0.0633, 0.433, 0.717, -0.0299, 0.2, 0.1, 1.0, 0.354, 0.0)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fl_M_act3</span><span class="o">.</span><span class="n">doit</span><span class="p">()</span>
<span class="go">0.1*exp(-3.98991349867535*(-1 + l_M(t)/l_M_opt)**2) + 0.433*exp(-12.5*(-0.717 + l_M(t)/l_M_opt)**2/(-0.1495 + l_M(t)/l_M_opt)**2) + 0.814*exp(-21.4067977442463*(-1 + 0.943396226415094*l_M(t)/l_M_opt)**2/(1 + 0.390740740740741*l_M(t)/l_M_opt)**2)</span>
</pre></div>
</div>
<p>Sensible values for <span class="math notranslate nohighlight">\(\tilde{l}^M\)</span> fall
within the range <span class="math notranslate nohighlight">\([0.0, 2.0]\)</span>, which we will plot below.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sympy.physics.biomechanics</span> <span class="kn">import</span> <span class="n">FiberForceLengthActiveDeGroote2016</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">l_M_tilde</span> <span class="o">=</span> <span class="n">me</span><span class="o">.</span><span class="n">dynamicsymbols</span><span class="p">(</span><span class="s1">&#39;l_M_tilde&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fl_M_act</span> <span class="o">=</span> <span class="n">FiberForceLengthActiveDeGroote2016</span><span class="o">.</span><span class="n">with_defaults</span><span class="p">(</span><span class="n">l_M_tilde</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fl_M_act_callable</span> <span class="o">=</span> <span class="n">sm</span><span class="o">.</span><span class="n">lambdify</span><span class="p">(</span><span class="n">l_M_tilde</span><span class="p">,</span> <span class="n">fl_M_act</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">l_M_tilde_num</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">2.0</span><span class="p">)</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">_</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">l_M_tilde_num</span><span class="p">,</span> <span class="n">fl_M_act_callable</span><span class="p">(</span><span class="n">l_M_tilde_num</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">_</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Normalized fiber length&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">_</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Normalized fiber active force-length&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>(<a class="reference download internal" download="" href="../../../../_downloads/3f31ee2598afd595c199773fba9a020b/biomechanics-13.png"><code class="xref download docutils literal notranslate"><span class="pre">png</span></code></a>, <a class="reference download internal" download="" href="../../../../_downloads/657eacb625975c61416ecc6d043f0b94/biomechanics-13.hires.png"><code class="xref download docutils literal notranslate"><span class="pre">hires.png</span></code></a>, <a class="reference download internal" download="" href="../../../../_downloads/f0f9e180dc0f510887f7768447a685c0/biomechanics-13.pdf"><code class="xref download docutils literal notranslate"><span class="pre">pdf</span></code></a>)</p>
<figure class="align-default">
<img alt="../../../../_images/biomechanics-13.png" class="plot-directive" src="../../../../_images/biomechanics-13.png" />
</figure>
<p>No inverse curve exists for the fiber active force-length characteristic curve
as it has multiple values of <span class="math notranslate nohighlight">\(\tilde{l}^M\)</span> for each value of
<span class="math notranslate nohighlight">\(fl^M_{act}\)</span>.</p>
</section>
<section id="fiber-force-velocity">
<h3>Fiber Force-Velocity<a class="headerlink" href="#fiber-force-velocity" title="Link to this heading">¶</a></h3>
<p>The force produced by the contractile element is also a function of its
lengthening velocity. The characteristic curve describing the velocity-dependent
portion of the contractile element’s dynamics is a function of normalized muscle
fiber lengthening velocity:</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[\tilde{v}^M = \frac{v^M}{v^M_{max}}\]</div>
</div>
<p>where <span class="math notranslate nohighlight">\(v^M\)</span> is muscle fiber lengthening velocity, and <span class="math notranslate nohighlight">\(v^M_{max}\)</span> is
the “maximum fiber velocity”, a constant representing the muscle fiber velocity
at which it is not able to produce any contractile force when concentrically
contracting. <span class="math notranslate nohighlight">\(v^M_{max}\)</span> is commonly given a value of
<span class="math notranslate nohighlight">\(10 l^M_{opt}\)</span>.</p>
<p>The equation for the fiber force-velocity curve
<span class="math notranslate nohighlight">\(fv^M\left(\tilde{v}^M\right)\)</span> from <a class="reference internal" href="../../../../tutorials/physics/biomechanics/biomechanical-model-example.html#degroote2016" id="id13"><span>[DeGroote2016]</span></a> is:</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[fv^M\left(\tilde{v}^M\right) = c_0 \log{\left(c_1 \tilde{v}^M + c_2\right) + \sqrt{\left(c_1 \tilde{v}^M + c_2\right)^2 + 1}} + c_3\]</div>
</div>
<p>Similarly to before, to implement this in SymPy we need a time-varying dynamic
symbol representing <span class="math notranslate nohighlight">\(\tilde{v}^M\)</span> and four symbols representing the four
constants.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">v_M_tilde</span> <span class="o">=</span> <span class="n">me</span><span class="o">.</span><span class="n">dynamicsymbols</span><span class="p">(</span><span class="s1">&#39;v_M_tilde&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">c0</span><span class="p">,</span> <span class="n">c1</span><span class="p">,</span> <span class="n">c2</span><span class="p">,</span> <span class="n">c3</span> <span class="o">=</span> <span class="n">sm</span><span class="o">.</span><span class="n">symbols</span><span class="p">(</span><span class="s1">&#39;c0, c1, c2, c3&#39;</span><span class="p">)</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">fv_M</span> <span class="o">=</span> <span class="n">c0</span><span class="o">*</span><span class="n">sm</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">c1</span><span class="o">*</span><span class="n">v_M_tilde</span> <span class="o">+</span> <span class="n">c2</span> <span class="o">+</span> <span class="n">sm</span><span class="o">.</span><span class="n">sqrt</span><span class="p">((</span><span class="n">c1</span><span class="o">*</span><span class="n">v_M_tilde</span> <span class="o">+</span> <span class="n">c2</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">1</span><span class="p">))</span> <span class="o">+</span> <span class="n">c3</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fv_M</span>
<span class="go">c0*log(c1*v_M_tilde(t) + c2 + sqrt((c1*v_M_tilde(t) + c2)**2 + 1)) + c3</span>
</pre></div>
</div>
<p>Alternatively, we could define this in terms of <span class="math notranslate nohighlight">\(v^M\)</span> and
<span class="math notranslate nohighlight">\(v^M_{max}\)</span>.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">v_M</span> <span class="o">=</span> <span class="n">me</span><span class="o">.</span><span class="n">dynamicsymbols</span><span class="p">(</span><span class="s1">&#39;v_M&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">v_M_max</span> <span class="o">=</span> <span class="n">sm</span><span class="o">.</span><span class="n">symbols</span><span class="p">(</span><span class="s1">&#39;v_M_max&#39;</span><span class="p">)</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">fv_M_pas2</span> <span class="o">=</span> <span class="n">c0</span><span class="o">*</span><span class="n">sm</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">c1</span><span class="o">*</span><span class="n">v_M</span><span class="o">/</span><span class="n">v_M_max</span> <span class="o">+</span> <span class="n">c2</span> <span class="o">+</span> <span class="n">sm</span><span class="o">.</span><span class="n">sqrt</span><span class="p">((</span><span class="n">c1</span><span class="o">*</span><span class="n">v_M</span><span class="o">/</span><span class="n">v_M_max</span> <span class="o">+</span> <span class="n">c2</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">1</span><span class="p">))</span> <span class="o">+</span> <span class="n">c3</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fv_M_pas2</span>
<span class="go">c0*log(c1*v_M(t)/v_M_max + c2 + sqrt((c1*v_M(t)/v_M_max + c2)**2 + 1)) + c3</span>
</pre></div>
</div>
<p>The SymPy-provided class for this exact curve is
<a class="reference internal" href="../../../../modules/physics/biomechanics/api/curve.html#sympy.physics.biomechanics.curve.FiberForceVelocityDeGroote2016" title="sympy.physics.biomechanics.curve.FiberForceVelocityDeGroote2016"><code class="xref py py-obj docutils literal notranslate"><span class="pre">FiberForceVelocityDeGroote2016</span></code></a>. It can
be instantiated with five arguments. The first argument is <span class="math notranslate nohighlight">\(\tilde{v}^M\)</span>,
which need not necessarily be a symbol and can be an expression. The further
four arguments are all constants. It is intended that these will be constants,
or sympifiable numerical values.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sympy.physics.biomechanics</span> <span class="kn">import</span> <span class="n">FiberForceVelocityDeGroote2016</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">fv_M2</span> <span class="o">=</span> <span class="n">FiberForceVelocityDeGroote2016</span><span class="p">(</span><span class="n">v_M</span><span class="o">/</span><span class="n">v_M_max</span><span class="p">,</span> <span class="n">c0</span><span class="p">,</span> <span class="n">c1</span><span class="p">,</span> <span class="n">c2</span><span class="p">,</span> <span class="n">c3</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fv_M2</span>
<span class="go">FiberForceVelocityDeGroote2016(v_M(t)/v_M_max, c0, c1, c2, c3)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fv_M2</span><span class="o">.</span><span class="n">doit</span><span class="p">()</span>
<span class="go">c0*log(c1*v_M(t)/v_M_max + c2 + sqrt((c1*v_M(t)/v_M_max + c2)**2 + 1)) + c3</span>
</pre></div>
</div>
<p>Using the alternate constructor, which takes a single parameter for
<span class="math notranslate nohighlight">\(\tilde{v}^M\)</span>, we can create an instance prepopulated with the values for
the constants recommended in <a class="reference internal" href="../../../../tutorials/physics/biomechanics/biomechanical-model-example.html#degroote2016" id="id14"><span>[DeGroote2016]</span></a>.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">fv_M3</span> <span class="o">=</span> <span class="n">FiberForceVelocityDeGroote2016</span><span class="o">.</span><span class="n">with_defaults</span><span class="p">(</span><span class="n">v_M</span><span class="o">/</span><span class="n">v_M_max</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fv_M3</span>
<span class="go">FiberForceVelocityDeGroote2016(v_M(t)/v_M_max, -0.318, -8.149, -0.374, 0.886)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fv_M3</span><span class="o">.</span><span class="n">doit</span><span class="p">()</span>
<span class="go">0.886 - 0.318*log(8.149*sqrt((-0.0458952018652595 - v_M(t)/v_M_max)**2 + 0.0150588346410601) - 0.374 - 8.149*v_M(t)/v_M_max)</span>
</pre></div>
</div>
<p>Sensible values for <span class="math notranslate nohighlight">\(\tilde{v}^M\)</span> fall within the range
<span class="math notranslate nohighlight">\([-1.0, 1.0]\)</span>, which we will plot below.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sympy.physics.biomechanics</span> <span class="kn">import</span> <span class="n">FiberForceVelocityDeGroote2016</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">v_M_tilde</span> <span class="o">=</span> <span class="n">me</span><span class="o">.</span><span class="n">dynamicsymbols</span><span class="p">(</span><span class="s1">&#39;v_M_tilde&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fv_M</span> <span class="o">=</span> <span class="n">FiberForceVelocityDeGroote2016</span><span class="o">.</span><span class="n">with_defaults</span><span class="p">(</span><span class="n">v_M_tilde</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fv_M_callable</span> <span class="o">=</span> <span class="n">sm</span><span class="o">.</span><span class="n">lambdify</span><span class="p">(</span><span class="n">v_M_tilde</span><span class="p">,</span> <span class="n">fv_M</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">v_M_tilde_num</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">)</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">_</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">l_M_tilde_num</span><span class="p">,</span> <span class="n">fv_M_callable</span><span class="p">(</span><span class="n">v_M_tilde_num</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">_</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Normalized fiber velocity&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">_</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Normalized fiber force-velocity&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>(<a class="reference download internal" download="" href="../../../../_downloads/04f52daf33e90863d17645ff89f0a2de/biomechanics-14.png"><code class="xref download docutils literal notranslate"><span class="pre">png</span></code></a>, <a class="reference download internal" download="" href="../../../../_downloads/43f4dcbcc2927446bae2c9ecc120e3f1/biomechanics-14.hires.png"><code class="xref download docutils literal notranslate"><span class="pre">hires.png</span></code></a>, <a class="reference download internal" download="" href="../../../../_downloads/945e2a45816629e69cae83f93476425f/biomechanics-14.pdf"><code class="xref download docutils literal notranslate"><span class="pre">pdf</span></code></a>)</p>
<figure class="align-default">
<img alt="../../../../_images/biomechanics-14.png" class="plot-directive" src="../../../../_images/biomechanics-14.png" />
</figure>
<p>The inverse of the fiber force-velocity characteristic curve is sometimes
required when formulating musculotendon dynamics. The equation for this curve
from <a class="reference internal" href="../../../../tutorials/physics/biomechanics/biomechanical-model-example.html#degroote2016" id="id15"><span>[DeGroote2016]</span></a> is again analytically invertible.</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[\tilde{v}^M = \left[fv^M\right]^{-1} = \frac{\sinh{\frac{fv^M - c_3}{c_0}} - c_2}{c_1}\]</div>
</div>
<p>There is also a class for this in <a class="reference internal" href="../../../../modules/physics/biomechanics/api/index.html#module-sympy.physics.biomechanics" title="sympy.physics.biomechanics"><code class="xref py py-obj docutils literal notranslate"><span class="pre">biomechanics</span></code></a>,
<a class="reference internal" href="../../../../modules/physics/biomechanics/api/curve.html#sympy.physics.biomechanics.curve.FiberForceVelocityInverseDeGroote2016" title="sympy.physics.biomechanics.curve.FiberForceVelocityInverseDeGroote2016"><code class="xref py py-obj docutils literal notranslate"><span class="pre">FiberForceVelocityInverseDeGroote2016</span></code></a>.
It can be instantiated with five parameters, the first for <span class="math notranslate nohighlight">\(fv^M\)</span>
followed by four constants, or by using the alternate constructor with a
single argument for <span class="math notranslate nohighlight">\(\tilde{v}^M\)</span>.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sympy.physics.biomechanics</span> <span class="kn">import</span> <span class="n">FiberForceVelocityInverseDeGroote2016</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">fv_M_sym</span> <span class="o">=</span> <span class="n">me</span><span class="o">.</span><span class="n">dynamicsymbols</span><span class="p">(</span><span class="s1">&#39;fv_M&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fv_M_inv</span> <span class="o">=</span> <span class="n">FiberForceVelocityInverseDeGroote2016</span><span class="p">(</span><span class="n">fv_M_sym</span><span class="p">,</span> <span class="n">c0</span><span class="p">,</span> <span class="n">c1</span><span class="p">,</span> <span class="n">c2</span><span class="p">,</span> <span class="n">c3</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fv_M_inv</span>
<span class="go">FiberForceVelocityInverseDeGroote2016(fv_M(t), c0, c1, c2, c3)</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">fv_M_inv2</span> <span class="o">=</span> <span class="n">FiberForceVelocityInverseDeGroote2016</span><span class="o">.</span><span class="n">with_defaults</span><span class="p">(</span><span class="n">fv_M_sym</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fv_M_inv2</span>
<span class="go">FiberForceVelocityInverseDeGroote2016(fv_M(t), -0.318, -8.149, -0.374, 0.886)</span>
</pre></div>
</div>
</section>
<section id="fiber-damping">
<h3>Fiber Damping<a class="headerlink" href="#fiber-damping" title="Link to this heading">¶</a></h3>
<p>Perhaps the simplest element in the musculotendon model is the fiber damping.
This does not have an associated characteristic curve as it is typically just
modeled as a simple linear damper. We will use <span class="math notranslate nohighlight">\(\beta\)</span> as the coefficient
of damping such that the damping force can be described as:</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[f_{damp} = \beta \tilde{v}^M\]</div>
</div>
<p><a class="reference internal" href="../../../../tutorials/physics/biomechanics/biomechanical-model-example.html#degroote2016" id="id16"><span>[DeGroote2016]</span></a> suggest the value <span class="math notranslate nohighlight">\(\beta = 0.1\)</span>. However, SymPy uses
<span class="math notranslate nohighlight">\(\beta = 10\)</span> by default. When conducting forward simulations or solving
optimal control problems as this increase in damping typically does not
significantly effect the musculotendon dynamics but does have been empirically
found to significantly improve the numerical conditioning of the equations.</p>
</section>
</section>
<section id="musculotendon-dynamics">
<h2>Musculotendon Dynamics<a class="headerlink" href="#musculotendon-dynamics" title="Link to this heading">¶</a></h2>
<section id="rigid-tendon-dynamics">
<h3>Rigid Tendon Dynamics<a class="headerlink" href="#rigid-tendon-dynamics" title="Link to this heading">¶</a></h3>
<p>Rigid tendon musculotendon dynamics are reasonably straightforward to implement
because the inextensible tendon allows for the normalized muscle fiber length
to be expressed directly in terms of musculotendon length. With the inextensible
tendon <span class="math notranslate nohighlight">\(l^T = l^T_{slack}\)</span> and as such, normalized tendon length
is just unity, <span class="math notranslate nohighlight">\(\tilde{l}^T = 1\)</span>. Using trigonometry, muscle fiber length
can be expressed as</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[l^M = \sqrt{\left(l^{MT} - l^T\right)^2 + \left(l^M_{opt} \sin{\alpha_{opt}} \right)^2}\]</div>
</div>
<p>where <span class="math notranslate nohighlight">\(\alpha_{opt}\)</span> is the “optimal pennation angle”, another constant
property of a musculotendon that describes the pennation angle (the angle of
the muscle fibers relative to the direction parallel to the tendon) at which
<span class="math notranslate nohighlight">\(l^M = l^M_{opt}\)</span>. A common simplifying assumption is to assume
<span class="math notranslate nohighlight">\(\alpha_{opt} = 0\)</span>, which simplifies the above to</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[l^M = \sqrt{\left(l^{MT} - l^T\right)^2 + \left(l^M_{opt}\right)^2}\]</div>
</div>
<p>With <span class="math notranslate nohighlight">\(\tilde{l}^M = \frac{l^M}{l^M_{opt}}\)</span>, the muscle fiber velocity can
be expressed as</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[v^M = v^{MT} \frac{l^{MT} - l^T_{slack}}{l^M}\]</div>
</div>
<p>Muscle fiber can be normalized as before,
<span class="math notranslate nohighlight">\(\tilde{v}^M = \frac{v^M}{v^M_{max}}\)</span>. Using the curves described above,
we can express the normalized muscle fiber force (<span class="math notranslate nohighlight">\(\tilde{F}^M\)</span>) can be
expressed as a function of normalized tendon length (<span class="math notranslate nohighlight">\(\tilde{l}^T\)</span>),
normalized fiber length (<span class="math notranslate nohighlight">\(\tilde{l}^M\)</span>), normalized fiber velocity
(<span class="math notranslate nohighlight">\(\tilde{v}^M\)</span>), and activation (<span class="math notranslate nohighlight">\(a\)</span>):</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[\tilde{F}^M = a \cdot fl^M_{act}\left(\tilde{l}^M\right) \cdot fv^M\left(\tilde{v}^M\right) + fl^M_{pas}\left(\tilde{l}^M\right) + \beta \cdot \tilde{v}^M\]</div>
</div>
<p>We introduce a new constant, <span class="math notranslate nohighlight">\(F^M_{max}\)</span>, the “maximum isometric force”,
which describes the maximum force that a musculotendon can produce under full
activation and an isometric (<span class="math notranslate nohighlight">\(v^M = 0\)</span>) contraction. Accounting for the
pennation angle, the tendon force (<span class="math notranslate nohighlight">\(F^T\)</span>), which is the force applied to
the skeleton at the musculotendon’s origin and insertion, can be expressed as:</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[F^T = F^M_{max} \cdot F^M \cdot \sqrt{1 - \sin{\alpha_{opt}}^2}\]</div>
</div>
<p>We can describe all of this using SymPy and the musculotendon curve classes that
we introduced above. We will need time-varying dynamics symbols for
<span class="math notranslate nohighlight">\(l^{MT}\)</span>, <span class="math notranslate nohighlight">\(v_{MT}\)</span>, and <span class="math notranslate nohighlight">\(a\)</span>. We will also need constant
symbols for <span class="math notranslate nohighlight">\(l^T_{slack}\)</span>, <span class="math notranslate nohighlight">\(l^M_{opt}\)</span>, <span class="math notranslate nohighlight">\(F^M_{max}\)</span>,
<span class="math notranslate nohighlight">\(v^M_{max}\)</span>, <span class="math notranslate nohighlight">\(\alpha_{opt}\)</span>, and <span class="math notranslate nohighlight">\(\beta\)</span>.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">l_MT</span><span class="p">,</span> <span class="n">v_MT</span><span class="p">,</span> <span class="n">a</span> <span class="o">=</span> <span class="n">me</span><span class="o">.</span><span class="n">dynamicsymbols</span><span class="p">(</span><span class="s1">&#39;l_MT, v_MT, a&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">l_T_slack</span><span class="p">,</span> <span class="n">l_M_opt</span><span class="p">,</span> <span class="n">F_M_max</span> <span class="o">=</span> <span class="n">sm</span><span class="o">.</span><span class="n">symbols</span><span class="p">(</span><span class="s1">&#39;l_T_slack, l_M_opt, F_M_max&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">v_M_max</span><span class="p">,</span> <span class="n">alpha_opt</span><span class="p">,</span> <span class="n">beta</span> <span class="o">=</span> <span class="n">sm</span><span class="o">.</span><span class="n">symbols</span><span class="p">(</span><span class="s1">&#39;v_M_max, alpha_opt, beta&#39;</span><span class="p">)</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">l_M</span> <span class="o">=</span> <span class="n">sm</span><span class="o">.</span><span class="n">sqrt</span><span class="p">((</span><span class="n">l_MT</span> <span class="o">-</span> <span class="n">l_T_slack</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="p">(</span><span class="n">l_M_opt</span><span class="o">*</span><span class="n">sm</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">alpha_opt</span><span class="p">))</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">l_M</span>
<span class="go">sqrt(l_M_opt**2*sin(alpha_opt)**2 + (-l_T_slack + l_MT(t))**2)</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">v_M</span> <span class="o">=</span> <span class="n">v_MT</span><span class="o">*</span><span class="p">(</span><span class="n">l_MT</span> <span class="o">-</span> <span class="n">l_T_slack</span><span class="p">)</span><span class="o">/</span><span class="n">l_M</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">v_M</span>
<span class="go">(-l_T_slack + l_MT(t))*v_MT(t)/sqrt(l_M_opt**2*sin(alpha_opt)**2 + (-l_T_slack + l_MT(t))**2)</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">fl_M_pas</span> <span class="o">=</span> <span class="n">FiberForceLengthPassiveDeGroote2016</span><span class="o">.</span><span class="n">with_defaults</span><span class="p">(</span><span class="n">l_M</span><span class="o">/</span><span class="n">l_M_opt</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fl_M_pas</span>
<span class="go">FiberForceLengthPassiveDeGroote2016(sqrt(l_M_opt**2*sin(alpha_opt)**2 + (-l_T_slack + l_MT(t))**2)/l_M_opt, 0.6, 4.0)</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">fl_M_act</span> <span class="o">=</span> <span class="n">FiberForceLengthActiveDeGroote2016</span><span class="o">.</span><span class="n">with_defaults</span><span class="p">(</span><span class="n">l_M</span><span class="o">/</span><span class="n">l_M_opt</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fl_M_act</span>
<span class="go">FiberForceLengthActiveDeGroote2016(sqrt(l_M_opt**2*sin(alpha_opt)**2 + (-l_T_slack + l_MT(t))**2)/l_M_opt, 0.814, 1.06, 0.162, 0.0633, 0.433, 0.717, -0.0299, 0.2, 0.1, 1.0, 0.354, 0.0)</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">fv_M</span> <span class="o">=</span> <span class="n">FiberForceVelocityDeGroote2016</span><span class="o">.</span><span class="n">with_defaults</span><span class="p">(</span><span class="n">v_M</span><span class="o">/</span><span class="n">v_M_max</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fv_M</span>
<span class="go">FiberForceVelocityDeGroote2016((-l_T_slack + l_MT(t))*v_MT(t)/(v_M_max*sqrt(l_M_opt**2*sin(alpha_opt)**2 + (-l_T_slack + l_MT(t))**2)), -0.318, -8.149, -0.374, 0.886)</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">F_M</span> <span class="o">=</span> <span class="n">a</span><span class="o">*</span><span class="n">fl_M_act</span><span class="o">*</span><span class="n">fv_M</span> <span class="o">+</span> <span class="n">fl_M_pas</span> <span class="o">+</span> <span class="n">beta</span><span class="o">*</span><span class="n">v_M</span><span class="o">/</span><span class="n">v_M_max</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">F_M</span>
<span class="go">beta*(-l_T_slack + l_MT(t))*v_MT(t)/(v_M_max*sqrt(l_M_opt**2*sin(alpha_opt)**2 + (-l_T_slack + l_MT(t))**2)) + a(t)*FiberForceLengthActiveDeGroote2016(sqrt(l_M_opt**2*sin(alpha_opt)**2 + (-l_T_slack + l_MT(t))**2)/l_M_opt, 0.814, 1.06, 0.162, 0.0633, 0.433, 0.717, -0.0299, 0.2, 0.1, 1.0, 0.354, 0.0)*FiberForceVelocityDeGroote2016((-l_T_slack + l_MT(t))*v_MT(t)/(v_M_max*sqrt(l_M_opt**2*sin(alpha_opt)**2 + (-l_T_slack + l_MT(t))**2)), -0.318, -8.149, -0.374, 0.886) + FiberForceLengthPassiveDeGroote2016(sqrt(l_M_opt**2*sin(alpha_opt)**2 + (-l_T_slack + l_MT(t))**2)/l_M_opt, 0.6, 4.0)</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">F_T</span> <span class="o">=</span> <span class="n">F_M_max</span><span class="o">*</span><span class="n">F_M</span><span class="o">*</span><span class="n">sm</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">sm</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">alpha_opt</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">F_T</span>
<span class="go">F_M_max*sqrt(1 - sin(alpha_opt)**2)*(beta*(-l_T_slack + l_MT(t))*v_MT(t)/(v_M_max*sqrt(l_M_opt**2*sin(alpha_opt)**2 + (-l_T_slack + l_MT(t))**2)) + a(t)*FiberForceLengthActiveDeGroote2016(sqrt(l_M_opt**2*sin(alpha_opt)**2 + (-l_T_slack + l_MT(t))**2)/l_M_opt, 0.814, 1.06, 0.162, 0.0633, 0.433, 0.717, -0.0299, 0.2, 0.1, 1.0, 0.354, 0.0)*FiberForceVelocityDeGroote2016((-l_T_slack + l_MT(t))*v_MT(t)/(v_M_max*sqrt(l_M_opt**2*sin(alpha_opt)**2 + (-l_T_slack + l_MT(t))**2)), -0.318, -8.149, -0.374, 0.886) + FiberForceLengthPassiveDeGroote2016(sqrt(l_M_opt**2*sin(alpha_opt)**2 + (-l_T_slack + l_MT(t))**2)/l_M_opt, 0.6, 4.0))</span>
</pre></div>
</div>
<p>SymPy offers this implementation of rigid tendon dynamics in the
<a class="reference internal" href="../../../../modules/physics/biomechanics/api/musculotendon.html#sympy.physics.biomechanics.musculotendon.MusculotendonDeGroote2016" title="sympy.physics.biomechanics.musculotendon.MusculotendonDeGroote2016"><code class="xref py py-obj docutils literal notranslate"><span class="pre">MusculotendonDeGroote2016</span></code></a> class,
a full demonstration of which is shown below when we will construct a complete
simple musculotendon model.</p>
</section>
<section id="elastic-tendon-dynamics">
<h3>Elastic Tendon Dynamics<a class="headerlink" href="#elastic-tendon-dynamics" title="Link to this heading">¶</a></h3>
<p>Elastic tendon dynamics are more complicated as we cannot directly express fiber
length in terms of musculotendon length due to tendon length varying. Instead,
we have to related the forces experienced in the tendon to the forces produced
by the muscle fibers, ensuring that the two are in equilibrium. We cannot do
this without introducing an additional state variable into the musculotendon
dynamics, and thus an additional first-order ordinary differential equation.
There are many choices that we can make for this state, but perhaps one of the
most intuitive is to use <span class="math notranslate nohighlight">\(\tilde{l}^M\)</span>. With this we will need to both
create an expression for the tendon force (<span class="math notranslate nohighlight">\(F^T\)</span>) as well as the
first-order ordinary differential equation for <span class="math notranslate nohighlight">\(\frac{d \tilde{l}^M}{dt}\)</span>.
<span class="math notranslate nohighlight">\(l^M\)</span>, <span class="math notranslate nohighlight">\(l^T\)</span>, and <span class="math notranslate nohighlight">\(\tilde{l}^T\)</span> can be calculated similar to with
rigid tendon dynamics, remembering that we already have <span class="math notranslate nohighlight">\(\tilde{l}^M\)</span>
available as a know value due to it being a state variable.</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[\begin{split}l^M &amp;= \tilde{l}^M \cdot l^M_{opt} \\
l^T &amp;= l^{MT} - \sqrt{\left(l^M\right)^2 - \left(l^M_{opt} \sin{\alpha_{opt}}\right)^2} \\
\tilde{l}^T &amp;= \frac{l^T}{l^T_{slack}}\end{split}\]</div>
</div>
<p>Using <span class="math notranslate nohighlight">\(\tilde{l}^T\)</span> and the tendon force-length curve
(<span class="math notranslate nohighlight">\(fl^T\left(\tilde{l}^T\right)\)</span>), we can write an equation for the
normalized and absolte tendon force:</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[\begin{split}\tilde{F}^T &amp;= fl^T\left(\tilde{l}^T\right) \\
F^T &amp;= F^M_{max} \cdot \tilde{F}^T\end{split}\]</div>
</div>
<p>To express <span class="math notranslate nohighlight">\(F^M\)</span> we need to know the cosine of the pennation angle
(<span class="math notranslate nohighlight">\(\cos{\alpha}\)</span>). We can use trigonometry to write an equation for this:</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[\begin{split}\cos{\alpha} &amp;= \frac{l^{MT} - l^T}{l^M} \\
F^M &amp;= \frac{F^T}{\cos{\alpha}}\end{split}\]</div>
</div>
<p>If we assume that the damping coefficient <span class="math notranslate nohighlight">\(\beta = 0\)</span>, we can rearrange
the muscle fiber force equation:</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[\tilde{F}^M = a \cdot fl^M_{act}\left(\tilde{l}^M\right) \cdot fv^M\left(\tilde{v}^M\right) + fl^M_{pas}\left(\tilde{l}^M\right) + \beta \cdot \tilde{v}^M\]</div>
</div>
<p>to give <span class="math notranslate nohighlight">\(fv^M\left(\tilde{v}^M\right)\)</span>:</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[fv^M\left(\tilde{v}^M\right) = \frac{\tilde{F}^M - fl^M_{pas}\left(\tilde{l}^M\right)}{a \cdot fl^M_{act}\left(\tilde{l}^M\right)}\]</div>
</div>
<p>Using the inverse fiber force-velocity curve,
<span class="math notranslate nohighlight">\(\left[fv^M\left(\tilde{v}^M\right)\right]^{-1}\)</span>, and differentiating
<span class="math notranslate nohighlight">\(\tilde{l}^M\)</span> with respect to time, we can finally write an equation for
<span class="math notranslate nohighlight">\(\frac{d \tilde{l}^M}{dt}\)</span>:</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[\frac{d \tilde{l}^M}{dt} = \frac{v^M_{max}}{l^M_{opt}} \tilde{v}^M\]</div>
</div>
<p>To formulate these elastic tendon musculotendon dynamics, we had to assume that
<span class="math notranslate nohighlight">\(\beta = 0\)</span>, which is suboptimal in forward simulations and optimal
control problems. It is possible to formulate elastic tendon musculotendon
dynamics with damping, but this requires a more complicated formulation with an
additional input variable in addition to an additional state variable, and as
such the musculotendon dynamics must be enforced as a differential algebraic
equation rather than an ordinary differential equation. The specifics of these
types of formulation will not be discussed here, but the interested reader can
refer to the docstrings of the
<a class="reference internal" href="../../../../modules/physics/biomechanics/api/musculotendon.html#sympy.physics.biomechanics.musculotendon.MusculotendonDeGroote2016" title="sympy.physics.biomechanics.musculotendon.MusculotendonDeGroote2016"><code class="xref py py-obj docutils literal notranslate"><span class="pre">MusculotendonDeGroote2016</span></code></a> where
they are implemented.</p>
</section>
</section>
<section id="a-simple-musculotendon-model">
<h2>A Simple Musculotendon Model<a class="headerlink" href="#a-simple-musculotendon-model" title="Link to this heading">¶</a></h2>
<p>To demonstrate a muscle’s effect on a simple system, we can model a particle of
mass <span class="math notranslate nohighlight">\(m\)</span> under the influence of gravity with a muscle pulling the mass
against gravity. The mass <span class="math notranslate nohighlight">\(m\)</span> has a single generalized coordinate
<span class="math notranslate nohighlight">\(q\)</span> and generalized speed <span class="math notranslate nohighlight">\(u\)</span> to describe its position and motion.
The following code establishes the kinematics and gravitational force and an
associated particle:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">pprint</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">sympy</span> <span class="k">as</span> <span class="nn">sm</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">sympy.physics.mechanics</span> <span class="k">as</span> <span class="nn">me</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">q</span><span class="p">,</span> <span class="n">u</span> <span class="o">=</span> <span class="n">me</span><span class="o">.</span><span class="n">dynamicsymbols</span><span class="p">(</span><span class="s1">&#39;q, u&#39;</span><span class="p">,</span> <span class="n">real</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">m</span><span class="p">,</span> <span class="n">g</span> <span class="o">=</span> <span class="n">sm</span><span class="o">.</span><span class="n">symbols</span><span class="p">(</span><span class="s1">&#39;m, g&#39;</span><span class="p">,</span> <span class="n">real</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">positive</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">N</span> <span class="o">=</span> <span class="n">me</span><span class="o">.</span><span class="n">ReferenceFrame</span><span class="p">(</span><span class="s1">&#39;N&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">O</span><span class="p">,</span> <span class="n">P</span> <span class="o">=</span> <span class="n">sm</span><span class="o">.</span><span class="n">symbols</span><span class="p">(</span><span class="s1">&#39;O, P&#39;</span><span class="p">,</span> <span class="bp">cls</span><span class="o">=</span><span class="n">me</span><span class="o">.</span><span class="n">Point</span><span class="p">)</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">P</span><span class="o">.</span><span class="n">set_pos</span><span class="p">(</span><span class="n">O</span><span class="p">,</span> <span class="n">q</span><span class="o">*</span><span class="n">N</span><span class="o">.</span><span class="n">x</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">O</span><span class="o">.</span><span class="n">set_vel</span><span class="p">(</span><span class="n">N</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">P</span><span class="o">.</span><span class="n">set_vel</span><span class="p">(</span><span class="n">N</span><span class="p">,</span> <span class="n">u</span><span class="o">*</span><span class="n">N</span><span class="o">.</span><span class="n">x</span><span class="p">)</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">gravity</span> <span class="o">=</span> <span class="n">me</span><span class="o">.</span><span class="n">Force</span><span class="p">(</span><span class="n">P</span><span class="p">,</span> <span class="n">m</span><span class="o">*</span><span class="n">g</span><span class="o">*</span><span class="n">N</span><span class="o">.</span><span class="n">x</span><span class="p">)</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">block</span> <span class="o">=</span> <span class="n">me</span><span class="o">.</span><span class="n">Particle</span><span class="p">(</span><span class="s1">&#39;block&#39;</span><span class="p">,</span> <span class="n">P</span><span class="p">,</span> <span class="n">m</span><span class="p">)</span>
</pre></div>
</div>
<p>SymPy Biomechanics includes musculotendon actuator models. Here we will use a
specific musculotendon model implementation. A musculotendon actuator is
instantiated with two input components, the pathway and the activation dynamics
model. The actuator must act along a pathway that connects the origin and
insertion points of the muscle. Our origin will attach to the fixed point
<span class="math notranslate nohighlight">\(O\)</span> and insert on the moving particle <span class="math notranslate nohighlight">\(P\)</span>.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sympy.physics.mechanics.pathway</span> <span class="kn">import</span> <span class="n">LinearPathway</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">muscle_pathway</span> <span class="o">=</span> <span class="n">LinearPathway</span><span class="p">(</span><span class="n">O</span><span class="p">,</span> <span class="n">P</span><span class="p">)</span>
</pre></div>
</div>
<p>A pathway has attachment points:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">muscle_pathway</span><span class="o">.</span><span class="n">attachments</span>
<span class="go">(O, P)</span>
</pre></div>
</div>
<p>and knows the length between the end attachment points as well as the relative
speed between the two attachment points:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">muscle_pathway</span><span class="o">.</span><span class="n">length</span>
<span class="go">Abs(q(t))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">muscle_pathway</span><span class="o">.</span><span class="n">extension_velocity</span>
<span class="go">sign(q(t))*Derivative(q(t), t)</span>
</pre></div>
</div>
<p>Finally, the pathway can determine the forces acting on the two attachment
points give a force magnitude:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">muscle_pathway</span><span class="o">.</span><span class="n">to_loads</span><span class="p">(</span><span class="n">m</span><span class="o">*</span><span class="n">g</span><span class="p">)</span>
<span class="go">[(O, - g*m*q(t)/Abs(q(t))*N.x), (P, g*m*q(t)/Abs(q(t))*N.x)]</span>
</pre></div>
</div>
<p>The activation dynamics model represents a set of algebraic or ordinary
differential equations that relate the muscle excitation to the muscle
activation. In our case, we will use a first order ordinary differential
equation that gives a smooth, but delayed activation <span class="math notranslate nohighlight">\(a(t)\)</span> from the
excitation <span class="math notranslate nohighlight">\(e(t)\)</span>.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sympy.physics.biomechanics</span> <span class="kn">import</span> <span class="n">FirstOrderActivationDeGroote2016</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">muscle_activation</span> <span class="o">=</span> <span class="n">FirstOrderActivationDeGroote2016</span><span class="o">.</span><span class="n">with_defaults</span><span class="p">(</span><span class="s1">&#39;muscle&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>The activation model has a state variable <span class="math notranslate nohighlight">\(\mathbf{x}\)</span>, input variable
<span class="math notranslate nohighlight">\(\mathbf{r}\)</span>, and some constant parameters <span class="math notranslate nohighlight">\(\mathbf{p}\)</span>:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">muscle_activation</span><span class="o">.</span><span class="n">x</span>
<span class="go">Matrix([[a_muscle(t)]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">muscle_activation</span><span class="o">.</span><span class="n">r</span>
<span class="go">Matrix([[e_muscle(t)]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">muscle_activation</span><span class="o">.</span><span class="n">p</span>
<span class="go">Matrix(0, 1, [])</span>
</pre></div>
</div>
<p>Note that the return value for the constants parameters is empty. If we had
instantiated
<a class="reference internal" href="../../../../modules/physics/biomechanics/api/activation.html#sympy.physics.biomechanics.activation.FirstOrderActivationDeGroote2016" title="sympy.physics.biomechanics.activation.FirstOrderActivationDeGroote2016"><code class="xref py py-obj docutils literal notranslate"><span class="pre">FirstOrderActivationDeGroote2016</span></code></a>
normally then we would have had to supply three values for <span class="math notranslate nohighlight">\(\tau_{a}\)</span>,
<span class="math notranslate nohighlight">\(\tau_{d}\)</span>, and <span class="math notranslate nohighlight">\(b\)</span>. If these had been <a class="reference internal" href="../../../../modules/core.html#sympy.core.symbol.Symbol" title="sympy.core.symbol.Symbol"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Symbol</span></code></a>
objects then these would have shown up in the returned
<a class="reference internal" href="../../../../modules/matrices/dense.html#sympy.matrices.dense.MutableDenseMatrix" title="sympy.matrices.dense.MutableDenseMatrix"><code class="xref py py-obj docutils literal notranslate"><span class="pre">MutableDenseMatrix</span></code></a>.</p>
<p>These are associated with its first order differential equation <span class="math notranslate nohighlight">\(\dot{a}
= f(a, e, t)\)</span>:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">muscle_activation</span><span class="o">.</span><span class="n">rhs</span><span class="p">()</span>
<span class="go">Matrix([[((1/2 - tanh(10.0*a_muscle(t) - 10.0*e_muscle(t))/2)/(0.0225*a_muscle(t) + 0.0075) + 16.6666666666667*(3*a_muscle(t)/2 + 1/2)*(tanh(10.0*a_muscle(t) - 10.0*e_muscle(t))/2 + 1/2))*(-a_muscle(t) + e_muscle(t))]])</span>
</pre></div>
</div>
<p>With the pathway and activation dynamics, the musculotendon model created using
them both and needs some parameters to define the muscle and tendon specific
properties. You need to specify the tendon slack length, peak isometric force,
optimal fiber length, maximal fiber velocity, optimal pennation angle, and
fiber damping coefficients.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sympy.physics.biomechanics</span> <span class="kn">import</span> <span class="n">MusculotendonDeGroote2016</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">F_M_max</span><span class="p">,</span> <span class="n">l_M_opt</span><span class="p">,</span> <span class="n">l_T_slack</span> <span class="o">=</span> <span class="n">sm</span><span class="o">.</span><span class="n">symbols</span><span class="p">(</span><span class="s1">&#39;F_M_max, l_M_opt, l_T_slack&#39;</span><span class="p">,</span> <span class="n">real</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">v_M_max</span><span class="p">,</span> <span class="n">alpha_opt</span><span class="p">,</span> <span class="n">beta</span> <span class="o">=</span> <span class="n">sm</span><span class="o">.</span><span class="n">symbols</span><span class="p">(</span><span class="s1">&#39;v_M_max, alpha_opt, beta&#39;</span><span class="p">,</span> <span class="n">real</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">muscle</span> <span class="o">=</span> <span class="n">MusculotendonDeGroote2016</span><span class="o">.</span><span class="n">with_defaults</span><span class="p">(</span>
<span class="gp">... </span>    <span class="s1">&#39;muscle&#39;</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">muscle_pathway</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">muscle_activation</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">tendon_slack_length</span><span class="o">=</span><span class="n">l_T_slack</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">peak_isometric_force</span><span class="o">=</span><span class="n">F_M_max</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">optimal_fiber_length</span><span class="o">=</span><span class="n">l_M_opt</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">maximal_fiber_velocity</span><span class="o">=</span><span class="n">v_M_max</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">optimal_pennation_angle</span><span class="o">=</span><span class="n">alpha_opt</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">fiber_damping_coefficient</span><span class="o">=</span><span class="n">beta</span><span class="p">,</span>
<span class="gp">... </span><span class="p">)</span>
<span class="gp">...</span>
</pre></div>
</div>
<p>Because this musculotendon actuator has a rigid tendon model, it has the same
state and ordinary differential equation as the activation model:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">muscle</span><span class="o">.</span><span class="n">musculotendon_dynamics</span>
<span class="go">0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">muscle</span><span class="o">.</span><span class="n">x</span>
<span class="go">Matrix([[a_muscle(t)]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">muscle</span><span class="o">.</span><span class="n">r</span>
<span class="go">Matrix([[e_muscle(t)]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">muscle</span><span class="o">.</span><span class="n">p</span>
<span class="go">Matrix([</span>
<span class="go">[l_T_slack],</span>
<span class="go">[  F_M_max],</span>
<span class="go">[  l_M_opt],</span>
<span class="go">[  v_M_max],</span>
<span class="go">[alpha_opt],</span>
<span class="go">[     beta]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">muscle</span><span class="o">.</span><span class="n">rhs</span><span class="p">()</span>
<span class="go">Matrix([[((1/2 - tanh(10.0*a_muscle(t) - 10.0*e_muscle(t))/2)/(0.0225*a_muscle(t) + 0.0075) + 16.6666666666667*(3*a_muscle(t)/2 + 1/2)*(tanh(10.0*a_muscle(t) - 10.0*e_muscle(t))/2 + 1/2))*(-a_muscle(t) + e_muscle(t))]])</span>
</pre></div>
</div>
<p>The musculotendon provides the extra ordinary differential equations as well as
the muscle specific forces applied to the pathway:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">muscle_loads</span> <span class="o">=</span> <span class="n">muscle</span><span class="o">.</span><span class="n">to_loads</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pprint</span><span class="o">.</span><span class="n">pprint</span><span class="p">(</span><span class="n">muscle_loads</span><span class="p">)</span>
<span class="go">[Force(point=O, force=F_M_max*(beta*(-l_T_slack + Abs(q(t)))*sign(q(t))*Derivative(q(t), t)/(v_M_max*sqrt(l_M_opt**2*sin(alpha_opt)**2 + (-l_T_slack + Abs(q(t)))**2)) + a_muscle(t)*FiberForceLengthActiveDeGroote2016(sqrt(l_M_opt**2*sin(alpha_opt)**2 + (-l_T_slack + Abs(q(t)))**2)/l_M_opt, 0.814, 1.06, 0.162, 0.0633, 0.433, 0.717, -0.0299, 0.2, 0.1, 1.0, 0.354, 0.0)*FiberForceVelocityDeGroote2016((-l_T_slack + Abs(q(t)))*sign(q(t))*Derivative(q(t), t)/(v_M_max*sqrt(l_M_opt**2*sin(alpha_opt)**2 + (-l_T_slack + Abs(q(t)))**2)), -0.318, -8.149, -0.374, 0.886) + FiberForceLengthPassiveDeGroote2016(sqrt(l_M_opt**2*sin(alpha_opt)**2 + (-l_T_slack + Abs(q(t)))**2)/l_M_opt, 0.6, 4.0))*q(t)*cos(alpha_opt)/Abs(q(t))*N.x),</span>
<span class="go"> Force(point=P, force=- F_M_max*(beta*(-l_T_slack + Abs(q(t)))*sign(q(t))*Derivative(q(t), t)/(v_M_max*sqrt(l_M_opt**2*sin(alpha_opt)**2 + (-l_T_slack + Abs(q(t)))**2)) + a_muscle(t)*FiberForceLengthActiveDeGroote2016(sqrt(l_M_opt**2*sin(alpha_opt)**2 + (-l_T_slack + Abs(q(t)))**2)/l_M_opt, 0.814, 1.06, 0.162, 0.0633, 0.433, 0.717, -0.0299, 0.2, 0.1, 1.0, 0.354, 0.0)*FiberForceVelocityDeGroote2016((-l_T_slack + Abs(q(t)))*sign(q(t))*Derivative(q(t), t)/(v_M_max*sqrt(l_M_opt**2*sin(alpha_opt)**2 + (-l_T_slack + Abs(q(t)))**2)), -0.318, -8.149, -0.374, 0.886) + FiberForceLengthPassiveDeGroote2016(sqrt(l_M_opt**2*sin(alpha_opt)**2 + (-l_T_slack + Abs(q(t)))**2)/l_M_opt, 0.6, 4.0))*q(t)*cos(alpha_opt)/Abs(q(t))*N.x)]</span>
</pre></div>
</div>
<p>These loads are made up of various functions that describe the length and
velocity relationships to the muscle fiber force.</p>
<p>Now that we have the forces that the muscles and tendons produce the equations
of motion of the system can be formed with, for example, Kane’s Method:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">kane</span> <span class="o">=</span> <span class="n">me</span><span class="o">.</span><span class="n">KanesMethod</span><span class="p">(</span><span class="n">N</span><span class="p">,</span> <span class="p">(</span><span class="n">q</span><span class="p">,),</span> <span class="p">(</span><span class="n">u</span><span class="p">,),</span> <span class="n">kd_eqs</span><span class="o">=</span><span class="p">(</span><span class="n">u</span> <span class="o">-</span> <span class="n">q</span><span class="o">.</span><span class="n">diff</span><span class="p">(),))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Fr</span><span class="p">,</span> <span class="n">Frs</span> <span class="o">=</span> <span class="n">kane</span><span class="o">.</span><span class="n">kanes_equations</span><span class="p">((</span><span class="n">block</span><span class="p">,),</span> <span class="p">(</span><span class="n">muscle_loads</span> <span class="o">+</span> <span class="p">[</span><span class="n">gravity</span><span class="p">]))</span>
</pre></div>
</div>
<p>The equations of motion are made up of the kinematical differential equation,
the dynamical differential equation (Newton’s Second Law), and the muscle
activation differential equation. The explicit form of each can be formed like
so:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">dqdt</span> <span class="o">=</span> <span class="n">u</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dudt</span> <span class="o">=</span> <span class="n">kane</span><span class="o">.</span><span class="n">forcing</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">/</span><span class="n">m</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dadt</span> <span class="o">=</span> <span class="n">muscle</span><span class="o">.</span><span class="n">rhs</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>
</pre></div>
</div>
<p>We can now create a numerical function that evaluates the equations of motion
given the state, inputs, and constant parameters. Start by listing each
symbolically:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">a</span> <span class="o">=</span> <span class="n">muscle</span><span class="o">.</span><span class="n">a</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">e</span> <span class="o">=</span> <span class="n">muscle</span><span class="o">.</span><span class="n">e</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">state</span> <span class="o">=</span> <span class="p">[</span><span class="n">q</span><span class="p">,</span> <span class="n">u</span><span class="p">,</span> <span class="n">a</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">inputs</span> <span class="o">=</span> <span class="p">[</span><span class="n">e</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">constants</span> <span class="o">=</span> <span class="p">[</span><span class="n">m</span><span class="p">,</span> <span class="n">g</span><span class="p">,</span> <span class="n">F_M_max</span><span class="p">,</span> <span class="n">l_M_opt</span><span class="p">,</span> <span class="n">l_T_slack</span><span class="p">,</span> <span class="n">v_M_max</span><span class="p">,</span> <span class="n">alpha_opt</span><span class="p">,</span> <span class="n">beta</span><span class="p">]</span>
</pre></div>
</div>
<p>Then the numerical function to evaluate the right hand side of the explicit
ordinary differential equations is:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">eval_eom</span> <span class="o">=</span> <span class="n">sm</span><span class="o">.</span><span class="n">lambdify</span><span class="p">((</span><span class="n">state</span><span class="p">,</span> <span class="n">inputs</span><span class="p">,</span> <span class="n">constants</span><span class="p">),</span> <span class="p">(</span><span class="n">dqdt</span><span class="p">,</span> <span class="n">dudt</span><span class="p">,</span> <span class="n">dadt</span><span class="p">))</span>
</pre></div>
</div>
<p>It will additionally be interesting to numerically evaluate the muscle force,
so create a function for it too:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">force</span> <span class="o">=</span> <span class="n">muscle</span><span class="o">.</span><span class="n">force</span><span class="o">.</span><span class="n">xreplace</span><span class="p">({</span><span class="n">q</span><span class="o">.</span><span class="n">diff</span><span class="p">():</span> <span class="n">u</span><span class="p">})</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">eval_force</span> <span class="o">=</span> <span class="n">sm</span><span class="o">.</span><span class="n">lambdify</span><span class="p">((</span><span class="n">state</span><span class="p">,</span> <span class="n">constants</span><span class="p">),</span> <span class="n">force</span><span class="p">)</span>
</pre></div>
</div>
<p>To test these functions we need some suitable numerical values. This muscle
will be able to produce a maximum force of 10 N to lift a mass of 0.5 kg:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">p_vals</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span>
<span class="gp">... </span>    <span class="mf">0.5</span><span class="p">,</span>  <span class="c1"># m [kg]</span>
<span class="gp">... </span>    <span class="mf">9.81</span><span class="p">,</span>  <span class="c1"># g [m/s/s]</span>
<span class="gp">... </span>    <span class="mf">10.0</span><span class="p">,</span>  <span class="c1"># F_M_max [N]</span>
<span class="gp">... </span>    <span class="mf">0.18</span><span class="p">,</span>  <span class="c1"># l_M_opt [m]</span>
<span class="gp">... </span>    <span class="mf">0.17</span><span class="p">,</span>  <span class="c1"># l_T_slack [m]</span>
<span class="gp">... </span>    <span class="mf">10.0</span><span class="p">,</span>  <span class="c1"># v_M_max [m/s]</span>
<span class="gp">... </span>    <span class="mf">0.0</span><span class="p">,</span>  <span class="c1"># alpha_opt</span>
<span class="gp">... </span>    <span class="mf">0.1</span><span class="p">,</span>  <span class="c1"># beta</span>
<span class="gp">... </span><span class="p">])</span>
<span class="gp">...</span>
</pre></div>
</div>
<p>Our tendon is rigid, so the length of the muscle will be
<span class="math notranslate nohighlight">\(q-l_{T_\textrm{slack}}\)</span> and we want to give an initial muscle length
near its force producing peak, so we choose <span class="math notranslate nohighlight">\(q_0=l_{M_\textrm{opt}} +
l_{T_\textrm{slack}}\)</span>. Let’s also give the muscle a small initial activation so
that it produces a non-zero force:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">x_vals</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span>
<span class="gp">... </span>    <span class="n">p_vals</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">+</span> <span class="n">p_vals</span><span class="p">[</span><span class="mi">4</span><span class="p">],</span>  <span class="c1"># q [m]</span>
<span class="gp">... </span>    <span class="mf">0.0</span><span class="p">,</span>  <span class="c1"># u [m/s]</span>
<span class="gp">... </span>    <span class="mf">0.1</span><span class="p">,</span>  <span class="c1"># a [unitless]</span>
<span class="gp">... </span><span class="p">])</span>
<span class="gp">...</span>
</pre></div>
</div>
<p>Set the excitation to 1.0 and test the numerical functions:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">r_vals</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span>
<span class="gp">... </span>    <span class="mf">1.0</span><span class="p">,</span>  <span class="c1"># e</span>
<span class="gp">... </span><span class="p">])</span>
<span class="gp">...</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">eval_eom</span><span class="p">(</span><span class="n">x_vals</span><span class="p">,</span> <span class="n">r_vals</span><span class="p">,</span> <span class="n">p_vals</span><span class="p">)</span>
<span class="go">(0.0, 7.817106179880225, 92.30769105034035)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">eval_force</span><span class="p">(</span><span class="n">x_vals</span><span class="p">,</span> <span class="n">p_vals</span><span class="p">)</span>
<span class="go">-0.9964469100598874</span>
</pre></div>
</div>
<p>The two functions work so we can now simulate this system to see if and how the
muscle lifts the mass:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="k">def</span> <span class="nf">eval_rhs</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
<span class="gp">...</span>
<span class="gp">... </span>    <span class="n">r</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">1.0</span><span class="p">])</span>
<span class="gp">...</span>
<span class="gp">... </span>    <span class="k">return</span> <span class="n">eval_eom</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">r</span><span class="p">,</span> <span class="n">p_vals</span><span class="p">)</span>
<span class="gp">...</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">scipy.integrate</span> <span class="kn">import</span> <span class="n">solve_ivp</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t0</span><span class="p">,</span> <span class="n">tf</span> <span class="o">=</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">6.0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">times</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">t0</span><span class="p">,</span> <span class="n">tf</span><span class="p">,</span> <span class="n">num</span><span class="o">=</span><span class="mi">601</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sol</span> <span class="o">=</span> <span class="n">solve_ivp</span><span class="p">(</span><span class="n">eval_rhs</span><span class="p">,</span>
<span class="gp">... </span>                <span class="p">(</span><span class="n">t0</span><span class="p">,</span> <span class="n">tf</span><span class="p">),</span>
<span class="gp">... </span>                <span class="n">x_vals</span><span class="p">,</span> <span class="n">t_eval</span><span class="o">=</span><span class="n">times</span><span class="p">)</span>
<span class="gp">...</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">sharex</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">_</span> <span class="o">=</span> <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">sol</span><span class="o">.</span><span class="n">t</span><span class="p">,</span> <span class="n">sol</span><span class="o">.</span><span class="n">y</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="n">p_vals</span><span class="p">[</span><span class="mi">4</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;length of muscle&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">_</span> <span class="o">=</span> <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Distance [m]&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">_</span> <span class="o">=</span> <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">sol</span><span class="o">.</span><span class="n">t</span><span class="p">,</span> <span class="n">sol</span><span class="o">.</span><span class="n">y</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="n">state</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">_</span> <span class="o">=</span> <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Speed [m/s]&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">_</span> <span class="o">=</span> <span class="n">axes</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">sol</span><span class="o">.</span><span class="n">t</span><span class="p">,</span> <span class="n">sol</span><span class="o">.</span><span class="n">y</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="n">state</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">_</span> <span class="o">=</span> <span class="n">axes</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Activation&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">_</span> <span class="o">=</span> <span class="n">axes</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">sol</span><span class="o">.</span><span class="n">t</span><span class="p">,</span> <span class="n">eval_force</span><span class="p">(</span><span class="n">sol</span><span class="o">.</span><span class="n">y</span><span class="p">,</span> <span class="n">p_vals</span><span class="p">)</span><span class="o">.</span><span class="n">T</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;force&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">_</span> <span class="o">=</span> <span class="n">axes</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Force [N]&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">_</span> <span class="o">=</span> <span class="n">axes</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Time [s]&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">_</span> <span class="o">=</span> <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">legend</span><span class="p">(),</span> <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">legend</span><span class="p">(),</span> <span class="n">axes</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">legend</span><span class="p">(),</span> <span class="n">axes</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
</pre></div>
</div>
<p>(<a class="reference download internal" download="" href="../../../../_downloads/adab2c544ad9d537a9f7726814a3db1b/biomechanics-34.png"><code class="xref download docutils literal notranslate"><span class="pre">png</span></code></a>, <a class="reference download internal" download="" href="../../../../_downloads/e02c667b5874e3ad500607ba0c19e45a/biomechanics-34.hires.png"><code class="xref download docutils literal notranslate"><span class="pre">hires.png</span></code></a>, <a class="reference download internal" download="" href="../../../../_downloads/9ae786c847d9ecd9aa665dd52ee79f4e/biomechanics-34.pdf"><code class="xref download docutils literal notranslate"><span class="pre">pdf</span></code></a>)</p>
<figure class="align-default">
<img alt="../../../../_images/biomechanics-34.png" class="plot-directive" src="../../../../_images/biomechanics-34.png" />
</figure>
<p>The muscle pulls the mass in opposition to gravity and damps out to an
equilibrium of 5 N.</p>
</section>
<section id="references">
<h2>References<a class="headerlink" href="#references" title="Link to this heading">¶</a></h2>
<div role="list" class="citation-list">
<div class="citation" id="degroote2016" role="doc-biblioentry">
<span class="label"><span class="fn-bracket">[</span>DeGroote2016<span class="fn-bracket">]</span></span>
<span class="backrefs">(<a role="doc-backlink" href="#id1">1</a>,<a role="doc-backlink" href="#id2">2</a>,<a role="doc-backlink" href="#id3">3</a>,<a role="doc-backlink" href="#id4">4</a>,<a role="doc-backlink" href="#id5">5</a>,<a role="doc-backlink" href="#id6">6</a>,<a role="doc-backlink" href="#id7">7</a>,<a role="doc-backlink" href="#id8">8</a>,<a role="doc-backlink" href="#id9">9</a>,<a role="doc-backlink" href="#id10">10</a>,<a role="doc-backlink" href="#id11">11</a>,<a role="doc-backlink" href="#id12">12</a>,<a role="doc-backlink" href="#id13">13</a>,<a role="doc-backlink" href="#id14">14</a>,<a role="doc-backlink" href="#id15">15</a>,<a role="doc-backlink" href="#id16">16</a>)</span>
<p>De Groote, F., Kinney, A. L., Rao, A. V., &amp; Fregly, B. J.,
Evaluation of direct collocation optimal control problem formulations for
solving the muscle redundancy problem, Annals of biomedical engineering,
44(10), (2016) pp. 2922-2936</p>
</div>
</div>
</section>
</section>

        </article>
      </div>
      <footer>
        
        <div class="related-pages">
          <a class="next-page" href="../../../special_topics/index.html">
              <div class="page-info">
                <div class="context">
                  <span>Next</span>
                </div>
                <div class="title">SymPy Special Topics</div>
              </div>
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
            </a>
          <a class="prev-page" href="index.html">
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
              <div class="page-info">
                <div class="context">
                  <span>Previous</span>
                </div>
                
                <div class="title">Biomechanics</div>
                
              </div>
            </a>
        </div>
        <div class="bottom-of-page">
          <div class="left-details">
            <div class="copyright">
                Copyright &#169; 2024 SymPy Development Team
            </div>
            Made with <a href="https://www.sphinx-doc.org/">Sphinx</a> and <a class="muted-link" href="https://pradyunsg.me">@pradyunsg</a>'s
            
            <a href="https://github.com/pradyunsg/furo">Furo</a>
            <div class="last-updated">
              Last updated on Oct 16, 2024</div>
          </div>
          <div class="right-details">
            <div class="icons">
              <a class="muted-link " href="https://github.com/sympy/sympy" aria-label="GitHub">
                <svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 16 16">
                    <path fill-rule="evenodd" d="M8 0C3.58 0 0 3.58 0 8c0 3.54 2.29 6.53 5.47 7.59.4.07.55-.17.55-.38 0-.19-.01-.82-.01-1.49-2.01.37-2.53-.49-2.69-.94-.09-.23-.48-.94-.82-1.13-.28-.15-.68-.52-.01-.53.63-.01 1.08.58 1.23.82.72 1.21 1.87.87 2.33.66.07-.52.28-.87.51-1.07-1.78-.2-3.64-.89-3.64-3.95 0-.87.31-1.59.82-2.15-.08-.2-.36-1.02.08-2.12 0 0 .67-.21 2.2.82.64-.18 1.32-.27 2-.27.68 0 1.36.09 2 .27 1.53-1.04 2.2-.82 2.2-.82.44 1.1.16 1.92.08 2.12.51.56.82 1.27.82 2.15 0 3.07-1.87 3.75-3.65 3.95.29.25.54.73.54 1.48 0 1.07-.01 1.93-.01 2.2 0 .21.15.46.55.38A8.013 8.013 0 0 0 16 8c0-4.42-3.58-8-8-8z"></path>
                </svg>
            </a>
              
            </div>
          </div>
        </div>
        
      </footer>
    </div>
    <aside class="toc-drawer">
      
      
      <div class="toc-sticky toc-scroll">
        <div class="toc-title-container">
          <span class="toc-title">
            On this page
          </span>
        </div>
        <div class="toc-tree-container">
          <div class="toc-tree">
            <ul>
<li><a class="reference internal" href="#">Introduction to Biomechanical Modeling</a><ul>
<li><a class="reference internal" href="#loads">Loads</a></li>
<li><a class="reference internal" href="#pathways">Pathways</a></li>
<li><a class="reference internal" href="#wrapping-geometries">Wrapping Geometries</a></li>
<li><a class="reference internal" href="#actuators">Actuators</a></li>
<li><a class="reference internal" href="#activation-dynamics">Activation Dynamics</a><ul>
<li><a class="reference internal" href="#zeroth-order">Zeroth-Order</a></li>
<li><a class="reference internal" href="#first-order">First-Order</a></li>
<li><a class="reference internal" href="#custom">Custom</a></li>
</ul>
</li>
<li><a class="reference internal" href="#musculotendon-curves">Musculotendon Curves</a><ul>
<li><a class="reference internal" href="#tendon-force-length">Tendon Force-Length</a></li>
<li><a class="reference internal" href="#fiber-passive-force-length">Fiber Passive Force-Length</a></li>
<li><a class="reference internal" href="#fiber-active-force-length">Fiber Active Force-Length</a></li>
<li><a class="reference internal" href="#fiber-force-velocity">Fiber Force-Velocity</a></li>
<li><a class="reference internal" href="#fiber-damping">Fiber Damping</a></li>
</ul>
</li>
<li><a class="reference internal" href="#musculotendon-dynamics">Musculotendon Dynamics</a><ul>
<li><a class="reference internal" href="#rigid-tendon-dynamics">Rigid Tendon Dynamics</a></li>
<li><a class="reference internal" href="#elastic-tendon-dynamics">Elastic Tendon Dynamics</a></li>
</ul>
</li>
<li><a class="reference internal" href="#a-simple-musculotendon-model">A Simple Musculotendon Model</a></li>
<li><a class="reference internal" href="#references">References</a></li>
</ul>
</li>
</ul>

          </div>
        </div>
      </div>
      
      
    </aside>
  </div>
</div><script src="../../../../_static/jquery.js?v=5d32c60e"></script>
    <script src="../../../../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
    <script src="../../../../_static/documentation_options.js?v=95b44b65"></script>
    <script src="../../../../_static/doctools.js?v=9bcbadda"></script>
    <script src="../../../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../../../../_static/scripts/furo.js?v=5fa4622c"></script>
    <script src="../../../../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../../../../_static/copybutton.js?v=30646c52"></script>
    <script>window.MathJax = {"tex": {"inlineMath": [["\\(", "\\)"]], "displayMath": [["\\[", "\\]"]]}, "options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    </body>
</html>