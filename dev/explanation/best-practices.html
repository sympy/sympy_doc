<!doctype html>
<html class="no-js" lang="en" data-content_root="../">
  <head><meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width,initial-scale=1"/>
    <meta name="color-scheme" content="light dark"><meta name="viewport" content="width=device-width, initial-scale=1" />
<link rel="index" title="Index" href="../genindex.html" /><link rel="search" title="Search" href="../search.html" /><link rel="next" title="Gotchas and Pitfalls" href="gotchas.html" /><link rel="prev" title="Explanations" href="index.html" />
        <link rel="canonical" href="https://docs.sympy.org/latest/explanation/best-practices.html" />

    <link rel="shortcut icon" href="../_static/sympy-notailtext-favicon.ico"/><!-- Generated with Sphinx 7.3.7 and Furo 2024.05.06 -->
        <title>Best Practices - SymPy 1.14.dev documentation</title>
      <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=16cf08d2" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/furo.css?v=387cc868" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../_static/graphviz.css?v=fd3f3429" />
    <link rel="stylesheet" type="text/css" href="../_static/plot_directive.css" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/furo-extensions.css?v=36a5483c" />
    <link rel="stylesheet" type="text/css" href="../_static/custom.css?v=30c876b7" />
    
    


<style>
  body {
    --color-code-background: #eeffcc;
  --color-code-foreground: black;
  --color-brand-primary: #52833A;
  --color-brand-content: #307748;
  --color-sidebar-background: #3B5526;
  --color-sidebar-background-border: var(--color-background-primary);
  --color-sidebar-link-text: #FFFFFF;
  --color-sidebar-brand-text: var(--color-sidebar-link-text--top-level);
  --color-sidebar-link-text--top-level: #FFFFFF;
  --color-sidebar-item-background--hover: var(--color-brand-primary);
  --color-sidebar-item-expander-background--hover: var(--color-brand-primary);
  --color-link-underline--hover: var(--color-link);
  --color-api-keyword: #000000bd;
  --color-api-name: var(--color-brand-content);
  --color-api-pre-name: var(--color-brand-content);
  --api-font-size: var(--font-size--normal);
  --color-foreground-secondary: #53555B;
  --color-admonition-title-background--seealso: #CCCCCC;
  --color-admonition-title--seealso: black;
  --color-admonition-title-background--note: #CCCCCC;
  --color-admonition-title--note: black;
  --color-admonition-title-background--warning: var(--color-problematic);
  --color-admonition-title--warning: white;
  --admonition-font-size: var(--font-size--normal);
  --admonition-title-font-size: var(--font-size--normal);
  --color-code-background: hsl(80deg 100% 95%);
  --code-font-size: var(--font-size--small);
  --font-stack--monospace: DejaVu Sans Mono,"SFMono-Regular",Menlo,Consolas,Monaco,Liberation Mono,Lucida Console,monospace;;
  
  }
  @media not print {
    body[data-theme="dark"] {
      --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  --color-brand-primary: #33CB33;
  --color-brand-content: #1DBD1D;
  --color-sidebar-background: #3B5526;
  --color-sidebar-background-border: var(--color-background-primary);
  --color-sidebar-link-text: #FFFFFF;
  --color-sidebar-brand-text: var(--color-sidebar-link-text--top-level);
  --color-sidebar-link-text--top-level: #FFFFFF;
  --color-sidebar-item-background--hover: #52833A;
  --color-sidebar-item-expander-background--hover: #52833A;
  --color-link-underline--hover: var(--color-link);
  --color-api-keyword: #FFFFFFbd;
  --color-api-name: var(--color-brand-content);
  --color-api-pre-name: var(--color-brand-content);
  --api-font-size: var(--font-size--normal);
  --color-foreground-secondary: #9DA1AC;
  --color-admonition-title-background--seealso: #555555;
  --color-admonition-title--seealso: black;
  --color-admonition-title-background--note: #555555;
  --color-admonition-title--note: black;
  --color-admonition-title-background--warning: var(--color-problematic);
  --color-admonition-title--warning: white;
  --admonition-font-size: var(--font-size--normal);
  --admonition-title-font-size: var(--font-size--normal);
  --color-code-background: hsl(80deg 100% 95%);
  --code-font-size: var(--font-size--small);
  --font-stack--monospace: DejaVu Sans Mono,"SFMono-Regular",Menlo,Consolas,Monaco,Liberation Mono,Lucida Console,monospace;;
  --color-api-overall: #FFFFFF90;
  --color-api-paren: #FFFFFF90;
  --color-problematic: #B30000;
  
    }
    @media (prefers-color-scheme: dark) {
      body:not([data-theme="light"]) {
        --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  --color-brand-primary: #33CB33;
  --color-brand-content: #1DBD1D;
  --color-sidebar-background: #3B5526;
  --color-sidebar-background-border: var(--color-background-primary);
  --color-sidebar-link-text: #FFFFFF;
  --color-sidebar-brand-text: var(--color-sidebar-link-text--top-level);
  --color-sidebar-link-text--top-level: #FFFFFF;
  --color-sidebar-item-background--hover: #52833A;
  --color-sidebar-item-expander-background--hover: #52833A;
  --color-link-underline--hover: var(--color-link);
  --color-api-keyword: #FFFFFFbd;
  --color-api-name: var(--color-brand-content);
  --color-api-pre-name: var(--color-brand-content);
  --api-font-size: var(--font-size--normal);
  --color-foreground-secondary: #9DA1AC;
  --color-admonition-title-background--seealso: #555555;
  --color-admonition-title--seealso: black;
  --color-admonition-title-background--note: #555555;
  --color-admonition-title--note: black;
  --color-admonition-title-background--warning: var(--color-problematic);
  --color-admonition-title--warning: white;
  --admonition-font-size: var(--font-size--normal);
  --admonition-title-font-size: var(--font-size--normal);
  --color-code-background: hsl(80deg 100% 95%);
  --code-font-size: var(--font-size--small);
  --font-stack--monospace: DejaVu Sans Mono,"SFMono-Regular",Menlo,Consolas,Monaco,Liberation Mono,Lucida Console,monospace;;
  --color-api-overall: #FFFFFF90;
  --color-api-paren: #FFFFFF90;
  --color-problematic: #B30000;
  
      }
    }
  }
</style></head>
  <body>
    
    <script>
      document.body.dataset.theme = localStorage.getItem("theme") || "auto";
    </script>
    

<svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
  <symbol id="svg-toc" viewBox="0 0 24 24">
    <title>Contents</title>
    <svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 1024 1024">
      <path d="M408 442h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8zm-8 204c0 4.4 3.6 8 8 8h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56zm504-486H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0 632H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM115.4 518.9L271.7 642c5.8 4.6 14.4.5 14.4-6.9V388.9c0-7.4-8.5-11.5-14.4-6.9L115.4 505.1a8.74 8.74 0 0 0 0 13.8z"/>
    </svg>
  </symbol>
  <symbol id="svg-menu" viewBox="0 0 24 24">
    <title>Menu</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-menu">
      <line x1="3" y1="12" x2="21" y2="12"></line>
      <line x1="3" y1="6" x2="21" y2="6"></line>
      <line x1="3" y1="18" x2="21" y2="18"></line>
    </svg>
  </symbol>
  <symbol id="svg-arrow-right" viewBox="0 0 24 24">
    <title>Expand</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-chevron-right">
      <polyline points="9 18 15 12 9 6"></polyline>
    </svg>
  </symbol>
  <symbol id="svg-sun" viewBox="0 0 24 24">
    <title>Light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="feather-sun">
      <circle cx="12" cy="12" r="5"></circle>
      <line x1="12" y1="1" x2="12" y2="3"></line>
      <line x1="12" y1="21" x2="12" y2="23"></line>
      <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
      <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
      <line x1="1" y1="12" x2="3" y2="12"></line>
      <line x1="21" y1="12" x2="23" y2="12"></line>
      <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
      <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
    </svg>
  </symbol>
  <symbol id="svg-moon" viewBox="0 0 24 24">
    <title>Dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-moon">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M12 3c.132 0 .263 0 .393 0a7.5 7.5 0 0 0 7.92 12.446a9 9 0 1 1 -8.313 -12.454z" />
    </svg>
  </symbol>
  <symbol id="svg-sun-half" viewBox="0 0 24 24">
    <title>Auto light/dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-shadow">
      <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
      <circle cx="12" cy="12" r="9" />
      <path d="M13 12h5" />
      <path d="M13 15h4" />
      <path d="M13 18h1" />
      <path d="M13 9h4" />
      <path d="M13 6h1" />
    </svg>
  </symbol>
  <symbol id="svg-sun-with-moon" viewBox="0 0 24 24">
    <title>Auto light/dark, in light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round"
      class="icon-custom-derived-from-feather-sun-and-tabler-moon">
      <path style="opacity: 50%" d="M 5.411 14.504 C 5.471 14.504 5.532 14.504 5.591 14.504 C 3.639 16.319 4.383 19.569 6.931 20.352 C 7.693 20.586 8.512 20.551 9.25 20.252 C 8.023 23.207 4.056 23.725 2.11 21.184 C 0.166 18.642 1.702 14.949 4.874 14.536 C 5.051 14.512 5.231 14.5 5.411 14.5 L 5.411 14.504 Z"/>
      <line x1="14.5" y1="3.25" x2="14.5" y2="1.25"/>
      <line x1="14.5" y1="15.85" x2="14.5" y2="17.85"/>
      <line x1="10.044" y1="5.094" x2="8.63" y2="3.68"/>
      <line x1="19" y1="14.05" x2="20.414" y2="15.464"/>
      <line x1="8.2" y1="9.55" x2="6.2" y2="9.55"/>
      <line x1="20.8" y1="9.55" x2="22.8" y2="9.55"/>
      <line x1="10.044" y1="14.006" x2="8.63" y2="15.42"/>
      <line x1="19" y1="5.05" x2="20.414" y2="3.636"/>
      <circle cx="14.5" cy="9.55" r="3.6"/>
    </svg>
  </symbol>
  <symbol id="svg-moon-with-sun" viewBox="0 0 24 24">
    <title>Auto light/dark, in dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round"
      class="icon-custom-derived-from-feather-sun-and-tabler-moon">
      <path d="M 8.282 7.007 C 8.385 7.007 8.494 7.007 8.595 7.007 C 5.18 10.184 6.481 15.869 10.942 17.24 C 12.275 17.648 13.706 17.589 15 17.066 C 12.851 22.236 5.91 23.143 2.505 18.696 C -0.897 14.249 1.791 7.786 7.342 7.063 C 7.652 7.021 7.965 7 8.282 7 L 8.282 7.007 Z"/>
      <line style="opacity: 50%" x1="18" y1="3.705" x2="18" y2="2.5"/>
      <line style="opacity: 50%" x1="18" y1="11.295" x2="18" y2="12.5"/>
      <line style="opacity: 50%" x1="15.316" y1="4.816" x2="14.464" y2="3.964"/>
      <line style="opacity: 50%" x1="20.711" y1="10.212" x2="21.563" y2="11.063"/>
      <line style="opacity: 50%" x1="14.205" y1="7.5" x2="13.001" y2="7.5"/>
      <line style="opacity: 50%" x1="21.795" y1="7.5" x2="23" y2="7.5"/>
      <line style="opacity: 50%" x1="15.316" y1="10.184" x2="14.464" y2="11.036"/>
      <line style="opacity: 50%" x1="20.711" y1="4.789" x2="21.563" y2="3.937"/>
      <circle style="opacity: 50%" cx="18" cy="7.5" r="2.169"/>
    </svg>
  </symbol>
  <symbol id="svg-pencil" viewBox="0 0 24 24">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-pencil-code">
      <path d="M4 20h4l10.5 -10.5a2.828 2.828 0 1 0 -4 -4l-10.5 10.5v4" />
      <path d="M13.5 6.5l4 4" />
      <path d="M20 21l2 -2l-2 -2" />
      <path d="M17 17l-2 2l2 2" /
    </svg>
  </symbol>
  <symbol id="svg-eye" viewBox="0 0 24 24">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-eye-code">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M10 12a2 2 0 1 0 4 0a2 2 0 0 0 -4 0" />
      <path
        d="M11.11 17.958c-3.209 -.307 -5.91 -2.293 -8.11 -5.958c2.4 -4 5.4 -6 9 -6c3.6 0 6.6 2 9 6c-.21 .352 -.427 .688 -.647 1.008" />
      <path d="M20 21l2 -2l-2 -2" />
      <path d="M17 17l-2 2l2 2" />
    </svg>
  </symbol>
</svg>

<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation">
<input type="checkbox" class="sidebar-toggle" name="__toc" id="__toc">
<label class="overlay sidebar-overlay" for="__navigation">
  <div class="visually-hidden">Hide navigation sidebar</div>
</label>
<label class="overlay toc-overlay" for="__toc">
  <div class="visually-hidden">Hide table of contents sidebar</div>
</label>

<a class="skip-to-content muted-link" href="#furo-main-content">Skip to content</a>



<div class="page">
  <header class="mobile-header">
    <div class="header-left">
      <label class="nav-overlay-icon" for="__navigation">
        <div class="visually-hidden">Toggle site navigation sidebar</div>
        <i class="icon"><svg><use href="#svg-menu"></use></svg></i>
      </label>
    </div>
    <div class="header-center">
      <a href="../index.html"><div class="brand">SymPy 1.14.dev documentation</div></a>
    </div>
    <div class="header-right">
      <div class="theme-toggle-container theme-toggle-header">
        <button class="theme-toggle">
          <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
          <svg class="theme-icon-when-auto-light"><use href="#svg-sun-with-moon"></use></svg>
          <svg class="theme-icon-when-auto-dark"><use href="#svg-moon-with-sun"></use></svg>
          <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
          <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
        </button>
      </div>
      <label class="toc-overlay-icon toc-header-icon" for="__toc">
        <div class="visually-hidden">Toggle table of contents sidebar</div>
        <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
      </label>
    </div>
  </header>
  <aside class="sidebar-drawer">
    <div class="sidebar-container">
      
      <div class="sidebar-sticky"><div class="sidebar-scroll"><a class="sidebar-brand" href="../index.html">
  
  <div class="sidebar-logo-container">
    <img class="sidebar-logo" src="../_static/sympylogo.png" alt="Logo"/>
  </div>
  
  <span class="sidebar-brand-text">SymPy 1.14.dev documentation</span>
  
</a><form class="sidebar-search-container" method="get" action="../search.html" role="search">
  <input class="sidebar-search" placeholder="Search" name="q" aria-label="Search">
  <input type="hidden" name="check_keywords" value="yes">
  <input type="hidden" name="area" value="default">
</form>
<div id="searchbox"></div><div class="sidebar-tree">
  <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../install.html">Installation</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../tutorials/index.html">Tutorials</a><input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" role="switch" type="checkbox"/><label for="toctree-checkbox-1"><div class="visually-hidden">Toggle navigation of Tutorials</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2 has-children"><a class="reference internal" href="../tutorials/intro-tutorial/index.html">Introductory Tutorial</a><input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" role="switch" type="checkbox"/><label for="toctree-checkbox-2"><div class="visually-hidden">Toggle navigation of Introductory Tutorial</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../tutorials/intro-tutorial/preliminaries.html">Preliminaries</a></li>
<li class="toctree-l3"><a class="reference internal" href="../tutorials/intro-tutorial/intro.html">Introduction</a></li>
<li class="toctree-l3"><a class="reference internal" href="../tutorials/intro-tutorial/gotchas.html">Gotchas</a></li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../tutorials/intro-tutorial/features.html">SymPy Features</a><input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" role="switch" type="checkbox"/><label for="toctree-checkbox-3"><div class="visually-hidden">Toggle navigation of SymPy Features</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../tutorials/intro-tutorial/basic_operations.html">Basic Operations</a></li>
<li class="toctree-l4"><a class="reference internal" href="../tutorials/intro-tutorial/printing.html">Printing</a></li>
<li class="toctree-l4"><a class="reference internal" href="../tutorials/intro-tutorial/simplification.html">Simplification</a></li>
<li class="toctree-l4"><a class="reference internal" href="../tutorials/intro-tutorial/calculus.html">Calculus</a></li>
<li class="toctree-l4"><a class="reference internal" href="../tutorials/intro-tutorial/solvers.html">Solvers</a></li>
<li class="toctree-l4"><a class="reference internal" href="../tutorials/intro-tutorial/matrices.html">Matrices</a></li>
<li class="toctree-l4"><a class="reference internal" href="../tutorials/intro-tutorial/manipulation.html">Advanced Expression Manipulation</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../tutorials/intro-tutorial/next.html">What’s Next</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../tutorials/physics/index.html">Physics Tutorials</a><input class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" role="switch" type="checkbox"/><label for="toctree-checkbox-4"><div class="visually-hidden">Toggle navigation of Physics Tutorials</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3 has-children"><a class="reference internal" href="../tutorials/physics/biomechanics/index.html">Biomechanics Tutorials</a><input class="toctree-checkbox" id="toctree-checkbox-5" name="toctree-checkbox-5" role="switch" type="checkbox"/><label for="toctree-checkbox-5"><div class="visually-hidden">Toggle navigation of Biomechanics Tutorials</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../tutorials/physics/biomechanics/biomechanics.html">Introduction to Biomechanical Modeling</a></li>
<li class="toctree-l4"><a class="reference internal" href="../tutorials/physics/biomechanics/biomechanical-model-example.html">Biomechanical Model Example</a></li>
</ul>
</li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../tutorials/physics/mechanics/index.html">Mechanics Tutorials</a><input class="toctree-checkbox" id="toctree-checkbox-6" name="toctree-checkbox-6" role="switch" type="checkbox"/><label for="toctree-checkbox-6"><div class="visually-hidden">Toggle navigation of Mechanics Tutorials</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../tutorials/physics/mechanics/duffing-example.html">Duffing Oscillator with a Pendulum</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../guides/index.html">How-to Guides</a><input class="toctree-checkbox" id="toctree-checkbox-7" name="toctree-checkbox-7" role="switch" type="checkbox"/><label for="toctree-checkbox-7"><div class="visually-hidden">Toggle navigation of How-to Guides</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../guides/assumptions.html">Assumptions</a></li>
<li class="toctree-l2"><a class="reference internal" href="../guides/booleans.html">Symbolic and fuzzy booleans</a></li>
<li class="toctree-l2"><a class="reference internal" href="../guides/custom-functions.html">Writing Custom Functions</a></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../guides/physics/index.html">Physics</a><input class="toctree-checkbox" id="toctree-checkbox-8" name="toctree-checkbox-8" role="switch" type="checkbox"/><label for="toctree-checkbox-8"><div class="visually-hidden">Toggle navigation of Physics</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../guides/physics/control_problems.html">Control Package Examples</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../guides/solving/index.html">Solve Equations</a><input class="toctree-checkbox" id="toctree-checkbox-9" name="toctree-checkbox-9" role="switch" type="checkbox"/><label for="toctree-checkbox-9"><div class="visually-hidden">Toggle navigation of Solve Equations</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../guides/solving/solving-guidance.html">Solving Guidance</a></li>
<li class="toctree-l3"><a class="reference internal" href="../guides/solving/solve-equation-algebraically.html">Solve an Equation Algebraically</a></li>
<li class="toctree-l3"><a class="reference internal" href="../guides/solving/solve-system-of-equations-algebraically.html">Solve a System of Equations Algebraically</a></li>
<li class="toctree-l3"><a class="reference internal" href="../guides/solving/solve-numerically.html">Solve One or a System of Equations Numerically</a></li>
<li class="toctree-l3"><a class="reference internal" href="../guides/solving/solve-ode.html">Solve an Ordinary Differential Equation (ODE) Algebraically</a></li>
<li class="toctree-l3"><a class="reference internal" href="../guides/solving/find-roots-polynomial.html">Find the Roots of a Polynomial Algebraically or Numerically</a></li>
<li class="toctree-l3"><a class="reference internal" href="../guides/solving/solve-matrix-equation.html">Solve a Matrix Equation Algebraically</a></li>
<li class="toctree-l3"><a class="reference internal" href="../guides/solving/reduce-inequalities-algebraically.html">Reduce One or a System of Inequalities for a Single Variable Algebraically</a></li>
<li class="toctree-l3"><a class="reference internal" href="../guides/solving/solve-diophantine-equation.html">Solve a Diophantine Equation Algebraically</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../guides/logo.html">SymPy Logo</a></li>
<li class="toctree-l2"><a class="reference internal" href="../citing.html">Citing SymPy</a></li>
</ul>
</li>
<li class="toctree-l1 current has-children"><a class="reference internal" href="index.html">Explanations</a><input checked="" class="toctree-checkbox" id="toctree-checkbox-10" name="toctree-checkbox-10" role="switch" type="checkbox"/><label for="toctree-checkbox-10"><div class="visually-hidden">Toggle navigation of Explanations</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul class="current">
<li class="toctree-l2 current current-page"><a class="current reference internal" href="#">Best Practices</a></li>
<li class="toctree-l2"><a class="reference internal" href="gotchas.html">Gotchas and Pitfalls</a></li>
<li class="toctree-l2"><a class="reference internal" href="solve_output.html">Solve Output by Type</a></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="special_topics/index.html">SymPy Special Topics</a><input class="toctree-checkbox" id="toctree-checkbox-11" name="toctree-checkbox-11" role="switch" type="checkbox"/><label for="toctree-checkbox-11"><div class="visually-hidden">Toggle navigation of SymPy Special Topics</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="special_topics/finite_diff_derivatives.html">Finite Difference Approximations to Derivatives</a></li>
<li class="toctree-l3"><a class="reference internal" href="special_topics/classification.html">Classification of SymPy objects</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="active-deprecations.html">List of active deprecations</a></li>
<li class="toctree-l2"><a class="reference internal" href="glossary.html">Glossary</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../reference/index.html">API Reference</a><input class="toctree-checkbox" id="toctree-checkbox-12" name="toctree-checkbox-12" role="switch" type="checkbox"/><label for="toctree-checkbox-12"><div class="visually-hidden">Toggle navigation of API Reference</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2 has-children"><a class="reference internal" href="../reference/public/basics/index.html">Basics</a><input class="toctree-checkbox" id="toctree-checkbox-13" name="toctree-checkbox-13" role="switch" type="checkbox"/><label for="toctree-checkbox-13"><div class="visually-hidden">Toggle navigation of Basics</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3 has-children"><a class="reference internal" href="../modules/assumptions/index.html">Assumptions</a><input class="toctree-checkbox" id="toctree-checkbox-14" name="toctree-checkbox-14" role="switch" type="checkbox"/><label for="toctree-checkbox-14"><div class="visually-hidden">Toggle navigation of Assumptions</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../modules/assumptions/ask.html">Ask</a></li>
<li class="toctree-l4"><a class="reference internal" href="../modules/assumptions/assume.html">Assume</a></li>
<li class="toctree-l4"><a class="reference internal" href="../modules/assumptions/refine.html">Refine</a></li>
<li class="toctree-l4"><a class="reference internal" href="../modules/assumptions/predicates.html">Predicates</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../modules/calculus/index.html">Calculus</a></li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../modules/combinatorics/index.html">Combinatorics</a><input class="toctree-checkbox" id="toctree-checkbox-15" name="toctree-checkbox-15" role="switch" type="checkbox"/><label for="toctree-checkbox-15"><div class="visually-hidden">Toggle navigation of Combinatorics</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../modules/combinatorics/partitions.html">Partitions</a></li>
<li class="toctree-l4"><a class="reference internal" href="../modules/combinatorics/permutations.html">Permutations</a></li>
<li class="toctree-l4"><a class="reference internal" href="../modules/combinatorics/perm_groups.html">Permutation Groups</a></li>
<li class="toctree-l4"><a class="reference internal" href="../modules/combinatorics/polyhedron.html">Polyhedron</a></li>
<li class="toctree-l4"><a class="reference internal" href="../modules/combinatorics/prufer.html">Prufer Sequences</a></li>
<li class="toctree-l4"><a class="reference internal" href="../modules/combinatorics/subsets.html">Subsets</a></li>
<li class="toctree-l4"><a class="reference internal" href="../modules/combinatorics/graycode.html">Gray Code</a></li>
<li class="toctree-l4"><a class="reference internal" href="../modules/combinatorics/named_groups.html">Named Groups</a></li>
<li class="toctree-l4"><a class="reference internal" href="../modules/combinatorics/galois.html">Galois Groups</a></li>
<li class="toctree-l4"><a class="reference internal" href="../modules/combinatorics/group_numbers.html">Number of groups</a></li>
<li class="toctree-l4"><a class="reference internal" href="../modules/combinatorics/util.html">Utilities</a></li>
<li class="toctree-l4"><a class="reference internal" href="../modules/combinatorics/group_constructs.html">Group constructors</a></li>
<li class="toctree-l4"><a class="reference internal" href="../modules/combinatorics/testutil.html">Test Utilities</a></li>
<li class="toctree-l4"><a class="reference internal" href="../modules/combinatorics/tensor_can.html">Tensor Canonicalization</a></li>
<li class="toctree-l4"><a class="reference internal" href="../modules/combinatorics/fp_groups.html">Finitely Presented Groups</a></li>
<li class="toctree-l4"><a class="reference internal" href="../modules/combinatorics/pc_groups.html">Polycyclic Groups</a></li>
</ul>
</li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../modules/functions/index.html">Functions</a><input class="toctree-checkbox" id="toctree-checkbox-16" name="toctree-checkbox-16" role="switch" type="checkbox"/><label for="toctree-checkbox-16"><div class="visually-hidden">Toggle navigation of Functions</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../modules/functions/elementary.html">Elementary</a></li>
<li class="toctree-l4"><a class="reference internal" href="../modules/functions/combinatorial.html">Combinatorial</a></li>
<li class="toctree-l4"><a class="reference internal" href="../modules/functions/combinatorial.html#enumeration">Enumeration</a></li>
<li class="toctree-l4"><a class="reference internal" href="../modules/functions/special.html">Special</a></li>
</ul>
</li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../modules/integrals/index.html">Integrals</a><input class="toctree-checkbox" id="toctree-checkbox-17" name="toctree-checkbox-17" role="switch" type="checkbox"/><label for="toctree-checkbox-17"><div class="visually-hidden">Toggle navigation of Integrals</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../modules/integrals/g-functions.html">Computing Integrals using Meijer G-Functions</a></li>
<li class="toctree-l4"><a class="reference internal" href="../modules/integrals/integrals.html">Integrals</a></li>
</ul>
</li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../modules/series/index.html">Series</a><input class="toctree-checkbox" id="toctree-checkbox-18" name="toctree-checkbox-18" role="switch" type="checkbox"/><label for="toctree-checkbox-18"><div class="visually-hidden">Toggle navigation of Series</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../modules/series/series.html">Series Expansions</a></li>
<li class="toctree-l4"><a class="reference internal" href="../modules/series/sequences.html">Sequences</a></li>
<li class="toctree-l4"><a class="reference internal" href="../modules/series/fourier.html">Fourier Series</a></li>
<li class="toctree-l4"><a class="reference internal" href="../modules/series/formal.html">Formal Power Series</a></li>
<li class="toctree-l4"><a class="reference internal" href="../modules/series/limitseq.html">Limits of Sequences</a></li>
</ul>
</li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../modules/simplify/index.html">Simplify</a><input class="toctree-checkbox" id="toctree-checkbox-19" name="toctree-checkbox-19" role="switch" type="checkbox"/><label for="toctree-checkbox-19"><div class="visually-hidden">Toggle navigation of Simplify</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../modules/simplify/simplify.html">Simplify</a></li>
<li class="toctree-l4"><a class="reference internal" href="../modules/simplify/hyperexpand.html">Hypergeometric Expansion</a></li>
<li class="toctree-l4"><a class="reference internal" href="../modules/simplify/fu.html">Hongguang Fu’s Trigonometric Simplification</a></li>
</ul>
</li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../modules/solvers/index.html">Solvers</a><input class="toctree-checkbox" id="toctree-checkbox-20" name="toctree-checkbox-20" role="switch" type="checkbox"/><label for="toctree-checkbox-20"><div class="visually-hidden">Toggle navigation of Solvers</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../modules/solvers/diophantine.html">Diophantine</a></li>
<li class="toctree-l4"><a class="reference internal" href="../modules/solvers/inequalities.html">Inequality Solvers</a></li>
<li class="toctree-l4"><a class="reference internal" href="../modules/solvers/ode.html">ODE</a></li>
<li class="toctree-l4"><a class="reference internal" href="../modules/solvers/pde.html">PDE</a></li>
<li class="toctree-l4"><a class="reference internal" href="../modules/solvers/solvers.html">Solvers</a></li>
<li class="toctree-l4"><a class="reference internal" href="../modules/solvers/solveset.html">Solveset</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../modules/abc.html">abc</a></li>
<li class="toctree-l3"><a class="reference internal" href="../modules/algebras.html">Algebras</a></li>
<li class="toctree-l3"><a class="reference internal" href="../modules/concrete.html">Concrete</a></li>
<li class="toctree-l3"><a class="reference internal" href="../modules/core.html">Core</a></li>
<li class="toctree-l3"><a class="reference internal" href="../modules/discrete.html">Discrete</a></li>
<li class="toctree-l3"><a class="reference internal" href="../modules/evalf.html">Numerical Evaluation</a></li>
<li class="toctree-l3"><a class="reference internal" href="../modules/numeric-computation.html">Numeric Computation</a></li>
<li class="toctree-l3"><a class="reference internal" href="../modules/rewriting.html">Term Rewriting</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../reference/public/codegeneration/index.html">Code Generation</a><input class="toctree-checkbox" id="toctree-checkbox-21" name="toctree-checkbox-21" role="switch" type="checkbox"/><label for="toctree-checkbox-21"><div class="visually-hidden">Toggle navigation of Code Generation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../modules/codegen.html">Code Generation</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../reference/public/logic/index.html">Logic</a><input class="toctree-checkbox" id="toctree-checkbox-22" name="toctree-checkbox-22" role="switch" type="checkbox"/><label for="toctree-checkbox-22"><div class="visually-hidden">Toggle navigation of Logic</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../modules/logic.html">Logic</a></li>
<li class="toctree-l3"><a class="reference internal" href="../modules/sets.html">Sets</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../reference/public/matrices/index.html">Matrices</a><input class="toctree-checkbox" id="toctree-checkbox-23" name="toctree-checkbox-23" role="switch" type="checkbox"/><label for="toctree-checkbox-23"><div class="visually-hidden">Toggle navigation of Matrices</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3 has-children"><a class="reference internal" href="../modules/matrices/index.html">Matrices</a><input class="toctree-checkbox" id="toctree-checkbox-24" name="toctree-checkbox-24" role="switch" type="checkbox"/><label for="toctree-checkbox-24"><div class="visually-hidden">Toggle navigation of Matrices</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../modules/matrices/matrices.html">Matrices (linear algebra)</a></li>
<li class="toctree-l4"><a class="reference internal" href="../modules/matrices/kind.html">Matrix Kind</a></li>
<li class="toctree-l4"><a class="reference internal" href="../modules/matrices/dense.html">Dense Matrices</a></li>
<li class="toctree-l4"><a class="reference internal" href="../modules/matrices/sparse.html">Sparse Matrices</a></li>
<li class="toctree-l4"><a class="reference internal" href="../modules/matrices/sparsetools.html">Sparse Tools</a></li>
<li class="toctree-l4"><a class="reference internal" href="../modules/matrices/immutablematrices.html">Immutable Matrices</a></li>
<li class="toctree-l4"><a class="reference internal" href="../modules/matrices/expressions.html">Matrix Expressions</a></li>
<li class="toctree-l4"><a class="reference internal" href="../modules/matrices/normalforms.html">Matrix Normal Forms</a></li>
</ul>
</li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../modules/tensor/index.html">Tensor</a><input class="toctree-checkbox" id="toctree-checkbox-25" name="toctree-checkbox-25" role="switch" type="checkbox"/><label for="toctree-checkbox-25"><div class="visually-hidden">Toggle navigation of Tensor</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../modules/tensor/array.html">N-dim array</a></li>
<li class="toctree-l4"><a class="reference internal" href="../modules/tensor/array_expressions.html">N-dim array expressions</a></li>
<li class="toctree-l4"><a class="reference internal" href="../modules/tensor/indexed.html">Indexed Objects</a></li>
<li class="toctree-l4"><a class="reference internal" href="../modules/tensor/index_methods.html">Methods</a></li>
<li class="toctree-l4"><a class="reference internal" href="../modules/tensor/tensor.html">Tensor</a></li>
<li class="toctree-l4"><a class="reference internal" href="../modules/tensor/toperators.html">Tensor Operators</a></li>
</ul>
</li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../modules/vector/index.html">Vector</a><input class="toctree-checkbox" id="toctree-checkbox-26" name="toctree-checkbox-26" role="switch" type="checkbox"/><label for="toctree-checkbox-26"><div class="visually-hidden">Toggle navigation of Vector</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../modules/vector/intro.html">Introduction</a></li>
<li class="toctree-l4"><a class="reference internal" href="../modules/vector/basics.html">Basic Implementation details</a></li>
<li class="toctree-l4"><a class="reference internal" href="../modules/vector/coordsys.html">More about Coordinate Systems</a></li>
<li class="toctree-l4"><a class="reference internal" href="../modules/vector/fields.html">Scalar and Vector Field Functionality</a></li>
<li class="toctree-l4"><a class="reference internal" href="../modules/vector/examples.html">General examples of usage</a></li>
<li class="toctree-l4"><a class="reference internal" href="../modules/vector/vector_integration.html">Applications of Vector Integrals</a></li>
<li class="toctree-l4 has-children"><a class="reference internal" href="../modules/vector/api/index.html">Vector API</a><input class="toctree-checkbox" id="toctree-checkbox-27" name="toctree-checkbox-27" role="switch" type="checkbox"/><label for="toctree-checkbox-27"><div class="visually-hidden">Toggle navigation of Vector API</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l5"><a class="reference internal" href="../modules/vector/api/classes.html">Essential Classes in sympy.vector (docstrings)</a></li>
<li class="toctree-l5"><a class="reference internal" href="../modules/vector/api/orienterclasses.html">Orienter classes (docstrings)</a></li>
<li class="toctree-l5"><a class="reference internal" href="../modules/vector/api/vectorfunctions.html">Essential Functions in sympy.vector (docstrings)</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../reference/public/numbertheory/index.html">Number Theory</a><input class="toctree-checkbox" id="toctree-checkbox-28" name="toctree-checkbox-28" role="switch" type="checkbox"/><label for="toctree-checkbox-28"><div class="visually-hidden">Toggle navigation of Number Theory</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../modules/ntheory.html">Number Theory</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../reference/public/physics/index.html">Physics</a><input class="toctree-checkbox" id="toctree-checkbox-29" name="toctree-checkbox-29" role="switch" type="checkbox"/><label for="toctree-checkbox-29"><div class="visually-hidden">Toggle navigation of Physics</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../modules/physics/hydrogen.html">Hydrogen Wavefunctions</a></li>
<li class="toctree-l3"><a class="reference internal" href="../modules/physics/matrices.html">Matrices</a></li>
<li class="toctree-l3"><a class="reference internal" href="../modules/physics/paulialgebra.html">Pauli Algebra</a></li>
<li class="toctree-l3"><a class="reference internal" href="../modules/physics/qho_1d.html">Quantum Harmonic Oscillator in 1-D</a></li>
<li class="toctree-l3"><a class="reference internal" href="../modules/physics/sho.html">Quantum Harmonic Oscillator in 3-D</a></li>
<li class="toctree-l3"><a class="reference internal" href="../modules/physics/secondquant.html">Second Quantization</a></li>
<li class="toctree-l3"><a class="reference internal" href="../modules/physics/wigner.html">Wigner Symbols</a></li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../modules/physics/units/index.html">Unit systems</a><input class="toctree-checkbox" id="toctree-checkbox-30" name="toctree-checkbox-30" role="switch" type="checkbox"/><label for="toctree-checkbox-30"><div class="visually-hidden">Toggle navigation of Unit systems</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../modules/physics/units/philosophy.html">Philosophy behind unit systems</a></li>
<li class="toctree-l4"><a class="reference internal" href="../modules/physics/units/examples.html">More examples</a></li>
<li class="toctree-l4"><a class="reference internal" href="../modules/physics/units/dimensions.html">Dimensions and dimension systems</a></li>
<li class="toctree-l4"><a class="reference internal" href="../modules/physics/units/prefixes.html">Unit prefixes</a></li>
<li class="toctree-l4"><a class="reference internal" href="../modules/physics/units/unitsystem.html">Units and unit systems</a></li>
<li class="toctree-l4"><a class="reference internal" href="../modules/physics/units/quantities.html">Physical quantities</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../modules/physics/hep/index.html">High energy physics</a></li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../modules/physics/vector/index.html">The Physics Vector Module</a><input class="toctree-checkbox" id="toctree-checkbox-31" name="toctree-checkbox-31" role="switch" type="checkbox"/><label for="toctree-checkbox-31"><div class="visually-hidden">Toggle navigation of The Physics Vector Module</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../modules/physics/vector/vectors.html">Vector &amp; ReferenceFrame</a></li>
<li class="toctree-l4"><a class="reference internal" href="../modules/physics/vector/kinematics.html">Vector: Kinematics</a></li>
<li class="toctree-l4"><a class="reference internal" href="../modules/physics/vector/advanced.html">Potential Issues/Advanced Topics/Future Features in Physics/Vector Module</a></li>
<li class="toctree-l4"><a class="reference internal" href="../modules/physics/vector/fields.html">Scalar and Vector Field Functionality</a></li>
<li class="toctree-l4 has-children"><a class="reference internal" href="../modules/physics/vector/api/index.html">Physics Vector API</a><input class="toctree-checkbox" id="toctree-checkbox-32" name="toctree-checkbox-32" role="switch" type="checkbox"/><label for="toctree-checkbox-32"><div class="visually-hidden">Toggle navigation of Physics Vector API</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l5"><a class="reference internal" href="../modules/physics/vector/api/classes.html">Essential Classes</a></li>
<li class="toctree-l5"><a class="reference internal" href="../modules/physics/vector/api/kinematics.html">Kinematics (Docstrings)</a></li>
<li class="toctree-l5"><a class="reference internal" href="../modules/physics/vector/api/printing.html">Printing (Docstrings)</a></li>
<li class="toctree-l5"><a class="reference internal" href="../modules/physics/vector/api/functions.html">Essential Functions (Docstrings)</a></li>
<li class="toctree-l5"><a class="reference internal" href="../modules/physics/vector/api/fieldfunctions.html">Docstrings for basic field functions</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../modules/physics/mechanics/index.html">Classical Mechanics</a><input class="toctree-checkbox" id="toctree-checkbox-33" name="toctree-checkbox-33" role="switch" type="checkbox"/><label for="toctree-checkbox-33"><div class="visually-hidden">Toggle navigation of Classical Mechanics</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../modules/physics/mechanics/masses.html">Masses, Inertias, Particles and Rigid Bodies in Physics/Mechanics</a></li>
<li class="toctree-l4"><a class="reference internal" href="../modules/physics/mechanics/kane.html">Kane’s Method in Physics/Mechanics</a></li>
<li class="toctree-l4"><a class="reference internal" href="../modules/physics/mechanics/lagrange.html">Lagrange’s Method in Physics/Mechanics</a></li>
<li class="toctree-l4"><a class="reference internal" href="../modules/physics/mechanics/joints.html">Joints Framework in Physics/Mechanics</a></li>
<li class="toctree-l4"><a class="reference internal" href="../modules/physics/mechanics/symsystem.html">Symbolic Systems in Physics/Mechanics</a></li>
<li class="toctree-l4 has-children"><a class="reference internal" href="../modules/physics/mechanics/linearize.html">Linearization in Physics/Mechanics</a><input class="toctree-checkbox" id="toctree-checkbox-34" name="toctree-checkbox-34" role="switch" type="checkbox"/><label for="toctree-checkbox-34"><div class="visually-hidden">Toggle navigation of Linearization in Physics/Mechanics</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l5"><a class="reference internal" href="../modules/physics/mechanics/examples/lin_pend_nonmin_example.html">Nonminimal Coordinates Pendulum</a></li>
</ul>
</li>
<li class="toctree-l4 has-children"><a class="reference internal" href="../modules/physics/mechanics/examples.html">Examples for Physics/Mechanics</a><input class="toctree-checkbox" id="toctree-checkbox-35" name="toctree-checkbox-35" role="switch" type="checkbox"/><label for="toctree-checkbox-35"><div class="visually-hidden">Toggle navigation of Examples for Physics/Mechanics</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l5 has-children"><a class="reference internal" href="../modules/physics/mechanics/examples/rollingdisc_example.html">A rolling disc</a><input class="toctree-checkbox" id="toctree-checkbox-36" name="toctree-checkbox-36" role="switch" type="checkbox"/><label for="toctree-checkbox-36"><div class="visually-hidden">Toggle navigation of A rolling disc</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l6"><a class="reference internal" href="../modules/physics/mechanics/examples/rollingdisc_example_kane.html">A rolling disc, with Kane’s method</a></li>
<li class="toctree-l6"><a class="reference internal" href="../modules/physics/mechanics/examples/rollingdisc_example_kane_constraints.html">A rolling disc, with Kane’s method and constraint forces</a></li>
<li class="toctree-l6"><a class="reference internal" href="../modules/physics/mechanics/examples/rollingdisc_example_lagrange.html">A rolling disc using Lagrange’s Method</a></li>
</ul>
</li>
<li class="toctree-l5"><a class="reference internal" href="../modules/physics/mechanics/examples/bicycle_example.html">A bicycle</a></li>
<li class="toctree-l5"><a class="reference internal" href="../modules/physics/mechanics/examples/lin_pend_nonmin_example.html">Nonminimal Coordinates Pendulum</a></li>
<li class="toctree-l5"><a class="reference internal" href="../modules/physics/mechanics/examples/multi_degree_freedom_holonomic_system.html">Multi Degree of Freedom Holonomic System</a></li>
<li class="toctree-l5"><a class="reference internal" href="../modules/physics/mechanics/examples/four_bar_linkage_example.html">A four bar linkage</a></li>
</ul>
</li>
<li class="toctree-l4"><a class="reference internal" href="../modules/physics/mechanics/advanced.html">Potential Issues/Advanced Topics/Future Features in Physics/Mechanics</a></li>
<li class="toctree-l4"><a class="reference internal" href="../modules/physics/mechanics/reference.html">References for Physics/Mechanics</a></li>
<li class="toctree-l4"><a class="reference internal" href="../modules/physics/mechanics/autolev_parser.html">Autolev Parser</a></li>
<li class="toctree-l4"><a class="reference internal" href="../modules/physics/mechanics/sympy_mechanics_for_autolev_users.html">SymPy Mechanics for Autolev Users</a></li>
<li class="toctree-l4 has-children"><a class="reference internal" href="../modules/physics/mechanics/api/index.html">Mechanics API Reference</a><input class="toctree-checkbox" id="toctree-checkbox-37" name="toctree-checkbox-37" role="switch" type="checkbox"/><label for="toctree-checkbox-37"><div class="visually-hidden">Toggle navigation of Mechanics API Reference</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l5"><a class="reference internal" href="../modules/physics/mechanics/api/part_bod.html">Bodies, Inertias, Loads &amp; Other Functions (Docstrings)</a></li>
<li class="toctree-l5"><a class="reference internal" href="../modules/physics/mechanics/api/kane_lagrange.html">Kane’s Method &amp; Lagrange’s Method (Docstrings)</a></li>
<li class="toctree-l5"><a class="reference internal" href="../modules/physics/mechanics/api/joint.html">Joints Framework (Docstrings)</a></li>
<li class="toctree-l5"><a class="reference internal" href="../modules/physics/mechanics/api/system.html">System (Docstrings)</a></li>
<li class="toctree-l5"><a class="reference internal" href="../modules/physics/mechanics/api/linearize.html">Linearization (Docstrings)</a></li>
<li class="toctree-l5"><a class="reference internal" href="../modules/physics/mechanics/api/expr_manip.html">Expression Manipulation (Docstrings)</a></li>
<li class="toctree-l5"><a class="reference internal" href="../modules/physics/mechanics/api/printing.html">Printing (Docstrings)</a></li>
<li class="toctree-l5"><a class="reference internal" href="../modules/physics/mechanics/api/pathway.html">Pathway (Docstrings)</a></li>
<li class="toctree-l5"><a class="reference internal" href="../modules/physics/mechanics/api/actuator.html">Actuator (Docstrings)</a></li>
<li class="toctree-l5"><a class="reference internal" href="../modules/physics/mechanics/api/wrapping_geometry.html">Wrapping Geometry (Docstrings)</a></li>
<li class="toctree-l5"><a class="reference internal" href="../modules/physics/mechanics/api/deprecated_classes.html">Deprecated Classes (Docstrings)</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../modules/physics/biomechanics/index.html">Biomechanics</a><input class="toctree-checkbox" id="toctree-checkbox-38" name="toctree-checkbox-38" role="switch" type="checkbox"/><label for="toctree-checkbox-38"><div class="visually-hidden">Toggle navigation of Biomechanics</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l4 has-children"><a class="reference internal" href="../modules/physics/biomechanics/api/index.html">Biomechanics API Reference</a><input class="toctree-checkbox" id="toctree-checkbox-39" name="toctree-checkbox-39" role="switch" type="checkbox"/><label for="toctree-checkbox-39"><div class="visually-hidden">Toggle navigation of Biomechanics API Reference</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l5"><a class="reference internal" href="../modules/physics/biomechanics/api/musculotendon.html">Musculotendon (Docstrings)</a></li>
<li class="toctree-l5"><a class="reference internal" href="../modules/physics/biomechanics/api/activation.html">Activation (Docstrings)</a></li>
<li class="toctree-l5"><a class="reference internal" href="../modules/physics/biomechanics/api/curve.html">Curve (Docstrings)</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../modules/physics/quantum/index.html">Quantum Mechanics</a><input class="toctree-checkbox" id="toctree-checkbox-40" name="toctree-checkbox-40" role="switch" type="checkbox"/><label for="toctree-checkbox-40"><div class="visually-hidden">Toggle navigation of Quantum Mechanics</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../modules/physics/quantum/anticommutator.html">Anticommutator</a></li>
<li class="toctree-l4"><a class="reference internal" href="../modules/physics/quantum/cg.html">Clebsch-Gordan Coefficients</a></li>
<li class="toctree-l4"><a class="reference internal" href="../modules/physics/quantum/commutator.html">Commutator</a></li>
<li class="toctree-l4"><a class="reference internal" href="../modules/physics/quantum/constants.html">Constants</a></li>
<li class="toctree-l4"><a class="reference internal" href="../modules/physics/quantum/dagger.html">Dagger</a></li>
<li class="toctree-l4"><a class="reference internal" href="../modules/physics/quantum/innerproduct.html">Inner Product</a></li>
<li class="toctree-l4"><a class="reference internal" href="../modules/physics/quantum/tensorproduct.html">Tensor Product</a></li>
<li class="toctree-l4"><a class="reference internal" href="../modules/physics/quantum/cartesian.html">Cartesian Operators and States</a></li>
<li class="toctree-l4"><a class="reference internal" href="../modules/physics/quantum/hilbert.html">Hilbert Space</a></li>
<li class="toctree-l4"><a class="reference internal" href="../modules/physics/quantum/operator.html">Operator</a></li>
<li class="toctree-l4"><a class="reference internal" href="../modules/physics/quantum/operatorset.html">Operator/State Helper Functions</a></li>
<li class="toctree-l4"><a class="reference internal" href="../modules/physics/quantum/qapply.html">Qapply</a></li>
<li class="toctree-l4"><a class="reference internal" href="../modules/physics/quantum/represent.html">Represent</a></li>
<li class="toctree-l4"><a class="reference internal" href="../modules/physics/quantum/spin.html">Spin</a></li>
<li class="toctree-l4"><a class="reference internal" href="../modules/physics/quantum/state.html">State</a></li>
<li class="toctree-l4"><a class="reference internal" href="../modules/physics/quantum/circuitplot.html">Circuit Plot</a></li>
<li class="toctree-l4"><a class="reference internal" href="../modules/physics/quantum/gate.html">Gates</a></li>
<li class="toctree-l4"><a class="reference internal" href="../modules/physics/quantum/grover.html">Grover’s Algorithm</a></li>
<li class="toctree-l4"><a class="reference internal" href="../modules/physics/quantum/qft.html">QFT</a></li>
<li class="toctree-l4"><a class="reference internal" href="../modules/physics/quantum/qubit.html">Qubit</a></li>
<li class="toctree-l4"><a class="reference internal" href="../modules/physics/quantum/shor.html">Shor’s Algorithm</a></li>
<li class="toctree-l4"><a class="reference internal" href="../modules/physics/quantum/piab.html">Particle in a Box</a></li>
</ul>
</li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../modules/physics/optics/index.html">Optics Module</a><input class="toctree-checkbox" id="toctree-checkbox-41" name="toctree-checkbox-41" role="switch" type="checkbox"/><label for="toctree-checkbox-41"><div class="visually-hidden">Toggle navigation of Optics Module</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../modules/physics/optics/gaussopt.html">Gaussian Optics</a></li>
<li class="toctree-l4"><a class="reference internal" href="../modules/physics/optics/medium.html">Medium</a></li>
<li class="toctree-l4"><a class="reference internal" href="../modules/physics/optics/polarization.html">Polarization</a></li>
<li class="toctree-l4"><a class="reference internal" href="../modules/physics/optics/utils.html">Utilities</a></li>
<li class="toctree-l4"><a class="reference internal" href="../modules/physics/optics/waves.html">Waves</a></li>
</ul>
</li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../modules/physics/control/index.html">Control Module</a><input class="toctree-checkbox" id="toctree-checkbox-42" name="toctree-checkbox-42" role="switch" type="checkbox"/><label for="toctree-checkbox-42"><div class="visually-hidden">Toggle navigation of Control Module</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../modules/physics/control/control.html">Control</a></li>
<li class="toctree-l4"><a class="reference internal" href="../modules/physics/control/lti.html">Control API</a></li>
<li class="toctree-l4"><a class="reference internal" href="../modules/physics/control/control_plots.html">Control System Plots</a></li>
</ul>
</li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../modules/physics/continuum_mechanics/index.html">Continuum Mechanics</a><input class="toctree-checkbox" id="toctree-checkbox-43" name="toctree-checkbox-43" role="switch" type="checkbox"/><label for="toctree-checkbox-43"><div class="visually-hidden">Toggle navigation of Continuum Mechanics</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../modules/physics/continuum_mechanics/beam.html">Beam (Docstrings)</a></li>
<li class="toctree-l4"><a class="reference internal" href="../modules/physics/continuum_mechanics/beam_problems.html">Solving Beam Bending Problems using Singularity Functions</a></li>
<li class="toctree-l4"><a class="reference internal" href="../modules/physics/continuum_mechanics/truss.html">Truss (Docstrings)</a></li>
<li class="toctree-l4"><a class="reference internal" href="../modules/physics/continuum_mechanics/cable.html">Cable (Docstrings)</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../reference/public/utilities/index.html">Utilities</a><input class="toctree-checkbox" id="toctree-checkbox-44" name="toctree-checkbox-44" role="switch" type="checkbox"/><label for="toctree-checkbox-44"><div class="visually-hidden">Toggle navigation of Utilities</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3 has-children"><a class="reference internal" href="../modules/testing/index.html">Testing</a><input class="toctree-checkbox" id="toctree-checkbox-45" name="toctree-checkbox-45" role="switch" type="checkbox"/><label for="toctree-checkbox-45"><div class="visually-hidden">Toggle navigation of Testing</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../modules/testing/pytest.html">pytest</a></li>
<li class="toctree-l4"><a class="reference internal" href="../modules/testing/randtest.html">Randomised Testing</a></li>
<li class="toctree-l4"><a class="reference internal" href="../modules/testing/runtests.html">Run Tests</a></li>
</ul>
</li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../modules/utilities/index.html">Utilities</a><input class="toctree-checkbox" id="toctree-checkbox-46" name="toctree-checkbox-46" role="switch" type="checkbox"/><label for="toctree-checkbox-46"><div class="visually-hidden">Toggle navigation of Utilities</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../modules/utilities/autowrap.html">Autowrap Module</a></li>
<li class="toctree-l4"><a class="reference internal" href="../modules/utilities/codegen.html">Codegen</a></li>
<li class="toctree-l4"><a class="reference internal" href="../modules/utilities/decorator.html">Decorator</a></li>
<li class="toctree-l4"><a class="reference internal" href="../modules/utilities/enumerative.html">Enumerative</a></li>
<li class="toctree-l4"><a class="reference internal" href="../modules/utilities/exceptions.html">Exceptions and Warnings</a></li>
<li class="toctree-l4"><a class="reference internal" href="../modules/utilities/iterables.html">Iterables</a></li>
<li class="toctree-l4"><a class="reference internal" href="../modules/utilities/lambdify.html">Lambdify</a></li>
<li class="toctree-l4"><a class="reference internal" href="../modules/utilities/memoization.html">Memoization</a></li>
<li class="toctree-l4"><a class="reference internal" href="../modules/utilities/misc.html">Miscellaneous</a></li>
<li class="toctree-l4"><a class="reference internal" href="../modules/utilities/source.html">Source Code Inspection</a></li>
<li class="toctree-l4"><a class="reference internal" href="../modules/utilities/timeutils.html">Timing Utilities</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../modules/interactive.html">Interactive</a></li>
<li class="toctree-l3"><a class="reference internal" href="../modules/parsing.html">Parsing</a></li>
<li class="toctree-l3"><a class="reference internal" href="../modules/printing.html">Printing</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../reference/public/topics/index.html">Topics</a><input class="toctree-checkbox" id="toctree-checkbox-47" name="toctree-checkbox-47" role="switch" type="checkbox"/><label for="toctree-checkbox-47"><div class="visually-hidden">Toggle navigation of Topics</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3 has-children"><a class="reference internal" href="../modules/geometry/index.html">Geometry</a><input class="toctree-checkbox" id="toctree-checkbox-48" name="toctree-checkbox-48" role="switch" type="checkbox"/><label for="toctree-checkbox-48"><div class="visually-hidden">Toggle navigation of Geometry</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../modules/geometry/entities.html">Entities</a></li>
<li class="toctree-l4"><a class="reference internal" href="../modules/geometry/utils.html">Utils</a></li>
<li class="toctree-l4"><a class="reference internal" href="../modules/geometry/points.html">Points</a></li>
<li class="toctree-l4"><a class="reference internal" href="../modules/geometry/lines.html">Lines</a></li>
<li class="toctree-l4"><a class="reference internal" href="../modules/geometry/curves.html">Curves</a></li>
<li class="toctree-l4"><a class="reference internal" href="../modules/geometry/ellipses.html">Ellipses</a></li>
<li class="toctree-l4"><a class="reference internal" href="../modules/geometry/polygons.html">Polygons</a></li>
<li class="toctree-l4"><a class="reference internal" href="../modules/geometry/plane.html">Plane</a></li>
</ul>
</li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../modules/holonomic/index.html">Holonomic</a><input class="toctree-checkbox" id="toctree-checkbox-49" name="toctree-checkbox-49" role="switch" type="checkbox"/><label for="toctree-checkbox-49"><div class="visually-hidden">Toggle navigation of Holonomic</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../modules/holonomic/about.html">About Holonomic Functions</a></li>
<li class="toctree-l4"><a class="reference internal" href="../modules/holonomic/represent.html">Representation of holonomic functions in SymPy</a></li>
<li class="toctree-l4"><a class="reference internal" href="../modules/holonomic/operations.html">Operations on holonomic functions</a></li>
<li class="toctree-l4"><a class="reference internal" href="../modules/holonomic/convert.html">Converting other representations to holonomic</a></li>
<li class="toctree-l4"><a class="reference internal" href="../modules/holonomic/uses.html">Uses and Current limitations</a></li>
<li class="toctree-l4"><a class="reference internal" href="../modules/holonomic/internal.html">Internal API</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../modules/liealgebras/index.html">Lie Algebra</a></li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../modules/polys/index.html">Polynomial Manipulation</a><input class="toctree-checkbox" id="toctree-checkbox-50" name="toctree-checkbox-50" role="switch" type="checkbox"/><label for="toctree-checkbox-50"><div class="visually-hidden">Toggle navigation of Polynomial Manipulation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../modules/polys/basics.html">Basic functionality of the module</a></li>
<li class="toctree-l4"><a class="reference internal" href="../modules/polys/wester.html">Examples from Wester’s Article</a></li>
<li class="toctree-l4"><a class="reference internal" href="../modules/polys/reference.html">Polynomials Manipulation Module Reference</a></li>
<li class="toctree-l4"><a class="reference internal" href="../modules/polys/agca.html">AGCA - Algebraic Geometry and Commutative Algebra Module</a></li>
<li class="toctree-l4"><a class="reference internal" href="../modules/polys/domainsintro.html">Introducing the Domains of the poly module</a></li>
<li class="toctree-l4"><a class="reference internal" href="../modules/polys/domainsref.html">Reference docs for the Poly Domains</a></li>
<li class="toctree-l4"><a class="reference internal" href="../modules/polys/internals.html">Internals of the Polynomial Manipulation Module</a></li>
<li class="toctree-l4"><a class="reference internal" href="../modules/polys/ringseries.html">Series Manipulation using Polynomials</a></li>
<li class="toctree-l4"><a class="reference internal" href="../modules/polys/literature.html">Literature</a></li>
<li class="toctree-l4"><a class="reference internal" href="../modules/polys/solvers.html">Poly solvers</a></li>
<li class="toctree-l4"><a class="reference internal" href="../modules/polys/domainmatrix.html">Introducing the domainmatrix of the poly module</a></li>
<li class="toctree-l4"><a class="reference internal" href="../modules/polys/numberfields.html">Number Fields</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../modules/categories.html">Category Theory</a></li>
<li class="toctree-l3"><a class="reference internal" href="../modules/crypto.html">Cryptography</a></li>
<li class="toctree-l3"><a class="reference internal" href="../modules/diffgeom.html">Differential Geometry</a></li>
<li class="toctree-l3"><a class="reference internal" href="../modules/plotting.html">Plotting</a></li>
<li class="toctree-l3"><a class="reference internal" href="../modules/stats.html">Stats</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../contributing/index.html">Contributing</a><input class="toctree-checkbox" id="toctree-checkbox-51" name="toctree-checkbox-51" role="switch" type="checkbox"/><label for="toctree-checkbox-51"><div class="visually-hidden">Toggle navigation of Contributing</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../contributing/introduction-to-contributing.html">Introduction to Contributing</a></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../contributing/new-contributors-guide/index.html">Guide for New Contributors</a><input class="toctree-checkbox" id="toctree-checkbox-52" name="toctree-checkbox-52" role="switch" type="checkbox"/><label for="toctree-checkbox-52"><div class="visually-hidden">Toggle navigation of Guide for New Contributors</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../contributing/new-contributors-guide/dev-setup.html">Setup Development Environment</a></li>
<li class="toctree-l3"><a class="reference internal" href="../contributing/new-contributors-guide/workflow-process.html">Development Workflow Process</a></li>
<li class="toctree-l3"><a class="reference internal" href="../contributing/new-contributors-guide/writing-tests.html">Writing Tests</a></li>
<li class="toctree-l3"><a class="reference internal" href="../contributing/new-contributors-guide/build-docs.html">Building the Documentation</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../contributing/dependencies.html">Dependencies</a></li>
<li class="toctree-l2"><a class="reference internal" href="../contributing/debug.html">Debugging</a></li>
<li class="toctree-l2"><a class="reference internal" href="../contributing/docstring.html">Docstrings Style Guide</a></li>
<li class="toctree-l2"><a class="reference internal" href="../contributing/documentation-style-guide.html">Documentation Style Guide</a></li>
<li class="toctree-l2"><a class="reference internal" href="../contributing/deprecations.html">Deprecation Policy</a></li>
</ul>
</li>
</ul>

</div><!-- Versions Menu. In order to work, there should be a file called versions.json one level up from the documentation listing the "dev" and "latest" version numbers, like
{
    "latest": "1.10",
    "dev": "1.11.dev"
}
-->
<div class="sidebar-tree sidebar-versions">
  <h5 class="versions-header">Documentation Version</h4>
</div>

<!-- Make sure jquery is loaded (we would put this as a separate .js, but it uses jinja templates in some of the variables) -->
<script src="../_static/jquery.js"></script>
<script>
  var versions_json_loc = "../../versions.json";

  function add_version_menu(json_loc) {
      var menu = document.createElement("ul");
      var thisversion = "dev"
      $.getJSON(json_loc, function(versions) {
          for (var key in versions) {
              if (key != "latest" && key != "dev") {
                  console.error("Invalid key in versions.json", key);
              } else {
                  var version = document.createElement("li")
                  version.className = "sidebar-versions-l1 sidebar-versions-" + key + "-l1";
                  if (key == thisversion){
                      version.className += " current-version";
                  }
                  var a = document.createElement("a");
                  a.className = "reference internal";
                  a.innerHTML = "SymPy " + versions[key] + " (" + key + " version)";
                  a.title = key + " version";
                  a.href = "https://docs.sympy.org/" + key + "/explanation/best-practices.html";
                  version.appendChild(a);
                  menu.appendChild(version);
              }
          }
      }).done(function() {
          console.log("versions.json read successfully");
      }).fail(function() {
          var version = document.createElement("li")
          version.className = "sidebar-versions-l1 sidebar-versions-latest-l1";
          var d = document.createElement("div");
          d.className = "versions-not-found"
          d.innerHTML = "Other Versions Not Found";
          d.title = "The version selection menu is only available for the documentation published on docs.sympy.org";
          version.appendChild(d);
          menu.appendChild(version);
          console.error("Could not read versions.json");
      }).always(function() {
          $(".sidebar-versions").append(menu)
      });
  };

  $( document ).ready( add_version_menu(versions_json_loc));
</script></div>
      </div>
      
    </div>
  </aside>
  <div class="main">
    <div class="content">
      <div class="article-container">
        <a href="#" class="back-to-top muted-link">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
            <path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12z"></path>
          </svg>
          <span>Back to top</span>
        </a>
        <div class="content-icon-container">
          <div class="view-this-page">
  <a class="muted-link" href="../_sources/explanation/best-practices.md.txt" title="View this page">
    <svg><use href="#svg-eye"></use></svg>
    <span class="visually-hidden">View this page</span>
  </a>
</div>
<div class="theme-toggle-container theme-toggle-content">
            <button class="theme-toggle">
              <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
              <svg class="theme-icon-when-auto-light"><use href="#svg-sun-with-moon"></use></svg>
              <svg class="theme-icon-when-auto-dark"><use href="#svg-moon-with-sun"></use></svg>
              <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
              <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
            </button>
          </div>
          <label class="toc-overlay-icon toc-content-icon" for="__toc">
            <div class="visually-hidden">Toggle table of contents sidebar</div>
            <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
          </label>
        </div>
        <article role="main" id="furo-main-content">
          <section class="tex2jax_ignore mathjax_ignore" id="best-practices">
<h1>Best Practices<a class="headerlink" href="#best-practices" title="Link to this heading">¶</a></h1>
<p>This page outlines some of the best practices for users of SymPy. The best
practices here will help avoid some common bugs and pitfalls that can occur
when using SymPy.</p>
<p>This page primarily focuses on best practices that apply generally to all
parts of SymPy. Best practices that are specific to certain SymPy submodules
or functions are outlined in the documentation for those specific functions.</p>
<section id="basic-usage">
<h2>Basic Usage<a class="headerlink" href="#basic-usage" title="Link to this heading">¶</a></h2>
<section id="defining-symbols">
<span id="best-practices-defining-symbols"></span><h3>Defining Symbols<a class="headerlink" href="#defining-symbols" title="Link to this heading">¶</a></h3>
<ul>
<li><p><strong>Define symbols with <a class="reference internal" href="../modules/core.html#sympy.core.symbol.symbols" title="sympy.core.symbol.symbols"><code class="xref py py-func docutils literal notranslate"><span class="pre">symbols()</span></code></a> or <a class="reference internal" href="../modules/core.html#sympy.core.symbol.Symbol" title="sympy.core.symbol.Symbol"><code class="xref py py-class docutils literal notranslate"><span class="pre">Symbol()</span></code></a>.</strong> The
<code class="docutils literal notranslate"><span class="pre">symbols()</span></code> function is the most convenient way to create symbols. It
supports creating one or more symbols at once:</p>
<div class="highlight-py notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sympy</span> <span class="kn">import</span> <span class="n">symbols</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">x</span> <span class="o">=</span> <span class="n">symbols</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">c</span> <span class="o">=</span> <span class="n">symbols</span><span class="p">(</span><span class="s1">&#39;a b c&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>Additionally, it supports adding assumptions to symbols</p>
<div class="highlight-py notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">k</span> <span class="o">=</span> <span class="n">symbols</span><span class="p">(</span><span class="s1">&#39;i j k&#39;</span><span class="p">,</span> <span class="n">integer</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
<p>and defining <a class="reference internal" href="../modules/core.html#sympy.core.function.Function" title="sympy.core.function.Function"><code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code></a> objects:</p>
<div class="highlight-py notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sympy</span> <span class="kn">import</span> <span class="n">Function</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">f</span><span class="p">,</span> <span class="n">g</span><span class="p">,</span> <span class="n">h</span> <span class="o">=</span> <span class="n">symbols</span><span class="p">(</span><span class="s1">&#39;f g h&#39;</span><span class="p">,</span> <span class="bp">cls</span><span class="o">=</span><span class="n">Function</span><span class="p">)</span>
</pre></div>
</div>
<p>It also supports shorthands for defining many numbered symbols at once:</p>
<div class="highlight-py notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">symbols</span><span class="p">(</span><span class="s1">&#39;x:10&#39;</span><span class="p">)</span>
<span class="go">(x0, x1, x2, x3, x4, x5, x6, x7, x8, x9)</span>
</pre></div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">Symbol()</span></code> constructor may also be used directly. Unlike <code class="docutils literal notranslate"><span class="pre">symbols()</span></code>,
<code class="docutils literal notranslate"><span class="pre">Symbol()</span></code> always creates one symbol. It is the best option if you want to
make a symbol with unusual characters in its name or if you are creating
symbols programmatically.</p>
<div class="highlight-py notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sympy</span> <span class="kn">import</span> <span class="n">Symbol</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">x_y</span> <span class="o">=</span> <span class="n">Symbol</span><span class="p">(</span><span class="s1">&#39;x y&#39;</span><span class="p">)</span> <span class="c1"># This creates a single symbol named &#39;x y&#39;</span>
</pre></div>
</div>
<p>The <a class="reference internal" href="../modules/core.html#sympy.core.symbol.var" title="sympy.core.symbol.var"><code class="xref py py-func docutils literal notranslate"><span class="pre">var()</span></code></a> function should be avoided, except when working
interactively. It works like the <a class="reference internal" href="../modules/core.html#sympy.core.symbol.symbols" title="sympy.core.symbol.symbols"><code class="xref py py-func docutils literal notranslate"><span class="pre">symbols()</span></code></a> function, except it
automatically injects symbol names into the calling namespace. This function
is designed solely for interactive typing convenience and is not recommended
for programmatic use.</p>
<p>Do not use <code class="docutils literal notranslate"><span class="pre">sympify()</span></code> or <code class="docutils literal notranslate"><span class="pre">S()</span></code> to create symbols. This may appear to work:</p>
<div class="highlight-py notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sympy</span> <span class="kn">import</span> <span class="n">S</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">x</span> <span class="o">=</span> <span class="n">S</span><span class="p">(</span><span class="s2">&quot;x&quot;</span><span class="p">)</span> <span class="c1"># DO NOT DO THIS</span>
</pre></div>
</div>
<p>However, <code class="docutils literal notranslate"><span class="pre">S()</span></code>/<code class="docutils literal notranslate"><span class="pre">sympify()</span></code> are not designed to create symbols. They are
designed to parse entire expressions. This method fails if the input string
is not valid Python. It also fails if the string parses to a larger
expression:</p>
<div class="highlight-py notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># These both fail</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">x</span> <span class="o">=</span> <span class="n">S</span><span class="p">(</span><span class="s2">&quot;0x&quot;</span><span class="p">)</span> 
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">SyntaxError</span>: <span class="n">invalid syntax (&lt;string&gt;, line 1)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">x</span> <span class="o">=</span> <span class="n">S</span><span class="p">(</span><span class="s2">&quot;x+&quot;</span><span class="p">)</span> 
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">SyntaxError</span>: <span class="n">invalid syntax (&lt;string&gt;, line 1)</span>
</pre></div>
</div>
<p>Any Python string can be used as a valid Symbol name.</p>
<p>Furthermore, all the same issues described in the
<a class="reference internal" href="#best-practices-avoid-string-inputs"><span class="std std-ref">Avoid String Inputs</span></a> section below apply here.</p>
</li>
<li><p><strong>Add assumptions to symbols when they are known.</strong>
<a class="reference internal" href="../guides/assumptions.html#assumptions-guide"><span class="std std-ref">Assumptions</span></a> can be added by passing the relevant
keywords to <a class="reference internal" href="../modules/core.html#sympy.core.symbol.symbols" title="sympy.core.symbol.symbols"><code class="xref py py-func docutils literal notranslate"><span class="pre">symbols()</span></code></a>. The most common assumptions are <code class="docutils literal notranslate"><span class="pre">real=True</span></code>,
<code class="docutils literal notranslate"><span class="pre">positive=True</span></code> (or <code class="docutils literal notranslate"><span class="pre">nonnegative=True</span></code>), and <code class="docutils literal notranslate"><span class="pre">integer=True</span></code>.</p>
<p>Assumptions are never required, but it is always recommended to include them
if they are known because it will allow certain operations to simplify. If
no assumptions are provided, symbols are assumed to be general complex
numbers, and simplifications will not be made unless they are true for all
complex numbers.</p>
<p>For example:</p>
<div class="highlight-py notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sympy</span> <span class="kn">import</span> <span class="n">integrate</span><span class="p">,</span> <span class="n">exp</span><span class="p">,</span> <span class="n">oo</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a</span> <span class="o">=</span> <span class="n">symbols</span><span class="p">(</span><span class="s1">&#39;a&#39;</span><span class="p">)</span> <span class="c1"># no assumptions</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">integrate</span><span class="p">(</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">a</span><span class="o">*</span><span class="n">x</span><span class="p">),</span> <span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">oo</span><span class="p">))</span>
<span class="go">Piecewise((1/a, Abs(arg(a)) &lt; pi/2), (Integral(exp(-a*x), (x, 0, oo)), True))</span>
</pre></div>
</div>
<div class="highlight-py notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">a</span> <span class="o">=</span> <span class="n">symbols</span><span class="p">(</span><span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="n">positive</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">integrate</span><span class="p">(</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">a</span><span class="o">*</span><span class="n">x</span><span class="p">),</span> <span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">oo</span><span class="p">))</span>
<span class="go">1/a</span>
</pre></div>
</div>
<p>Here, <span class="math notranslate nohighlight">\(\int_0^\infty e^{-ax}\,dx\)</span> gives a piecewise result when <code class="docutils literal notranslate"><span class="pre">a</span></code>
is defined with no assumptions, because the integral only converges when <code class="docutils literal notranslate"><span class="pre">a</span></code>
is positive. Setting <code class="docutils literal notranslate"><span class="pre">a</span></code> to be positive removes this piecewise.</p>
<p>When you do use assumptions, the best practice is to always use the same
assumptions for each symbol name. SymPy allows the same symbol name to be
defined with different assumptions, but these symbols will be considered
unequal to each other:</p>
<div class="highlight-py notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">z1</span> <span class="o">=</span> <span class="n">symbols</span><span class="p">(</span><span class="s1">&#39;z&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">z2</span> <span class="o">=</span> <span class="n">symbols</span><span class="p">(</span><span class="s1">&#39;z&#39;</span><span class="p">,</span> <span class="n">positive</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">z1</span> <span class="o">==</span> <span class="n">z2</span>
<span class="go">False</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">z1</span> <span class="o">+</span> <span class="n">z2</span>
<span class="go">z + z</span>
</pre></div>
</div>
</li>
</ul>
<p>See also <a class="reference internal" href="#best-practices-avoid-string-inputs"><span class="std std-ref">Avoid String Inputs</span></a> and
<a class="reference internal" href="#best-practices-dont-hardcode-symbol-names"><span class="std std-ref">Don’t Hardcode Symbol Names in Python Functions</span></a> for related best practices
around defining symbols.</p>
</section>
<section id="avoid-string-inputs">
<span id="best-practices-avoid-string-inputs"></span><h3>Avoid String Inputs<a class="headerlink" href="#avoid-string-inputs" title="Link to this heading">¶</a></h3>
<p>Don’t use strings as input to functions. Rather, create the objects
symbolically using Symbols and the appropriate SymPy functions, and manipulate
them.</p>
<p><strong>Don’t</strong></p>
<div class="highlight-py notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sympy</span> <span class="kn">import</span> <span class="n">expand</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">expand</span><span class="p">(</span><span class="s2">&quot;(x**2 + x)/x&quot;</span><span class="p">)</span>
<span class="go">x + 1</span>
</pre></div>
</div>
<p><strong>Do</strong></p>
<div class="highlight-py notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sympy</span> <span class="kn">import</span> <span class="n">symbols</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">x</span> <span class="o">=</span> <span class="n">symbols</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">expand</span><span class="p">((</span><span class="n">x</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">x</span><span class="p">)</span><span class="o">/</span><span class="n">x</span><span class="p">)</span>
<span class="go">x + 1</span>
</pre></div>
</div>
<p>It’s always best to create expressions explicitly using Python operators, but
sometimes you really do start with a string input, like if you accept an
expression from the user. If you do have a string that you are starting with,
you should parse it explicitly with
<a class="reference internal" href="../modules/parsing.html#sympy.parsing.sympy_parser.parse_expr" title="sympy.parsing.sympy_parser.parse_expr"><span class="xref myst py py-func"><code class="docutils literal notranslate"><span class="pre">parse_expr()</span></code></span></a>. It is best to parse
all strings early and only use symbolic manipulation from there on.</p>
<div class="highlight-py notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sympy</span> <span class="kn">import</span> <span class="n">parse_expr</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">string_input</span> <span class="o">=</span> <span class="s2">&quot;(x**2 + x)/x&quot;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">expr</span> <span class="o">=</span> <span class="n">parse_expr</span><span class="p">(</span><span class="n">string_input</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">expand</span><span class="p">(</span><span class="n">expr</span><span class="p">)</span>
<span class="go">x + 1</span>
</pre></div>
</div>
<p><strong>Reason</strong></p>
<p>There are many disadvantages to using strings as input to SymPy functions:</p>
<ul>
<li><p>It is unpythonic and makes code harder to read. See <a class="reference external" href="https://peps.python.org/pep-0020/">the Zen of
Python</a> “explicit is better than implicit”.</p></li>
<li><p>Support for string inputs in general SymPy functions is mostly accidental.
It happens because these functions call <a class="reference internal" href="../modules/core.html#sympy.core.sympify.sympify" title="sympy.core.sympify.sympify"><code class="xref py py-func docutils literal notranslate"><span class="pre">sympify()</span></code></a> on their inputs in
order to convert things like Python <code class="docutils literal notranslate"><span class="pre">int</span></code>s into SymPy <code class="docutils literal notranslate"><span class="pre">Integer</span></code>s. However,
<code class="docutils literal notranslate"><span class="pre">sympify()</span></code> also parses strings into SymPy expressions, unless the
<code class="docutils literal notranslate"><span class="pre">strict=True</span></code> flag is used. Automatic parsing of strings for general SymPy
functions (other than <code class="docutils literal notranslate"><span class="pre">sympify()</span></code> or <a class="reference internal" href="../modules/parsing.html#sympy.parsing.sympy_parser.parse_expr" title="sympy.parsing.sympy_parser.parse_expr"><code class="xref py py-func docutils literal notranslate"><span class="pre">parse_expr()</span></code></a>) <a class="reference external" href="https://github.com/sympy/sympy/issues/11003">may go away in
a future version of SymPy</a>.</p></li>
<li><p>Typos in symbol or function names can go unnoticed. This is because all
undefined names in the string will be automatically parsed into Symbols or
Functions. If the input has a typo, the string will still parse correctly,
but the output will not be what was expected. For example</p>
<div class="highlight-py notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sympy</span> <span class="kn">import</span> <span class="n">expand_trig</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">expand_trig</span><span class="p">(</span><span class="s2">&quot;sine(x + y)&quot;</span><span class="p">)</span>
<span class="go">sine(x + y)</span>
</pre></div>
</div>
<p>Compare this to the explicit error you get when not using strings:</p>
<div class="highlight-py notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sympy</span> <span class="kn">import</span> <span class="n">sin</span><span class="p">,</span> <span class="n">symbols</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">symbols</span><span class="p">(</span><span class="s1">&#39;x y&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">expand_trig</span><span class="p">(</span><span class="n">sine</span><span class="p">(</span><span class="n">x</span> <span class="o">+</span> <span class="n">y</span><span class="p">))</span> <span class="c1"># The typo is caught by a NameError</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">NameError</span>: <span class="n">name &#39;sine&#39; is not defined</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">expand_trig</span><span class="p">(</span><span class="n">sin</span><span class="p">(</span><span class="n">x</span> <span class="o">+</span> <span class="n">y</span><span class="p">))</span>
<span class="go">sin(x)*cos(y) + sin(y)*cos(x)</span>
</pre></div>
</div>
<p>In the first example, <code class="docutils literal notranslate"><span class="pre">sine</span></code>, a typo for <code class="docutils literal notranslate"><span class="pre">sin</span></code>, is parsed into
<code class="docutils literal notranslate"><span class="pre">Function(&quot;sine&quot;)</span></code>, and it appears that <code class="docutils literal notranslate"><span class="pre">expand_trig</span></code> cannot handle it. In the
second case, we immediately get an error from the undefined name <code class="docutils literal notranslate"><span class="pre">sine</span></code>, and
fixing our typo, we see that <code class="docutils literal notranslate"><span class="pre">expand_trig</span></code> can indeed do what we want.</p>
</li>
<li><p>The biggest gotcha when using string inputs comes from using assumptions. In
SymPy, if two symbols have the same name but different assumptions, they are
considered unequal:</p>
<div class="highlight-py notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">z1</span> <span class="o">=</span> <span class="n">symbols</span><span class="p">(</span><span class="s1">&#39;z&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">z2</span> <span class="o">=</span> <span class="n">symbols</span><span class="p">(</span><span class="s1">&#39;z&#39;</span><span class="p">,</span> <span class="n">positive</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">z1</span> <span class="o">==</span> <span class="n">z2</span>
<span class="go">False</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">z1</span> <span class="o">+</span> <span class="n">z2</span>
<span class="go">z + z</span>
</pre></div>
</div>
<p>It is generally recommended to avoid doing this, as it can lead to confusing
expressions like the one above (see <a class="reference internal" href="#best-practices-defining-symbols"><span class="std std-ref">Defining Symbols</span></a>
above).</p>
<p>However, string inputs will always create symbols without assumptions. So
if you have a symbol with an assumption and later try to use the string
version of it, you will end up with confusing results.</p>
<div class="highlight-py notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sympy</span> <span class="kn">import</span> <span class="n">diff</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">z</span> <span class="o">=</span> <span class="n">symbols</span><span class="p">(</span><span class="s1">&#39;z&#39;</span><span class="p">,</span> <span class="n">positive</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">diff</span><span class="p">(</span><span class="s1">&#39;z**2&#39;</span><span class="p">,</span> <span class="n">z</span><span class="p">)</span>
<span class="go">0</span>
</pre></div>
</div>
<p>The answer here is apparently wrong, but what happened is that the <code class="docutils literal notranslate"><span class="pre">z</span></code> in
<code class="docutils literal notranslate"><span class="pre">&quot;z**2&quot;</span></code> parsed to <code class="docutils literal notranslate"><span class="pre">Symbol('z')</span></code> with no assumptions, which SymPy considers
to be a different symbol from <code class="docutils literal notranslate"><span class="pre">z</span> <span class="pre">=</span> <span class="pre">Symbol('z',</span> <span class="pre">positive=True)</span></code>, which is
used as the second argument to <code class="docutils literal notranslate"><span class="pre">diff()</span></code>. So as far as <code class="docutils literal notranslate"><span class="pre">diff</span></code> is concerned,
the expression is constant and the result is 0.</p>
<p>This sort of thing is particularly bad because it generally doesn’t lead to
any errors. It will just silently give the “wrong” answer because SymPy will
be treating symbols that you thought were the same as different. The
situation is avoided by not using string inputs.</p>
<p>If you are parsing strings, and you want some of the symbols in it to have
certain assumptions, you should create those symbols and pass them to the
dictionary to <a class="reference internal" href="../modules/parsing.html#sympy.parsing.sympy_parser.parse_expr" title="sympy.parsing.sympy_parser.parse_expr"><span class="xref myst py py-func"><code class="docutils literal notranslate"><span class="pre">parse_expr()</span></code></span></a>. For example:</p>
<p><strong>Don’t</strong></p>
<div class="highlight-py notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">c</span> <span class="o">=</span> <span class="n">symbols</span><span class="p">(</span><span class="s1">&#39;a b c&#39;</span><span class="p">,</span> <span class="n">real</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># a, b, and c in expr are different symbols without assumptions</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">expr</span> <span class="o">=</span> <span class="n">parse_expr</span><span class="p">(</span><span class="s1">&#39;a**2 + b - c&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">expr</span><span class="o">.</span><span class="n">subs</span><span class="p">({</span><span class="n">a</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="n">b</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="n">c</span><span class="p">:</span> <span class="mi">1</span><span class="p">})</span> <span class="c1"># The substitution (apparently) doesn&#39;t work</span>
<span class="go">a**2 + b - c</span>
</pre></div>
</div>
<p><strong>Do</strong></p>
<div class="highlight-py notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># a, b, and c are the same as the a, b, c with real=True defined above</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">expr</span> <span class="o">=</span> <span class="n">parse_expr</span><span class="p">(</span><span class="s1">&#39;a**2 + b - c&#39;</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;a&#39;</span><span class="p">:</span> <span class="n">a</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">:</span> <span class="n">b</span><span class="p">,</span> <span class="s1">&#39;c&#39;</span><span class="p">:</span> <span class="n">c</span><span class="p">})</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">expr</span><span class="o">.</span><span class="n">subs</span><span class="p">({</span><span class="n">a</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="n">b</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="n">c</span><span class="p">:</span> <span class="mi">1</span><span class="p">})</span>
<span class="go">1</span>
</pre></div>
</div>
</li>
<li><p>Many SymPy operations are defined as methods, not functions, that is, they
are called like <code class="docutils literal notranslate"><span class="pre">sympy_obj.method_name()</span></code>. These methods won’t work on
strings, since they are not yet SymPy objects. For example:</p>
<div class="highlight-py notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="s2">&quot;x + 1&quot;</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span><span class="s2">&quot;x&quot;</span><span class="p">,</span> <span class="s2">&quot;y&quot;</span><span class="p">)</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">AttributeError</span>: <span class="n">&#39;str&#39; object has no attribute &#39;subs&#39;</span>
</pre></div>
</div>
<p>Contrasted with:</p>
<div class="highlight-py notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">symbols</span><span class="p">(</span><span class="s1">&#39;x y&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">(</span><span class="n">x</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
<span class="go">y + 1</span>
</pre></div>
</div>
</li>
<li><p>Symbol names can contain any character, including things that aren’t
valid Python. But if you use strings as input, it is impossible to use such
symbols. For example</p>
<div class="highlight-py notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sympy</span> <span class="kn">import</span> <span class="n">solve</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">solve</span><span class="p">(</span><span class="s1">&#39;x_</span><span class="si">{2}</span><span class="s1"> - 1&#39;</span><span class="p">)</span> 
<span class="go">ValueError: Error from parse_expr with transformed code: &quot;Symbol (&#39;x_&#39; ){Integer (2 )}-Integer (1 )&quot;</span>
<span class="go">...</span>
<span class="go">SyntaxError: invalid syntax (&lt;string&gt;, line 1)</span>
</pre></div>
</div>
<p>This doesn’t work because <code class="docutils literal notranslate"><span class="pre">x_{2}</span></code> is not valid Python. But it is perfectly
possible to use this as a Symbol name:</p>
<div class="highlight-py notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">x2</span> <span class="o">=</span> <span class="n">symbols</span><span class="p">(</span><span class="s1">&#39;x_</span><span class="si">{2}</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">solve</span><span class="p">(</span><span class="n">x2</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="n">x2</span><span class="p">)</span>
<span class="go">[1]</span>
</pre></div>
</div>
<p>Actually, the above is the best case scenario, where you get an error. It is
also possible you might get something unexpected:</p>
<div class="highlight-py notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">solve</span><span class="p">(</span><span class="s1">&#39;x^1_2 - 1&#39;</span><span class="p">)</span>
<span class="go">[-1, 1, -I, I, -1/2 - sqrt(3)*I/2, -1/2 + sqrt(3)*I/2, 1/2 - sqrt(3)*I/2, 1/2 + sqrt(3)*I/2, -sqrt(3)/2 - I/2, -sqrt(3)/2 + I/2, sqrt(3)/2 - I/2, sqrt(3)/2 + I/2]</span>
</pre></div>
</div>
<p>What happened here is that instead of parsing <code class="docutils literal notranslate"><span class="pre">x^1_2</span></code> as <span class="math notranslate nohighlight">\(x^1_2\)</span>, it is
parsed as <code class="docutils literal notranslate"><span class="pre">x**12</span></code> (<code class="docutils literal notranslate"><span class="pre">^</span></code> is converted to <code class="docutils literal notranslate"><span class="pre">**</span></code> and <a class="reference external" href="https://peps.python.org/pep-0515/"><code class="docutils literal notranslate"><span class="pre">_</span></code> is ignored in
numeric literals in Python</a>).</p>
<p>If we instead create a Symbol, the actual contents of the symbol name are
ignored. It is always represented as a single symbol.</p>
<div class="highlight-py notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">x12</span> <span class="o">=</span> <span class="n">symbols</span><span class="p">(</span><span class="s1">&#39;x^1_2&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">solve</span><span class="p">(</span><span class="n">x12</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="n">x12</span><span class="p">)</span>
<span class="go">[1]</span>
</pre></div>
</div>
</li>
<li><p>If you use strings, syntax errors won’t be caught until the line is run. If
you build up the expressions, syntax errors will be caught immediately by
before any of it runs.</p></li>
<li><p>Syntax highlighting in code editors doesn’t typically recognize and
color-code the content of strings, whereas it can recognize Python
expressions.</p></li>
</ul>
</section>
<section id="avoid-manipulating-expressions-as-strings">
<h3>Avoid Manipulating Expressions as Strings<a class="headerlink" href="#avoid-manipulating-expressions-as-strings" title="Link to this heading">¶</a></h3>
<p>If you find yourself doing a lot of string or regular expression manipulations
on symbolic expressions, this is generally a sign that you are using SymPy
incorrectly. It’s better to build up expressions directly with operators like
<code class="docutils literal notranslate"><span class="pre">+</span></code>, <code class="docutils literal notranslate"><span class="pre">-</span></code>, <code class="docutils literal notranslate"><span class="pre">*</span></code>, and <code class="docutils literal notranslate"><span class="pre">/</span></code> and SymPy’s various functions and methods. String-based
manipulations can introduce errors, grow complex quickly, and lose the
benefits of symbolic expression structures.</p>
<p>The reason for this is that there is no notion of a symbolic expression in a
string. To Python, <code class="docutils literal notranslate"><span class="pre">&quot;(x</span> <span class="pre">+</span> <span class="pre">y)/z&quot;</span></code> is no different from <code class="docutils literal notranslate"><span class="pre">&quot;/x+)(y</span> <span class="pre">z</span> <span class="pre">&quot;</span></code>, which is
the same string with the characters in another order. To contrast, a SymPy
expression actually knows about what type of mathematical object it
represents. SymPy has many methods and functions for building and manipulating
expressions, and they all operate on SymPy objects, not strings.</p>
<p>For example</p>
<p><strong>Don’t</strong></p>
<div class="highlight-py notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">expression_str</span> <span class="o">=</span> <span class="s1">&#39;+&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s1">*x_</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s1">&#39;</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">)])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">expr</span> <span class="o">=</span> <span class="n">parse_expr</span><span class="p">(</span><span class="n">expression_str</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">expr</span>
<span class="go">x_1 + 2*x_2 + 3*x_3 + 4*x_4 + 5*x_5 + 6*x_6 + 7*x_7 + 8*x_8 + 9*x_9</span>
</pre></div>
</div>
<p><strong>Do</strong></p>
<div class="highlight-py notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sympy</span> <span class="kn">import</span> <span class="n">Add</span><span class="p">,</span> <span class="n">Symbol</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">expr</span> <span class="o">=</span> <span class="n">Add</span><span class="p">(</span><span class="o">*</span><span class="p">[</span><span class="n">i</span><span class="o">*</span><span class="n">Symbol</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;x_</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">)])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">expr</span>
<span class="go">x_1 + 2*x_2 + 3*x_3 + 4*x_4 + 5*x_5 + 6*x_6 + 7*x_7 + 8*x_8 + 9*x_9</span>
</pre></div>
</div>
<p>See also the <a class="reference internal" href="#best-practices-avoid-string-inputs"><span class="std std-ref">previous section on avoiding string inputs to
functions</span></a>.</p>
</section>
<section id="exact-rational-numbers-vs-floats">
<span id="best-practices-exact-rational-numbers-vs-floats"></span><h3>Exact Rational Numbers vs. Floats<a class="headerlink" href="#exact-rational-numbers-vs-floats" title="Link to this heading">¶</a></h3>
<p>If a number is known to be exactly equal to some quantity, avoid defining it
as a floating-point number.</p>
<p>For example,</p>
<p><strong>Don’t</strong></p>
<div class="highlight-py notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">expression</span> <span class="o">=</span> <span class="n">x</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="mf">0.5</span><span class="o">*</span><span class="n">x</span> <span class="o">+</span> <span class="mi">1</span>
</pre></div>
</div>
<p><strong>Do</strong></p>
<div class="highlight-py notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sympy</span> <span class="kn">import</span> <span class="n">Rational</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">expression</span> <span class="o">=</span> <span class="n">x</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">Rational</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">x</span> <span class="o">+</span> <span class="mi">1</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">expression</span> <span class="o">=</span> <span class="n">x</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">x</span><span class="o">/</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">1</span> <span class="c1"># Equivalently</span>
</pre></div>
</div>
<p>However, this isn’t to say that you should never use floating-point numbers in
SymPy, only that if a more exact value is known it should be preferred. SymPy
does support <a class="reference internal" href="../modules/core.html#sympy.core.numbers.Float" title="sympy.core.numbers.Float"><span class="xref myst py py-class">arbitrary precision floating-point
numbers</span></a>, but some operations may not perform as
well with them.</p>
<p>This also applies to non-rational numbers which can be represented exactly. For
example, one should avoid using <code class="docutils literal notranslate"><span class="pre">math.pi</span></code> and prefer <code class="docutils literal notranslate"><span class="pre">sympy.pi</span></code>, since the
former is a numerical approximation to <span class="math notranslate nohighlight">\(\pi\)</span> and the latter is exactly <span class="math notranslate nohighlight">\(\pi\)</span>
(see also <a class="reference internal" href="#best-practices-separate-symbolic-and-numeric-code"><span class="std std-ref">Separate Symbolic and Numeric Code</span></a> below; in
general, one should avoid importing <code class="docutils literal notranslate"><span class="pre">math</span></code> when using SymPy).</p>
<p><strong>Don’t</strong></p>
<div class="highlight-py notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">math</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">sympy</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">math</span><span class="o">.</span><span class="n">pi</span>
<span class="go">3.141592653589793</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sympy</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">math</span><span class="o">.</span><span class="n">pi</span><span class="p">)</span>
<span class="go">1.22464679914735e-16</span>
</pre></div>
</div>
<p><strong>Do</strong></p>
<div class="highlight-py notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">sympy</span><span class="o">.</span><span class="n">pi</span>
<span class="go">pi</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sympy</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">sympy</span><span class="o">.</span><span class="n">pi</span><span class="p">)</span>
<span class="go">0</span>
</pre></div>
</div>
<p>Here <code class="docutils literal notranslate"><span class="pre">sympy.sin(math.pi)</span></code> is not exactly 0, because <code class="docutils literal notranslate"><span class="pre">math.pi</span></code> is not exactly <span class="math notranslate nohighlight">\(\pi\)</span>.</p>
<p>One should also take care to avoid writing <code class="docutils literal notranslate"><span class="pre">integer/integer</span></code> where both
integers are explicit integers. This is because Python will evaluate this to a
floating-point value before SymPy is able to parse it.</p>
<p><strong>Don’t</strong></p>
<div class="highlight-py notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">x</span> <span class="o">+</span> <span class="mi">2</span><span class="o">/</span><span class="mi">7</span> <span class="c1"># The exact value of 2/7 is lost</span>
<span class="go">x + 0.2857142857142857</span>
</pre></div>
</div>
<p>In this case, use <a class="reference internal" href="../modules/core.html#sympy.core.numbers.Rational" title="sympy.core.numbers.Rational"><code class="xref py py-class docutils literal notranslate"><span class="pre">Rational</span></code></a> to create a rational number, or use
<code class="docutils literal notranslate"><span class="pre">S()</span></code> shorthand if you want to save on typing.</p>
<p><strong>Do</strong></p>
<div class="highlight-py notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sympy</span> <span class="kn">import</span> <span class="n">Rational</span><span class="p">,</span> <span class="n">S</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">x</span> <span class="o">+</span> <span class="n">Rational</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">7</span><span class="p">)</span>
<span class="go">x + 2/7</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">x</span> <span class="o">+</span> <span class="n">S</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">/</span><span class="mi">7</span> <span class="c1"># Equivalently</span>
<span class="go">x + 2/7</span>
</pre></div>
</div>
<p><strong>Reason</strong></p>
<p>Exact values, if they are known, should be preferred over floats for the
following reasons:</p>
<ul>
<li><p>An exact symbolic value can often be symbolically simplified or manipulated.
A float represents an approximation to an exact real number, and therefore
cannot be simplified exactly. For example, in the above example,
<code class="docutils literal notranslate"><span class="pre">sin(math.pi)</span></code> does not produce <code class="docutils literal notranslate"><span class="pre">0</span></code> because <code class="docutils literal notranslate"><span class="pre">math.pi</span></code> is not exactly <span class="math notranslate nohighlight">\(\pi\)</span>.
It is just a floating-point number that approximates <span class="math notranslate nohighlight">\(\pi\)</span> to 15 digits
(effectively, a close rational approximation to <span class="math notranslate nohighlight">\(\pi\)</span>, but not exactly
<span class="math notranslate nohighlight">\(\pi\)</span>).</p></li>
<li><p>Some algorithms will not be able to compute a result if there are
floating-point values, but can if the values are rational numbers. This is
because rational numbers have properties that make it easier for these
algorithms to work with them. For instance, with floats, one can have a
situation where a number should be 0, but due to approximation errors, does
not equal exactly 0.</p>
<p>A particularly notable example of this is with floating-point exponents. For
example,</p>
<div class="highlight-py notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sympy</span> <span class="kn">import</span> <span class="n">factor</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">factor</span><span class="p">(</span><span class="n">x</span><span class="o">**</span><span class="mf">2.0</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
<span class="go">x**2.0 - 1</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">factor</span><span class="p">(</span><span class="n">x</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
<span class="go">(x - 1)*(x + 1)</span>
</pre></div>
</div>
</li>
<li><p>SymPy Floats have the same loss of significance cancellation issues that can
occur from using finite precision floating-point approximations:</p>
<div class="highlight-py notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sympy</span> <span class="kn">import</span> <span class="n">expand</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">expand</span><span class="p">((</span><span class="n">x</span> <span class="o">+</span> <span class="mf">1.0</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">x</span> <span class="o">-</span> <span class="mf">1e-16</span><span class="p">))</span> <span class="c1"># the coefficient of x should be slightly less than 1</span>
<span class="go">x**2 + 1.0*x - 1.0e-16</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">expand</span><span class="p">((</span><span class="n">x</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">x</span> <span class="o">-</span> <span class="n">Rational</span><span class="p">(</span><span class="s1">&#39;1e-16&#39;</span><span class="p">)))</span> <span class="c1"># Using rational numbers gives the coefficient of x exactly</span>
<span class="go">x**2 + 9999999999999999*x/10000000000000000 - 1/10000000000000000</span>
</pre></div>
</div>
<p>It is possible to avoid these issues in SymPy in many cases by making
careful use of <code class="docutils literal notranslate"><span class="pre">evalf</span></code> with its ability to evaluate in arbitrary precision.
This typically involves either computing an expression with symbolic values
and substituting them later with <code class="docutils literal notranslate"><span class="pre">expr.evalf(subs=...)</span></code>, or by starting with
<code class="docutils literal notranslate"><span class="pre">Float</span></code> values with a precision higher than the default of 15 digits:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sympy</span> <span class="kn">import</span> <span class="n">Float</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">expand</span><span class="p">((</span><span class="n">x</span> <span class="o">+</span> <span class="mf">1.0</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">x</span> <span class="o">-</span> <span class="n">Float</span><span class="p">(</span><span class="s1">&#39;1e-16&#39;</span><span class="p">,</span> <span class="mi">20</span><span class="p">)))</span>
<span class="go">x**2 + 0.9999999999999999*x - 1.0e-16</span>
</pre></div>
</div>
</li>
</ul>
<p>A <code class="docutils literal notranslate"><span class="pre">Float</span></code> number can be converted to its exact rational equivalent by passing
it to <code class="docutils literal notranslate"><span class="pre">Rational</span></code>. Alternatively, you can use <code class="docutils literal notranslate"><span class="pre">nsimplify</span></code> to find the nicest
rational approximation. This can sometimes reproduce the number that was
intended if the number is supposed to be rational (although again, it’s best
to just start with rational numbers in the first place, if you can):</p>
<div class="highlight-py notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sympy</span> <span class="kn">import</span> <span class="n">nsimplify</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Rational</span><span class="p">(</span><span class="mf">0.7</span><span class="p">)</span>
<span class="go">3152519739159347/4503599627370496</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">nsimplify</span><span class="p">(</span><span class="mf">0.7</span><span class="p">)</span>
<span class="go">7/10</span>
</pre></div>
</div>
</section>
<section id="avoid-simplify">
<h3>Avoid <code class="docutils literal notranslate"><span class="pre">simplify()</span></code><a class="headerlink" href="#avoid-simplify" title="Link to this heading">¶</a></h3>
<p><a class="reference internal" href="../modules/simplify/simplify.html#sympy.simplify.simplify.simplify" title="sympy.simplify.simplify.simplify"><code class="xref py py-func docutils literal notranslate"><span class="pre">simplify()</span></code></a> (not to be confused with <a class="reference internal" href="../modules/core.html#sympy.core.sympify.sympify" title="sympy.core.sympify.sympify"><code class="xref py py-func docutils literal notranslate"><span class="pre">sympify()</span></code></a>) is designed as
a general purpose heuristic. It tries various simplification algorithms on the
input expression and returns the result that seems the “simplest” based on
some metric.</p>
<p><code class="docutils literal notranslate"><span class="pre">simplify()</span></code> is perfectly fine for interactive use, where you just want SymPy
to do whatever it can to an expression. However, in programmatic usage, it’s
better to avoid <code class="docutils literal notranslate"><span class="pre">simplify()</span></code> and use more <a class="reference internal" href="../modules/simplify/simplify.html#simplify-docs"><span class="std std-ref">targeted simplification
functions</span></a> instead (e.g., <a class="reference internal" href="../modules/polys/reference.html#sympy.polys.polytools.cancel" title="sympy.polys.polytools.cancel"><code class="xref py py-func docutils literal notranslate"><span class="pre">cancel()</span></code></a>, <a class="reference internal" href="../modules/core.html#sympy.core.function.expand" title="sympy.core.function.expand"><code class="xref py py-func docutils literal notranslate"><span class="pre">expand()</span></code></a>,
or <a class="reference internal" href="../modules/simplify/simplify.html#sympy.simplify.radsimp.collect" title="sympy.simplify.radsimp.collect"><code class="xref py py-func docutils literal notranslate"><span class="pre">collect()</span></code></a>).</p>
<p>There are a few reasons why this is generally preferred:</p>
<ul>
<li><p>Due to its heuristical nature, <code class="docutils literal notranslate"><span class="pre">simplify()</span></code> can potentially be slow, since
it tries a lot of different approaches to try to find the best
simplification.</p></li>
<li><p>There are no guarantees about what form an expression will have after being
passed through <code class="docutils literal notranslate"><span class="pre">simplify()</span></code>. It may actually end up “less simple” by
whatever metric you were hoping for. To contrast, targeted simplification
functions are very specific about what behaviors they have and what they
guarantee about the output. For example,</p>
<ul class="simple">
<li><p><a class="reference internal" href="../modules/polys/reference.html#sympy.polys.polytools.factor" title="sympy.polys.polytools.factor"><code class="xref py py-func docutils literal notranslate"><span class="pre">factor()</span></code></a> will always factor a polynomial into irreducible factors.</p></li>
<li><p><a class="reference internal" href="../modules/polys/reference.html#sympy.polys.polytools.cancel" title="sympy.polys.polytools.cancel"><code class="xref py py-func docutils literal notranslate"><span class="pre">cancel()</span></code></a> will always convert a rational function into the form
<span class="math notranslate nohighlight">\(p/q\)</span> where <span class="math notranslate nohighlight">\(p\)</span> and <span class="math notranslate nohighlight">\(q\)</span> are expanded polynomials with no common factors.</p></li>
</ul>
<p>The documentation for each function describes exactly what behavior it will
have on the input expression.</p>
</li>
<li><p>A targeted simplification will not do something unexpected if the expression
contains an unexpected form, or an unexpected subexpression. This is
especially the case if simplification functions are applied with <code class="docutils literal notranslate"><span class="pre">deep=False</span></code>
to only apply the simplification to the top-level expression.</p></li>
</ul>
<p>Some other simplification functions are heuristical in nature, and care should
be taken with them as well. For example, the <a class="reference internal" href="../modules/simplify/simplify.html#sympy.simplify.trigsimp.trigsimp" title="sympy.simplify.trigsimp.trigsimp"><code class="xref py py-func docutils literal notranslate"><span class="pre">trigsimp()</span></code></a> function is a
heuristic targeted to trigonometric functions, but the routines in the
<a class="reference internal" href="../modules/simplify/fu.html#module-sympy.simplify.fu" title="sympy.simplify.fu"><code class="xref py py-mod docutils literal notranslate"><span class="pre">sympy.simplify.fu</span></code></a> submodule allow applying specific trigonometric
identities.</p>
<p>The <a class="reference internal" href="../tutorials/intro-tutorial/simplification.html#tutorial-simplify"><span class="std std-ref">simplify section of the tutorial</span></a> and the
<a class="reference internal" href="../modules/simplify/simplify.html"><span class="std std-doc">simplify module reference</span></a> list the various
targeted simplification functions.</p>
<p>In some cases, you may know exactly what simplification operations you wish to
apply to an expression, but there may not be an exact set of simplification
functions that do them. When this happens, you can create your own targeted
simplification using <a class="reference internal" href="../modules/core.html#sympy.core.basic.Basic.replace" title="sympy.core.basic.Basic.replace"><code class="xref py py-meth docutils literal notranslate"><span class="pre">replace()</span></code></a>, or in general, manually using
<a class="reference internal" href="../tutorials/intro-tutorial/manipulation.html#tutorial-manipulation"><span class="std std-ref">advanced expression manipulation</span></a>.</p>
<!-- TODO: Add an example -->
</section>
<section id="don-t-hardcode-symbol-names-in-python-functions">
<span id="best-practices-dont-hardcode-symbol-names"></span><h3>Don’t Hardcode Symbol Names in Python Functions<a class="headerlink" href="#don-t-hardcode-symbol-names-in-python-functions" title="Link to this heading">¶</a></h3>
<p>Instead of hard-coding <a class="reference internal" href="../modules/core.html#sympy.core.symbol.Symbol" title="sympy.core.symbol.Symbol"><code class="xref py py-class docutils literal notranslate"><span class="pre">Symbol</span></code></a> names inside of a function
definition, make the symbols a parameter to the function.</p>
<p>For example, consider a function <code class="docutils literal notranslate"><span class="pre">theta_operator</span></code> that computes the <a class="reference external" href="https://en.wikipedia.org/wiki/Theta_operator">theta
operator</a> <span class="math notranslate nohighlight">\(\theta =
zD_z\)</span>:</p>
<p><strong>Don’t</strong></p>
<div class="highlight-py notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">theta_operator</span><span class="p">(</span><span class="n">expr</span><span class="p">):</span>
    <span class="n">z</span> <span class="o">=</span> <span class="n">symbols</span><span class="p">(</span><span class="s1">&#39;z&#39;</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">z</span><span class="o">*</span><span class="n">expr</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">z</span><span class="p">)</span>
</pre></div>
</div>
<p><strong>Do</strong></p>
<div class="highlight-py notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">theta_operator</span><span class="p">(</span><span class="n">expr</span><span class="p">,</span> <span class="n">z</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">z</span><span class="o">*</span><span class="n">expr</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">z</span><span class="p">)</span>
</pre></div>
</div>
<p>A hard-coded symbol name has the disadvantage of requiring all expressions to
use that exact symbol name. In the above example, it is not possible to
compute <span class="math notranslate nohighlight">\(\theta = xD_x\)</span> because it is hard-coded to <span class="math notranslate nohighlight">\(zD_z\)</span>. What’s worse,
trying to do so silently leads to a wrong result instead of an error, since
<code class="docutils literal notranslate"><span class="pre">x</span></code> is treated as a constant expression:</p>
<div class="highlight-py notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="k">def</span> <span class="nf">theta_operator</span><span class="p">(</span><span class="n">expr</span><span class="p">):</span>
<span class="gp">... </span>    <span class="n">z</span> <span class="o">=</span> <span class="n">symbols</span><span class="p">(</span><span class="s1">&#39;z&#39;</span><span class="p">)</span>
<span class="gp">... </span>    <span class="k">return</span> <span class="n">z</span><span class="o">*</span><span class="n">expr</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">z</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">theta_operator</span><span class="p">(</span><span class="n">x</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span> <span class="c1"># The expected answer is 2*x**2</span>
<span class="go">0</span>
</pre></div>
</div>
<p>This is particularly problematic if the function accepts arbitrary user input,
as the user may be using a different variable name that makes more sense in
their mathematical context. And if the user already used the symbol <code class="docutils literal notranslate"><span class="pre">z</span></code> but as
a constant, they would need to swap things around with <code class="docutils literal notranslate"><span class="pre">subs</span></code> before being
able to use the function.</p>
<p>The other reason this antipattern is problematic is due to the gotcha that
symbols with assumptions are considered unequal to symbols without
assumptions. If someone defined their expression using</p>
<div class="highlight-py notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">z</span> <span class="o">=</span> <span class="n">symbols</span><span class="p">(</span><span class="s1">&#39;z&#39;</span><span class="p">,</span> <span class="n">positive</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
<p>for example, to make further simplifications possible (see
<a class="reference internal" href="#best-practices-defining-symbols"><span class="std std-ref">Defining Symbols</span></a> above), the function hard-coding
<code class="docutils literal notranslate"><span class="pre">Symbol('z')</span></code> without assumptions would not work:</p>
<div class="highlight-py notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">theta_operator</span><span class="p">(</span><span class="n">z</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
<span class="go">0</span>
</pre></div>
</div>
<p>By making the symbol an argument to the function, like <code class="docutils literal notranslate"><span class="pre">theta_operator(expr,</span> <span class="pre">z)</span></code>, these problems all go away.</p>
</section>
<section id="separate-symbolic-and-numeric-code">
<span id="best-practices-separate-symbolic-and-numeric-code"></span><h3>Separate Symbolic and Numeric Code<a class="headerlink" href="#separate-symbolic-and-numeric-code" title="Link to this heading">¶</a></h3>
<p>SymPy sets itself apart from most of the rest of the libraries in the Python
ecosystem in that it operates symbolically, whereas other libraries, like
NumPy, operate numerically. These two paradigms are different enough that it’s
always best to keep them as separate as possible.</p>
<p>Importantly, SymPy is not designed to work with NumPy arrays, and conversely,
NumPy will not work directly with SymPy objects.</p>
<div class="highlight-py notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">sympy</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.</span><span class="p">,</span> <span class="mf">1.</span><span class="p">,</span> <span class="mf">2.</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sympy</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">AttributeError</span>: <span class="n">&#39;ImmutableDenseNDimArray&#39; object has no attribute &#39;as_coefficient&#39;</span>
</pre></div>
</div>
<div class="highlight-py notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">x</span> <span class="o">=</span> <span class="n">Symbol</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="c1"># NumPy functions do not know how to handle SymPy expressions</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">TypeError</span>: <span class="n">loop of ufunc does not support argument 0 of type Symbol which has no callable sin method</span>
</pre></div>
</div>
<p>If you want to use both SymPy and NumPy, you should explicitly convert your
SymPy expressions into NumPy functions using <a class="reference internal" href="../modules/utilities/lambdify.html#sympy.utilities.lambdify.lambdify" title="sympy.utilities.lambdify.lambdify"><code class="xref py py-func docutils literal notranslate"><span class="pre">lambdify()</span></code></a>. The typical
workflow in SymPy is to model your problem symbolically using SymPy, then
convert the result into a numerical function with <code class="docutils literal notranslate"><span class="pre">lambdify()</span></code> that can be
evaluated on NumPy arrays. For advanced use-cases, <code class="docutils literal notranslate"><span class="pre">lambdify()</span></code>/NumPy may not
be enough and you may instead need to use SymPy’s more general <a class="reference internal" href="../modules/codegen.html#codegen-prose"><span class="std std-ref">code
generation</span></a> routines to generate code for other fast numerical
languages such as Fortran or C.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># First symbolically construct the expression you are interested in with SymPy</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sympy</span> <span class="kn">import</span> <span class="n">diff</span><span class="p">,</span> <span class="n">sin</span><span class="p">,</span> <span class="n">exp</span><span class="p">,</span> <span class="n">lambdify</span><span class="p">,</span> <span class="n">symbols</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">x</span> <span class="o">=</span> <span class="n">symbols</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">expr</span> <span class="o">=</span> <span class="n">diff</span><span class="p">(</span><span class="n">sin</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="n">x</span><span class="o">**</span><span class="mi">2</span><span class="p">),</span> <span class="n">x</span><span class="p">)</span>

<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Then convert it to a numeric function with lambdify()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">f</span> <span class="o">=</span> <span class="n">lambdify</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">expr</span><span class="p">)</span>

<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Now use this function with NumPy</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">f</span><span class="p">(</span><span class="n">a</span><span class="p">)</span> 
<span class="go">[ 1.00000000e+00  1.10713341e+00  1.46699555e+00 ... -3.15033720e+44]</span>
</pre></div>
</div>
<p>These are some antipatterns that should be generally avoided</p>
<ul>
<li><p><strong>Do not use <code class="docutils literal notranslate"><span class="pre">import</span> <span class="pre">math</span></code>.</strong> It is virtually never necessary to use the
<a class="reference external" href="https://docs.python.org/3/library/math.html">standard library <code class="docutils literal notranslate"><span class="pre">math</span></code>
module</a> alongside SymPy (or
NumPy). Every function that is in <code class="docutils literal notranslate"><span class="pre">math</span></code> is already in SymPy. SymPy can
compute values numerically using <a class="reference internal" href="glossary.html#term-evalf"><span class="xref std std-term">evalf</span></a>, which provides more
precision and accuracy than <code class="docutils literal notranslate"><span class="pre">math</span></code>. Or better, SymPy will by default compute
things symbolically. Functions and constants in <code class="docutils literal notranslate"><span class="pre">math</span></code> are floats, which are
inexact. SymPy always works better with exact quantities when possible. For
example,</p>
<div class="highlight-py notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">math</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">math</span><span class="o">.</span><span class="n">pi</span> <span class="c1"># a float</span>
<span class="go">3.141592653589793</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">sympy</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sympy</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">math</span><span class="o">.</span><span class="n">pi</span><span class="p">)</span>
<span class="go">1.22464679914735e-16</span>
</pre></div>
</div>
<p>The result of <code class="docutils literal notranslate"><span class="pre">sympy.sin(math.pi)</span></code> is not <code class="docutils literal notranslate"><span class="pre">0</span></code> as you might expect, because
<code class="docutils literal notranslate"><span class="pre">math.pi</span></code> is only an approximation of <span class="math notranslate nohighlight">\(\pi\)</span>, equal to 16 digits. On the
other hand, <code class="docutils literal notranslate"><span class="pre">sympy.pi</span></code> is <em>exactly</em> equal to <span class="math notranslate nohighlight">\(\pi\)</span> because it is represented
symbolically, so it is able to give the exact answer:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">sympy</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">sympy</span><span class="o">.</span><span class="n">pi</span><span class="p">)</span>
<span class="go">0</span>
</pre></div>
</div>
<p>So in general, one should <a class="reference internal" href="#best-practices-exact-rational-numbers-vs-floats"><span class="std std-ref">prefer symbolic
representations</span></a>. But even
if you actually do want a float, you are better off using SymPy’s <code class="docutils literal notranslate"><span class="pre">evalf()</span></code>
rather than <code class="docutils literal notranslate"><span class="pre">math</span></code>. This avoids the pitfall that <code class="docutils literal notranslate"><span class="pre">math</span></code> functions can only
operate on <code class="docutils literal notranslate"><span class="pre">float</span></code> objects, not symbolic expressions</p>
<div class="highlight-py notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">x</span> <span class="o">=</span> <span class="n">Symbol</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">math</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">TypeError</span>: <span class="n">Cannot convert expression to float</span>
</pre></div>
</div>
<p>And furthermore, SymPy’s <code class="docutils literal notranslate"><span class="pre">evalf()</span></code> is more accurate than <code class="docutils literal notranslate"><span class="pre">math</span></code>, because it
uses arbitrary precision arithmetic, and allows you to specify any number
of digits.</p>
<div class="highlight-py notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">sympy</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">evalf</span><span class="p">(</span><span class="mi">30</span><span class="p">)</span>
<span class="go">0.841470984807896506652502321630</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">math</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="go">0.8414709848078965</span>
</pre></div>
</div>
<p>Even when using NumPy, <code class="docutils literal notranslate"><span class="pre">math</span></code> should be avoided. NumPy functions are faster
than their <code class="docutils literal notranslate"><span class="pre">math</span></code> equivalents, support a larger range of numerical dtypes,
and can operate on arrays of values, whereas <code class="docutils literal notranslate"><span class="pre">math</span></code> functions can only
operate on a single scalar at a time.</p>
</li>
<li><p><strong>Don’t pass SymPy expressions to a NumPy function.</strong> You should not pass a
SymPy expression to a NumPy function. This includes anything in the <code class="docutils literal notranslate"><span class="pre">numpy</span></code>
or <code class="docutils literal notranslate"><span class="pre">scipy</span></code> namespaces, as well as most functions from other Python libraries
such as <code class="docutils literal notranslate"><span class="pre">matplotlib</span></code>. These functions are only designed to work with NumPy
arrays with numeric values.</p></li>
<li><p><strong>Don’t pass SymPy expressions to a lambdified function.</strong> Similar to the
previous point, you should not pass SymPy expressions to a function created
with <code class="docutils literal notranslate"><span class="pre">lambdify</span></code>. In effect, the functions returned by <code class="docutils literal notranslate"><span class="pre">lambdify</span></code> <em>are</em> NumPy
functions, so the situation here is exactly the same. It is possible that in
some cases a function created from <code class="docutils literal notranslate"><span class="pre">lambdify()</span></code> will work with a SymPy
expression, but this is just an accident of the way it works. See <a class="reference internal" href="../modules/utilities/lambdify.html#lambdify-how-it-works"><span class="std std-ref">the “how
it works” section of the <code class="docutils literal notranslate"><span class="pre">lambdify()</span></code> documentation</span></a>
for more details on why this happens.</p></li>
<li><p><strong>Avoid storing SymPy expressions in a NumPy array.</strong> While it is
technically possible to store SymPy expressions inside of a NumPy array,
doing so usually represents a mistake. A sign that this is happening is if
the <code class="docutils literal notranslate"><span class="pre">dtype</span></code> of the NumPy array is <code class="docutils literal notranslate"><span class="pre">object</span></code> (instead of a numeric dtype like
<code class="docutils literal notranslate"><span class="pre">float64</span></code> or <code class="docutils literal notranslate"><span class="pre">int64</span></code>).</p>
<p>Just as one should avoid using NumPy when doing symbolic calculations with
SymPy, one should stop using SymPy once the calculation have moved over to
the numeric side of things with NumPy.</p>
<p>A NumPy array that contains SymPy expressions effectively has the same
problem as trying to call NumPy functions directly on a SymPy expression.
They do not know how to operate on SymPy objects, so they will fail. This
applies even if the SymPy objects are all SymPy
<a class="reference internal" href="../modules/core.html#sympy.core.numbers.Float" title="sympy.core.numbers.Float"><span class="xref myst py py-class"><code class="docutils literal notranslate"><span class="pre">Float</span></code>s</span></a>.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">sympy</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">([</span><span class="n">sympy</span><span class="o">.</span><span class="n">Float</span><span class="p">(</span><span class="mf">1.0</span><span class="p">),</span> <span class="n">sympy</span><span class="o">.</span><span class="n">Float</span><span class="p">(</span><span class="mf">0.0</span><span class="p">)])</span> <span class="c1"># Do not do this</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="nb">repr</span><span class="p">(</span><span class="n">a</span><span class="p">))</span> <span class="c1"># Note that the dtype is &#39;object&#39;</span>
<span class="go">array([1.00000000000000, 0.0], dtype=object)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">TypeError</span>: <span class="n">loop of ufunc does not support argument 0 of type Float which has no callable sin method</span>
</pre></div>
</div>
<p>If you are doing this, you should probably either be using native NumPy
floats, or, if you really do want to store an array of SymPy expressions,
you should use SymPy’s <a class="reference internal" href="../modules/matrices/dense.html#sympy.matrices.dense.Matrix" title="sympy.matrices.dense.Matrix"><span class="xref myst py py-attr"><code class="docutils literal notranslate"><span class="pre">Matrix</span></code></span></a> or
<code class="docutils literal notranslate"><span class="pre">NDimArray</span></code> classes.</p>
</li>
</ul>
</section>
</section>
<section id="advanced-usage">
<h2>Advanced Usage<a class="headerlink" href="#advanced-usage" title="Link to this heading">¶</a></h2>
<section id="be-careful-comparing-and-sorting-symbolic-objects">
<h3>Be Careful Comparing and Sorting Symbolic Objects<a class="headerlink" href="#be-careful-comparing-and-sorting-symbolic-objects" title="Link to this heading">¶</a></h3>
<p>Be careful with programmatic code that compares numerical quantities, either
directly using an inequality (<code class="docutils literal notranslate"><span class="pre">&lt;</span></code>, <code class="docutils literal notranslate"><span class="pre">&lt;=</span></code>, <code class="docutils literal notranslate"><span class="pre">&gt;</span></code>, <code class="docutils literal notranslate"><span class="pre">&gt;=</span></code>) or indirectly with
something like <code class="docutils literal notranslate"><span class="pre">sorted</span></code>. The issue is that if an inequality is unknown, the
result will be symbolic, like</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">x</span> <span class="o">&gt;</span> <span class="mi">0</span>
<span class="go">x &gt; 0</span>
</pre></div>
</div>
<p>A symbolic inequality will raise an exception if <code class="docutils literal notranslate"><span class="pre">bool()</span></code> is called on it, due
to the ambiguity:</p>
<div class="highlight-py notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">bool</span><span class="p">(</span><span class="n">x</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">TypeError</span>: <span class="n">cannot determine truth value of Relational</span>
</pre></div>
</div>
<p>A check like</p>
<div class="highlight-py notranslate"><div class="highlight"><pre><span></span><span class="k">if</span> <span class="n">x</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
    <span class="o">...</span>
</pre></div>
</div>
<p>May work just fine if you only ever test it for numerical <code class="docutils literal notranslate"><span class="pre">x</span></code>. But if <code class="docutils literal notranslate"><span class="pre">x</span></code> can
ever be symbolic, the above code is wrong. It will fail with <code class="docutils literal notranslate"><span class="pre">TypeError:</span> <span class="pre">cannot</span> <span class="pre">determine</span> <span class="pre">truth</span> <span class="pre">value</span> <span class="pre">of</span> <span class="pre">Relational</span></code>. If you ever see this exception,
it means this error has been made somewhere (sometimes the error is in SymPy
itself; if this appears to be the case, please <a class="reference external" href="https://github.com/sympy/sympy/issues">open an
issue</a>).</p>
<p>The exact same issue occurs when using <code class="docutils literal notranslate"><span class="pre">sorted</span></code>, since this internally uses <code class="docutils literal notranslate"><span class="pre">&gt;</span></code>.</p>
<div class="highlight-py notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">sorted</span><span class="p">([</span><span class="n">x</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">TypeError</span>: <span class="n">cannot determine truth value of Relational</span>
</pre></div>
</div>
<p>There are a few options for fixing this issue, and the correct one to choose
depends on what you are doing:</p>
<ul>
<li><p><strong>Disallow symbolic inputs.</strong> If your function cannot possibly work on
symbolic inputs, you can explicitly disallow them. The primary benefit here
is to give a more readable error message to users than <code class="docutils literal notranslate"><span class="pre">TypeError:</span>&#160; <span class="pre">cannot</span> <span class="pre">determine</span> <span class="pre">truth</span> <span class="pre">value</span> <span class="pre">of</span> <span class="pre">Relational</span></code>. The
<a class="reference internal" href="../modules/core.html#sympy.core.expr.Expr.is_number" title="sympy.core.expr.Expr.is_number"><code class="xref py py-attr docutils literal notranslate"><span class="pre">is_number</span></code></a> attribute can be used to check if an
expression can be evaluated to a specific number with <code class="docutils literal notranslate"><span class="pre">evalf()</span></code>. If you want
to only accept integers, you can check <code class="docutils literal notranslate"><span class="pre">isinstance(x,</span> <span class="pre">Integer)</span></code> (after
calling <code class="docutils literal notranslate"><span class="pre">sympify()</span></code> to convert Python ints). Beware that <code class="docutils literal notranslate"><span class="pre">is_integer</span></code> uses
the assumptions system and may be True even for symbolic objects, like
<code class="docutils literal notranslate"><span class="pre">Symbol('x',</span> <span class="pre">integer=True)</span></code>.</p></li>
<li><p><strong>Use the assumptions system.</strong> If you do support symbolic inputs, you
should use the assumptions system to check for things like <code class="docutils literal notranslate"><span class="pre">x</span> <span class="pre">&gt;</span> <span class="pre">0</span></code>, e.g.,
using <code class="docutils literal notranslate"><span class="pre">x.is_positive</span></code>. When doing this, you should always <a class="reference internal" href="../guides/booleans.html#booleans-guide"><span class="std std-ref">be aware of the
nuances</span></a> of the <a class="reference internal" href="glossary.html#term-Three-valued-logic"><span class="xref std std-term">three-valued fuzzy logic</span></a> used in the assumptions system. That is, always be
aware that an assumption could be <code class="docutils literal notranslate"><span class="pre">None</span></code>, meaning its value is unknown and
could be either true or false. For example,</p>
<div class="highlight-py notranslate"><div class="highlight"><pre><span></span><span class="k">if</span> <span class="n">x</span><span class="o">.</span><span class="n">is_positive</span><span class="p">:</span>
    <span class="o">...</span>
</pre></div>
</div>
<p>will only run the block if <code class="docutils literal notranslate"><span class="pre">x.is_positive</span></code> is <code class="docutils literal notranslate"><span class="pre">True</span></code>, but you may want to do
something when <code class="docutils literal notranslate"><span class="pre">x.is_positive</span></code> is <code class="docutils literal notranslate"><span class="pre">None</span></code>.</p>
</li>
<li><p><strong>Return a Piecewise result.</strong> If the result of a function depends on an
inequality or other boolean condition, you can use <a class="reference internal" href="../modules/functions/elementary.html#sympy.functions.elementary.piecewise.Piecewise" title="sympy.functions.elementary.piecewise.Piecewise"><code class="xref py py-class docutils literal notranslate"><span class="pre">Piecewise</span></code></a> to
return a result that represents both possibilities symbolically. This is
generally preferred when possible, as it offers the most flexibility. This
is because the result is represented symbolically, meaning, for instance,
one can later substitute specific values for the symbols and it will
evaluate to the specific case, even if it is combined with other
expressions.</p>
<p>For example, instead of</p>
<div class="highlight-py notranslate"><div class="highlight"><pre><span></span><span class="k">if</span> <span class="n">x</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
    <span class="n">expr</span> <span class="o">=</span> <span class="mi">1</span>
<span class="k">else</span><span class="p">:</span>
    <span class="n">expr</span> <span class="o">=</span> <span class="mi">0</span>
</pre></div>
</div>
<p>this can be represented symbolically as</p>
<div class="highlight-py notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sympy</span> <span class="kn">import</span> <span class="n">Piecewise</span><span class="p">,</span> <span class="n">pprint</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">expr</span> <span class="o">=</span> <span class="n">Piecewise</span><span class="p">((</span><span class="mi">1</span><span class="p">,</span> <span class="n">x</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="kc">True</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pprint</span><span class="p">(</span><span class="n">expr</span><span class="p">,</span> <span class="n">use_unicode</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="go">⎧1  for x &gt; 0</span>
<span class="go">⎨</span>
<span class="go">⎩0  otherwise</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">expr</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="go">1</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">expr</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span class="go">0</span>
</pre></div>
</div>
</li>
<li><p><strong>Use <a class="reference internal" href="../modules/core.html#sympy.core.sorting.ordered" title="sympy.core.sorting.ordered"><code class="xref py py-func docutils literal notranslate"><span class="pre">ordered()</span></code></a> to sort expressions into a canonical order.</strong> If you
are trying to use <code class="docutils literal notranslate"><span class="pre">sorted</span></code> because you want a canonical ordering, but you
don’t particularly care what that ordering is, you can use <code class="docutils literal notranslate"><span class="pre">ordered</span></code>.</p>
<div class="highlight-py notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sympy</span> <span class="kn">import</span> <span class="n">ordered</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">list</span><span class="p">(</span><span class="n">ordered</span><span class="p">([</span><span class="n">x</span><span class="p">,</span> <span class="mi">0</span><span class="p">]))</span>
<span class="go">[0, x]</span>
</pre></div>
</div>
<p>Alternatively, try to write the function in a way so that the correctness of
the result does not depend on the order that arguments are processed in.</p>
</li>
</ul>
</section>
</section>
<section id="custom-sympy-objects">
<h2>Custom SymPy Objects<a class="headerlink" href="#custom-sympy-objects" title="Link to this heading">¶</a></h2>
<p>SymPy is designed to be extended with custom classes, typically by subclassing
<a class="reference internal" href="glossary.html#term-Basic"><span class="xref std std-term">Basic</span></a>, <a class="reference internal" href="glossary.html#term-Expr"><span class="xref std std-term">Expr</span></a>, or <a class="reference internal" href="glossary.html#term-Function-class"><span class="xref std std-term">Function</span></a>. All the
symbolic classes in SymPy itself are written this way, and the points here
apply equally to them as to user-defined classes.</p>
<p>For an in-depth guide on how to write a <code class="docutils literal notranslate"><span class="pre">Function</span></code> subclass, see the <a class="reference internal" href="../guides/custom-functions.html#custom-functions"><span class="std std-ref">guide on
writing custom functions</span></a>.</p>
<section id="args-invariants">
<span id="best-practices-args-invariants"></span><h3>Args Invariants<a class="headerlink" href="#args-invariants" title="Link to this heading">¶</a></h3>
<p>Custom SymPy objects should always satisfy the following invariants:</p>
<ol class="arabic simple">
<li><p><code class="docutils literal notranslate"><span class="pre">all(isinstance(arg,</span> <span class="pre">Basic)</span> <span class="pre">for</span> <span class="pre">arg</span> <span class="pre">in</span> <span class="pre">args)</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">expr.func(*expr.args)</span> <span class="pre">==</span> <span class="pre">expr</span></code></p></li>
</ol>
<p>The first says that all elements of <a class="reference internal" href="glossary.html#term-args"><span class="xref std std-term">args</span></a> should be instances of
<a class="reference internal" href="glossary.html#term-Basic"><span class="xref std std-term">Basic</span></a>. The second says that an expression should be rebuildable from
its <code class="docutils literal notranslate"><span class="pre">args</span></code> (note that <a class="reference internal" href="glossary.html#term-func"><span class="xref std std-term">func</span></a> is usually the same as <code class="docutils literal notranslate"><span class="pre">type(expr)</span></code>, though
it may not always be).</p>
<p>These two invariants are assumed throughout SymPy, and are essential for any
function that manipulates expressions.</p>
<p>For example, consider this simple function, which is a simplified version of
<a class="reference internal" href="../modules/core.html#sympy.core.basic.Basic.xreplace" title="sympy.core.basic.Basic.xreplace"><code class="xref py py-meth docutils literal notranslate"><span class="pre">xreplace()</span></code></a>:</p>
<div class="highlight-py notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="k">def</span> <span class="nf">replace</span><span class="p">(</span><span class="n">expr</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">):</span>
<span class="gp">... </span><span class="w">    </span><span class="sd">&quot;&quot;&quot;Replace x with y in expr&quot;&quot;&quot;</span>
<span class="gp">... </span>    <span class="n">newargs</span> <span class="o">=</span> <span class="p">[]</span>
<span class="gp">... </span>    <span class="k">for</span> <span class="n">arg</span> <span class="ow">in</span> <span class="n">expr</span><span class="o">.</span><span class="n">args</span><span class="p">:</span>
<span class="gp">... </span>        <span class="k">if</span> <span class="n">arg</span> <span class="o">==</span> <span class="n">x</span><span class="p">:</span>
<span class="gp">... </span>            <span class="n">newargs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>
<span class="gp">... </span>        <span class="k">else</span><span class="p">:</span>
<span class="gp">... </span>            <span class="n">newargs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">replace</span><span class="p">(</span><span class="n">arg</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">))</span>
<span class="gp">... </span>    <span class="k">return</span> <span class="n">expr</span><span class="o">.</span><span class="n">func</span><span class="p">(</span><span class="o">*</span><span class="n">newargs</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">replace</span><span class="p">(</span><span class="n">x</span> <span class="o">+</span> <span class="n">sin</span><span class="p">(</span><span class="n">x</span> <span class="o">-</span> <span class="mi">1</span><span class="p">),</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
<span class="go">y + sin(y - 1)</span>
</pre></div>
</div>
<p>The function works by recursively traversing the <code class="docutils literal notranslate"><span class="pre">args</span></code> of <code class="docutils literal notranslate"><span class="pre">expr</span></code>, and
rebuilding it except any instances of <code class="docutils literal notranslate"><span class="pre">x</span></code> are replaced by <code class="docutils literal notranslate"><span class="pre">y</span></code>.</p>
<p>It’s easy to see how this function would break if the args invariants did not
hold:</p>
<ol class="arabic simple">
<li><p>If an expression had args that were not <code class="docutils literal notranslate"><span class="pre">Basic</span></code>, they would fail with
<code class="docutils literal notranslate"><span class="pre">AttributeError</span></code> on a recursive call, because the non-<code class="docutils literal notranslate"><span class="pre">Basic</span></code> args would not
have the <code class="docutils literal notranslate"><span class="pre">.args</span></code> or <code class="docutils literal notranslate"><span class="pre">.func</span></code> attributes.</p></li>
<li><p>If an expression did not rebuild from its <code class="docutils literal notranslate"><span class="pre">args</span></code>, the line <code class="docutils literal notranslate"><span class="pre">return</span> <span class="pre">exr.func(*newargs)</span></code> would fail, even in the trivial case where none of the
args are changed by the replacement, which should effectively be a no-op.</p></li>
</ol>
<p>Making all <code class="docutils literal notranslate"><span class="pre">args</span></code> instances of <code class="docutils literal notranslate"><span class="pre">Basic</span></code> usually just means calling <code class="docutils literal notranslate"><span class="pre">_sympify()</span></code>
on the inputs to the class so that they are basic instances. If you want to
store a string on a class, you should either use a <code class="docutils literal notranslate"><span class="pre">Symbol</span></code> or
<code class="docutils literal notranslate"><span class="pre">sympy.core.symbols.Str</span></code>.</p>
<p>In some cases a class may accept args in multiple equivalent forms. It is
important that whatever form is stored in <code class="docutils literal notranslate"><span class="pre">args</span></code> is one of the ways that can
be used to reconstruct the class. It is okay to normalize <code class="docutils literal notranslate"><span class="pre">args</span></code> as long as
that normalized form is accepted as input. For example, <code class="docutils literal notranslate"><span class="pre">Integral</span></code> always
stores the variable argument as a tuple to make things easier to process
internally, but this form is also accepted by the class constructor:</p>
<div class="highlight-py notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sympy</span> <span class="kn">import</span> <span class="n">Integral</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">expr</span> <span class="o">=</span> <span class="n">Integral</span><span class="p">(</span><span class="n">sin</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="n">x</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">expr</span><span class="o">.</span><span class="n">args</span> <span class="c1"># args are normalized</span>
<span class="go">(sin(x), (x,))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Integral</span><span class="p">(</span><span class="n">sin</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="p">(</span><span class="n">x</span><span class="p">,))</span> <span class="c1"># Also accepted</span>
<span class="go">Integral(sin(x), x)</span>
</pre></div>
</div>
<p>Note that most user-defined custom functions should be defined by subclassing
<code class="docutils literal notranslate"><span class="pre">Function</span></code> (see the <a class="reference internal" href="../guides/custom-functions.html#custom-functions"><span class="std std-ref">guide to writing custom functions</span></a>).
The <code class="docutils literal notranslate"><span class="pre">Function</span></code> class automatically takes care of both of the args invariants,
so if you are using it, you do not need to worry about this.</p>
</section>
<section id="avoid-too-much-automatic-evaluation">
<span id="best-practices-avoid-automatic-evaluation"></span><h3>Avoid Too Much Automatic Evaluation<a class="headerlink" href="#avoid-too-much-automatic-evaluation" title="Link to this heading">¶</a></h3>
<p>When defining a custom function, avoid doing too much automatic evaluation
(i.e., evaluation in the <code class="docutils literal notranslate"><span class="pre">eval</span></code> or <code class="docutils literal notranslate"><span class="pre">__new__</span></code> methods).</p>
<p>Generally, automatic evaluation should only be done in instances where it is
fast, and it is something that no one ever want to not happen. Automatic
evaluation is difficult to undo. A good rule of thumb is to evaluate on
explicit numeric values (<code class="docutils literal notranslate"><span class="pre">isinstance(x,</span> <span class="pre">Number)</span></code>), and leave everything else
symbolically unevaluated.
Further simplification using more advanced identities should be done in
specific simplification functions or <code class="docutils literal notranslate"><span class="pre">doit</span></code> (see the <a class="reference internal" href="../guides/custom-functions.html#custom-functions"><span class="std std-ref">custom functions
guide</span></a> for a list of common simplification routines that can
be defined on SymPy objects).</p>
<p>The <a class="reference internal" href="../guides/custom-functions.html#custom-functions-automatic-evaluation"><span class="std std-ref">custom functions guide</span></a> goes over
this in depth (but note that this guideline applies equally to all SymPy
objects, not just functions). But in a nutshell, the reason for this is that
the only way to prevent automatic evaluation is to use <code class="docutils literal notranslate"><span class="pre">evaluate=False</span></code>, which
is fragile. Additionally, code will invariably be written assuming the
invariants that are true due to automatic evaluations, meaning that
expressions created with <code class="docutils literal notranslate"><span class="pre">evaluate=False</span></code> can lead to wrong results from this
code. This also means that removing automatic evaluation later can be
difficult.</p>
<p>Evaluation that can potentially be expensive (for instance, applying a
symbolic identity) is itself bad because it can make creating an expression
without even doing anything with it allow. This also applies to checking for
symbolic assumptions (like <code class="docutils literal notranslate"><span class="pre">x.is_integer</span></code>), so this should also be avoided in
class constructors.</p>
<p><strong>Don’t</strong></p>
<div class="highlight-py notranslate"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">f</span><span class="p">(</span><span class="n">Function</span><span class="p">):</span>
    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">eval</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">x</span><span class="o">.</span><span class="n">is_integer</span><span class="p">:</span> <span class="c1"># Bad (checking general assumptions)</span>
            <span class="k">return</span> <span class="mi">0</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">Add</span><span class="p">):</span> <span class="c1"># Bad (applying symbolic identities)</span>
            <span class="k">return</span> <span class="n">Add</span><span class="p">(</span><span class="o">*</span><span class="p">[</span><span class="n">f</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">x</span><span class="o">.</span><span class="n">args</span><span class="p">])</span>

</pre></div>
</div>
<p><strong>Do</strong></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">f</span><span class="p">(</span><span class="n">Function</span><span class="p">):</span>
    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">eval</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">Integer</span><span class="p">):</span> <span class="c1"># Good (only evaluating on explicit integers)</span>
            <span class="k">return</span> <span class="mi">0</span>

    <span class="c1"># Good (applying simplification on assumptions in doit())</span>
    <span class="k">def</span> <span class="nf">doit</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">deep</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="o">**</span><span class="n">hints</span><span class="p">):</span>
        <span class="n">x</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">args</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">deep</span><span class="p">:</span>
           <span class="n">x</span> <span class="o">=</span> <span class="n">x</span><span class="o">.</span><span class="n">doit</span><span class="p">(</span><span class="n">deep</span><span class="o">=</span><span class="n">deep</span><span class="p">,</span> <span class="o">**</span><span class="n">hints</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">x</span><span class="o">.</span><span class="n">is_integer</span><span class="p">:</span>
           <span class="k">return</span> <span class="n">S</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span>

    <span class="c1"># Good (applying symbolic identities inside of simplification functions)</span>
    <span class="k">def</span> <span class="nf">_eval_expand_func</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">hints</span><span class="p">):</span>
        <span class="n">x</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">args</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">Add</span><span class="p">):</span>
            <span class="k">return</span> <span class="n">Add</span><span class="p">(</span><span class="o">*</span><span class="p">[</span><span class="n">f</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">x</span><span class="o">.</span><span class="n">args</span><span class="p">])</span>
        <span class="k">return</span> <span class="bp">self</span>
</pre></div>
</div>
<p>Note that not all the classes in SymPy currently follow this guideline very
well, but it is something that we are improving.</p>
</section>
<section id="don-t-denest-collections">
<h3>Don’t Denest Collections<a class="headerlink" href="#don-t-denest-collections" title="Link to this heading">¶</a></h3>
<p>Functions and classes that accept an arbitrary number of arguments should
either accept the arguments directly, like <code class="docutils literal notranslate"><span class="pre">f(*args)</span></code>, or as a single
argument, like <code class="docutils literal notranslate"><span class="pre">f(args)</span></code>. They should not try to support both at once.</p>
<p>The reason is that this makes it impossible to represented nested collections.
For example, take the <a class="reference internal" href="../modules/sets.html#sympy.sets.sets.FiniteSet" title="sympy.sets.sets.FiniteSet"><code class="xref py py-class docutils literal notranslate"><span class="pre">FiniteSet</span></code></a> class. It is constructed like
<code class="docutils literal notranslate"><span class="pre">FiniteSet(x,</span> <span class="pre">y,</span> <span class="pre">z)</span></code> (i.e., using <code class="docutils literal notranslate"><span class="pre">*args</span></code>).</p>
<div class="highlight-py notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sympy</span> <span class="kn">import</span> <span class="n">FiniteSet</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">FiniteSet</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
<span class="go">{1, 2, 3}</span>
</pre></div>
</div>
<p>It might be tempting to also support <code class="docutils literal notranslate"><span class="pre">FiniteSet([1,</span> <span class="pre">2,</span> <span class="pre">3])</span></code>, to match the
built-in <code class="docutils literal notranslate"><span class="pre">set</span></code>. However, doing so would make it impossible to represent a
nested <code class="docutils literal notranslate"><span class="pre">FiniteSet</span></code> containing a single <code class="docutils literal notranslate"><span class="pre">FiniteSet</span></code>, like <span class="math notranslate nohighlight">\(\{\{1, 2, 3\}\}\)</span>:</p>
<div class="highlight-py notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">FiniteSet</span><span class="p">(</span><span class="n">FiniteSet</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">))</span> <span class="c1"># We don&#39;t want this to be the same as {1, 2, 3}</span>
<span class="go">FiniteSet({1, 2, 3})</span>
</pre></div>
</div>
<p>As to whether <code class="docutils literal notranslate"><span class="pre">args</span></code> or <code class="docutils literal notranslate"><span class="pre">*args</span></code> should be used, if it is only possible for
there to be a finite number of arguments, <code class="docutils literal notranslate"><span class="pre">*args</span></code> is generally better, as this
makes things easier to deal with using the object’s <a class="reference internal" href="glossary.html#term-args"><span class="xref std std-term">args</span></a>, since
<code class="docutils literal notranslate"><span class="pre">obj.args</span></code> will be the direct arguments of the class. However, if it is
possible that you might want to support a symbolic infinite collection in
addition to finite ones, like <a class="reference internal" href="../modules/sets.html#sympy.sets.fancysets.Integers" title="sympy.sets.fancysets.Integers"><code class="xref py py-class docutils literal notranslate"><span class="pre">Integers</span></code></a> or <a class="reference internal" href="../modules/sets.html#sympy.sets.fancysets.Range" title="sympy.sets.fancysets.Range"><code class="xref py py-class docutils literal notranslate"><span class="pre">Range</span></code></a>, then it
is better to use <code class="docutils literal notranslate"><span class="pre">args</span></code> as this will be impossible to do with <code class="docutils literal notranslate"><span class="pre">*args</span></code>.</p>
</section>
<section id="avoid-storing-extra-attributes-on-an-object">
<span id="best-practices-extra-attributes"></span><h3>Avoid Storing Extra Attributes on an Object<a class="headerlink" href="#avoid-storing-extra-attributes-on-an-object" title="Link to this heading">¶</a></h3>
<p>A common reason that you might want to create a custom SymPy object is that
you want to store extra attributes on the object. However, doing this in a
naive way, i.e., by simply storing the data as a Python attribute on the
object, is almost always a bad idea.</p>
<p>SymPy does not expect objects to have extra data stored in them beyond what is
in their <a class="reference internal" href="glossary.html#term-args"><span class="xref std std-term">args</span></a>. For instance, this breaks <code class="docutils literal notranslate"><span class="pre">==</span></code> checking, which only
compares an objects <code class="docutils literal notranslate"><span class="pre">args</span></code>. See the <a class="reference internal" href="#best-practices-eq"><span class="std std-ref">Don’t Overwrite __eq__</span></a> section below for
why it is a bad idea to override <code class="docutils literal notranslate"><span class="pre">__eq__</span></code>. This section and that one are
closely related.</p>
<p>Typically, there is a better way to do what you are trying to do, depending on
the specific details of your situation:</p>
<ul>
<li><p><strong>Store the extra data in the object’s <code class="docutils literal notranslate"><span class="pre">args</span></code>.</strong> This is the best approach if
the extra data you want to store is part of the <em>mathematical</em> description
of your object.</p>
<p>As long as the data is representable using other SymPy objects, it can be
stored in <code class="docutils literal notranslate"><span class="pre">args</span></code>. Note that an object’s <code class="docutils literal notranslate"><span class="pre">args</span></code> should be usable to <a class="reference internal" href="#best-practices-args-invariants"><span class="std std-ref">recreate
the object</span></a> (e.g., something like
<code class="docutils literal notranslate"><span class="pre">YourObject(*instance.args)</span></code> should recreate <code class="docutils literal notranslate"><span class="pre">instance</span></code>).</p>
<p>Additionally, it should be mentioned that it is not a good idea to subclass
<code class="docutils literal notranslate"><span class="pre">Symbol</span></code> if you plan to store anything extra in <code class="docutils literal notranslate"><span class="pre">args</span></code>. <code class="docutils literal notranslate"><span class="pre">Symbol</span></code> is designed
around having no <code class="docutils literal notranslate"><span class="pre">args</span></code>. You are better off subclassing <code class="docutils literal notranslate"><span class="pre">Function</span></code> (see
<a class="reference internal" href="../guides/custom-functions.html#custom-functions"><span class="std std-ref">Writing Custom Functions</span></a>) or <code class="docutils literal notranslate"><span class="pre">Expr</span></code> directly. If you simply want to have two
symbols that are distinct from one another, the best approach is often just
to give them different names. If you are concerned about how they are
printed, you can replace them with a more canonical name when it comes time
to print things, or use a <a class="reference internal" href="../modules/printing.html#module-printing"><span class="std std-ref">custom printer</span></a>.</p>
</li>
<li><p><strong>Store the data about the object separately.</strong> This is the best approach if
the extra data is not directly related to an object’s mathematical
properties.</p>
<p>Remember that SymPy objects are hashable, so they can easily be used as
dictionary keys. So maintaining a separate dictionary of <code class="docutils literal notranslate"><span class="pre">{object:</span> <span class="pre">extra_data}</span></code> pairs is straightforward.</p>
<p>Note that some SymPy APIs already allow redefining how they operate on
objects separately from the objects themselves. A big example of this is the
<a class="reference internal" href="glossary.html#term-Printing"><span class="xref std std-term">printers</span></a>, which allow defining <a class="reference internal" href="../modules/printing.html#module-printing"><span class="std std-ref">custom
printers</span></a> that change how any SymPy object is printed
without modifying those object themselves. Functions like <a class="reference internal" href="../modules/utilities/lambdify.html#sympy.utilities.lambdify.lambdify" title="sympy.utilities.lambdify.lambdify"><code class="xref py py-func docutils literal notranslate"><span class="pre">lambdify()</span></code></a>
and <a class="reference internal" href="../modules/interactive.html#sympy.interactive.printing.init_printing" title="sympy.interactive.printing.init_printing"><code class="xref py py-func docutils literal notranslate"><span class="pre">init_printing()</span></code></a> allow passing in a custom printer.</p>
</li>
<li><p><strong>Represent the attribute using different subclasses.</strong> This is often a good
idea if there are only a few possible values for the attribute (e.g., a
boolean flag). Code duplication can be avoided by using a common superclass.</p></li>
<li><p><strong>If the data you want to store is a Python function</strong>, it’s best to just
use as a method on the class. In many cases, the method may already fit into
one of the <a class="reference internal" href="../guides/custom-functions.html#custom-functions"><span class="std std-ref">existing set of overridable SymPy methods</span></a>. If
you want to define how a function evaluates itself numerically, you can use
<a class="reference internal" href="../modules/utilities/lambdify.html#sympy.utilities.lambdify.implemented_function" title="sympy.utilities.lambdify.implemented_function"><code class="xref py py-func docutils literal notranslate"><span class="pre">implemented_function()</span></code></a>.</p></li>
<li><p><strong>Represent the information using by modifying the object’s <code class="docutils literal notranslate"><span class="pre">func</span></code>.</strong> This
solution is much more complicated than the others, and should only be used
when it is necessary. In some extreme cases, it is not possible to represent
every mathematical aspect of an object using <code class="docutils literal notranslate"><span class="pre">args</span></code> alone. This can happen,
for example, because of the limitation that <a class="reference internal" href="#best-practices-args-invariants"><span class="std std-ref"><code class="docutils literal notranslate"><span class="pre">args</span></code> should only contain
<code class="docutils literal notranslate"><span class="pre">Basic</span></code> instances</span></a>. It is still possible to
create custom SymPy objects in these situations by using a custom
<a class="reference internal" href="glossary.html#term-func"><span class="xref std std-term">func</span></a> that is different from <code class="docutils literal notranslate"><span class="pre">type(expr)</span></code> (in this case, you would
override <code class="docutils literal notranslate"><span class="pre">__eq__</span></code> on the <code class="docutils literal notranslate"><span class="pre">func</span></code> <a class="reference internal" href="#best-practices-eq"><span class="std std-ref">rather than on the
class</span></a>).</p>
<p>However, this sort of situation is rare.</p>
</li>
</ul>
</section>
<section id="don-t-overwrite-eq">
<span id="best-practices-eq"></span><h3>Don’t Overwrite <code class="docutils literal notranslate"><span class="pre">__eq__</span></code><a class="headerlink" href="#don-t-overwrite-eq" title="Link to this heading">¶</a></h3>
<p>When building a custom SymPy object, it is sometimes tempting to overwrite
<code class="docutils literal notranslate"><span class="pre">__eq__</span></code> to define custom logic for the <code class="docutils literal notranslate"><span class="pre">==</span></code> operator. This is almost always a
bad idea. Custom SymPy classes should leave <code class="docutils literal notranslate"><span class="pre">__eq__</span></code> undefined and use the
default implementation in the <code class="docutils literal notranslate"><span class="pre">Basic</span></code> superclass.</p>
<p>In SymPy, <code class="docutils literal notranslate"><span class="pre">==</span></code> compares objects using <a class="reference internal" href="glossary.html#term-Structural-Equality"><span class="xref std std-term">structural equality</span></a>. That is, <code class="docutils literal notranslate"><span class="pre">a</span> <span class="pre">==</span> <span class="pre">b</span></code> means that <code class="docutils literal notranslate"><span class="pre">a</span></code> and <code class="docutils literal notranslate"><span class="pre">b</span></code> are exactly the same object. They have the same
type and the same <a class="reference internal" href="glossary.html#term-args"><span class="xref std std-term">args</span></a>. <code class="docutils literal notranslate"><span class="pre">==</span></code> does not perform any sort of
<em>mathematical</em> equality checking. For example,</p>
<div class="highlight-py notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">x</span><span class="o">*</span><span class="p">(</span><span class="n">x</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">==</span> <span class="n">x</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span> <span class="n">x</span>
<span class="go">False</span>
</pre></div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">==</span></code> also always returns a boolean <code class="docutils literal notranslate"><span class="pre">True</span></code> or <code class="docutils literal notranslate"><span class="pre">False</span></code>. Symbolic equations can
be represented with <a class="reference internal" href="../modules/core.html#sympy.core.relational.Equality" title="sympy.core.relational.Equality"><code class="xref py py-class docutils literal notranslate"><span class="pre">Eq</span></code></a>.</p>
<p>There are several reasons for this</p>
<ul class="simple">
<li><p>Mathematical equality checking can be very expensive to compute, and in
general, it is <a class="reference external" href="https://en.wikipedia.org/wiki/Richardson%27s_theorem">computationally impossible to
determine</a>.</p></li>
<li><p>Python itself automatically uses <code class="docutils literal notranslate"><span class="pre">==</span></code> in various places and assumes that it
returns a boolean and is inexpensive to compute. For example, if <code class="docutils literal notranslate"><span class="pre">b</span></code> is a
builtin Python container like <code class="docutils literal notranslate"><span class="pre">list</span></code>, <code class="docutils literal notranslate"><span class="pre">dict</span></code>, or <code class="docutils literal notranslate"><span class="pre">set</span></code>, then <code class="docutils literal notranslate"><span class="pre">a</span> <span class="pre">in</span> <span class="pre">b</span></code> uses
<code class="docutils literal notranslate"><span class="pre">==</span></code>.<a class="footnote-reference brackets" href="#dict-footnote" id="id1" role="doc-noteref"><span class="fn-bracket">[</span>1<span class="fn-bracket">]</span></a></p></li>
</ul>
<ul class="simple">
<li><p>SymPy internally uses <code class="docutils literal notranslate"><span class="pre">==</span></code> all over the place, both explicitly and
implicitly via things like <code class="docutils literal notranslate"><span class="pre">in</span></code> or dictionary keys. This
usage all implicitly assumes that <code class="docutils literal notranslate"><span class="pre">==</span></code> operates structurally.</p></li>
</ul>
<p>In affect, <em>structural equality</em> means that if <code class="docutils literal notranslate"><span class="pre">a</span> <span class="pre">==</span> <span class="pre">b</span></code> is <code class="docutils literal notranslate"><span class="pre">True</span></code>, then <code class="docutils literal notranslate"><span class="pre">a</span></code>
and <code class="docutils literal notranslate"><span class="pre">b</span></code> are for all intents and purposes the same object. This is because all
SymPy objects are <a class="reference internal" href="glossary.html#term-Immutable"><span class="xref std std-term">immutable</span></a>. When <code class="docutils literal notranslate"><span class="pre">a</span> <span class="pre">==</span> </code>, any SymPy function may
freely replace <code class="docutils literal notranslate"><span class="pre">a</span></code> with <code class="docutils literal notranslate"><span class="pre">b</span></code> in any subexpression.</p>
<p>The default <code class="docutils literal notranslate"><span class="pre">__eq__</span></code> method on <a class="reference internal" href="glossary.html#term-Basic"><span class="xref std std-term">Basic</span></a> checks if the two objects have
the same type and the same <code class="docutils literal notranslate"><span class="pre">args</span></code>. There are also many parts of SymPy that
implicitly assume that if two objects are equal, then they have the same
<code class="docutils literal notranslate"><span class="pre">args</span></code>. Therefore, it is not a good idea to try to override <code class="docutils literal notranslate"><span class="pre">__eq__</span></code> as a way
to avoid storing some identifying information about an object in its <code class="docutils literal notranslate"><span class="pre">args</span></code>.
The <code class="docutils literal notranslate"><span class="pre">args</span></code> of an object should contain everything that is needed to recreate
it (see <a class="reference internal" href="glossary.html#term-args"><span class="xref std std-term">args</span></a>). Note that it is possible for an objects constructor to
accept multiple forms of arguments, so long as it accepts the form stored in
<code class="docutils literal notranslate"><span class="pre">args</span></code> (e.g., it is perfectly fine for some args to have default values).</p>
<p>Here are some examples of reasons you might be tempted to override <code class="docutils literal notranslate"><span class="pre">__eq__</span></code>
and the preferred alternatives:</p>
<ul>
<li><p>To make <code class="docutils literal notranslate"><span class="pre">==</span></code> apply some smarter equality check than purely structural
equality. As noted above, this is a bad idea because too many things
implicitly assume <code class="docutils literal notranslate"><span class="pre">==</span></code> works structurally only. Instead, use a function or
method to implement the smarter equality checking (for example, the <code class="docutils literal notranslate"><span class="pre">equals</span></code>
method).</p>
<p>Another option is to define a <a class="reference internal" href="glossary.html#term-Canonicalize"><span class="xref std std-term">canonicalization</span></a> method
that puts objects into canonical form (e.g., via <code class="docutils literal notranslate"><span class="pre">doit</span></code>), so that, for
instance, <code class="docutils literal notranslate"><span class="pre">x.doit()</span> <span class="pre">==</span> <span class="pre">y.doit()</span></code> is true whenever <code class="docutils literal notranslate"><span class="pre">x</span></code> and <code class="docutils literal notranslate"><span class="pre">y</span></code> are
mathematically equal. This is not always possible because not every type of
object has a computable canonical form, but it is a convenient approach when
one does exist.</p>
</li>
<li><p>To make <code class="docutils literal notranslate"><span class="pre">==</span></code> check for some additional attributes beyond those stored in the
<code class="docutils literal notranslate"><span class="pre">args</span></code> of an expression. See the <a class="reference internal" href="#best-practices-extra-attributes"><span class="std std-ref">Avoid Storing Extra Attributes on an Object</span></a> section
above for more details on why it’s a bad idea to directly store extra
attributes on a SymPy object, and what the best alternatives are.</p></li>
<li><p>To make <code class="docutils literal notranslate"><span class="pre">==</span></code> compare equal to some non-SymPy object. It is preferable to
extend <code class="docutils literal notranslate"><span class="pre">sympify</span></code> to be able to convert this object into the SymPy object.
The default <code class="docutils literal notranslate"><span class="pre">__eq__</span></code> implementation will automatically call <code class="docutils literal notranslate"><span class="pre">sympify</span></code> on the
other argument if it isn’t a <code class="docutils literal notranslate"><span class="pre">Basic</span></code> instance (e.g., <code class="docutils literal notranslate"><span class="pre">Integer(1)</span> <span class="pre">==</span> <span class="pre">int(1)</span></code>
gives <code class="docutils literal notranslate"><span class="pre">True</span></code>). It is possible to extend <code class="docutils literal notranslate"><span class="pre">sympify</span></code> both for objects you
control by defining a <code class="docutils literal notranslate"><span class="pre">_sympy_</span></code> method and for objects you do not control by
extending the <code class="docutils literal notranslate"><span class="pre">converter</span></code> dictionary. See the <a class="reference internal" href="../modules/core.html#sympy.core.sympify.sympify" title="sympy.core.sympify.sympify"><code class="xref py py-func docutils literal notranslate"><span class="pre">sympify()</span></code></a>
documentation for more details.</p></li>
</ul>
</section>
<section id="avoiding-infinite-recursion-from-assumptions-handlers">
<h3>Avoiding Infinite Recursion from Assumptions Handlers<a class="headerlink" href="#avoiding-infinite-recursion-from-assumptions-handlers" title="Link to this heading">¶</a></h3>
<p>When writing assumptions handlers on custom functions like <code class="docutils literal notranslate"><span class="pre">_eval_is_positive</span></code>
(see the <a class="reference internal" href="../guides/custom-functions.html#custom-functions-assumptions"><span class="std std-ref">custom
functions guide</span></a> for details on how to do this),
there are two important things to keep in mind:</p>
<p><strong>Firstly, avoid creating new expressions inside of an assumption handler. You
should always pull apart the arguments of a function directly instead.</strong> The
reason is that creating a new expression could itself result in an assumptions
query. This can easily lead to infinite recursion. And even when it doesn’t,
creating a new expression that itself could lead to many recursive
assumptions queries is bad for performance compared to querying the desired
property more directly.</p>
<p>This generally means using methods like <a class="reference internal" href="../modules/core.html#sympy.core.expr.Expr.as_independent" title="sympy.core.expr.Expr.as_independent"><code class="xref py py-meth docutils literal notranslate"><span class="pre">as_independent()</span></code></a> or
<code class="docutils literal notranslate"><span class="pre">{meth}</span></code>~.as_coeff_mul<code class="docutils literal notranslate"><span class="pre">and</span> <span class="pre">checking</span> <span class="pre">the</span></code>args` of expressions directly (see the <a class="reference internal" href="../guides/custom-functions.html#custom-functions-assumptions"><span class="std std-ref">custom functions
guide</span></a> for an example).</p>
<p>Secondly, <strong>do not recursively evaluate assumptions on <code class="docutils literal notranslate"><span class="pre">self</span></code> in assumptions
handlers</strong>. Assumptions handlers should only check for assumptions on
<code class="docutils literal notranslate"><span class="pre">self.args</span></code>. The global assumptions system will automatically handle
implications between different assumptions.</p>
<p>For example, you may be tempted to write something like</p>
<div class="highlight-py notranslate"><div class="highlight"><pre><span></span><span class="c1"># BAD</span>

<span class="k">class</span> <span class="nc">f</span><span class="p">(</span><span class="n">Function</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">_eval_is_integer</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c1"># Quick return if self is not real (do not do this).</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_real</span> <span class="ow">is</span> <span class="kc">False</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">False</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">args</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">is_integer</span>
</pre></div>
</div>
<p>However, the <code class="docutils literal notranslate"><span class="pre">if</span> <span class="pre">self.is_real</span> <span class="pre">is</span> <span class="pre">False</span></code> check is completely unnecessary. The
assumptions system already knows that <code class="docutils literal notranslate"><span class="pre">integer</span></code> implies <code class="docutils literal notranslate"><span class="pre">real</span></code>, and it will
not bother checking <code class="docutils literal notranslate"><span class="pre">is_integer</span></code> if it already knows that <code class="docutils literal notranslate"><span class="pre">is_real</span></code> is False.</p>
<p>If you define the function this way, it will lead to an infinite recursion:</p>
<div class="highlight-py notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="k">class</span> <span class="nc">f</span><span class="p">(</span><span class="n">Function</span><span class="p">):</span>
<span class="gp">... </span>    <span class="k">def</span> <span class="nf">_eval_is_integer</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="gp">... </span>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_real</span> <span class="ow">is</span> <span class="kc">False</span><span class="p">:</span>
<span class="gp">... </span>            <span class="k">return</span> <span class="kc">False</span>
<span class="gp">... </span>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">args</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">is_integer</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">.</span><span class="n">is_real</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">RecursionError</span>: <span class="n">maximum recursion depth exceeded while calling a Python object</span>
</pre></div>
</div>
<p>Instead, define the handler based on the arguments of the function only:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># GOOD</span>

<span class="k">class</span> <span class="nc">f</span><span class="p">(</span><span class="n">Function</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">_eval_is_integer</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">args</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">is_integer</span>
</pre></div>
</div>
<hr class="footnotes docutils" />
<aside class="footnote-list brackets">
<aside class="footnote brackets" id="dict-footnote" role="doc-footnote">
<span class="label"><span class="fn-bracket">[</span><a role="doc-backlink" href="#id1">1</a><span class="fn-bracket">]</span></span>
<p>Python dicts and sets use <code class="docutils literal notranslate"><span class="pre">hash</span></code>, but fallback to using <code class="docutils literal notranslate"><span class="pre">==</span></code>
when there is a hash collision.</p>
</aside>
</aside>
</section>
</section>
</section>

        </article>
      </div>
      <footer>
        
        <div class="related-pages">
          <a class="next-page" href="gotchas.html">
              <div class="page-info">
                <div class="context">
                  <span>Next</span>
                </div>
                <div class="title">Gotchas and Pitfalls</div>
              </div>
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
            </a>
          <a class="prev-page" href="index.html">
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
              <div class="page-info">
                <div class="context">
                  <span>Previous</span>
                </div>
                
                <div class="title">Explanations</div>
                
              </div>
            </a>
        </div>
        <div class="bottom-of-page">
          <div class="left-details">
            <div class="copyright">
                Copyright &#169; 2024 SymPy Development Team
            </div>
            Made with <a href="https://www.sphinx-doc.org/">Sphinx</a> and <a class="muted-link" href="https://pradyunsg.me">@pradyunsg</a>'s
            
            <a href="https://github.com/pradyunsg/furo">Furo</a>
            <div class="last-updated">
              Last updated on Jun 29, 2024</div>
          </div>
          <div class="right-details">
            <div class="icons">
              <a class="muted-link " href="https://github.com/sympy/sympy" aria-label="GitHub">
                <svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 16 16">
                    <path fill-rule="evenodd" d="M8 0C3.58 0 0 3.58 0 8c0 3.54 2.29 6.53 5.47 7.59.4.07.55-.17.55-.38 0-.19-.01-.82-.01-1.49-2.01.37-2.53-.49-2.69-.94-.09-.23-.48-.94-.82-1.13-.28-.15-.68-.52-.01-.53.63-.01 1.08.58 1.23.82.72 1.21 1.87.87 2.33.66.07-.52.28-.87.51-1.07-1.78-.2-3.64-.89-3.64-3.95 0-.87.31-1.59.82-2.15-.08-.2-.36-1.02.08-2.12 0 0 .67-.21 2.2.82.64-.18 1.32-.27 2-.27.68 0 1.36.09 2 .27 1.53-1.04 2.2-.82 2.2-.82.44 1.1.16 1.92.08 2.12.51.56.82 1.27.82 2.15 0 3.07-1.87 3.75-3.65 3.95.29.25.54.73.54 1.48 0 1.07-.01 1.93-.01 2.2 0 .21.15.46.55.38A8.013 8.013 0 0 0 16 8c0-4.42-3.58-8-8-8z"></path>
                </svg>
            </a>
              
            </div>
          </div>
        </div>
        
      </footer>
    </div>
    <aside class="toc-drawer">
      
      
      <div class="toc-sticky toc-scroll">
        <div class="toc-title-container">
          <span class="toc-title">
            On this page
          </span>
        </div>
        <div class="toc-tree-container">
          <div class="toc-tree">
            <ul>
<li><a class="reference internal" href="#">Best Practices</a><ul>
<li><a class="reference internal" href="#basic-usage">Basic Usage</a><ul>
<li><a class="reference internal" href="#defining-symbols">Defining Symbols</a></li>
<li><a class="reference internal" href="#avoid-string-inputs">Avoid String Inputs</a></li>
<li><a class="reference internal" href="#avoid-manipulating-expressions-as-strings">Avoid Manipulating Expressions as Strings</a></li>
<li><a class="reference internal" href="#exact-rational-numbers-vs-floats">Exact Rational Numbers vs. Floats</a></li>
<li><a class="reference internal" href="#avoid-simplify">Avoid <code class="docutils literal notranslate"><span class="pre">simplify()</span></code></a></li>
<li><a class="reference internal" href="#don-t-hardcode-symbol-names-in-python-functions">Don’t Hardcode Symbol Names in Python Functions</a></li>
<li><a class="reference internal" href="#separate-symbolic-and-numeric-code">Separate Symbolic and Numeric Code</a></li>
</ul>
</li>
<li><a class="reference internal" href="#advanced-usage">Advanced Usage</a><ul>
<li><a class="reference internal" href="#be-careful-comparing-and-sorting-symbolic-objects">Be Careful Comparing and Sorting Symbolic Objects</a></li>
</ul>
</li>
<li><a class="reference internal" href="#custom-sympy-objects">Custom SymPy Objects</a><ul>
<li><a class="reference internal" href="#args-invariants">Args Invariants</a></li>
<li><a class="reference internal" href="#avoid-too-much-automatic-evaluation">Avoid Too Much Automatic Evaluation</a></li>
<li><a class="reference internal" href="#don-t-denest-collections">Don’t Denest Collections</a></li>
<li><a class="reference internal" href="#avoid-storing-extra-attributes-on-an-object">Avoid Storing Extra Attributes on an Object</a></li>
<li><a class="reference internal" href="#don-t-overwrite-eq">Don’t Overwrite <code class="docutils literal notranslate"><span class="pre">__eq__</span></code></a></li>
<li><a class="reference internal" href="#avoiding-infinite-recursion-from-assumptions-handlers">Avoiding Infinite Recursion from Assumptions Handlers</a></li>
</ul>
</li>
</ul>
</li>
</ul>

          </div>
        </div>
      </div>
      
      
    </aside>
  </div>
</div><script src="../_static/jquery.js?v=5d32c60e"></script>
    <script src="../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
    <script src="../_static/documentation_options.js?v=95b44b65"></script>
    <script src="../_static/doctools.js?v=9a2dae69"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/scripts/furo.js?v=4e2eecee"></script>
    <script src="../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../_static/copybutton.js?v=30646c52"></script>
    <script>window.MathJax = {"tex": {"inlineMath": [["\\(", "\\)"]], "displayMath": [["\\[", "\\]"]]}, "options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    </body>
</html>