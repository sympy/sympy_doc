

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>sympy.functions.special.error_functions &mdash; SymPy 0.7.3 documentation</title>
    
    <link rel="stylesheet" href="../../../../_static/default.css" type="text/css" />
    <link rel="stylesheet" href="../../../../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="http://live.sympy.org/static/live-core.css" type="text/css" />
    <link rel="stylesheet" href="http://live.sympy.org/static/live-autocomplete.css" type="text/css" />
    <link rel="stylesheet" href="http://live.sympy.org/static/live-sphinx.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../../../../',
        VERSION:     '0.7.3',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../../../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../../../_static/doctools.js"></script>
    <script type="text/javascript" src="https://c328740.ssl.cf1.rackcdn.com/mathjax/latest/MathJax.js?config=TeX-AMS_HTML-full"></script>
    <script type="text/javascript" src="http://live.sympy.org/static/utilities.js"></script>
    <script type="text/javascript" src="http://live.sympy.org/static/external/classy.js"></script>
    <script type="text/javascript" src="http://live.sympy.org/static/live-core.js"></script>
    <script type="text/javascript" src="http://live.sympy.org/static/live-autocomplete.js"></script>
    <script type="text/javascript" src="http://live.sympy.org/static/live-sphinx.js"></script>
    <script type="text/javascript" src="../../../../_static/sidebar.js"></script>
    <link rel="shortcut icon" href="../../../../_static/SymPy-Favicon.ico"/>
    <link rel="top" title="SymPy 0.7.3 documentation" href="../../../../index.html" />
    <link rel="up" title="sympy" href="../../../sympy.html" /> 
  </head>
  <body>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../../../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../../../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="../../../../np-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li><a href="../../../../index.html">SymPy 0.7.3 documentation</a> &raquo;</li>
          <li><a href="../../../index.html" >Module code</a> &raquo;</li>
          <li><a href="../../../sympy.html" accesskey="U">sympy</a> &raquo;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <h1>Source code for sympy.functions.special.error_functions</h1><div class="highlight"><pre>
<span class="sd">&quot;&quot;&quot; This module contains various functions that are special cases</span>
<span class="sd">    of incomplete gamma functions. It should probably be renamed. &quot;&quot;&quot;</span>

<span class="kn">from</span> <span class="nn">__future__</span> <span class="kn">import</span> <span class="n">print_function</span><span class="p">,</span> <span class="n">division</span>

<span class="kn">from</span> <span class="nn">sympy.core</span> <span class="kn">import</span> <span class="n">Add</span><span class="p">,</span> <span class="n">S</span><span class="p">,</span> <span class="n">C</span><span class="p">,</span> <span class="n">sympify</span><span class="p">,</span> <span class="n">cacheit</span><span class="p">,</span> <span class="n">pi</span><span class="p">,</span> <span class="n">I</span>
<span class="kn">from</span> <span class="nn">sympy.core.function</span> <span class="kn">import</span> <span class="n">Function</span><span class="p">,</span> <span class="n">ArgumentIndexError</span>
<span class="kn">from</span> <span class="nn">sympy.functions.elementary.miscellaneous</span> <span class="kn">import</span> <span class="n">sqrt</span><span class="p">,</span> <span class="n">root</span>
<span class="kn">from</span> <span class="nn">sympy.functions.elementary.exponential</span> <span class="kn">import</span> <span class="n">exp</span><span class="p">,</span> <span class="n">log</span>
<span class="kn">from</span> <span class="nn">sympy.functions.elementary.complexes</span> <span class="kn">import</span> <span class="n">polar_lift</span>
<span class="kn">from</span> <span class="nn">sympy.functions.special.hyper</span> <span class="kn">import</span> <span class="n">hyper</span><span class="p">,</span> <span class="n">meijerg</span>
<span class="kn">from</span> <span class="nn">sympy.core.compatibility</span> <span class="kn">import</span> <span class="nb">xrange</span>

<span class="c"># TODO series expansions</span>
<span class="c"># TODO see the &quot;Note:&quot; in Ei</span>

<span class="c">###############################################################################</span>
<span class="c">################################ ERROR FUNCTION ###############################</span>
<span class="c">###############################################################################</span>


<div class="viewcode-block" id="erf"><a class="viewcode-back" href="../../../../modules/functions/special.html#sympy.functions.special.error_functions.erf">[docs]</a><span class="k">class</span> <span class="nc">erf</span><span class="p">(</span><span class="n">Function</span><span class="p">):</span>
    <span class="sd">r&quot;&quot;&quot;</span>
<span class="sd">    The Gauss error function. This function is defined as:</span>

<span class="sd">    .. math ::</span>
<span class="sd">        \mathrm{erf}(x) = \frac{2}{\sqrt{\pi}} \int_0^x e^{-t^2} \mathrm{d}t.</span>

<span class="sd">    Examples</span>
<span class="sd">    ========</span>

<span class="sd">    &gt;&gt;&gt; from sympy import I, oo, erf</span>
<span class="sd">    &gt;&gt;&gt; from sympy.abc import z</span>

<span class="sd">    Several special values are known:</span>

<span class="sd">    &gt;&gt;&gt; erf(0)</span>
<span class="sd">    0</span>
<span class="sd">    &gt;&gt;&gt; erf(oo)</span>
<span class="sd">    1</span>
<span class="sd">    &gt;&gt;&gt; erf(-oo)</span>
<span class="sd">    -1</span>
<span class="sd">    &gt;&gt;&gt; erf(I*oo)</span>
<span class="sd">    oo*I</span>
<span class="sd">    &gt;&gt;&gt; erf(-I*oo)</span>
<span class="sd">    -oo*I</span>

<span class="sd">    In general one can pull out factors of -1 and I from the argument:</span>

<span class="sd">    &gt;&gt;&gt; erf(-z)</span>
<span class="sd">    -erf(z)</span>

<span class="sd">    The error function obeys the mirror symmetry:</span>

<span class="sd">    &gt;&gt;&gt; from sympy import conjugate</span>
<span class="sd">    &gt;&gt;&gt; conjugate(erf(z))</span>
<span class="sd">    erf(conjugate(z))</span>

<span class="sd">    Differentiation with respect to z is supported:</span>

<span class="sd">    &gt;&gt;&gt; from sympy import diff</span>
<span class="sd">    &gt;&gt;&gt; diff(erf(z), z)</span>
<span class="sd">    2*exp(-z**2)/sqrt(pi)</span>

<span class="sd">    We can numerically evaluate the error function to arbitrary precision</span>
<span class="sd">    on the whole complex plane:</span>

<span class="sd">    &gt;&gt;&gt; erf(4).evalf(30)</span>
<span class="sd">    0.999999984582742099719981147840</span>

<span class="sd">    &gt;&gt;&gt; erf(-4*I).evalf(30)</span>
<span class="sd">    -1296959.73071763923152794095062*I</span>

<span class="sd">    See Also</span>
<span class="sd">    ========</span>

<span class="sd">    erfc: Complementary error function.</span>
<span class="sd">    erfi: Imaginary error function.</span>
<span class="sd">    erf2: Two-argument error function.</span>
<span class="sd">    erfinv: Inverse error function.</span>
<span class="sd">    erfcinv: Inverse Complementary error function.</span>
<span class="sd">    erf2inv: Inverse two-argument error function.</span>

<span class="sd">    References</span>
<span class="sd">    ==========</span>

<span class="sd">    .. [1] http://en.wikipedia.org/wiki/Error_function</span>
<span class="sd">    .. [2] http://dlmf.nist.gov/7</span>
<span class="sd">    .. [3] http://mathworld.wolfram.com/Erf.html</span>
<span class="sd">    .. [4] http://functions.wolfram.com/GammaBetaErf/Erf</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">nargs</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="n">unbranched</span> <span class="o">=</span> <span class="bp">True</span>

    <span class="k">def</span> <span class="nf">fdiff</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">argindex</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">argindex</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="k">return</span> <span class="mi">2</span><span class="o">*</span><span class="n">C</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">args</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">/</span><span class="n">sqrt</span><span class="p">(</span><span class="n">S</span><span class="o">.</span><span class="n">Pi</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">ArgumentIndexError</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">argindex</span><span class="p">)</span>

    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">eval</span><span class="p">(</span><span class="n">cls</span><span class="p">,</span> <span class="n">arg</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">arg</span><span class="o">.</span><span class="n">is_Number</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">arg</span> <span class="ow">is</span> <span class="n">S</span><span class="o">.</span><span class="n">NaN</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">S</span><span class="o">.</span><span class="n">NaN</span>
            <span class="k">elif</span> <span class="n">arg</span> <span class="ow">is</span> <span class="n">S</span><span class="o">.</span><span class="n">Infinity</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">S</span><span class="o">.</span><span class="n">One</span>
            <span class="k">elif</span> <span class="n">arg</span> <span class="ow">is</span> <span class="n">S</span><span class="o">.</span><span class="n">NegativeInfinity</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">S</span><span class="o">.</span><span class="n">NegativeOne</span>
            <span class="k">elif</span> <span class="n">arg</span> <span class="ow">is</span> <span class="n">S</span><span class="o">.</span><span class="n">Zero</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">S</span><span class="o">.</span><span class="n">Zero</span>

        <span class="k">if</span> <span class="n">arg</span><span class="o">.</span><span class="n">func</span> <span class="ow">is</span> <span class="n">erfinv</span><span class="p">:</span>
             <span class="k">return</span> <span class="n">arg</span><span class="o">.</span><span class="n">args</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

        <span class="k">if</span> <span class="n">arg</span><span class="o">.</span><span class="n">func</span> <span class="ow">is</span> <span class="n">erfcinv</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">S</span><span class="o">.</span><span class="n">One</span> <span class="o">-</span> <span class="n">arg</span><span class="o">.</span><span class="n">args</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

        <span class="k">if</span> <span class="n">arg</span><span class="o">.</span><span class="n">func</span> <span class="ow">is</span> <span class="n">erf2inv</span> <span class="ow">and</span> <span class="n">arg</span><span class="o">.</span><span class="n">args</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="ow">is</span> <span class="n">S</span><span class="o">.</span><span class="n">Zero</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">arg</span><span class="o">.</span><span class="n">args</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>

        <span class="c"># Try to pull out factors of I</span>
        <span class="n">t</span> <span class="o">=</span> <span class="n">arg</span><span class="o">.</span><span class="n">extract_multiplicatively</span><span class="p">(</span><span class="n">S</span><span class="o">.</span><span class="n">ImaginaryUnit</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">t</span> <span class="ow">is</span> <span class="n">S</span><span class="o">.</span><span class="n">Infinity</span> <span class="ow">or</span> <span class="n">t</span> <span class="ow">is</span> <span class="n">S</span><span class="o">.</span><span class="n">NegativeInfinity</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">arg</span>

        <span class="c"># Try to pull out factors of -1</span>
        <span class="k">if</span> <span class="n">arg</span><span class="o">.</span><span class="n">could_extract_minus_sign</span><span class="p">():</span>
            <span class="k">return</span> <span class="o">-</span><span class="n">cls</span><span class="p">(</span><span class="o">-</span><span class="n">arg</span><span class="p">)</span>

    <span class="nd">@staticmethod</span>
    <span class="nd">@cacheit</span>
    <span class="k">def</span> <span class="nf">taylor_term</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="o">*</span><span class="n">previous_terms</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">n</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">n</span> <span class="o">%</span> <span class="mi">2</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">S</span><span class="o">.</span><span class="n">Zero</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">x</span> <span class="o">=</span> <span class="n">sympify</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
            <span class="n">k</span> <span class="o">=</span> <span class="n">C</span><span class="o">.</span><span class="n">floor</span><span class="p">((</span><span class="n">n</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="n">S</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">previous_terms</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">2</span><span class="p">:</span>
                <span class="k">return</span> <span class="o">-</span><span class="n">previous_terms</span><span class="p">[</span><span class="o">-</span><span class="mi">2</span><span class="p">]</span> <span class="o">*</span> <span class="n">x</span><span class="o">**</span><span class="mi">2</span> <span class="o">*</span> <span class="p">(</span><span class="n">n</span> <span class="o">-</span> <span class="mi">2</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">n</span><span class="o">*</span><span class="n">k</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">return</span> <span class="mi">2</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">**</span><span class="n">k</span> <span class="o">*</span> <span class="n">x</span><span class="o">**</span><span class="n">n</span><span class="o">/</span><span class="p">(</span><span class="n">n</span><span class="o">*</span><span class="n">C</span><span class="o">.</span><span class="n">factorial</span><span class="p">(</span><span class="n">k</span><span class="p">)</span><span class="o">*</span><span class="n">sqrt</span><span class="p">(</span><span class="n">S</span><span class="o">.</span><span class="n">Pi</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">_eval_conjugate</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">func</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">args</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">conjugate</span><span class="p">())</span>

    <span class="k">def</span> <span class="nf">_eval_is_real</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">args</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">is_real</span>

    <span class="k">def</span> <span class="nf">_eval_rewrite_as_uppergamma</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">z</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">sqrt</span><span class="p">(</span><span class="n">z</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">/</span><span class="n">z</span><span class="o">*</span><span class="p">(</span><span class="n">S</span><span class="o">.</span><span class="n">One</span> <span class="o">-</span> <span class="n">C</span><span class="o">.</span><span class="n">uppergamma</span><span class="p">(</span><span class="n">S</span><span class="o">.</span><span class="n">Half</span><span class="p">,</span> <span class="n">z</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">/</span><span class="n">sqrt</span><span class="p">(</span><span class="n">S</span><span class="o">.</span><span class="n">Pi</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">_eval_rewrite_as_fresnels</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">z</span><span class="p">):</span>
        <span class="n">arg</span> <span class="o">=</span> <span class="p">(</span><span class="n">S</span><span class="o">.</span><span class="n">One</span> <span class="o">-</span> <span class="n">S</span><span class="o">.</span><span class="n">ImaginaryUnit</span><span class="p">)</span><span class="o">*</span><span class="n">z</span><span class="o">/</span><span class="n">sqrt</span><span class="p">(</span><span class="n">pi</span><span class="p">)</span>
        <span class="k">return</span> <span class="p">(</span><span class="n">S</span><span class="o">.</span><span class="n">One</span> <span class="o">+</span> <span class="n">S</span><span class="o">.</span><span class="n">ImaginaryUnit</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">fresnelc</span><span class="p">(</span><span class="n">arg</span><span class="p">)</span> <span class="o">-</span> <span class="n">I</span><span class="o">*</span><span class="n">fresnels</span><span class="p">(</span><span class="n">arg</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">_eval_rewrite_as_fresnelc</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">z</span><span class="p">):</span>
        <span class="n">arg</span> <span class="o">=</span> <span class="p">(</span><span class="n">S</span><span class="o">.</span><span class="n">One</span> <span class="o">-</span> <span class="n">S</span><span class="o">.</span><span class="n">ImaginaryUnit</span><span class="p">)</span><span class="o">*</span><span class="n">z</span><span class="o">/</span><span class="n">sqrt</span><span class="p">(</span><span class="n">pi</span><span class="p">)</span>
        <span class="k">return</span> <span class="p">(</span><span class="n">S</span><span class="o">.</span><span class="n">One</span> <span class="o">+</span> <span class="n">S</span><span class="o">.</span><span class="n">ImaginaryUnit</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">fresnelc</span><span class="p">(</span><span class="n">arg</span><span class="p">)</span> <span class="o">-</span> <span class="n">I</span><span class="o">*</span><span class="n">fresnels</span><span class="p">(</span><span class="n">arg</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">_eval_rewrite_as_meijerg</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">z</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">z</span><span class="o">/</span><span class="n">sqrt</span><span class="p">(</span><span class="n">pi</span><span class="p">)</span><span class="o">*</span><span class="n">meijerg</span><span class="p">([</span><span class="n">S</span><span class="o">.</span><span class="n">Half</span><span class="p">],</span> <span class="p">[],</span> <span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="o">-</span><span class="n">S</span><span class="o">.</span><span class="n">Half</span><span class="p">],</span> <span class="n">z</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_eval_rewrite_as_hyper</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">z</span><span class="p">):</span>
        <span class="k">return</span> <span class="mi">2</span><span class="o">*</span><span class="n">z</span><span class="o">/</span><span class="n">sqrt</span><span class="p">(</span><span class="n">pi</span><span class="p">)</span><span class="o">*</span><span class="n">hyper</span><span class="p">([</span><span class="n">S</span><span class="o">.</span><span class="n">Half</span><span class="p">],</span> <span class="p">[</span><span class="mi">3</span><span class="o">*</span><span class="n">S</span><span class="o">.</span><span class="n">Half</span><span class="p">],</span> <span class="o">-</span><span class="n">z</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_eval_rewrite_as_expint</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">z</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">sqrt</span><span class="p">(</span><span class="n">z</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">/</span><span class="n">z</span> <span class="o">-</span> <span class="n">z</span><span class="o">*</span><span class="n">expint</span><span class="p">(</span><span class="n">S</span><span class="o">.</span><span class="n">Half</span><span class="p">,</span> <span class="n">z</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">/</span><span class="n">sqrt</span><span class="p">(</span><span class="n">S</span><span class="o">.</span><span class="n">Pi</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_eval_rewrite_as_tractable</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">z</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">S</span><span class="o">.</span><span class="n">One</span> <span class="o">-</span> <span class="n">_erfs</span><span class="p">(</span><span class="n">z</span><span class="p">)</span><span class="o">*</span><span class="n">C</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">z</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_eval_rewrite_as_erfc</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">z</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">S</span><span class="o">.</span><span class="n">One</span> <span class="o">-</span> <span class="n">erfc</span><span class="p">(</span><span class="n">z</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_eval_rewrite_as_erfi</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">z</span><span class="p">):</span>
        <span class="k">return</span> <span class="o">-</span><span class="n">I</span><span class="o">*</span><span class="n">erfi</span><span class="p">(</span><span class="n">I</span><span class="o">*</span><span class="n">z</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_eval_as_leading_term</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
        <span class="n">arg</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">args</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">as_leading_term</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">arg</span><span class="o">.</span><span class="n">free_symbols</span> <span class="ow">and</span> <span class="n">C</span><span class="o">.</span><span class="n">Order</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span><span class="o">.</span><span class="n">contains</span><span class="p">(</span><span class="n">arg</span><span class="p">):</span>
            <span class="k">return</span> <span class="mi">2</span><span class="o">*</span><span class="n">x</span><span class="o">/</span><span class="n">sqrt</span><span class="p">(</span><span class="n">pi</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">func</span><span class="p">(</span><span class="n">arg</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">as_real_imag</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">deep</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="o">**</span><span class="n">hints</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">args</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">is_real</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">deep</span><span class="p">:</span>
                <span class="n">hints</span><span class="p">[</span><span class="s">&#39;complex&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">False</span>
                <span class="k">return</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">expand</span><span class="p">(</span><span class="n">deep</span><span class="p">,</span> <span class="o">**</span><span class="n">hints</span><span class="p">),</span> <span class="n">S</span><span class="o">.</span><span class="n">Zero</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">return</span> <span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">S</span><span class="o">.</span><span class="n">Zero</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">deep</span><span class="p">:</span>
            <span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">args</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">expand</span><span class="p">(</span><span class="n">deep</span><span class="p">,</span> <span class="o">**</span><span class="n">hints</span><span class="p">)</span><span class="o">.</span><span class="n">as_real_imag</span><span class="p">()</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">args</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">as_real_imag</span><span class="p">()</span>

        <span class="n">sq</span> <span class="o">=</span> <span class="o">-</span><span class="n">y</span><span class="o">**</span><span class="mi">2</span><span class="o">/</span><span class="n">x</span><span class="o">**</span><span class="mi">2</span>
        <span class="n">re</span> <span class="o">=</span> <span class="n">S</span><span class="o">.</span><span class="n">Half</span><span class="o">*</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">func</span><span class="p">(</span><span class="n">x</span> <span class="o">+</span> <span class="n">x</span><span class="o">*</span><span class="n">sqrt</span><span class="p">(</span><span class="n">sq</span><span class="p">))</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">func</span><span class="p">(</span><span class="n">x</span> <span class="o">-</span> <span class="n">x</span><span class="o">*</span><span class="n">sqrt</span><span class="p">(</span><span class="n">sq</span><span class="p">)))</span>
        <span class="n">im</span> <span class="o">=</span> <span class="n">x</span><span class="o">/</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">y</span><span class="p">)</span> <span class="o">*</span> <span class="n">sqrt</span><span class="p">(</span><span class="n">sq</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">func</span><span class="p">(</span><span class="n">x</span> <span class="o">-</span> <span class="n">x</span><span class="o">*</span><span class="n">sqrt</span><span class="p">(</span><span class="n">sq</span><span class="p">))</span> <span class="o">-</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">func</span><span class="p">(</span><span class="n">x</span> <span class="o">+</span> <span class="n">x</span><span class="o">*</span><span class="n">sqrt</span><span class="p">(</span><span class="n">sq</span><span class="p">)))</span>
        <span class="k">return</span> <span class="p">(</span><span class="n">re</span><span class="p">,</span> <span class="n">im</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="erfc"><a class="viewcode-back" href="../../../../modules/functions/special.html#sympy.functions.special.error_functions.erfc">[docs]</a><span class="k">class</span> <span class="nc">erfc</span><span class="p">(</span><span class="n">Function</span><span class="p">):</span>
    <span class="sd">r&quot;&quot;&quot;</span>
<span class="sd">    Complementary Error Function. The function is defined as:</span>

<span class="sd">    .. math ::</span>
<span class="sd">        \mathrm{erfc}(x) = \frac{2}{\sqrt{\pi}} \int_x^\infty e^{-t^2} \mathrm{d}t</span>

<span class="sd">    Examples</span>
<span class="sd">    ========</span>

<span class="sd">    &gt;&gt;&gt; from sympy import I, oo, erfc</span>
<span class="sd">    &gt;&gt;&gt; from sympy.abc import z</span>

<span class="sd">    Several special values are known:</span>

<span class="sd">    &gt;&gt;&gt; erfc(0)</span>
<span class="sd">    1</span>
<span class="sd">    &gt;&gt;&gt; erfc(oo)</span>
<span class="sd">    0</span>
<span class="sd">    &gt;&gt;&gt; erfc(-oo)</span>
<span class="sd">    2</span>
<span class="sd">    &gt;&gt;&gt; erfc(I*oo)</span>
<span class="sd">    -oo*I</span>
<span class="sd">    &gt;&gt;&gt; erfc(-I*oo)</span>
<span class="sd">    oo*I</span>

<span class="sd">    The error function obeys the mirror symmetry:</span>

<span class="sd">    &gt;&gt;&gt; from sympy import conjugate</span>
<span class="sd">    &gt;&gt;&gt; conjugate(erfc(z))</span>
<span class="sd">    erfc(conjugate(z))</span>

<span class="sd">    Differentiation with respect to z is supported:</span>

<span class="sd">    &gt;&gt;&gt; from sympy import diff</span>
<span class="sd">    &gt;&gt;&gt; diff(erfc(z), z)</span>
<span class="sd">    -2*exp(-z**2)/sqrt(pi)</span>

<span class="sd">    It also follows</span>

<span class="sd">    &gt;&gt;&gt; erfc(-z)</span>
<span class="sd">    -erfc(z) + 2</span>

<span class="sd">    We can numerically evaluate the complementary error function to arbitrary precision</span>
<span class="sd">    on the whole complex plane:</span>

<span class="sd">    &gt;&gt;&gt; erfc(4).evalf(30)</span>
<span class="sd">    0.0000000154172579002800188521596734869</span>

<span class="sd">    &gt;&gt;&gt; erfc(4*I).evalf(30)</span>
<span class="sd">    1.0 - 1296959.73071763923152794095062*I</span>

<span class="sd">    See Also</span>
<span class="sd">    ========</span>

<span class="sd">    erf: Gaussian error function.</span>
<span class="sd">    erfi: Imaginary error function.</span>
<span class="sd">    erf2: Two-argument error function.</span>
<span class="sd">    erfinv: Inverse error function.</span>
<span class="sd">    erfcinv: Inverse Complementary error function.</span>
<span class="sd">    erf2inv: Inverse two-argument error function.</span>

<span class="sd">    References</span>
<span class="sd">    ==========</span>

<span class="sd">    .. [1] http://en.wikipedia.org/wiki/Error_function</span>
<span class="sd">    .. [2] http://dlmf.nist.gov/7</span>
<span class="sd">    .. [3] http://mathworld.wolfram.com/Erfc.html</span>
<span class="sd">    .. [4] http://functions.wolfram.com/GammaBetaErf/Erfc</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">nargs</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="n">unbranched</span> <span class="o">=</span> <span class="bp">True</span>

    <span class="k">def</span> <span class="nf">fdiff</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">argindex</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">argindex</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="k">return</span> <span class="o">-</span><span class="mi">2</span><span class="o">*</span><span class="n">C</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">args</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">/</span><span class="n">sqrt</span><span class="p">(</span><span class="n">S</span><span class="o">.</span><span class="n">Pi</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">ArgumentIndexError</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">argindex</span><span class="p">)</span>

    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">eval</span><span class="p">(</span><span class="n">cls</span><span class="p">,</span> <span class="n">arg</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">arg</span><span class="o">.</span><span class="n">is_Number</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">arg</span> <span class="ow">is</span> <span class="n">S</span><span class="o">.</span><span class="n">NaN</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">S</span><span class="o">.</span><span class="n">NaN</span>
            <span class="k">elif</span> <span class="n">arg</span> <span class="ow">is</span> <span class="n">S</span><span class="o">.</span><span class="n">Infinity</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">S</span><span class="o">.</span><span class="n">Zero</span>
            <span class="k">elif</span> <span class="n">arg</span> <span class="ow">is</span> <span class="n">S</span><span class="o">.</span><span class="n">Zero</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">S</span><span class="o">.</span><span class="n">One</span>

        <span class="k">if</span> <span class="n">arg</span><span class="o">.</span><span class="n">func</span> <span class="ow">is</span> <span class="n">erfinv</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">S</span><span class="o">.</span><span class="n">One</span> <span class="o">-</span> <span class="n">arg</span><span class="o">.</span><span class="n">args</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

        <span class="k">if</span> <span class="n">arg</span><span class="o">.</span><span class="n">func</span> <span class="ow">is</span> <span class="n">erfcinv</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">arg</span><span class="o">.</span><span class="n">args</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

        <span class="c"># Try to pull out factors of I</span>
        <span class="n">t</span> <span class="o">=</span> <span class="n">arg</span><span class="o">.</span><span class="n">extract_multiplicatively</span><span class="p">(</span><span class="n">S</span><span class="o">.</span><span class="n">ImaginaryUnit</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">t</span> <span class="ow">is</span> <span class="n">S</span><span class="o">.</span><span class="n">Infinity</span> <span class="ow">or</span> <span class="n">t</span> <span class="ow">is</span> <span class="n">S</span><span class="o">.</span><span class="n">NegativeInfinity</span><span class="p">:</span>
            <span class="k">return</span> <span class="o">-</span><span class="n">arg</span>

        <span class="c"># Try to pull out factors of -1</span>
        <span class="k">if</span> <span class="n">arg</span><span class="o">.</span><span class="n">could_extract_minus_sign</span><span class="p">():</span>
            <span class="k">return</span> <span class="n">S</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">-</span> <span class="n">cls</span><span class="p">(</span><span class="o">-</span><span class="n">arg</span><span class="p">)</span>

    <span class="nd">@staticmethod</span>
    <span class="nd">@cacheit</span>
    <span class="k">def</span> <span class="nf">taylor_term</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="o">*</span><span class="n">previous_terms</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">n</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">S</span><span class="o">.</span><span class="n">One</span>
        <span class="k">elif</span> <span class="n">n</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">n</span> <span class="o">%</span> <span class="mi">2</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">S</span><span class="o">.</span><span class="n">Zero</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">x</span> <span class="o">=</span> <span class="n">sympify</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
            <span class="n">k</span> <span class="o">=</span> <span class="n">C</span><span class="o">.</span><span class="n">floor</span><span class="p">((</span><span class="n">n</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="n">S</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">previous_terms</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">2</span><span class="p">:</span>
                <span class="k">return</span> <span class="o">-</span><span class="n">previous_terms</span><span class="p">[</span><span class="o">-</span><span class="mi">2</span><span class="p">]</span> <span class="o">*</span> <span class="n">x</span><span class="o">**</span><span class="mi">2</span> <span class="o">*</span> <span class="p">(</span><span class="n">n</span> <span class="o">-</span> <span class="mi">2</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">n</span><span class="o">*</span><span class="n">k</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">return</span> <span class="o">-</span><span class="mi">2</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">**</span><span class="n">k</span> <span class="o">*</span> <span class="n">x</span><span class="o">**</span><span class="n">n</span><span class="o">/</span><span class="p">(</span><span class="n">n</span><span class="o">*</span><span class="n">C</span><span class="o">.</span><span class="n">factorial</span><span class="p">(</span><span class="n">k</span><span class="p">)</span><span class="o">*</span><span class="n">sqrt</span><span class="p">(</span><span class="n">S</span><span class="o">.</span><span class="n">Pi</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">_eval_conjugate</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">func</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">args</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">conjugate</span><span class="p">())</span>

    <span class="k">def</span> <span class="nf">_eval_is_real</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">args</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">is_real</span>

    <span class="k">def</span> <span class="nf">_eval_rewrite_as_tractable</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">z</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">rewrite</span><span class="p">(</span><span class="n">erf</span><span class="p">)</span><span class="o">.</span><span class="n">rewrite</span><span class="p">(</span><span class="s">&quot;tractable&quot;</span><span class="p">,</span> <span class="n">deep</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_eval_rewrite_as_erf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">z</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">S</span><span class="o">.</span><span class="n">One</span> <span class="o">-</span> <span class="n">erf</span><span class="p">(</span><span class="n">z</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_eval_rewrite_as_erfi</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">z</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">S</span><span class="o">.</span><span class="n">One</span> <span class="o">+</span> <span class="n">I</span><span class="o">*</span><span class="n">erfi</span><span class="p">(</span><span class="n">I</span><span class="o">*</span><span class="n">z</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_eval_rewrite_as_fresnels</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">z</span><span class="p">):</span>
        <span class="n">arg</span> <span class="o">=</span> <span class="p">(</span><span class="n">S</span><span class="o">.</span><span class="n">One</span> <span class="o">-</span> <span class="n">S</span><span class="o">.</span><span class="n">ImaginaryUnit</span><span class="p">)</span><span class="o">*</span><span class="n">z</span><span class="o">/</span><span class="n">sqrt</span><span class="p">(</span><span class="n">pi</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">S</span><span class="o">.</span><span class="n">One</span> <span class="o">-</span> <span class="p">(</span><span class="n">S</span><span class="o">.</span><span class="n">One</span> <span class="o">+</span> <span class="n">S</span><span class="o">.</span><span class="n">ImaginaryUnit</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">fresnelc</span><span class="p">(</span><span class="n">arg</span><span class="p">)</span> <span class="o">-</span> <span class="n">I</span><span class="o">*</span><span class="n">fresnels</span><span class="p">(</span><span class="n">arg</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">_eval_rewrite_as_fresnelc</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">z</span><span class="p">):</span>
        <span class="n">arg</span> <span class="o">=</span> <span class="p">(</span><span class="n">S</span><span class="o">.</span><span class="n">One</span><span class="o">-</span><span class="n">S</span><span class="o">.</span><span class="n">ImaginaryUnit</span><span class="p">)</span><span class="o">*</span><span class="n">z</span><span class="o">/</span><span class="n">sqrt</span><span class="p">(</span><span class="n">pi</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">S</span><span class="o">.</span><span class="n">One</span> <span class="o">-</span> <span class="p">(</span><span class="n">S</span><span class="o">.</span><span class="n">One</span> <span class="o">+</span> <span class="n">S</span><span class="o">.</span><span class="n">ImaginaryUnit</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">fresnelc</span><span class="p">(</span><span class="n">arg</span><span class="p">)</span> <span class="o">-</span> <span class="n">I</span><span class="o">*</span><span class="n">fresnels</span><span class="p">(</span><span class="n">arg</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">_eval_rewrite_as_meijerg</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">z</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">S</span><span class="o">.</span><span class="n">One</span> <span class="o">-</span> <span class="n">z</span><span class="o">/</span><span class="n">sqrt</span><span class="p">(</span><span class="n">pi</span><span class="p">)</span><span class="o">*</span><span class="n">meijerg</span><span class="p">([</span><span class="n">S</span><span class="o">.</span><span class="n">Half</span><span class="p">],</span> <span class="p">[],</span> <span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="o">-</span><span class="n">S</span><span class="o">.</span><span class="n">Half</span><span class="p">],</span> <span class="n">z</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_eval_rewrite_as_hyper</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">z</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">S</span><span class="o">.</span><span class="n">One</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">z</span><span class="o">/</span><span class="n">sqrt</span><span class="p">(</span><span class="n">pi</span><span class="p">)</span><span class="o">*</span><span class="n">hyper</span><span class="p">([</span><span class="n">S</span><span class="o">.</span><span class="n">Half</span><span class="p">],</span> <span class="p">[</span><span class="mi">3</span><span class="o">*</span><span class="n">S</span><span class="o">.</span><span class="n">Half</span><span class="p">],</span> <span class="o">-</span><span class="n">z</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_eval_rewrite_as_uppergamma</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">z</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">S</span><span class="o">.</span><span class="n">One</span> <span class="o">-</span> <span class="n">sqrt</span><span class="p">(</span><span class="n">z</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">/</span><span class="n">z</span><span class="o">*</span><span class="p">(</span><span class="n">S</span><span class="o">.</span><span class="n">One</span> <span class="o">-</span> <span class="n">C</span><span class="o">.</span><span class="n">uppergamma</span><span class="p">(</span><span class="n">S</span><span class="o">.</span><span class="n">Half</span><span class="p">,</span> <span class="n">z</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">/</span><span class="n">sqrt</span><span class="p">(</span><span class="n">S</span><span class="o">.</span><span class="n">Pi</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">_eval_rewrite_as_expint</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">z</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">S</span><span class="o">.</span><span class="n">One</span> <span class="o">-</span> <span class="n">sqrt</span><span class="p">(</span><span class="n">z</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">/</span><span class="n">z</span> <span class="o">+</span> <span class="n">z</span><span class="o">*</span><span class="n">expint</span><span class="p">(</span><span class="n">S</span><span class="o">.</span><span class="n">Half</span><span class="p">,</span> <span class="n">z</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">/</span><span class="n">sqrt</span><span class="p">(</span><span class="n">S</span><span class="o">.</span><span class="n">Pi</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_eval_as_leading_term</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
        <span class="n">arg</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">args</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">as_leading_term</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">arg</span><span class="o">.</span><span class="n">free_symbols</span> <span class="ow">and</span> <span class="n">C</span><span class="o">.</span><span class="n">Order</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span><span class="o">.</span><span class="n">contains</span><span class="p">(</span><span class="n">arg</span><span class="p">):</span>
            <span class="k">return</span> <span class="n">S</span><span class="o">.</span><span class="n">One</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">func</span><span class="p">(</span><span class="n">arg</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">as_real_imag</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">deep</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="o">**</span><span class="n">hints</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">args</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">is_real</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">deep</span><span class="p">:</span>
                <span class="n">hints</span><span class="p">[</span><span class="s">&#39;complex&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">False</span>
                <span class="k">return</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">expand</span><span class="p">(</span><span class="n">deep</span><span class="p">,</span> <span class="o">**</span><span class="n">hints</span><span class="p">),</span> <span class="n">S</span><span class="o">.</span><span class="n">Zero</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">return</span> <span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">S</span><span class="o">.</span><span class="n">Zero</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">deep</span><span class="p">:</span>
            <span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">args</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">expand</span><span class="p">(</span><span class="n">deep</span><span class="p">,</span> <span class="o">**</span><span class="n">hints</span><span class="p">)</span><span class="o">.</span><span class="n">as_real_imag</span><span class="p">()</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">args</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">as_real_imag</span><span class="p">()</span>

        <span class="n">sq</span> <span class="o">=</span> <span class="o">-</span><span class="n">y</span><span class="o">**</span><span class="mi">2</span><span class="o">/</span><span class="n">x</span><span class="o">**</span><span class="mi">2</span>
        <span class="n">re</span> <span class="o">=</span> <span class="n">S</span><span class="o">.</span><span class="n">Half</span><span class="o">*</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">func</span><span class="p">(</span><span class="n">x</span> <span class="o">+</span> <span class="n">x</span><span class="o">*</span><span class="n">sqrt</span><span class="p">(</span><span class="n">sq</span><span class="p">))</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">func</span><span class="p">(</span><span class="n">x</span> <span class="o">-</span> <span class="n">x</span><span class="o">*</span><span class="n">sqrt</span><span class="p">(</span><span class="n">sq</span><span class="p">)))</span>
        <span class="n">im</span> <span class="o">=</span> <span class="n">x</span><span class="o">/</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">y</span><span class="p">)</span> <span class="o">*</span> <span class="n">sqrt</span><span class="p">(</span><span class="n">sq</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">func</span><span class="p">(</span><span class="n">x</span> <span class="o">-</span> <span class="n">x</span><span class="o">*</span><span class="n">sqrt</span><span class="p">(</span><span class="n">sq</span><span class="p">))</span> <span class="o">-</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">func</span><span class="p">(</span><span class="n">x</span> <span class="o">+</span> <span class="n">x</span><span class="o">*</span><span class="n">sqrt</span><span class="p">(</span><span class="n">sq</span><span class="p">)))</span>
        <span class="k">return</span> <span class="p">(</span><span class="n">re</span><span class="p">,</span> <span class="n">im</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="erfi"><a class="viewcode-back" href="../../../../modules/functions/special.html#sympy.functions.special.error_functions.erfi">[docs]</a><span class="k">class</span> <span class="nc">erfi</span><span class="p">(</span><span class="n">Function</span><span class="p">):</span>
    <span class="sd">r&quot;&quot;&quot;</span>
<span class="sd">    Imaginary error function. The function erfi is defined as:</span>

<span class="sd">    .. math ::</span>
<span class="sd">        \mathrm{erfi}(x) = \frac{2}{\sqrt{\pi}} \int_0^x e^{t^2} \mathrm{d}t</span>

<span class="sd">    Examples</span>
<span class="sd">    ========</span>

<span class="sd">    &gt;&gt;&gt; from sympy import I, oo, erfi</span>
<span class="sd">    &gt;&gt;&gt; from sympy.abc import z</span>

<span class="sd">    Several special values are known:</span>

<span class="sd">    &gt;&gt;&gt; erfi(0)</span>
<span class="sd">    0</span>
<span class="sd">    &gt;&gt;&gt; erfi(oo)</span>
<span class="sd">    oo</span>
<span class="sd">    &gt;&gt;&gt; erfi(-oo)</span>
<span class="sd">    -oo</span>
<span class="sd">    &gt;&gt;&gt; erfi(I*oo)</span>
<span class="sd">    I</span>
<span class="sd">    &gt;&gt;&gt; erfi(-I*oo)</span>
<span class="sd">    -I</span>

<span class="sd">    In general one can pull out factors of -1 and I from the argument:</span>

<span class="sd">    &gt;&gt;&gt; erfi(-z)</span>
<span class="sd">    -erfi(z)</span>

<span class="sd">    &gt;&gt;&gt; from sympy import conjugate</span>
<span class="sd">    &gt;&gt;&gt; conjugate(erfi(z))</span>
<span class="sd">    erfi(conjugate(z))</span>

<span class="sd">    Differentiation with respect to z is supported:</span>

<span class="sd">    &gt;&gt;&gt; from sympy import diff</span>
<span class="sd">    &gt;&gt;&gt; diff(erfi(z), z)</span>
<span class="sd">    2*exp(z**2)/sqrt(pi)</span>

<span class="sd">    We can numerically evaluate the imaginary error function to arbitrary precision</span>
<span class="sd">    on the whole complex plane:</span>

<span class="sd">    &gt;&gt;&gt; erfi(2).evalf(30)</span>
<span class="sd">    18.5648024145755525987042919132</span>

<span class="sd">    &gt;&gt;&gt; erfi(-2*I).evalf(30)</span>
<span class="sd">    -0.995322265018952734162069256367*I</span>

<span class="sd">    See Also</span>
<span class="sd">    ========</span>

<span class="sd">    erf: Gaussian error function.</span>
<span class="sd">    erfc: Complementary error function.</span>
<span class="sd">    erf2: Two-argument error function.</span>
<span class="sd">    erfinv: Inverse error function.</span>
<span class="sd">    erfcinv: Inverse Complementary error function.</span>
<span class="sd">    erf2inv: Inverse two-argument error function.</span>

<span class="sd">    References</span>
<span class="sd">    ==========</span>

<span class="sd">    .. [1] http://en.wikipedia.org/wiki/Error_function</span>
<span class="sd">    .. [2] http://mathworld.wolfram.com/Erfi.html</span>
<span class="sd">    .. [3] http://functions.wolfram.com/GammaBetaErf/Erfi</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">nargs</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="n">unbranched</span> <span class="o">=</span> <span class="bp">True</span>

    <span class="k">def</span> <span class="nf">fdiff</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">argindex</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">argindex</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="k">return</span> <span class="mi">2</span><span class="o">*</span><span class="n">C</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">args</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">/</span><span class="n">sqrt</span><span class="p">(</span><span class="n">S</span><span class="o">.</span><span class="n">Pi</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">ArgumentIndexError</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">argindex</span><span class="p">)</span>

    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">eval</span><span class="p">(</span><span class="n">cls</span><span class="p">,</span> <span class="n">z</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">z</span><span class="o">.</span><span class="n">is_Number</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">z</span> <span class="ow">is</span> <span class="n">S</span><span class="o">.</span><span class="n">NaN</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">S</span><span class="o">.</span><span class="n">NaN</span>
            <span class="k">elif</span> <span class="n">z</span> <span class="ow">is</span> <span class="n">S</span><span class="o">.</span><span class="n">Zero</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">S</span><span class="o">.</span><span class="n">Zero</span>
            <span class="k">elif</span> <span class="n">z</span> <span class="ow">is</span> <span class="n">S</span><span class="o">.</span><span class="n">Infinity</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">S</span><span class="o">.</span><span class="n">Infinity</span>

        <span class="c"># Try to pull out factors of -1</span>
        <span class="k">if</span> <span class="n">z</span><span class="o">.</span><span class="n">could_extract_minus_sign</span><span class="p">():</span>
            <span class="k">return</span> <span class="o">-</span><span class="n">cls</span><span class="p">(</span><span class="o">-</span><span class="n">z</span><span class="p">)</span>

        <span class="c"># Try to pull out factors of I</span>
        <span class="n">nz</span> <span class="o">=</span> <span class="n">z</span><span class="o">.</span><span class="n">extract_multiplicatively</span><span class="p">(</span><span class="n">I</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">nz</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">nz</span> <span class="ow">is</span> <span class="n">S</span><span class="o">.</span><span class="n">Infinity</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">I</span>
            <span class="k">if</span> <span class="n">nz</span><span class="o">.</span><span class="n">func</span> <span class="ow">is</span> <span class="n">erfinv</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">I</span><span class="o">*</span><span class="n">nz</span><span class="o">.</span><span class="n">args</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="k">if</span> <span class="n">nz</span><span class="o">.</span><span class="n">func</span> <span class="ow">is</span> <span class="n">erfcinv</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">I</span><span class="o">*</span><span class="p">(</span><span class="n">S</span><span class="o">.</span><span class="n">One</span> <span class="o">-</span> <span class="n">nz</span><span class="o">.</span><span class="n">args</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
            <span class="k">if</span> <span class="n">nz</span><span class="o">.</span><span class="n">func</span> <span class="ow">is</span> <span class="n">erf2inv</span> <span class="ow">and</span> <span class="n">nz</span><span class="o">.</span><span class="n">args</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="ow">is</span> <span class="n">S</span><span class="o">.</span><span class="n">Zero</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">I</span><span class="o">*</span><span class="n">nz</span><span class="o">.</span><span class="n">args</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>

    <span class="nd">@staticmethod</span>
    <span class="nd">@cacheit</span>
    <span class="k">def</span> <span class="nf">taylor_term</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="o">*</span><span class="n">previous_terms</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">n</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">n</span> <span class="o">%</span> <span class="mi">2</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">S</span><span class="o">.</span><span class="n">Zero</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">x</span> <span class="o">=</span> <span class="n">sympify</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
            <span class="n">k</span> <span class="o">=</span> <span class="n">C</span><span class="o">.</span><span class="n">floor</span><span class="p">((</span><span class="n">n</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="n">S</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">previous_terms</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">2</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">previous_terms</span><span class="p">[</span><span class="o">-</span><span class="mi">2</span><span class="p">]</span> <span class="o">*</span> <span class="n">x</span><span class="o">**</span><span class="mi">2</span> <span class="o">*</span> <span class="p">(</span><span class="n">n</span> <span class="o">-</span> <span class="mi">2</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">n</span><span class="o">*</span><span class="n">k</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">return</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">x</span><span class="o">**</span><span class="n">n</span><span class="o">/</span><span class="p">(</span><span class="n">n</span><span class="o">*</span><span class="n">C</span><span class="o">.</span><span class="n">factorial</span><span class="p">(</span><span class="n">k</span><span class="p">)</span><span class="o">*</span><span class="n">sqrt</span><span class="p">(</span><span class="n">S</span><span class="o">.</span><span class="n">Pi</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">_eval_conjugate</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">func</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">args</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">conjugate</span><span class="p">())</span>

    <span class="k">def</span> <span class="nf">_eval_is_real</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">args</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">is_real</span>

    <span class="k">def</span> <span class="nf">_eval_rewrite_as_tractable</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">z</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">rewrite</span><span class="p">(</span><span class="n">erf</span><span class="p">)</span><span class="o">.</span><span class="n">rewrite</span><span class="p">(</span><span class="s">&quot;tractable&quot;</span><span class="p">,</span> <span class="n">deep</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_eval_rewrite_as_erf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">z</span><span class="p">):</span>
        <span class="k">return</span> <span class="o">-</span><span class="n">I</span><span class="o">*</span><span class="n">erf</span><span class="p">(</span><span class="n">I</span><span class="o">*</span><span class="n">z</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_eval_rewrite_as_erfc</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">z</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">I</span><span class="o">*</span><span class="n">erfc</span><span class="p">(</span><span class="n">I</span><span class="o">*</span><span class="n">z</span><span class="p">)</span> <span class="o">-</span> <span class="n">I</span>

    <span class="k">def</span> <span class="nf">_eval_rewrite_as_fresnels</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">z</span><span class="p">):</span>
        <span class="n">arg</span> <span class="o">=</span> <span class="p">(</span><span class="n">S</span><span class="o">.</span><span class="n">One</span> <span class="o">+</span> <span class="n">S</span><span class="o">.</span><span class="n">ImaginaryUnit</span><span class="p">)</span><span class="o">*</span><span class="n">z</span><span class="o">/</span><span class="n">sqrt</span><span class="p">(</span><span class="n">pi</span><span class="p">)</span>
        <span class="k">return</span> <span class="p">(</span><span class="n">S</span><span class="o">.</span><span class="n">One</span> <span class="o">-</span> <span class="n">S</span><span class="o">.</span><span class="n">ImaginaryUnit</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">fresnelc</span><span class="p">(</span><span class="n">arg</span><span class="p">)</span> <span class="o">-</span> <span class="n">I</span><span class="o">*</span><span class="n">fresnels</span><span class="p">(</span><span class="n">arg</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">_eval_rewrite_as_fresnelc</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">z</span><span class="p">):</span>
        <span class="n">arg</span> <span class="o">=</span> <span class="p">(</span><span class="n">S</span><span class="o">.</span><span class="n">One</span> <span class="o">+</span> <span class="n">S</span><span class="o">.</span><span class="n">ImaginaryUnit</span><span class="p">)</span><span class="o">*</span><span class="n">z</span><span class="o">/</span><span class="n">sqrt</span><span class="p">(</span><span class="n">pi</span><span class="p">)</span>
        <span class="k">return</span> <span class="p">(</span><span class="n">S</span><span class="o">.</span><span class="n">One</span> <span class="o">-</span> <span class="n">S</span><span class="o">.</span><span class="n">ImaginaryUnit</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">fresnelc</span><span class="p">(</span><span class="n">arg</span><span class="p">)</span> <span class="o">-</span> <span class="n">I</span><span class="o">*</span><span class="n">fresnels</span><span class="p">(</span><span class="n">arg</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">_eval_rewrite_as_meijerg</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">z</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">z</span><span class="o">/</span><span class="n">sqrt</span><span class="p">(</span><span class="n">pi</span><span class="p">)</span><span class="o">*</span><span class="n">meijerg</span><span class="p">([</span><span class="n">S</span><span class="o">.</span><span class="n">Half</span><span class="p">],</span> <span class="p">[],</span> <span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="o">-</span><span class="n">S</span><span class="o">.</span><span class="n">Half</span><span class="p">],</span> <span class="o">-</span><span class="n">z</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_eval_rewrite_as_hyper</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">z</span><span class="p">):</span>
        <span class="k">return</span> <span class="mi">2</span><span class="o">*</span><span class="n">z</span><span class="o">/</span><span class="n">sqrt</span><span class="p">(</span><span class="n">pi</span><span class="p">)</span><span class="o">*</span><span class="n">hyper</span><span class="p">([</span><span class="n">S</span><span class="o">.</span><span class="n">Half</span><span class="p">],</span> <span class="p">[</span><span class="mi">3</span><span class="o">*</span><span class="n">S</span><span class="o">.</span><span class="n">Half</span><span class="p">],</span> <span class="n">z</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_eval_rewrite_as_uppergamma</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">z</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">sqrt</span><span class="p">(</span><span class="o">-</span><span class="n">z</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">/</span><span class="n">z</span><span class="o">*</span><span class="p">(</span><span class="n">C</span><span class="o">.</span><span class="n">uppergamma</span><span class="p">(</span><span class="n">S</span><span class="o">.</span><span class="n">Half</span><span class="p">,</span> <span class="o">-</span><span class="n">z</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">/</span><span class="n">sqrt</span><span class="p">(</span><span class="n">S</span><span class="o">.</span><span class="n">Pi</span><span class="p">)</span> <span class="o">-</span> <span class="n">S</span><span class="o">.</span><span class="n">One</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_eval_rewrite_as_expint</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">z</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">sqrt</span><span class="p">(</span><span class="o">-</span><span class="n">z</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">/</span><span class="n">z</span> <span class="o">-</span> <span class="n">z</span><span class="o">*</span><span class="n">expint</span><span class="p">(</span><span class="n">S</span><span class="o">.</span><span class="n">Half</span><span class="p">,</span> <span class="o">-</span><span class="n">z</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">/</span><span class="n">sqrt</span><span class="p">(</span><span class="n">S</span><span class="o">.</span><span class="n">Pi</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">as_real_imag</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">deep</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="o">**</span><span class="n">hints</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">args</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">is_real</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">deep</span><span class="p">:</span>
                <span class="n">hints</span><span class="p">[</span><span class="s">&#39;complex&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">False</span>
                <span class="k">return</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">expand</span><span class="p">(</span><span class="n">deep</span><span class="p">,</span> <span class="o">**</span><span class="n">hints</span><span class="p">),</span> <span class="n">S</span><span class="o">.</span><span class="n">Zero</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">return</span> <span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">S</span><span class="o">.</span><span class="n">Zero</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">deep</span><span class="p">:</span>
            <span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">args</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">expand</span><span class="p">(</span><span class="n">deep</span><span class="p">,</span> <span class="o">**</span><span class="n">hints</span><span class="p">)</span><span class="o">.</span><span class="n">as_real_imag</span><span class="p">()</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">args</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">as_real_imag</span><span class="p">()</span>

        <span class="n">sq</span> <span class="o">=</span> <span class="o">-</span><span class="n">y</span><span class="o">**</span><span class="mi">2</span><span class="o">/</span><span class="n">x</span><span class="o">**</span><span class="mi">2</span>
        <span class="n">re</span> <span class="o">=</span> <span class="n">S</span><span class="o">.</span><span class="n">Half</span><span class="o">*</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">func</span><span class="p">(</span><span class="n">x</span> <span class="o">+</span> <span class="n">x</span><span class="o">*</span><span class="n">sqrt</span><span class="p">(</span><span class="n">sq</span><span class="p">))</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">func</span><span class="p">(</span><span class="n">x</span> <span class="o">-</span> <span class="n">x</span><span class="o">*</span><span class="n">sqrt</span><span class="p">(</span><span class="n">sq</span><span class="p">)))</span>
        <span class="n">im</span> <span class="o">=</span> <span class="n">x</span><span class="o">/</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">y</span><span class="p">)</span> <span class="o">*</span> <span class="n">sqrt</span><span class="p">(</span><span class="n">sq</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">func</span><span class="p">(</span><span class="n">x</span> <span class="o">-</span> <span class="n">x</span><span class="o">*</span><span class="n">sqrt</span><span class="p">(</span><span class="n">sq</span><span class="p">))</span> <span class="o">-</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">func</span><span class="p">(</span><span class="n">x</span> <span class="o">+</span> <span class="n">x</span><span class="o">*</span><span class="n">sqrt</span><span class="p">(</span><span class="n">sq</span><span class="p">)))</span>
        <span class="k">return</span> <span class="p">(</span><span class="n">re</span><span class="p">,</span> <span class="n">im</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="erf2"><a class="viewcode-back" href="../../../../modules/functions/special.html#sympy.functions.special.error_functions.erf2">[docs]</a><span class="k">class</span> <span class="nc">erf2</span><span class="p">(</span><span class="n">Function</span><span class="p">):</span>
    <span class="sd">r&quot;&quot;&quot;</span>
<span class="sd">    Two-argument error function. This function is defined as:</span>

<span class="sd">    .. math ::</span>
<span class="sd">        \mathrm{erf2}(x, y) = \frac{2}{\sqrt{\pi}} \int_x^y e^{-t^2} \mathrm{d}t</span>

<span class="sd">    Examples</span>
<span class="sd">    ========</span>

<span class="sd">    &gt;&gt;&gt; from sympy import I, oo, erf2</span>
<span class="sd">    &gt;&gt;&gt; from sympy.abc import x, y</span>

<span class="sd">    Several special values are known:</span>

<span class="sd">    &gt;&gt;&gt; erf2(0, 0)</span>
<span class="sd">    0</span>
<span class="sd">    &gt;&gt;&gt; erf2(x, x)</span>
<span class="sd">    0</span>
<span class="sd">    &gt;&gt;&gt; erf2(x, oo)</span>
<span class="sd">    -erf(x) + 1</span>
<span class="sd">    &gt;&gt;&gt; erf2(x, -oo)</span>
<span class="sd">    -erf(x) - 1</span>
<span class="sd">    &gt;&gt;&gt; erf2(oo, y)</span>
<span class="sd">    erf(y) - 1</span>
<span class="sd">    &gt;&gt;&gt; erf2(-oo, y)</span>
<span class="sd">    erf(y) + 1</span>

<span class="sd">    In general one can pull out factors of -1:</span>

<span class="sd">    &gt;&gt;&gt; erf2(-x, -y)</span>
<span class="sd">    -erf2(x, y)</span>

<span class="sd">    The error function obeys the mirror symmetry:</span>

<span class="sd">    &gt;&gt;&gt; from sympy import conjugate</span>
<span class="sd">    &gt;&gt;&gt; conjugate(erf2(x, y))</span>
<span class="sd">    erf2(conjugate(x), conjugate(y))</span>

<span class="sd">    Differentiation with respect to x, y is supported:</span>

<span class="sd">    &gt;&gt;&gt; from sympy import diff</span>
<span class="sd">    &gt;&gt;&gt; diff(erf2(x, y), x)</span>
<span class="sd">    -2*exp(-x**2)/sqrt(pi)</span>
<span class="sd">    &gt;&gt;&gt; diff(erf2(x, y), y)</span>
<span class="sd">    2*exp(-y**2)/sqrt(pi)</span>

<span class="sd">    See Also</span>
<span class="sd">    ========</span>

<span class="sd">    erf: Gaussian error function.</span>
<span class="sd">    erfc: Complementary error function.</span>
<span class="sd">    erfi: Imaginary error function.</span>
<span class="sd">    erfinv: Inverse error function.</span>
<span class="sd">    erfcinv: Inverse Complementary error function.</span>
<span class="sd">    erf2inv: Inverse two-argument error function.</span>

<span class="sd">    References</span>
<span class="sd">    ==========</span>

<span class="sd">    .. [1] http://functions.wolfram.com/GammaBetaErf/Erf2/</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">nargs</span> <span class="o">=</span> <span class="mi">2</span>

    <span class="k">def</span> <span class="nf">fdiff</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">argindex</span><span class="p">):</span>
        <span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">args</span>
        <span class="k">if</span> <span class="n">argindex</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="k">return</span> <span class="o">-</span><span class="mi">2</span><span class="o">*</span><span class="n">C</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">x</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">/</span><span class="n">sqrt</span><span class="p">(</span><span class="n">S</span><span class="o">.</span><span class="n">Pi</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">argindex</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
            <span class="k">return</span> <span class="mi">2</span><span class="o">*</span><span class="n">C</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">y</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">/</span><span class="n">sqrt</span><span class="p">(</span><span class="n">S</span><span class="o">.</span><span class="n">Pi</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">ArgumentIndexError</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">argindex</span><span class="p">)</span>

    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">eval</span><span class="p">(</span><span class="n">cls</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">):</span>
        <span class="n">I</span> <span class="o">=</span> <span class="n">S</span><span class="o">.</span><span class="n">Infinity</span>
        <span class="n">N</span> <span class="o">=</span> <span class="n">S</span><span class="o">.</span><span class="n">NegativeInfinity</span>
        <span class="n">O</span> <span class="o">=</span> <span class="n">S</span><span class="o">.</span><span class="n">Zero</span>
        <span class="k">if</span> <span class="n">x</span> <span class="ow">is</span> <span class="n">S</span><span class="o">.</span><span class="n">NaN</span> <span class="ow">or</span> <span class="n">y</span> <span class="ow">is</span> <span class="n">S</span><span class="o">.</span><span class="n">NaN</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">S</span><span class="o">.</span><span class="n">NaN</span>
        <span class="k">elif</span> <span class="n">x</span> <span class="o">==</span> <span class="n">y</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">S</span><span class="o">.</span><span class="n">Zero</span>
        <span class="k">elif</span> <span class="p">(</span><span class="n">x</span> <span class="ow">is</span> <span class="n">I</span> <span class="ow">or</span> <span class="n">x</span> <span class="ow">is</span> <span class="n">N</span> <span class="ow">or</span> <span class="n">x</span> <span class="ow">is</span> <span class="n">O</span><span class="p">)</span> <span class="ow">or</span> <span class="p">(</span><span class="n">y</span> <span class="ow">is</span> <span class="n">I</span> <span class="ow">or</span> <span class="n">y</span> <span class="ow">is</span> <span class="n">N</span> <span class="ow">or</span> <span class="n">y</span> <span class="ow">is</span> <span class="n">O</span><span class="p">):</span>
            <span class="k">return</span> <span class="n">erf</span><span class="p">(</span><span class="n">y</span><span class="p">)</span> <span class="o">-</span> <span class="n">erf</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">y</span><span class="o">.</span><span class="n">func</span> <span class="ow">is</span> <span class="n">erf2inv</span> <span class="ow">and</span> <span class="n">y</span><span class="o">.</span><span class="n">args</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="n">x</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">y</span><span class="o">.</span><span class="n">args</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>

        <span class="c">#Try to pull out -1 factor</span>
        <span class="n">sign_x</span> <span class="o">=</span> <span class="n">x</span><span class="o">.</span><span class="n">could_extract_minus_sign</span><span class="p">()</span>
        <span class="n">sign_y</span> <span class="o">=</span> <span class="n">y</span><span class="o">.</span><span class="n">could_extract_minus_sign</span><span class="p">()</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">sign_x</span> <span class="ow">and</span> <span class="n">sign_y</span><span class="p">):</span>
            <span class="k">return</span> <span class="o">-</span><span class="n">cls</span><span class="p">(</span><span class="o">-</span><span class="n">x</span><span class="p">,</span> <span class="o">-</span><span class="n">y</span><span class="p">)</span>
        <span class="k">elif</span> <span class="p">(</span><span class="n">sign_x</span> <span class="ow">or</span> <span class="n">sign_y</span><span class="p">):</span>
            <span class="k">return</span> <span class="n">erf</span><span class="p">(</span><span class="n">y</span><span class="p">)</span><span class="o">-</span><span class="n">erf</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_eval_conjugate</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">func</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">args</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">conjugate</span><span class="p">(),</span> <span class="bp">self</span><span class="o">.</span><span class="n">args</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">conjugate</span><span class="p">())</span>

    <span class="k">def</span> <span class="nf">_eval_is_real</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">args</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">is_real</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">args</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">is_real</span>

    <span class="k">def</span> <span class="nf">_eval_rewrite_as_erf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">erf</span><span class="p">(</span><span class="n">y</span><span class="p">)</span> <span class="o">-</span> <span class="n">erf</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_eval_rewrite_as_erfc</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">erfc</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">-</span> <span class="n">erfc</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_eval_rewrite_as_erfi</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">I</span><span class="o">*</span><span class="p">(</span><span class="n">erfi</span><span class="p">(</span><span class="n">I</span><span class="o">*</span><span class="n">x</span><span class="p">)</span><span class="o">-</span><span class="n">erfi</span><span class="p">(</span><span class="n">I</span><span class="o">*</span><span class="n">y</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">_eval_rewrite_as_fresnels</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">erf</span><span class="p">(</span><span class="n">y</span><span class="p">)</span><span class="o">.</span><span class="n">rewrite</span><span class="p">(</span><span class="n">fresnels</span><span class="p">)</span> <span class="o">-</span> <span class="n">erf</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">.</span><span class="n">rewrite</span><span class="p">(</span><span class="n">fresnels</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_eval_rewrite_as_fresnelc</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">erf</span><span class="p">(</span><span class="n">y</span><span class="p">)</span><span class="o">.</span><span class="n">rewrite</span><span class="p">(</span><span class="n">fresnelc</span><span class="p">)</span> <span class="o">-</span> <span class="n">erf</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">.</span><span class="n">rewrite</span><span class="p">(</span><span class="n">fresnelc</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_eval_rewrite_as_meijerg</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">erf</span><span class="p">(</span><span class="n">y</span><span class="p">)</span><span class="o">.</span><span class="n">rewrite</span><span class="p">(</span><span class="n">meijerg</span><span class="p">)</span> <span class="o">-</span> <span class="n">erf</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">.</span><span class="n">rewrite</span><span class="p">(</span><span class="n">meijerg</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_eval_rewrite_as_hyper</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">erf</span><span class="p">(</span><span class="n">y</span><span class="p">)</span><span class="o">.</span><span class="n">rewrite</span><span class="p">(</span><span class="n">hyper</span><span class="p">)</span> <span class="o">-</span> <span class="n">erf</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">.</span><span class="n">rewrite</span><span class="p">(</span><span class="n">hyper</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_eval_rewrite_as_uppergamma</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">):</span>
        <span class="k">return</span> <span class="p">(</span><span class="n">sqrt</span><span class="p">(</span><span class="n">y</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">/</span><span class="n">y</span><span class="o">*</span><span class="p">(</span><span class="n">S</span><span class="o">.</span><span class="n">One</span> <span class="o">-</span> <span class="n">C</span><span class="o">.</span><span class="n">uppergamma</span><span class="p">(</span><span class="n">S</span><span class="o">.</span><span class="n">Half</span><span class="p">,</span> <span class="n">y</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">/</span><span class="n">sqrt</span><span class="p">(</span><span class="n">S</span><span class="o">.</span><span class="n">Pi</span><span class="p">))</span> <span class="o">-</span>
            <span class="n">sqrt</span><span class="p">(</span><span class="n">x</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">/</span><span class="n">x</span><span class="o">*</span><span class="p">(</span><span class="n">S</span><span class="o">.</span><span class="n">One</span> <span class="o">-</span> <span class="n">C</span><span class="o">.</span><span class="n">uppergamma</span><span class="p">(</span><span class="n">S</span><span class="o">.</span><span class="n">Half</span><span class="p">,</span> <span class="n">x</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">/</span><span class="n">sqrt</span><span class="p">(</span><span class="n">S</span><span class="o">.</span><span class="n">Pi</span><span class="p">)))</span>

    <span class="k">def</span> <span class="nf">_eval_rewrite_as_expint</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">erf</span><span class="p">(</span><span class="n">y</span><span class="p">)</span><span class="o">.</span><span class="n">rewrite</span><span class="p">(</span><span class="n">expint</span><span class="p">)</span> <span class="o">-</span> <span class="n">erf</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">.</span><span class="n">rewrite</span><span class="p">(</span><span class="n">expint</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="erfinv"><a class="viewcode-back" href="../../../../modules/functions/special.html#sympy.functions.special.error_functions.erfinv">[docs]</a><span class="k">class</span> <span class="nc">erfinv</span><span class="p">(</span><span class="n">Function</span><span class="p">):</span>
    <span class="sd">r&quot;&quot;&quot;</span>
<span class="sd">    Inverse Error Function. The erfinv function is defined as:</span>

<span class="sd">    .. math ::</span>
<span class="sd">        \mathrm{erf}(x) = y \quad \Rightarrow \quad \mathrm{erfinv}(y) = x</span>

<span class="sd">    Examples</span>
<span class="sd">    ========</span>

<span class="sd">    &gt;&gt;&gt; from sympy import I, oo, erfinv</span>
<span class="sd">    &gt;&gt;&gt; from sympy.abc import x</span>

<span class="sd">    Several special values are known:</span>

<span class="sd">    &gt;&gt;&gt; erfinv(0)</span>
<span class="sd">    0</span>
<span class="sd">    &gt;&gt;&gt; erfinv(1)</span>
<span class="sd">    oo</span>

<span class="sd">    Differentiation with respect to x is supported:</span>

<span class="sd">    &gt;&gt;&gt; from sympy import diff</span>
<span class="sd">    &gt;&gt;&gt; diff(erfinv(x), x)</span>
<span class="sd">    sqrt(pi)*exp(erfinv(x)**2)/2</span>

<span class="sd">    We can numerically evaluate the inverse error function to arbitrary precision</span>
<span class="sd">    on [-1, 1]:</span>

<span class="sd">    &gt;&gt;&gt; erfinv(0.2).evalf(30)</span>
<span class="sd">    0.179143454621291692285822705344</span>

<span class="sd">    See Also</span>
<span class="sd">    ========</span>

<span class="sd">    erf: Gaussian error function.</span>
<span class="sd">    erfc: Complementary error function.</span>
<span class="sd">    erfi: Imaginary error function.</span>
<span class="sd">    erf2: Two-argument error function.</span>
<span class="sd">    erfcinv: Inverse Complementary error function.</span>
<span class="sd">    erf2inv: Inverse two-argument error function.</span>

<span class="sd">    References</span>
<span class="sd">    ==========</span>

<span class="sd">    .. [1] http://en.wikipedia.org/wiki/Error_function#Inverse_functions</span>
<span class="sd">    .. [2] http://functions.wolfram.com/GammaBetaErf/InverseErf/</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">nargs</span> <span class="o">=</span> <span class="mi">1</span>

    <span class="k">def</span> <span class="nf">fdiff</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">argindex</span> <span class="o">=</span><span class="mi">1</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">argindex</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">sqrt</span><span class="p">(</span><span class="n">S</span><span class="o">.</span><span class="n">Pi</span><span class="p">)</span><span class="o">*</span><span class="n">C</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">func</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">args</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">S</span><span class="o">.</span><span class="n">Half</span>
        <span class="k">else</span> <span class="p">:</span>
            <span class="k">raise</span> <span class="n">ArgumentIndexError</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">argindex</span><span class="p">)</span>

    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">eval</span><span class="p">(</span><span class="n">cls</span><span class="p">,</span> <span class="n">z</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">z</span> <span class="ow">is</span> <span class="n">S</span><span class="o">.</span><span class="n">NaN</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">S</span><span class="o">.</span><span class="n">NaN</span>
        <span class="k">elif</span> <span class="n">z</span> <span class="ow">is</span> <span class="n">S</span><span class="o">.</span><span class="n">NegativeOne</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">S</span><span class="o">.</span><span class="n">NegativeInfinity</span>
        <span class="k">elif</span> <span class="n">z</span> <span class="ow">is</span> <span class="n">S</span><span class="o">.</span><span class="n">Zero</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">S</span><span class="o">.</span><span class="n">Zero</span>
        <span class="k">elif</span> <span class="n">z</span> <span class="ow">is</span> <span class="n">S</span><span class="o">.</span><span class="n">One</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">S</span><span class="o">.</span><span class="n">Infinity</span>

        <span class="k">if</span> <span class="p">(</span><span class="n">z</span><span class="o">.</span><span class="n">func</span> <span class="ow">is</span> <span class="n">erf</span><span class="p">)</span> <span class="ow">and</span> <span class="n">z</span><span class="o">.</span><span class="n">args</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">is_real</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">z</span><span class="o">.</span><span class="n">args</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

        <span class="c"># Try to pull out factors of -1</span>
        <span class="n">nz</span> <span class="o">=</span> <span class="n">z</span><span class="o">.</span><span class="n">extract_multiplicatively</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">nz</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span> <span class="ow">and</span> <span class="p">((</span><span class="n">nz</span><span class="o">.</span><span class="n">func</span> <span class="ow">is</span> <span class="n">erf</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="n">nz</span><span class="o">.</span><span class="n">args</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">.</span><span class="n">is_real</span><span class="p">):</span>
            <span class="k">return</span> <span class="o">-</span><span class="n">nz</span><span class="o">.</span><span class="n">args</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

    <span class="k">def</span> <span class="nf">_eval_rewrite_as_erfcinv</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">z</span><span class="p">):</span>
       <span class="k">return</span> <span class="n">erfcinv</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">z</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="erfcinv"><a class="viewcode-back" href="../../../../modules/functions/special.html#sympy.functions.special.error_functions.erfcinv">[docs]</a><span class="k">class</span> <span class="nc">erfcinv</span> <span class="p">(</span><span class="n">Function</span><span class="p">):</span>
    <span class="sd">r&quot;&quot;&quot;</span>
<span class="sd">    Inverse Complementary Error Function. The erfcinv function is defined as:</span>

<span class="sd">    .. math ::</span>
<span class="sd">        \mathrm{erfc}(x) = y \quad \Rightarrow \quad \mathrm{erfcinv}(y) = x</span>

<span class="sd">    Examples</span>
<span class="sd">    ========</span>

<span class="sd">    &gt;&gt;&gt; from sympy import I, oo, erfcinv</span>
<span class="sd">    &gt;&gt;&gt; from sympy.abc import x</span>

<span class="sd">    Several special values are known:</span>

<span class="sd">    &gt;&gt;&gt; erfcinv(1)</span>
<span class="sd">    0</span>
<span class="sd">    &gt;&gt;&gt; erfcinv(0)</span>
<span class="sd">    oo</span>

<span class="sd">    Differentiation with respect to x is supported:</span>

<span class="sd">    &gt;&gt;&gt; from sympy import diff</span>
<span class="sd">    &gt;&gt;&gt; diff(erfcinv(x), x)</span>
<span class="sd">    -sqrt(pi)*exp(erfcinv(x)**2)/2</span>

<span class="sd">    See Also</span>
<span class="sd">    ========</span>

<span class="sd">    erf: Gaussian error function.</span>
<span class="sd">    erfc: Complementary error function.</span>
<span class="sd">    erfi: Imaginary error function.</span>
<span class="sd">    erf2: Two-argument error function.</span>
<span class="sd">    erfinv: Inverse error function.</span>
<span class="sd">    erf2inv: Inverse two-argument error function.</span>

<span class="sd">    References</span>
<span class="sd">    ==========</span>

<span class="sd">    .. [1] http://en.wikipedia.org/wiki/Error_function#Inverse_functions</span>
<span class="sd">    .. [2] http://functions.wolfram.com/GammaBetaErf/InverseErfc/</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">nargs</span> <span class="o">=</span> <span class="mi">1</span>

    <span class="k">def</span> <span class="nf">fdiff</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">argindex</span> <span class="o">=</span><span class="mi">1</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">argindex</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="k">return</span> <span class="o">-</span><span class="n">sqrt</span><span class="p">(</span><span class="n">S</span><span class="o">.</span><span class="n">Pi</span><span class="p">)</span><span class="o">*</span><span class="n">C</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">func</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">args</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">S</span><span class="o">.</span><span class="n">Half</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">ArgumentIndexError</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">argindex</span><span class="p">)</span>

    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">eval</span><span class="p">(</span><span class="n">cls</span><span class="p">,</span> <span class="n">z</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">z</span> <span class="ow">is</span> <span class="n">S</span><span class="o">.</span><span class="n">NaN</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">S</span><span class="o">.</span><span class="n">NaN</span>
        <span class="k">elif</span> <span class="n">z</span> <span class="ow">is</span> <span class="n">S</span><span class="o">.</span><span class="n">Zero</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">S</span><span class="o">.</span><span class="n">Infinity</span>
        <span class="k">elif</span> <span class="n">z</span> <span class="ow">is</span> <span class="n">S</span><span class="o">.</span><span class="n">One</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">S</span><span class="o">.</span><span class="n">Zero</span>
        <span class="k">elif</span> <span class="n">z</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">S</span><span class="o">.</span><span class="n">NegativeInfinity</span>

    <span class="k">def</span> <span class="nf">_eval_rewrite_as_erfinv</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">z</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">erfinv</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">z</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="erf2inv"><a class="viewcode-back" href="../../../../modules/functions/special.html#sympy.functions.special.error_functions.erf2inv">[docs]</a><span class="k">class</span> <span class="nc">erf2inv</span><span class="p">(</span><span class="n">Function</span><span class="p">):</span>
    <span class="sd">r&quot;&quot;&quot;</span>
<span class="sd">    Two-argument Inverse error function. The erf2inv function is defined as:</span>

<span class="sd">    .. math ::</span>
<span class="sd">        \mathrm{erf2}(x, w) = y \quad \Rightarrow \quad \mathrm{erf2inv}(x, y) = w</span>

<span class="sd">    Examples</span>
<span class="sd">    ========</span>

<span class="sd">    &gt;&gt;&gt; from sympy import I, oo, erf2inv, erfinv, erfcinv</span>
<span class="sd">    &gt;&gt;&gt; from sympy.abc import x, y</span>

<span class="sd">    Several special values are known:</span>

<span class="sd">    &gt;&gt;&gt; erf2inv(0, 0)</span>
<span class="sd">    0</span>
<span class="sd">    &gt;&gt;&gt; erf2inv(1, 0)</span>
<span class="sd">    1</span>
<span class="sd">    &gt;&gt;&gt; erf2inv(0, 1)</span>
<span class="sd">    oo</span>
<span class="sd">    &gt;&gt;&gt; erf2inv(0, y)</span>
<span class="sd">    erfinv(y)</span>
<span class="sd">    &gt;&gt;&gt; erf2inv(oo, y)</span>
<span class="sd">    erfcinv(-y)</span>

<span class="sd">    Differentiation with respect to x and y is supported:</span>

<span class="sd">    &gt;&gt;&gt; from sympy import diff</span>
<span class="sd">    &gt;&gt;&gt; diff(erf2inv(x, y), x)</span>
<span class="sd">    exp(-x**2 + erf2inv(x, y)**2)</span>
<span class="sd">    &gt;&gt;&gt; diff(erf2inv(x, y), y)</span>
<span class="sd">    sqrt(pi)*exp(erf2inv(x, y)**2)/2</span>

<span class="sd">    See Also</span>
<span class="sd">    ========</span>

<span class="sd">    erf: Gaussian error function.</span>
<span class="sd">    erfc: Complementary error function.</span>
<span class="sd">    erfi: Imaginary error function.</span>
<span class="sd">    erf2: Two-argument error function.</span>
<span class="sd">    erfinv: Inverse error function.</span>
<span class="sd">    erfcinv: Inverse complementary error function.</span>

<span class="sd">    References</span>
<span class="sd">    ==========</span>

<span class="sd">    .. [1] http://functions.wolfram.com/GammaBetaErf/InverseErf2/</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">nargs</span> <span class="o">=</span> <span class="mi">2</span>

    <span class="k">def</span> <span class="nf">fdiff</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">argindex</span><span class="p">):</span>
        <span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">args</span>
        <span class="k">if</span> <span class="n">argindex</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">C</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">func</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="o">-</span><span class="n">x</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">argindex</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">sqrt</span><span class="p">(</span><span class="n">S</span><span class="o">.</span><span class="n">Pi</span><span class="p">)</span><span class="o">*</span><span class="n">S</span><span class="o">.</span><span class="n">Half</span><span class="o">*</span><span class="n">C</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">func</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">ArgumentIndexError</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">argindex</span><span class="p">)</span>

    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">eval</span><span class="p">(</span><span class="n">cls</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">x</span> <span class="ow">is</span> <span class="n">S</span><span class="o">.</span><span class="n">NaN</span> <span class="ow">or</span> <span class="n">y</span> <span class="ow">is</span> <span class="n">S</span><span class="o">.</span><span class="n">NaN</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">S</span><span class="o">.</span><span class="n">NaN</span>
        <span class="k">elif</span> <span class="n">x</span> <span class="ow">is</span> <span class="n">S</span><span class="o">.</span><span class="n">Zero</span> <span class="ow">and</span> <span class="n">y</span> <span class="ow">is</span> <span class="n">S</span><span class="o">.</span><span class="n">Zero</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">S</span><span class="o">.</span><span class="n">Zero</span>
        <span class="k">elif</span> <span class="n">x</span> <span class="ow">is</span> <span class="n">S</span><span class="o">.</span><span class="n">Zero</span> <span class="ow">and</span> <span class="n">y</span> <span class="ow">is</span> <span class="n">S</span><span class="o">.</span><span class="n">One</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">S</span><span class="o">.</span><span class="n">Infinity</span>
        <span class="k">elif</span> <span class="n">x</span> <span class="ow">is</span> <span class="n">S</span><span class="o">.</span><span class="n">One</span> <span class="ow">and</span> <span class="n">y</span> <span class="ow">is</span> <span class="n">S</span><span class="o">.</span><span class="n">Zero</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">S</span><span class="o">.</span><span class="n">One</span>
        <span class="k">elif</span> <span class="n">x</span> <span class="ow">is</span> <span class="n">S</span><span class="o">.</span><span class="n">Zero</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">erfinv</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">x</span> <span class="ow">is</span> <span class="n">S</span><span class="o">.</span><span class="n">Infinity</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">erfcinv</span><span class="p">(</span><span class="o">-</span><span class="n">y</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">y</span> <span class="ow">is</span> <span class="n">S</span><span class="o">.</span><span class="n">Zero</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">x</span>
        <span class="k">elif</span> <span class="n">y</span> <span class="ow">is</span> <span class="n">S</span><span class="o">.</span><span class="n">Infinity</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">erfinv</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>


<span class="c">###############################################################################</span>
<span class="c">#################### EXPONENTIAL INTEGRALS ####################################</span>
<span class="c">###############################################################################</span>
</div>
<div class="viewcode-block" id="Ei"><a class="viewcode-back" href="../../../../modules/functions/special.html#sympy.functions.special.error_functions.Ei">[docs]</a><span class="k">class</span> <span class="nc">Ei</span><span class="p">(</span><span class="n">Function</span><span class="p">):</span>
    <span class="sd">r&quot;&quot;&quot;</span>
<span class="sd">    The classical exponential integral.</span>

<span class="sd">    For use in SymPy, this function is defined as</span>

<span class="sd">    .. math:: \operatorname{Ei}(x) = \sum_{n=1}^\infty \frac{x^n}{n\, n!}</span>
<span class="sd">                                     + \log(x) + \gamma,</span>

<span class="sd">    where `\gamma` is the Euler-Mascheroni constant.</span>

<span class="sd">    If `x` is a polar number, this defines an analytic function on the</span>
<span class="sd">    riemann surface of the logarithm. Otherwise this defines an analytic</span>
<span class="sd">    function in the cut plane `\mathbb{C} \setminus (-\infty, 0]`.</span>

<span class="sd">    **Background**</span>

<span class="sd">    The name *exponential integral* comes from the following statement:</span>

<span class="sd">    .. math:: \operatorname{Ei}(x) = \int_{-\infty}^x \frac{e^t}{t} \mathrm{d}t</span>

<span class="sd">    If the integral is interpreted as a Cauchy principal value, this statement</span>
<span class="sd">    holds for `x &gt; 0` and `\operatorname{Ei}(x)` as defined above.</span>

<span class="sd">    Note that we carefully avoided defining `\operatorname{Ei}(x)` for</span>
<span class="sd">    negative real `x`. This is because above integral formula does not hold for</span>
<span class="sd">    any polar lift of such `x`, indeed all branches of</span>
<span class="sd">    `\operatorname{Ei}(x)` above the negative reals are imaginary.</span>

<span class="sd">    However, the following statement holds for all `x \in \mathbb{R}^*`:</span>

<span class="sd">    .. math:: \int_{-\infty}^x \frac{e^t}{t} \mathrm{d}t =</span>
<span class="sd">              \frac{\operatorname{Ei}\left(|x|e^{i \arg(x)}\right) +</span>
<span class="sd">                    \operatorname{Ei}\left(|x|e^{- i \arg(x)}\right)}{2},</span>

<span class="sd">    where the integral is again understood to be a principal value if</span>
<span class="sd">    `x &gt; 0`, and `|x|e^{i \arg(x)}`,</span>
<span class="sd">    `|x|e^{- i \arg(x)}` denote two conjugate polar lifts of `x`.</span>

<span class="sd">    Examples</span>
<span class="sd">    ========</span>

<span class="sd">    &gt;&gt;&gt; from sympy import Ei, polar_lift, exp_polar, I, pi</span>
<span class="sd">    &gt;&gt;&gt; from sympy.abc import x</span>

<span class="sd">    The exponential integral in SymPy is strictly undefined for negative values</span>
<span class="sd">    of the argument. For convenience, exponential integrals with negative</span>
<span class="sd">    arguments are immediately converted into an expression that agrees with</span>
<span class="sd">    the classical integral definition:</span>

<span class="sd">    &gt;&gt;&gt; Ei(-1)</span>
<span class="sd">    -I*pi + Ei(exp_polar(I*pi))</span>

<span class="sd">    This yields a real value:</span>

<span class="sd">    &gt;&gt;&gt; Ei(-1).n(chop=True)</span>
<span class="sd">    -0.219383934395520</span>

<span class="sd">    On the other hand the analytic continuation is not real:</span>

<span class="sd">    &gt;&gt;&gt; Ei(polar_lift(-1)).n(chop=True)</span>
<span class="sd">    -0.21938393439552 + 3.14159265358979*I</span>

<span class="sd">    The exponential integral has a logarithmic branch point at the origin:</span>

<span class="sd">    &gt;&gt;&gt; Ei(x*exp_polar(2*I*pi))</span>
<span class="sd">    Ei(x) + 2*I*pi</span>

<span class="sd">    Differentiation is supported:</span>

<span class="sd">    &gt;&gt;&gt; Ei(x).diff(x)</span>
<span class="sd">    exp(x)/x</span>

<span class="sd">    The exponential integral is related to many other special functions.</span>
<span class="sd">    For example:</span>

<span class="sd">    &gt;&gt;&gt; from sympy import uppergamma, expint, Shi</span>
<span class="sd">    &gt;&gt;&gt; Ei(x).rewrite(expint)</span>
<span class="sd">    -expint(1, x*exp_polar(I*pi)) - I*pi</span>
<span class="sd">    &gt;&gt;&gt; Ei(x).rewrite(Shi)</span>
<span class="sd">    Chi(x) + Shi(x)</span>

<span class="sd">    See Also</span>
<span class="sd">    ========</span>

<span class="sd">    expint: Generalised exponential integral.</span>
<span class="sd">    E1: Special case of the generalised exponential integral.</span>
<span class="sd">    li: Logarithmic integral.</span>
<span class="sd">    Li: Offset logarithmic integral.</span>
<span class="sd">    Si: Sine integral.</span>
<span class="sd">    Ci: Cosine integral.</span>
<span class="sd">    Shi: Hyperbolic sine integral.</span>
<span class="sd">    Chi: Hyperbolic cosine integral.</span>
<span class="sd">    sympy.functions.special.gamma_functions.uppergamma</span>

<span class="sd">    References</span>
<span class="sd">    ==========</span>

<span class="sd">    .. [1] http://dlmf.nist.gov/6.6</span>
<span class="sd">    .. [2] http://en.wikipedia.org/wiki/Exponential_integral</span>
<span class="sd">    .. [3] Abramowitz &amp; Stegun, section 5: http://www.math.sfu.ca/~cbm/aands/page_228.htm</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">nargs</span> <span class="o">=</span> <span class="mi">1</span>

    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">eval</span><span class="p">(</span><span class="n">cls</span><span class="p">,</span> <span class="n">z</span><span class="p">):</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">z</span><span class="o">.</span><span class="n">is_polar</span> <span class="ow">and</span> <span class="n">z</span><span class="o">.</span><span class="n">is_negative</span><span class="p">:</span>
            <span class="c"># Note: is this a good idea?</span>
            <span class="k">return</span> <span class="n">Ei</span><span class="p">(</span><span class="n">polar_lift</span><span class="p">(</span><span class="n">z</span><span class="p">))</span> <span class="o">-</span> <span class="n">pi</span><span class="o">*</span><span class="n">I</span>
        <span class="n">nz</span><span class="p">,</span> <span class="n">n</span> <span class="o">=</span> <span class="n">z</span><span class="o">.</span><span class="n">extract_branch_factor</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">n</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">Ei</span><span class="p">(</span><span class="n">nz</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">I</span><span class="o">*</span><span class="n">pi</span><span class="o">*</span><span class="n">n</span>

    <span class="k">def</span> <span class="nf">fdiff</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">argindex</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
        <span class="kn">from</span> <span class="nn">sympy</span> <span class="kn">import</span> <span class="n">unpolarify</span>
        <span class="n">arg</span> <span class="o">=</span> <span class="n">unpolarify</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">args</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
        <span class="k">if</span> <span class="n">argindex</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">C</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">arg</span><span class="p">)</span><span class="o">/</span><span class="n">arg</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">ArgumentIndexError</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">argindex</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_eval_evalf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">prec</span><span class="p">):</span>
        <span class="k">if</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">args</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">/</span><span class="n">polar_lift</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">))</span><span class="o">.</span><span class="n">is_positive</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">Function</span><span class="o">.</span><span class="n">_eval_evalf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">prec</span><span class="p">)</span> <span class="o">+</span> <span class="p">(</span><span class="n">I</span><span class="o">*</span><span class="n">pi</span><span class="p">)</span><span class="o">.</span><span class="n">_eval_evalf</span><span class="p">(</span><span class="n">prec</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">Function</span><span class="o">.</span><span class="n">_eval_evalf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">prec</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_eval_rewrite_as_uppergamma</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">z</span><span class="p">):</span>
        <span class="kn">from</span> <span class="nn">sympy</span> <span class="kn">import</span> <span class="n">uppergamma</span>
        <span class="c"># XXX this does not currently work usefully because uppergamma</span>
        <span class="c">#     immediately turns into expint</span>
        <span class="k">return</span> <span class="o">-</span><span class="n">uppergamma</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">polar_lift</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">z</span><span class="p">)</span> <span class="o">-</span> <span class="n">I</span><span class="o">*</span><span class="n">pi</span>

    <span class="k">def</span> <span class="nf">_eval_rewrite_as_expint</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">z</span><span class="p">):</span>
        <span class="k">return</span> <span class="o">-</span><span class="n">expint</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">polar_lift</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">z</span><span class="p">)</span> <span class="o">-</span> <span class="n">I</span><span class="o">*</span><span class="n">pi</span>

    <span class="k">def</span> <span class="nf">_eval_rewrite_as_li</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">z</span><span class="p">):</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">z</span><span class="p">,</span> <span class="n">log</span><span class="p">):</span>
            <span class="k">return</span> <span class="n">li</span><span class="p">(</span><span class="n">z</span><span class="o">.</span><span class="n">args</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
        <span class="c"># TODO:</span>
        <span class="c"># Actually it only holds that:</span>
        <span class="c">#  Ei(z) = li(exp(z))</span>
        <span class="c"># for -pi &lt; imag(z) &lt;= pi</span>
        <span class="k">return</span> <span class="n">li</span><span class="p">(</span><span class="n">exp</span><span class="p">(</span><span class="n">z</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">_eval_rewrite_as_Si</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">z</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">Shi</span><span class="p">(</span><span class="n">z</span><span class="p">)</span> <span class="o">+</span> <span class="n">Chi</span><span class="p">(</span><span class="n">z</span><span class="p">)</span>
    <span class="n">_eval_rewrite_as_Ci</span> <span class="o">=</span> <span class="n">_eval_rewrite_as_Si</span>
    <span class="n">_eval_rewrite_as_Chi</span> <span class="o">=</span> <span class="n">_eval_rewrite_as_Si</span>
    <span class="n">_eval_rewrite_as_Shi</span> <span class="o">=</span> <span class="n">_eval_rewrite_as_Si</span>

    <span class="k">def</span> <span class="nf">_eval_rewrite_as_tractable</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">z</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">C</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">z</span><span class="p">)</span> <span class="o">*</span> <span class="n">_eis</span><span class="p">(</span><span class="n">z</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="expint"><a class="viewcode-back" href="../../../../modules/functions/special.html#sympy.functions.special.error_functions.expint">[docs]</a><span class="k">class</span> <span class="nc">expint</span><span class="p">(</span><span class="n">Function</span><span class="p">):</span>
    <span class="sd">r&quot;&quot;&quot;</span>
<span class="sd">    Generalized exponential integral.</span>

<span class="sd">    This function is defined as</span>

<span class="sd">    .. math:: \operatorname{E}_\nu(z) = z^{\nu - 1} \Gamma(1 - \nu, z),</span>

<span class="sd">    where `\Gamma(1 - \nu, z)` is the upper incomplete gamma function</span>
<span class="sd">    (``uppergamma``).</span>

<span class="sd">    Hence for :math:`z` with positive real part we have</span>

<span class="sd">    .. math:: \operatorname{E}_\nu(z)</span>
<span class="sd">              =   \int_1^\infty \frac{e^{-zt}}{z^\nu} \mathrm{d}t,</span>

<span class="sd">    which explains the name.</span>

<span class="sd">    The representation as an incomplete gamma function provides an analytic</span>
<span class="sd">    continuation for :math:`\operatorname{E}_\nu(z)`. If :math:`\nu` is a</span>
<span class="sd">    non-positive integer the exponential integral is thus an unbranched</span>
<span class="sd">    function of :math:`z`, otherwise there is a branch point at the origin.</span>
<span class="sd">    Refer to the incomplete gamma function documentation for details of the</span>
<span class="sd">    branching behavior.</span>

<span class="sd">    Examples</span>
<span class="sd">    ========</span>

<span class="sd">    &gt;&gt;&gt; from sympy import expint, S</span>
<span class="sd">    &gt;&gt;&gt; from sympy.abc import nu, z</span>

<span class="sd">    Differentiation is supported. Differentiation with respect to z explains</span>
<span class="sd">    further the name: for integral orders, the exponential integral is an</span>
<span class="sd">    iterated integral of the exponential function.</span>

<span class="sd">    &gt;&gt;&gt; expint(nu, z).diff(z)</span>
<span class="sd">    -expint(nu - 1, z)</span>

<span class="sd">    Differentiation with respect to nu has no classical expression:</span>

<span class="sd">    &gt;&gt;&gt; expint(nu, z).diff(nu)</span>
<span class="sd">    -z**(nu - 1)*meijerg(((), (1, 1)), ((0, 0, -nu + 1), ()), z)</span>

<span class="sd">    At non-postive integer orders, the exponential integral reduces to the</span>
<span class="sd">    exponential function:</span>

<span class="sd">    &gt;&gt;&gt; expint(0, z)</span>
<span class="sd">    exp(-z)/z</span>
<span class="sd">    &gt;&gt;&gt; expint(-1, z)</span>
<span class="sd">    exp(-z)/z + exp(-z)/z**2</span>

<span class="sd">    At half-integers it reduces to error functions:</span>

<span class="sd">    &gt;&gt;&gt; expint(S(1)/2, z)</span>
<span class="sd">    -sqrt(pi)*erf(sqrt(z))/sqrt(z) + sqrt(pi)/sqrt(z)</span>

<span class="sd">    At positive integer orders it can be rewritten in terms of exponentials</span>
<span class="sd">    and expint(1, z). Use expand_func() to do this:</span>

<span class="sd">    &gt;&gt;&gt; from sympy import expand_func</span>
<span class="sd">    &gt;&gt;&gt; expand_func(expint(5, z))</span>
<span class="sd">    z**4*expint(1, z)/24 + (-z**3 + z**2 - 2*z + 6)*exp(-z)/24</span>

<span class="sd">    The generalised exponential integral is essentially equivalent to the</span>
<span class="sd">    incomplete gamma function:</span>

<span class="sd">    &gt;&gt;&gt; from sympy import uppergamma</span>
<span class="sd">    &gt;&gt;&gt; expint(nu, z).rewrite(uppergamma)</span>
<span class="sd">    z**(nu - 1)*uppergamma(-nu + 1, z)</span>

<span class="sd">    As such it is branched at the origin:</span>

<span class="sd">    &gt;&gt;&gt; from sympy import exp_polar, pi, I</span>
<span class="sd">    &gt;&gt;&gt; expint(4, z*exp_polar(2*pi*I))</span>
<span class="sd">    I*pi*z**3/3 + expint(4, z)</span>
<span class="sd">    &gt;&gt;&gt; expint(nu, z*exp_polar(2*pi*I))</span>
<span class="sd">    z**(nu - 1)*(exp(2*I*pi*nu) - 1)*gamma(-nu + 1) + expint(nu, z)</span>

<span class="sd">    See Also</span>
<span class="sd">    ========</span>

<span class="sd">    Ei: Another related function called exponential integral.</span>
<span class="sd">    E1: The classical case, returns expint(1, z).</span>
<span class="sd">    li: Logarithmic integral.</span>
<span class="sd">    Li: Offset logarithmic integral.</span>
<span class="sd">    Si: Sine integral.</span>
<span class="sd">    Ci: Cosine integral.</span>
<span class="sd">    Shi: Hyperbolic sine integral.</span>
<span class="sd">    Chi: Hyperbolic cosine integral.</span>
<span class="sd">    sympy.functions.special.gamma_functions.uppergamma</span>

<span class="sd">    References</span>
<span class="sd">    ==========</span>

<span class="sd">    .. [1] http://dlmf.nist.gov/8.19</span>
<span class="sd">    .. [2] http://functions.wolfram.com/GammaBetaErf/ExpIntegralE/</span>
<span class="sd">    .. [3] http://en.wikipedia.org/wiki/Exponential_integral</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">nargs</span> <span class="o">=</span> <span class="mi">2</span>

    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">eval</span><span class="p">(</span><span class="n">cls</span><span class="p">,</span> <span class="n">nu</span><span class="p">,</span> <span class="n">z</span><span class="p">):</span>
        <span class="kn">from</span> <span class="nn">sympy</span> <span class="kn">import</span> <span class="p">(</span><span class="n">unpolarify</span><span class="p">,</span> <span class="n">expand_mul</span><span class="p">,</span> <span class="n">uppergamma</span><span class="p">,</span> <span class="n">exp</span><span class="p">,</span> <span class="n">gamma</span><span class="p">,</span>
                           <span class="n">factorial</span><span class="p">)</span>
        <span class="n">nu2</span> <span class="o">=</span> <span class="n">unpolarify</span><span class="p">(</span><span class="n">nu</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">nu</span> <span class="o">!=</span> <span class="n">nu2</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">expint</span><span class="p">(</span><span class="n">nu2</span><span class="p">,</span> <span class="n">z</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">nu</span><span class="o">.</span><span class="n">is_Integer</span> <span class="ow">and</span> <span class="n">nu</span> <span class="o">&lt;=</span> <span class="mi">0</span> <span class="ow">or</span> <span class="p">(</span><span class="ow">not</span> <span class="n">nu</span><span class="o">.</span><span class="n">is_Integer</span> <span class="ow">and</span> <span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">nu</span><span class="p">)</span><span class="o">.</span><span class="n">is_Integer</span><span class="p">):</span>
            <span class="k">return</span> <span class="n">unpolarify</span><span class="p">(</span><span class="n">expand_mul</span><span class="p">(</span><span class="n">z</span><span class="o">**</span><span class="p">(</span><span class="n">nu</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">uppergamma</span><span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">nu</span><span class="p">,</span> <span class="n">z</span><span class="p">)))</span>

        <span class="c"># Extract branching information. This can be deduced from what is</span>
        <span class="c"># explained in lowergamma.eval().</span>
        <span class="n">z</span><span class="p">,</span> <span class="n">n</span> <span class="o">=</span> <span class="n">z</span><span class="o">.</span><span class="n">extract_branch_factor</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">n</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">return</span>
        <span class="k">if</span> <span class="n">nu</span><span class="o">.</span><span class="n">is_integer</span><span class="p">:</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">nu</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">True</span><span class="p">:</span>
                <span class="k">return</span>
            <span class="k">return</span> <span class="n">expint</span><span class="p">(</span><span class="n">nu</span><span class="p">,</span> <span class="n">z</span><span class="p">)</span> \
                <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">pi</span><span class="o">*</span><span class="n">I</span><span class="o">*</span><span class="n">n</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="n">nu</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="n">factorial</span><span class="p">(</span><span class="n">nu</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">unpolarify</span><span class="p">(</span><span class="n">z</span><span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="n">nu</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="p">(</span><span class="n">exp</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">I</span><span class="o">*</span><span class="n">pi</span><span class="o">*</span><span class="n">nu</span><span class="o">*</span><span class="n">n</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">z</span><span class="o">**</span><span class="p">(</span><span class="n">nu</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">gamma</span><span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">nu</span><span class="p">)</span> <span class="o">+</span> <span class="n">expint</span><span class="p">(</span><span class="n">nu</span><span class="p">,</span> <span class="n">z</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">fdiff</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">argindex</span><span class="p">):</span>
        <span class="kn">from</span> <span class="nn">sympy</span> <span class="kn">import</span> <span class="n">meijerg</span>
        <span class="n">nu</span><span class="p">,</span> <span class="n">z</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">args</span>
        <span class="k">if</span> <span class="n">argindex</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="k">return</span> <span class="o">-</span><span class="n">z</span><span class="o">**</span><span class="p">(</span><span class="n">nu</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">meijerg</span><span class="p">([],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span> <span class="o">-</span> <span class="n">nu</span><span class="p">],</span> <span class="p">[],</span> <span class="n">z</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">argindex</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
            <span class="k">return</span> <span class="o">-</span><span class="n">expint</span><span class="p">(</span><span class="n">nu</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="n">z</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">ArgumentIndexError</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">argindex</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_eval_rewrite_as_uppergamma</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">nu</span><span class="p">,</span> <span class="n">z</span><span class="p">):</span>
        <span class="kn">from</span> <span class="nn">sympy</span> <span class="kn">import</span> <span class="n">uppergamma</span>
        <span class="k">return</span> <span class="n">z</span><span class="o">**</span><span class="p">(</span><span class="n">nu</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">uppergamma</span><span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">nu</span><span class="p">,</span> <span class="n">z</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_eval_rewrite_as_Ei</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">nu</span><span class="p">,</span> <span class="n">z</span><span class="p">):</span>
        <span class="kn">from</span> <span class="nn">sympy</span> <span class="kn">import</span> <span class="n">exp_polar</span><span class="p">,</span> <span class="n">unpolarify</span><span class="p">,</span> <span class="n">exp</span><span class="p">,</span> <span class="n">factorial</span>
        <span class="k">if</span> <span class="n">nu</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="k">return</span> <span class="o">-</span><span class="n">Ei</span><span class="p">(</span><span class="n">z</span><span class="o">*</span><span class="n">exp_polar</span><span class="p">(</span><span class="o">-</span><span class="n">I</span><span class="o">*</span><span class="n">pi</span><span class="p">))</span> <span class="o">-</span> <span class="n">I</span><span class="o">*</span><span class="n">pi</span>
        <span class="k">elif</span> <span class="n">nu</span><span class="o">.</span><span class="n">is_Integer</span> <span class="ow">and</span> <span class="n">nu</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
            <span class="c"># DLMF, 8.19.7</span>
            <span class="n">x</span> <span class="o">=</span> <span class="o">-</span><span class="n">unpolarify</span><span class="p">(</span><span class="n">z</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">x</span><span class="o">**</span><span class="p">(</span><span class="n">nu</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="n">factorial</span><span class="p">(</span><span class="n">nu</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">E1</span><span class="p">(</span><span class="n">z</span><span class="p">)</span><span class="o">.</span><span class="n">rewrite</span><span class="p">(</span><span class="n">Ei</span><span class="p">)</span> <span class="o">+</span> \
                <span class="n">exp</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">/</span><span class="n">factorial</span><span class="p">(</span><span class="n">nu</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">*</span> \
                <span class="n">Add</span><span class="p">(</span><span class="o">*</span><span class="p">[</span><span class="n">factorial</span><span class="p">(</span><span class="n">nu</span> <span class="o">-</span> <span class="n">k</span> <span class="o">-</span> <span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">x</span><span class="o">**</span><span class="n">k</span> <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nu</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)])</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span>

    <span class="k">def</span> <span class="nf">_eval_expand_func</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">hints</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">rewrite</span><span class="p">(</span><span class="n">Ei</span><span class="p">)</span><span class="o">.</span><span class="n">rewrite</span><span class="p">(</span><span class="n">expint</span><span class="p">,</span> <span class="o">**</span><span class="n">hints</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_eval_rewrite_as_Si</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">nu</span><span class="p">,</span> <span class="n">z</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">nu</span> <span class="o">!=</span> <span class="mi">1</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span>
        <span class="k">return</span> <span class="n">Shi</span><span class="p">(</span><span class="n">z</span><span class="p">)</span> <span class="o">-</span> <span class="n">Chi</span><span class="p">(</span><span class="n">z</span><span class="p">)</span>
    <span class="n">_eval_rewrite_as_Ci</span> <span class="o">=</span> <span class="n">_eval_rewrite_as_Si</span>
    <span class="n">_eval_rewrite_as_Chi</span> <span class="o">=</span> <span class="n">_eval_rewrite_as_Si</span>
    <span class="n">_eval_rewrite_as_Shi</span> <span class="o">=</span> <span class="n">_eval_rewrite_as_Si</span>

</div>
<div class="viewcode-block" id="E1"><a class="viewcode-back" href="../../../../modules/functions/special.html#sympy.functions.special.error_functions.E1">[docs]</a><span class="k">def</span> <span class="nf">E1</span><span class="p">(</span><span class="n">z</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Classical case of the generalized exponential integral.</span>

<span class="sd">    This is equivalent to ``expint(1, z)``.</span>

<span class="sd">    See Also</span>
<span class="sd">    ========</span>

<span class="sd">    Ei: Exponential integral.</span>
<span class="sd">    expint: Generalised exponential integral.</span>
<span class="sd">    li: Logarithmic integral.</span>
<span class="sd">    Li: Offset logarithmic integral.</span>
<span class="sd">    Si: Sine integral.</span>
<span class="sd">    Ci: Cosine integral.</span>
<span class="sd">    Shi: Hyperbolic sine integral.</span>
<span class="sd">    Chi: Hyperbolic cosine integral.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">expint</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">z</span><span class="p">)</span>

</div>
<div class="viewcode-block" id="li"><a class="viewcode-back" href="../../../../modules/functions/special.html#sympy.functions.special.error_functions.li">[docs]</a><span class="k">class</span> <span class="nc">li</span><span class="p">(</span><span class="n">Function</span><span class="p">):</span>
    <span class="sd">r&quot;&quot;&quot;</span>
<span class="sd">    The classical logarithmic integral.</span>

<span class="sd">    For the use in SymPy, this function is defined as</span>

<span class="sd">    .. math:: \operatorname{li}(x) = \int_0^x \frac{1}{\log(t)} \mathrm{d}t \,.</span>

<span class="sd">    Examples</span>
<span class="sd">    ========</span>

<span class="sd">    &gt;&gt;&gt; from sympy import I, oo, li</span>
<span class="sd">    &gt;&gt;&gt; from sympy.abc import z</span>

<span class="sd">    Several special values are known:</span>

<span class="sd">    &gt;&gt;&gt; li(0)</span>
<span class="sd">    0</span>
<span class="sd">    &gt;&gt;&gt; li(1)</span>
<span class="sd">    -oo</span>
<span class="sd">    &gt;&gt;&gt; li(oo)</span>
<span class="sd">    oo</span>

<span class="sd">    Differentiation with respect to z is supported:</span>

<span class="sd">    &gt;&gt;&gt; from sympy import diff</span>
<span class="sd">    &gt;&gt;&gt; diff(li(z), z)</span>
<span class="sd">    1/log(z)</span>

<span class="sd">    Defining the `li` function via an integral:</span>


<span class="sd">    The logarithmic integral can also be defined in terms of Ei:</span>

<span class="sd">    &gt;&gt;&gt; from sympy import Ei</span>
<span class="sd">    &gt;&gt;&gt; li(z).rewrite(Ei)</span>
<span class="sd">    Ei(log(z))</span>
<span class="sd">    &gt;&gt;&gt; diff(li(z).rewrite(Ei), z)</span>
<span class="sd">    1/log(z)</span>

<span class="sd">    We can numerically evaluate the logarithmic integral to arbitrary precision</span>
<span class="sd">    on the whole complex plane (except the singular points):</span>

<span class="sd">    &gt;&gt;&gt; li(2).evalf(30)</span>
<span class="sd">    1.04516378011749278484458888919</span>

<span class="sd">    &gt;&gt;&gt; li(2*I).evalf(30)</span>
<span class="sd">    1.0652795784357498247001125598 + 3.08346052231061726610939702133*I</span>

<span class="sd">    We can even compute Soldner&#39;s constant by the help of mpmath:</span>

<span class="sd">    &gt;&gt;&gt; from sympy.mpmath import findroot</span>
<span class="sd">    &gt;&gt;&gt; findroot(li, 2)</span>
<span class="sd">    1.45136923488338</span>

<span class="sd">    Further transformations include rewriting `li` in terms of</span>
<span class="sd">    the trigonometric integrals `Si`, `Ci`, `Shi` and `Chi`:</span>

<span class="sd">    &gt;&gt;&gt; from sympy import Si, Ci, Shi, Chi</span>
<span class="sd">    &gt;&gt;&gt; li(z).rewrite(Si)</span>
<span class="sd">    -log(I*log(z)) - log(1/log(z))/2 + log(log(z))/2 + Ci(I*log(z)) + Shi(log(z))</span>
<span class="sd">    &gt;&gt;&gt; li(z).rewrite(Ci)</span>
<span class="sd">    -log(I*log(z)) - log(1/log(z))/2 + log(log(z))/2 + Ci(I*log(z)) + Shi(log(z))</span>
<span class="sd">    &gt;&gt;&gt; li(z).rewrite(Shi)</span>
<span class="sd">    -log(1/log(z))/2 + log(log(z))/2 + Chi(log(z)) - Shi(log(z))</span>
<span class="sd">    &gt;&gt;&gt; li(z).rewrite(Chi)</span>
<span class="sd">    -log(1/log(z))/2 + log(log(z))/2 + Chi(log(z)) - Shi(log(z))</span>

<span class="sd">    See Also</span>
<span class="sd">    ========</span>

<span class="sd">    Li: Offset logarithmic integral.</span>
<span class="sd">    Ei: Exponential integral.</span>
<span class="sd">    expint: Generalised exponential integral.</span>
<span class="sd">    E1: Special case of the generalised exponential integral.</span>
<span class="sd">    Si: Sine integral.</span>
<span class="sd">    Ci: Cosine integral.</span>
<span class="sd">    Shi: Hyperbolic sine integral.</span>
<span class="sd">    Chi: Hyperbolic cosine integral.</span>

<span class="sd">    References</span>
<span class="sd">    ==========</span>

<span class="sd">    .. [1] http://en.wikipedia.org/wiki/Logarithmic_integral</span>
<span class="sd">    .. [2] http://mathworld.wolfram.com/LogarithmicIntegral.html</span>
<span class="sd">    .. [3] http://dlmf.nist.gov/6</span>
<span class="sd">    .. [4] http://mathworld.wolfram.com/SoldnersConstant.html</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">nargs</span> <span class="o">=</span> <span class="mi">1</span>

    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">eval</span><span class="p">(</span><span class="n">cls</span><span class="p">,</span> <span class="n">z</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">z</span> <span class="ow">is</span> <span class="n">S</span><span class="o">.</span><span class="n">Zero</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">S</span><span class="o">.</span><span class="n">Zero</span>
        <span class="k">elif</span> <span class="n">z</span> <span class="ow">is</span> <span class="n">S</span><span class="o">.</span><span class="n">One</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">S</span><span class="o">.</span><span class="n">NegativeInfinity</span>
        <span class="k">elif</span> <span class="n">z</span> <span class="ow">is</span> <span class="n">S</span><span class="o">.</span><span class="n">Infinity</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">S</span><span class="o">.</span><span class="n">Infinity</span>

    <span class="k">def</span> <span class="nf">fdiff</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">argindex</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
        <span class="n">arg</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">args</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">argindex</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">S</span><span class="o">.</span><span class="n">One</span> <span class="o">/</span> <span class="n">C</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">arg</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">ArgumentIndexError</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">argindex</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_eval_conjugate</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">z</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">args</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="c"># Exclude values on the branch cut (-oo, 0)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="n">z</span><span class="o">.</span><span class="n">is_real</span> <span class="ow">and</span> <span class="n">z</span><span class="o">.</span><span class="n">is_negative</span><span class="p">):</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">func</span><span class="p">(</span><span class="n">z</span><span class="o">.</span><span class="n">conjugate</span><span class="p">())</span>

    <span class="k">def</span> <span class="nf">_eval_rewrite_as_Li</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">z</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">Li</span><span class="p">(</span><span class="n">z</span><span class="p">)</span> <span class="o">+</span> <span class="n">li</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_eval_rewrite_as_Ei</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">z</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">Ei</span><span class="p">(</span><span class="n">C</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">z</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">_eval_rewrite_as_uppergamma</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">z</span><span class="p">):</span>
        <span class="kn">from</span> <span class="nn">sympy</span> <span class="kn">import</span> <span class="n">uppergamma</span>
        <span class="k">return</span> <span class="p">(</span><span class="o">-</span><span class="n">uppergamma</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="n">C</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">z</span><span class="p">))</span> <span class="o">+</span>
                <span class="n">S</span><span class="o">.</span><span class="n">Half</span><span class="o">*</span><span class="p">(</span><span class="n">C</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">C</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">z</span><span class="p">))</span> <span class="o">-</span> <span class="n">C</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">S</span><span class="o">.</span><span class="n">One</span><span class="o">/</span><span class="n">C</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">z</span><span class="p">)))</span> <span class="o">-</span> <span class="n">C</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="o">-</span><span class="n">C</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">z</span><span class="p">)))</span>

    <span class="k">def</span> <span class="nf">_eval_rewrite_as_Si</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">z</span><span class="p">):</span>
        <span class="k">return</span> <span class="p">(</span><span class="n">Ci</span><span class="p">(</span><span class="n">I</span><span class="o">*</span><span class="n">C</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">z</span><span class="p">))</span> <span class="o">-</span> <span class="n">I</span><span class="o">*</span><span class="n">Si</span><span class="p">(</span><span class="n">I</span><span class="o">*</span><span class="n">C</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">z</span><span class="p">))</span> <span class="o">-</span>
                <span class="n">S</span><span class="o">.</span><span class="n">Half</span><span class="o">*</span><span class="p">(</span><span class="n">C</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">S</span><span class="o">.</span><span class="n">One</span><span class="o">/</span><span class="n">C</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">z</span><span class="p">))</span> <span class="o">-</span> <span class="n">C</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">C</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">z</span><span class="p">)))</span> <span class="o">-</span> <span class="n">C</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">I</span><span class="o">*</span><span class="n">C</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">z</span><span class="p">)))</span>

    <span class="n">_eval_rewrite_as_Ci</span> <span class="o">=</span> <span class="n">_eval_rewrite_as_Si</span>

    <span class="k">def</span> <span class="nf">_eval_rewrite_as_Shi</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">z</span><span class="p">):</span>
        <span class="k">return</span> <span class="p">(</span><span class="n">Chi</span><span class="p">(</span><span class="n">C</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">z</span><span class="p">))</span> <span class="o">-</span> <span class="n">Shi</span><span class="p">(</span><span class="n">C</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">z</span><span class="p">))</span> <span class="o">-</span> <span class="n">S</span><span class="o">.</span><span class="n">Half</span><span class="o">*</span><span class="p">(</span><span class="n">C</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">S</span><span class="o">.</span><span class="n">One</span><span class="o">/</span><span class="n">C</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">z</span><span class="p">))</span> <span class="o">-</span> <span class="n">C</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">C</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">z</span><span class="p">))))</span>

    <span class="n">_eval_rewrite_as_Chi</span> <span class="o">=</span> <span class="n">_eval_rewrite_as_Shi</span>

    <span class="k">def</span> <span class="nf">_eval_rewrite_as_hyper</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">z</span><span class="p">):</span>
        <span class="k">return</span> <span class="p">(</span><span class="n">C</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">z</span><span class="p">)</span><span class="o">*</span><span class="n">hyper</span><span class="p">((</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="n">C</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">z</span><span class="p">))</span> <span class="o">+</span>
                <span class="n">S</span><span class="o">.</span><span class="n">Half</span><span class="o">*</span><span class="p">(</span><span class="n">C</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">C</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">z</span><span class="p">))</span> <span class="o">-</span> <span class="n">C</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">S</span><span class="o">.</span><span class="n">One</span><span class="o">/</span><span class="n">C</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">z</span><span class="p">)))</span> <span class="o">+</span> <span class="n">S</span><span class="o">.</span><span class="n">EulerGamma</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_eval_rewrite_as_meijerg</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">z</span><span class="p">):</span>
        <span class="k">return</span> <span class="p">(</span><span class="o">-</span><span class="n">C</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="o">-</span><span class="n">C</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">z</span><span class="p">))</span> <span class="o">-</span> <span class="n">S</span><span class="o">.</span><span class="n">Half</span><span class="o">*</span><span class="p">(</span><span class="n">C</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">S</span><span class="o">.</span><span class="n">One</span><span class="o">/</span><span class="n">C</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">z</span><span class="p">))</span> <span class="o">-</span> <span class="n">C</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">C</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">z</span><span class="p">)))</span>
                <span class="o">-</span> <span class="n">meijerg</span><span class="p">(((),</span> <span class="p">(</span><span class="mi">1</span><span class="p">,)),</span> <span class="p">((</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="p">()),</span> <span class="o">-</span><span class="n">C</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">z</span><span class="p">)))</span>

    <span class="k">def</span> <span class="nf">_eval_rewrite_as_tractable</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">z</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">z</span> <span class="o">*</span> <span class="n">_eis</span><span class="p">(</span><span class="n">C</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">z</span><span class="p">))</span>

</div>
<div class="viewcode-block" id="Li"><a class="viewcode-back" href="../../../../modules/functions/special.html#sympy.functions.special.error_functions.Li">[docs]</a><span class="k">class</span> <span class="nc">Li</span><span class="p">(</span><span class="n">Function</span><span class="p">):</span>
    <span class="sd">r&quot;&quot;&quot;</span>
<span class="sd">    The offset logarithmic integral.</span>

<span class="sd">    For the use in SymPy, this function is defined as</span>

<span class="sd">    .. math:: \operatorname{Li}(x) = \operatorname{li}(x) - \operatorname{li}(2)</span>

<span class="sd">    Examples</span>
<span class="sd">    ========</span>

<span class="sd">    &gt;&gt;&gt; from sympy import I, oo, Li</span>
<span class="sd">    &gt;&gt;&gt; from sympy.abc import z</span>

<span class="sd">    The following special value is known:</span>

<span class="sd">    &gt;&gt;&gt; Li(2)</span>
<span class="sd">    0</span>

<span class="sd">    Differentiation with respect to z is supported:</span>

<span class="sd">    &gt;&gt;&gt; from sympy import diff</span>
<span class="sd">    &gt;&gt;&gt; diff(Li(z), z)</span>
<span class="sd">    1/log(z)</span>

<span class="sd">    The shifted logarithmic integral can be written in terms of `li(z)`:</span>

<span class="sd">    &gt;&gt;&gt; from sympy import li</span>
<span class="sd">    &gt;&gt;&gt; Li(z).rewrite(li)</span>
<span class="sd">    li(z) - li(2)</span>

<span class="sd">    We can numerically evaluate the logarithmic integral to arbitrary precision</span>
<span class="sd">    on the whole complex plane (except the singular points):</span>

<span class="sd">    &gt;&gt;&gt; Li(2).evalf(30)</span>
<span class="sd">    0</span>

<span class="sd">    &gt;&gt;&gt; Li(4).evalf(30)</span>
<span class="sd">    1.92242131492155809316615998938</span>

<span class="sd">    See Also</span>
<span class="sd">    ========</span>

<span class="sd">    li: Logarithmic integral.</span>
<span class="sd">    Ei: Exponential integral.</span>
<span class="sd">    expint: Generalised exponential integral.</span>
<span class="sd">    E1: Special case of the generalised exponential integral.</span>
<span class="sd">    Si: Sine integral.</span>
<span class="sd">    Ci: Cosine integral.</span>
<span class="sd">    Shi: Hyperbolic sine integral.</span>
<span class="sd">    Chi: Hyperbolic cosine integral.</span>

<span class="sd">    References</span>
<span class="sd">    ==========</span>

<span class="sd">    .. [1] http://en.wikipedia.org/wiki/Logarithmic_integral</span>
<span class="sd">    .. [2] http://mathworld.wolfram.com/LogarithmicIntegral.html</span>
<span class="sd">    .. [3] http://dlmf.nist.gov/6</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">nargs</span> <span class="o">=</span> <span class="mi">1</span>

    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">eval</span><span class="p">(</span><span class="n">cls</span><span class="p">,</span> <span class="n">z</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">z</span> <span class="ow">is</span> <span class="n">S</span><span class="o">.</span><span class="n">Infinity</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">S</span><span class="o">.</span><span class="n">Infinity</span>
        <span class="k">elif</span> <span class="n">z</span> <span class="ow">is</span> <span class="mi">2</span><span class="o">*</span><span class="n">S</span><span class="o">.</span><span class="n">One</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">S</span><span class="o">.</span><span class="n">Zero</span>

    <span class="k">def</span> <span class="nf">fdiff</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">argindex</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
        <span class="n">arg</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">args</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">argindex</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">S</span><span class="o">.</span><span class="n">One</span> <span class="o">/</span> <span class="n">C</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">arg</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">ArgumentIndexError</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">argindex</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_eval_evalf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">prec</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">rewrite</span><span class="p">(</span><span class="n">li</span><span class="p">)</span><span class="o">.</span><span class="n">evalf</span><span class="p">(</span><span class="n">prec</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_eval_rewrite_as_li</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">z</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">li</span><span class="p">(</span><span class="n">z</span><span class="p">)</span> <span class="o">-</span> <span class="n">li</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_eval_rewrite_as_tractable</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">z</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">rewrite</span><span class="p">(</span><span class="n">li</span><span class="p">)</span><span class="o">.</span><span class="n">rewrite</span><span class="p">(</span><span class="s">&quot;tractable&quot;</span><span class="p">,</span> <span class="n">deep</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>

<span class="c">###############################################################################</span>
<span class="c">#################### TRIGONOMETRIC INTEGRALS ##################################</span>
<span class="c">###############################################################################</span>
</div>
<span class="k">class</span> <span class="nc">TrigonometricIntegral</span><span class="p">(</span><span class="n">Function</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot; Base class for trigonometric integrals. &quot;&quot;&quot;</span>

    <span class="n">nargs</span> <span class="o">=</span> <span class="mi">1</span>

    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">eval</span><span class="p">(</span><span class="n">cls</span><span class="p">,</span> <span class="n">z</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">z</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">cls</span><span class="o">.</span><span class="n">_atzero</span>
        <span class="k">elif</span> <span class="n">z</span> <span class="ow">is</span> <span class="n">S</span><span class="o">.</span><span class="n">Infinity</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">cls</span><span class="o">.</span><span class="n">_atinf</span>
        <span class="k">elif</span> <span class="n">z</span> <span class="ow">is</span> <span class="n">S</span><span class="o">.</span><span class="n">NegativeInfinity</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">cls</span><span class="o">.</span><span class="n">_atneginf</span>

        <span class="n">nz</span> <span class="o">=</span> <span class="n">z</span><span class="o">.</span><span class="n">extract_multiplicatively</span><span class="p">(</span><span class="n">polar_lift</span><span class="p">(</span><span class="n">I</span><span class="p">))</span>
        <span class="k">if</span> <span class="n">nz</span> <span class="ow">is</span> <span class="bp">None</span> <span class="ow">and</span> <span class="n">cls</span><span class="o">.</span><span class="n">_trigfunc</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">nz</span> <span class="o">=</span> <span class="n">z</span><span class="o">.</span><span class="n">extract_multiplicatively</span><span class="p">(</span><span class="n">I</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">nz</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">cls</span><span class="o">.</span><span class="n">_Ifactor</span><span class="p">(</span><span class="n">nz</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
        <span class="n">nz</span> <span class="o">=</span> <span class="n">z</span><span class="o">.</span><span class="n">extract_multiplicatively</span><span class="p">(</span><span class="n">polar_lift</span><span class="p">(</span><span class="o">-</span><span class="n">I</span><span class="p">))</span>
        <span class="k">if</span> <span class="n">nz</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">cls</span><span class="o">.</span><span class="n">_Ifactor</span><span class="p">(</span><span class="n">nz</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>

        <span class="n">nz</span> <span class="o">=</span> <span class="n">z</span><span class="o">.</span><span class="n">extract_multiplicatively</span><span class="p">(</span><span class="n">polar_lift</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">))</span>
        <span class="k">if</span> <span class="n">nz</span> <span class="ow">is</span> <span class="bp">None</span> <span class="ow">and</span> <span class="n">cls</span><span class="o">.</span><span class="n">_trigfunc</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">nz</span> <span class="o">=</span> <span class="n">z</span><span class="o">.</span><span class="n">extract_multiplicatively</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">nz</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">cls</span><span class="o">.</span><span class="n">_minusfactor</span><span class="p">(</span><span class="n">nz</span><span class="p">)</span>

        <span class="n">nz</span><span class="p">,</span> <span class="n">n</span> <span class="o">=</span> <span class="n">z</span><span class="o">.</span><span class="n">extract_branch_factor</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">n</span> <span class="o">==</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">nz</span> <span class="o">==</span> <span class="n">z</span><span class="p">:</span>
            <span class="k">return</span>
        <span class="k">return</span> <span class="mi">2</span><span class="o">*</span><span class="n">pi</span><span class="o">*</span><span class="n">I</span><span class="o">*</span><span class="n">n</span><span class="o">*</span><span class="n">cls</span><span class="o">.</span><span class="n">_trigfunc</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span> <span class="o">+</span> <span class="n">cls</span><span class="p">(</span><span class="n">nz</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">fdiff</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">argindex</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
        <span class="kn">from</span> <span class="nn">sympy</span> <span class="kn">import</span> <span class="n">unpolarify</span>
        <span class="n">arg</span> <span class="o">=</span> <span class="n">unpolarify</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">args</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
        <span class="k">if</span> <span class="n">argindex</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_trigfunc</span><span class="p">(</span><span class="n">arg</span><span class="p">)</span><span class="o">/</span><span class="n">arg</span>

    <span class="k">def</span> <span class="nf">_eval_rewrite_as_Ei</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">z</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_eval_rewrite_as_expint</span><span class="p">(</span><span class="n">z</span><span class="p">)</span><span class="o">.</span><span class="n">rewrite</span><span class="p">(</span><span class="n">Ei</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_eval_rewrite_as_uppergamma</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">z</span><span class="p">):</span>
        <span class="kn">from</span> <span class="nn">sympy</span> <span class="kn">import</span> <span class="n">uppergamma</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_eval_rewrite_as_expint</span><span class="p">(</span><span class="n">z</span><span class="p">)</span><span class="o">.</span><span class="n">rewrite</span><span class="p">(</span><span class="n">uppergamma</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_eval_nseries</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">logx</span><span class="p">):</span>
        <span class="c"># NOTE this is fairly inefficient</span>
        <span class="kn">from</span> <span class="nn">sympy</span> <span class="kn">import</span> <span class="n">log</span><span class="p">,</span> <span class="n">EulerGamma</span><span class="p">,</span> <span class="n">Pow</span>
        <span class="n">n</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">args</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">return</span> <span class="nb">super</span><span class="p">(</span><span class="n">TrigonometricIntegral</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">_eval_nseries</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">logx</span><span class="p">)</span>
        <span class="n">baseseries</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_trigfunc</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">.</span><span class="n">_eval_nseries</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">logx</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_trigfunc</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">baseseries</span> <span class="o">-=</span> <span class="mi">1</span>
        <span class="n">baseseries</span> <span class="o">=</span> <span class="n">baseseries</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="n">Pow</span><span class="p">,</span> <span class="k">lambda</span> <span class="n">t</span><span class="p">,</span> <span class="n">n</span><span class="p">:</span> <span class="n">t</span><span class="o">**</span><span class="n">n</span><span class="o">/</span><span class="n">n</span><span class="p">,</span> <span class="n">simultaneous</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_trigfunc</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">baseseries</span> <span class="o">+=</span> <span class="n">EulerGamma</span> <span class="o">+</span> <span class="n">log</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">baseseries</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">args</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">.</span><span class="n">_eval_nseries</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">logx</span><span class="p">)</span>


<div class="viewcode-block" id="Si"><a class="viewcode-back" href="../../../../modules/functions/special.html#sympy.functions.special.error_functions.Si">[docs]</a><span class="k">class</span> <span class="nc">Si</span><span class="p">(</span><span class="n">TrigonometricIntegral</span><span class="p">):</span>
    <span class="sd">r&quot;&quot;&quot;</span>
<span class="sd">    Sine integral.</span>

<span class="sd">    This function is defined by</span>

<span class="sd">    .. math:: \operatorname{Si}(z) = \int_0^z \frac{\sin{t}}{t} \mathrm{d}t.</span>

<span class="sd">    It is an entire function.</span>

<span class="sd">    Examples</span>
<span class="sd">    ========</span>

<span class="sd">    &gt;&gt;&gt; from sympy import Si</span>
<span class="sd">    &gt;&gt;&gt; from sympy.abc import z</span>

<span class="sd">    The sine integral is an antiderivative of sin(z)/z:</span>

<span class="sd">    &gt;&gt;&gt; Si(z).diff(z)</span>
<span class="sd">    sin(z)/z</span>

<span class="sd">    It is unbranched:</span>

<span class="sd">    &gt;&gt;&gt; from sympy import exp_polar, I, pi</span>
<span class="sd">    &gt;&gt;&gt; Si(z*exp_polar(2*I*pi))</span>
<span class="sd">    Si(z)</span>

<span class="sd">    Sine integral behaves much like ordinary sine under multiplication by ``I``:</span>

<span class="sd">    &gt;&gt;&gt; Si(I*z)</span>
<span class="sd">    I*Shi(z)</span>
<span class="sd">    &gt;&gt;&gt; Si(-z)</span>
<span class="sd">    -Si(z)</span>

<span class="sd">    It can also be expressed in terms of exponential integrals, but beware</span>
<span class="sd">    that the latter is branched:</span>

<span class="sd">    &gt;&gt;&gt; from sympy import expint</span>
<span class="sd">    &gt;&gt;&gt; Si(z).rewrite(expint)</span>
<span class="sd">    -I*(-expint(1, z*exp_polar(-I*pi/2))/2 +</span>
<span class="sd">         expint(1, z*exp_polar(I*pi/2))/2) + pi/2</span>

<span class="sd">    See Also</span>
<span class="sd">    ========</span>

<span class="sd">    Ci: Cosine integral.</span>
<span class="sd">    Shi: Hyperbolic sine integral.</span>
<span class="sd">    Chi: Hyperbolic cosine integral.</span>
<span class="sd">    Ei: Exponential integral.</span>
<span class="sd">    expint: Generalised exponential integral.</span>
<span class="sd">    E1: Special case of the generalised exponential integral.</span>
<span class="sd">    li: Logarithmic integral.</span>
<span class="sd">    Li: Offset logarithmic integral.</span>

<span class="sd">    References</span>
<span class="sd">    ==========</span>

<span class="sd">    .. [1] http://en.wikipedia.org/wiki/Trigonometric_integral</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">_trigfunc</span> <span class="o">=</span> <span class="n">C</span><span class="o">.</span><span class="n">sin</span>
    <span class="n">_atzero</span> <span class="o">=</span> <span class="n">S</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
    <span class="n">_atinf</span> <span class="o">=</span> <span class="n">pi</span><span class="o">*</span><span class="n">S</span><span class="o">.</span><span class="n">Half</span>
    <span class="n">_atneginf</span> <span class="o">=</span> <span class="o">-</span><span class="n">pi</span><span class="o">*</span><span class="n">S</span><span class="o">.</span><span class="n">Half</span>

    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">_minusfactor</span><span class="p">(</span><span class="n">cls</span><span class="p">,</span> <span class="n">z</span><span class="p">):</span>
        <span class="k">return</span> <span class="o">-</span><span class="n">Si</span><span class="p">(</span><span class="n">z</span><span class="p">)</span>

    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">_Ifactor</span><span class="p">(</span><span class="n">cls</span><span class="p">,</span> <span class="n">z</span><span class="p">,</span> <span class="n">sign</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">I</span><span class="o">*</span><span class="n">Shi</span><span class="p">(</span><span class="n">z</span><span class="p">)</span><span class="o">*</span><span class="n">sign</span>

    <span class="k">def</span> <span class="nf">_eval_rewrite_as_expint</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">z</span><span class="p">):</span>
        <span class="c"># XXX should we polarify z?</span>
        <span class="k">return</span> <span class="n">pi</span><span class="o">/</span><span class="mi">2</span> <span class="o">+</span> <span class="p">(</span><span class="n">E1</span><span class="p">(</span><span class="n">polar_lift</span><span class="p">(</span><span class="n">I</span><span class="p">)</span><span class="o">*</span><span class="n">z</span><span class="p">)</span> <span class="o">-</span> <span class="n">E1</span><span class="p">(</span><span class="n">polar_lift</span><span class="p">(</span><span class="o">-</span><span class="n">I</span><span class="p">)</span><span class="o">*</span><span class="n">z</span><span class="p">))</span><span class="o">/</span><span class="mi">2</span><span class="o">/</span><span class="n">I</span>

</div>
<div class="viewcode-block" id="Ci"><a class="viewcode-back" href="../../../../modules/functions/special.html#sympy.functions.special.error_functions.Ci">[docs]</a><span class="k">class</span> <span class="nc">Ci</span><span class="p">(</span><span class="n">TrigonometricIntegral</span><span class="p">):</span>
    <span class="sd">r&quot;&quot;&quot;</span>
<span class="sd">    Cosine integral.</span>

<span class="sd">    This function is defined for positive `x` by</span>

<span class="sd">    .. math:: \operatorname{Ci}(x) = \gamma + \log{x}</span>
<span class="sd">                         + \int_0^x \frac{\cos{t} - 1}{t} \mathrm{d}t</span>
<span class="sd">           = -\int_x^\infty \frac{\cos{t}}{t} \mathrm{d}t,</span>

<span class="sd">    where `\gamma` is the Euler-Mascheroni constant.</span>

<span class="sd">    We have</span>

<span class="sd">    .. math:: \operatorname{Ci}(z) =</span>
<span class="sd">        -\frac{\operatorname{E}_1\left(e^{i\pi/2} z\right)</span>
<span class="sd">               + \operatorname{E}_1\left(e^{-i \pi/2} z\right)}{2}</span>

<span class="sd">    which holds for all polar `z` and thus provides an analytic</span>
<span class="sd">    continuation to the Riemann surface of the logarithm.</span>

<span class="sd">    The formula also holds as stated</span>
<span class="sd">    for `z \in \mathbb{C}` with `\Re(z) &gt; 0`.</span>
<span class="sd">    By lifting to the principal branch we obtain an analytic function on the</span>
<span class="sd">    cut complex plane.</span>

<span class="sd">    Examples</span>
<span class="sd">    ========</span>

<span class="sd">    &gt;&gt;&gt; from sympy import Ci</span>
<span class="sd">    &gt;&gt;&gt; from sympy.abc import z</span>

<span class="sd">    The cosine integral is a primitive of `\cos(z)/z`:</span>

<span class="sd">    &gt;&gt;&gt; Ci(z).diff(z)</span>
<span class="sd">    cos(z)/z</span>

<span class="sd">    It has a logarithmic branch point at the origin:</span>

<span class="sd">    &gt;&gt;&gt; from sympy import exp_polar, I, pi</span>
<span class="sd">    &gt;&gt;&gt; Ci(z*exp_polar(2*I*pi))</span>
<span class="sd">    Ci(z) + 2*I*pi</span>

<span class="sd">    The cosine integral behaves somewhat like ordinary `\cos` under multiplication by `i`:</span>

<span class="sd">    &gt;&gt;&gt; from sympy import polar_lift</span>
<span class="sd">    &gt;&gt;&gt; Ci(polar_lift(I)*z)</span>
<span class="sd">    Chi(z) + I*pi/2</span>
<span class="sd">    &gt;&gt;&gt; Ci(polar_lift(-1)*z)</span>
<span class="sd">    Ci(z) + I*pi</span>

<span class="sd">    It can also be expressed in terms of exponential integrals:</span>

<span class="sd">    &gt;&gt;&gt; from sympy import expint</span>
<span class="sd">    &gt;&gt;&gt; Ci(z).rewrite(expint)</span>
<span class="sd">    -expint(1, z*exp_polar(-I*pi/2))/2 - expint(1, z*exp_polar(I*pi/2))/2</span>

<span class="sd">    See Also</span>
<span class="sd">    ========</span>

<span class="sd">    Si: Sine integral.</span>
<span class="sd">    Shi: Hyperbolic sine integral.</span>
<span class="sd">    Chi: Hyperbolic cosine integral.</span>
<span class="sd">    Ei: Exponential integral.</span>
<span class="sd">    expint: Generalised exponential integral.</span>
<span class="sd">    E1: Special case of the generalised exponential integral.</span>
<span class="sd">    li: Logarithmic integral.</span>
<span class="sd">    Li: Offset logarithmic integral.</span>

<span class="sd">    References</span>
<span class="sd">    ==========</span>

<span class="sd">    .. [1] http://en.wikipedia.org/wiki/Trigonometric_integral</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">_trigfunc</span> <span class="o">=</span> <span class="n">C</span><span class="o">.</span><span class="n">cos</span>
    <span class="n">_atzero</span> <span class="o">=</span> <span class="n">S</span><span class="o">.</span><span class="n">ComplexInfinity</span>
    <span class="n">_atinf</span> <span class="o">=</span> <span class="n">S</span><span class="o">.</span><span class="n">Zero</span>
    <span class="n">_atneginf</span> <span class="o">=</span> <span class="n">I</span><span class="o">*</span><span class="n">pi</span>

    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">_minusfactor</span><span class="p">(</span><span class="n">cls</span><span class="p">,</span> <span class="n">z</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">Ci</span><span class="p">(</span><span class="n">z</span><span class="p">)</span> <span class="o">+</span> <span class="n">I</span><span class="o">*</span><span class="n">pi</span>

    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">_Ifactor</span><span class="p">(</span><span class="n">cls</span><span class="p">,</span> <span class="n">z</span><span class="p">,</span> <span class="n">sign</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">Chi</span><span class="p">(</span><span class="n">z</span><span class="p">)</span> <span class="o">+</span> <span class="n">I</span><span class="o">*</span><span class="n">pi</span><span class="o">/</span><span class="mi">2</span><span class="o">*</span><span class="n">sign</span>

    <span class="k">def</span> <span class="nf">_eval_rewrite_as_expint</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">z</span><span class="p">):</span>
        <span class="k">return</span> <span class="o">-</span><span class="p">(</span><span class="n">E1</span><span class="p">(</span><span class="n">polar_lift</span><span class="p">(</span><span class="n">I</span><span class="p">)</span><span class="o">*</span><span class="n">z</span><span class="p">)</span> <span class="o">+</span> <span class="n">E1</span><span class="p">(</span><span class="n">polar_lift</span><span class="p">(</span><span class="o">-</span><span class="n">I</span><span class="p">)</span><span class="o">*</span><span class="n">z</span><span class="p">))</span><span class="o">/</span><span class="mi">2</span>

</div>
<div class="viewcode-block" id="Shi"><a class="viewcode-back" href="../../../../modules/functions/special.html#sympy.functions.special.error_functions.Shi">[docs]</a><span class="k">class</span> <span class="nc">Shi</span><span class="p">(</span><span class="n">TrigonometricIntegral</span><span class="p">):</span>
    <span class="sd">r&quot;&quot;&quot;</span>
<span class="sd">    Sinh integral.</span>

<span class="sd">    This function is defined by</span>

<span class="sd">    .. math:: \operatorname{Shi}(z) = \int_0^z \frac{\sinh{t}}{t} \mathrm{d}t.</span>

<span class="sd">    It is an entire function.</span>

<span class="sd">    Examples</span>
<span class="sd">    ========</span>

<span class="sd">    &gt;&gt;&gt; from sympy import Shi</span>
<span class="sd">    &gt;&gt;&gt; from sympy.abc import z</span>

<span class="sd">    The Sinh integral is a primitive of `\sinh(z)/z`:</span>

<span class="sd">    &gt;&gt;&gt; Shi(z).diff(z)</span>
<span class="sd">    sinh(z)/z</span>

<span class="sd">    It is unbranched:</span>

<span class="sd">    &gt;&gt;&gt; from sympy import exp_polar, I, pi</span>
<span class="sd">    &gt;&gt;&gt; Shi(z*exp_polar(2*I*pi))</span>
<span class="sd">    Shi(z)</span>

<span class="sd">    The `\sinh` integral behaves much like ordinary `\sinh` under multiplication by `i`:</span>

<span class="sd">    &gt;&gt;&gt; Shi(I*z)</span>
<span class="sd">    I*Si(z)</span>
<span class="sd">    &gt;&gt;&gt; Shi(-z)</span>
<span class="sd">    -Shi(z)</span>

<span class="sd">    It can also be expressed in terms of exponential integrals, but beware</span>
<span class="sd">    that the latter is branched:</span>

<span class="sd">    &gt;&gt;&gt; from sympy import expint</span>
<span class="sd">    &gt;&gt;&gt; Shi(z).rewrite(expint)</span>
<span class="sd">    expint(1, z)/2 - expint(1, z*exp_polar(I*pi))/2 - I*pi/2</span>

<span class="sd">    See Also</span>
<span class="sd">    ========</span>

<span class="sd">    Si: Sine integral.</span>
<span class="sd">    Ci: Cosine integral.</span>
<span class="sd">    Chi: Hyperbolic cosine integral.</span>
<span class="sd">    Ei: Exponential integral.</span>
<span class="sd">    expint: Generalised exponential integral.</span>
<span class="sd">    E1: Special case of the generalised exponential integral.</span>
<span class="sd">    li: Logarithmic integral.</span>
<span class="sd">    Li: Offset logarithmic integral.</span>

<span class="sd">    References</span>
<span class="sd">    ==========</span>

<span class="sd">    .. [1] http://en.wikipedia.org/wiki/Trigonometric_integral</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">_trigfunc</span> <span class="o">=</span> <span class="n">C</span><span class="o">.</span><span class="n">sinh</span>
    <span class="n">_atzero</span> <span class="o">=</span> <span class="n">S</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
    <span class="n">_atinf</span> <span class="o">=</span> <span class="n">S</span><span class="o">.</span><span class="n">Infinity</span>
    <span class="n">_atneginf</span> <span class="o">=</span> <span class="n">S</span><span class="o">.</span><span class="n">NegativeInfinity</span>

    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">_minusfactor</span><span class="p">(</span><span class="n">cls</span><span class="p">,</span> <span class="n">z</span><span class="p">):</span>
        <span class="k">return</span> <span class="o">-</span><span class="n">Shi</span><span class="p">(</span><span class="n">z</span><span class="p">)</span>

    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">_Ifactor</span><span class="p">(</span><span class="n">cls</span><span class="p">,</span> <span class="n">z</span><span class="p">,</span> <span class="n">sign</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">I</span><span class="o">*</span><span class="n">Si</span><span class="p">(</span><span class="n">z</span><span class="p">)</span><span class="o">*</span><span class="n">sign</span>

    <span class="k">def</span> <span class="nf">_eval_rewrite_as_expint</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">z</span><span class="p">):</span>
        <span class="kn">from</span> <span class="nn">sympy</span> <span class="kn">import</span> <span class="n">exp_polar</span>
        <span class="c"># XXX should we polarify z?</span>
        <span class="k">return</span> <span class="p">(</span><span class="n">E1</span><span class="p">(</span><span class="n">z</span><span class="p">)</span> <span class="o">-</span> <span class="n">E1</span><span class="p">(</span><span class="n">exp_polar</span><span class="p">(</span><span class="n">I</span><span class="o">*</span><span class="n">pi</span><span class="p">)</span><span class="o">*</span><span class="n">z</span><span class="p">))</span><span class="o">/</span><span class="mi">2</span> <span class="o">-</span> <span class="n">I</span><span class="o">*</span><span class="n">pi</span><span class="o">/</span><span class="mi">2</span>

</div>
<div class="viewcode-block" id="Chi"><a class="viewcode-back" href="../../../../modules/functions/special.html#sympy.functions.special.error_functions.Chi">[docs]</a><span class="k">class</span> <span class="nc">Chi</span><span class="p">(</span><span class="n">TrigonometricIntegral</span><span class="p">):</span>
    <span class="sd">r&quot;&quot;&quot;</span>
<span class="sd">    Cosh integral.</span>

<span class="sd">    This function is defined for positive :math:`x` by</span>

<span class="sd">    .. math:: \operatorname{Chi}(x) = \gamma + \log{x}</span>
<span class="sd">                         + \int_0^x \frac{\cosh{t} - 1}{t} \mathrm{d}t,</span>

<span class="sd">    where :math:`\gamma` is the Euler-Mascheroni constant.</span>

<span class="sd">    We have</span>

<span class="sd">    .. math:: \operatorname{Chi}(z) = \operatorname{Ci}\left(e^{i \pi/2}z\right)</span>
<span class="sd">                         - i\frac{\pi}{2},</span>

<span class="sd">    which holds for all polar :math:`z` and thus provides an analytic</span>
<span class="sd">    continuation to the Riemann surface of the logarithm.</span>
<span class="sd">    By lifting to the principal branch we obtain an analytic function on the</span>
<span class="sd">    cut complex plane.</span>

<span class="sd">    Examples</span>
<span class="sd">    ========</span>

<span class="sd">    &gt;&gt;&gt; from sympy import Chi</span>
<span class="sd">    &gt;&gt;&gt; from sympy.abc import z</span>

<span class="sd">    The `\cosh` integral is a primitive of `\cosh(z)/z`:</span>

<span class="sd">    &gt;&gt;&gt; Chi(z).diff(z)</span>
<span class="sd">    cosh(z)/z</span>

<span class="sd">    It has a logarithmic branch point at the origin:</span>

<span class="sd">    &gt;&gt;&gt; from sympy import exp_polar, I, pi</span>
<span class="sd">    &gt;&gt;&gt; Chi(z*exp_polar(2*I*pi))</span>
<span class="sd">    Chi(z) + 2*I*pi</span>

<span class="sd">    The `\cosh` integral behaves somewhat like ordinary `\cosh` under multiplication by `i`:</span>

<span class="sd">    &gt;&gt;&gt; from sympy import polar_lift</span>
<span class="sd">    &gt;&gt;&gt; Chi(polar_lift(I)*z)</span>
<span class="sd">    Ci(z) + I*pi/2</span>
<span class="sd">    &gt;&gt;&gt; Chi(polar_lift(-1)*z)</span>
<span class="sd">    Chi(z) + I*pi</span>

<span class="sd">    It can also be expressed in terms of exponential integrals:</span>

<span class="sd">    &gt;&gt;&gt; from sympy import expint</span>
<span class="sd">    &gt;&gt;&gt; Chi(z).rewrite(expint)</span>
<span class="sd">    -expint(1, z)/2 - expint(1, z*exp_polar(I*pi))/2 - I*pi/2</span>

<span class="sd">    See Also</span>
<span class="sd">    ========</span>

<span class="sd">    Si: Sine integral.</span>
<span class="sd">    Ci: Cosine integral.</span>
<span class="sd">    Shi: Hyperbolic sine integral.</span>
<span class="sd">    Ei: Exponential integral.</span>
<span class="sd">    expint: Generalised exponential integral.</span>
<span class="sd">    E1: Special case of the generalised exponential integral.</span>
<span class="sd">    li: Logarithmic integral.</span>
<span class="sd">    Li: Offset logarithmic integral.</span>

<span class="sd">    References</span>
<span class="sd">    ==========</span>

<span class="sd">    .. [1] http://en.wikipedia.org/wiki/Trigonometric_integral</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">_trigfunc</span> <span class="o">=</span> <span class="n">C</span><span class="o">.</span><span class="n">cosh</span>
    <span class="n">_atzero</span> <span class="o">=</span> <span class="n">S</span><span class="o">.</span><span class="n">ComplexInfinity</span>
    <span class="n">_atinf</span> <span class="o">=</span> <span class="n">S</span><span class="o">.</span><span class="n">Infinity</span>
    <span class="n">_atneginf</span> <span class="o">=</span> <span class="n">S</span><span class="o">.</span><span class="n">Infinity</span>

    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">_minusfactor</span><span class="p">(</span><span class="n">cls</span><span class="p">,</span> <span class="n">z</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">Chi</span><span class="p">(</span><span class="n">z</span><span class="p">)</span> <span class="o">+</span> <span class="n">I</span><span class="o">*</span><span class="n">pi</span>

    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">_Ifactor</span><span class="p">(</span><span class="n">cls</span><span class="p">,</span> <span class="n">z</span><span class="p">,</span> <span class="n">sign</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">Ci</span><span class="p">(</span><span class="n">z</span><span class="p">)</span> <span class="o">+</span> <span class="n">I</span><span class="o">*</span><span class="n">pi</span><span class="o">/</span><span class="mi">2</span><span class="o">*</span><span class="n">sign</span>

    <span class="k">def</span> <span class="nf">_eval_rewrite_as_expint</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">z</span><span class="p">):</span>
        <span class="kn">from</span> <span class="nn">sympy</span> <span class="kn">import</span> <span class="n">exp_polar</span>
        <span class="k">return</span> <span class="o">-</span><span class="n">I</span><span class="o">*</span><span class="n">pi</span><span class="o">/</span><span class="mi">2</span> <span class="o">-</span> <span class="p">(</span><span class="n">E1</span><span class="p">(</span><span class="n">z</span><span class="p">)</span> <span class="o">+</span> <span class="n">E1</span><span class="p">(</span><span class="n">exp_polar</span><span class="p">(</span><span class="n">I</span><span class="o">*</span><span class="n">pi</span><span class="p">)</span><span class="o">*</span><span class="n">z</span><span class="p">))</span><span class="o">/</span><span class="mi">2</span>

    <span class="k">def</span> <span class="nf">_latex</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">printer</span><span class="p">,</span> <span class="n">exp</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">args</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span>
        <span class="k">if</span> <span class="n">exp</span><span class="p">:</span>
            <span class="k">return</span> <span class="s">r&#39;\operatorname{Chi}^{</span><span class="si">%s</span><span class="s">}{\left (</span><span class="si">%s</span><span class="s"> \right )}&#39;</span> \
                <span class="o">%</span> <span class="p">(</span><span class="n">printer</span><span class="o">.</span><span class="n">_print</span><span class="p">(</span><span class="n">exp</span><span class="p">),</span> <span class="n">printer</span><span class="o">.</span><span class="n">_print</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">args</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="s">r&#39;\operatorname{Chi}{\left (</span><span class="si">%s</span><span class="s"> \right )}&#39;</span> \
                <span class="o">%</span> <span class="n">printer</span><span class="o">.</span><span class="n">_print</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">args</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">_latex_no_arg</span><span class="p">(</span><span class="n">printer</span><span class="p">):</span>
        <span class="k">return</span> <span class="s">r&#39;\operatorname{Chi}&#39;</span>

<span class="c">###############################################################################</span>
<span class="c">#################### FRESNEL INTEGRALS ########################################</span>
<span class="c">###############################################################################</span>
</div>
<div class="viewcode-block" id="FresnelIntegral"><a class="viewcode-back" href="../../../../modules/functions/special.html#sympy.functions.special.error_functions.FresnelIntegral">[docs]</a><span class="k">class</span> <span class="nc">FresnelIntegral</span><span class="p">(</span><span class="n">Function</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot; Base class for the Fresnel integrals.&quot;&quot;&quot;</span>

    <span class="n">nargs</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="n">unbranched</span> <span class="o">=</span> <span class="bp">True</span>

    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">eval</span><span class="p">(</span><span class="n">cls</span><span class="p">,</span> <span class="n">z</span><span class="p">):</span>
        <span class="c"># Value at zero</span>
        <span class="k">if</span> <span class="n">z</span> <span class="ow">is</span> <span class="n">S</span><span class="o">.</span><span class="n">Zero</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">S</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>

        <span class="c"># Try to pull out factors of -1 and I</span>
        <span class="n">prefact</span> <span class="o">=</span> <span class="n">S</span><span class="o">.</span><span class="n">One</span>
        <span class="n">newarg</span> <span class="o">=</span> <span class="n">z</span>
        <span class="n">changed</span> <span class="o">=</span> <span class="bp">False</span>

        <span class="n">nz</span> <span class="o">=</span> <span class="n">newarg</span><span class="o">.</span><span class="n">extract_multiplicatively</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">nz</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">prefact</span> <span class="o">=</span> <span class="o">-</span><span class="n">prefact</span>
            <span class="n">newarg</span> <span class="o">=</span> <span class="n">nz</span>
            <span class="n">changed</span> <span class="o">=</span> <span class="bp">True</span>

        <span class="n">nz</span> <span class="o">=</span> <span class="n">newarg</span><span class="o">.</span><span class="n">extract_multiplicatively</span><span class="p">(</span><span class="n">I</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">nz</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">prefact</span> <span class="o">=</span> <span class="n">cls</span><span class="o">.</span><span class="n">_sign</span><span class="o">*</span><span class="n">I</span><span class="o">*</span><span class="n">prefact</span>
            <span class="n">newarg</span> <span class="o">=</span> <span class="n">nz</span>
            <span class="n">changed</span> <span class="o">=</span> <span class="bp">True</span>

        <span class="k">if</span> <span class="n">changed</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">prefact</span><span class="o">*</span><span class="n">cls</span><span class="p">(</span><span class="n">newarg</span><span class="p">)</span>

        <span class="c"># Values at positive infinities signs</span>
        <span class="c"># if any were extracted automatically</span>
        <span class="k">if</span> <span class="n">z</span> <span class="ow">is</span> <span class="n">S</span><span class="o">.</span><span class="n">Infinity</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">S</span><span class="o">.</span><span class="n">Half</span>
        <span class="k">elif</span> <span class="n">z</span> <span class="ow">is</span> <span class="n">I</span><span class="o">*</span><span class="n">S</span><span class="o">.</span><span class="n">Infinity</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">cls</span><span class="o">.</span><span class="n">_sign</span><span class="o">*</span><span class="n">I</span><span class="o">*</span><span class="n">S</span><span class="o">.</span><span class="n">Half</span>

    <span class="k">def</span> <span class="nf">fdiff</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">argindex</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">argindex</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_trigfunc</span><span class="p">(</span><span class="n">S</span><span class="o">.</span><span class="n">Half</span><span class="o">*</span><span class="n">pi</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">args</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">ArgumentIndexError</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">argindex</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_eval_is_real</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">args</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">is_real</span>

    <span class="k">def</span> <span class="nf">_eval_conjugate</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">func</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">args</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">conjugate</span><span class="p">())</span>

    <span class="k">def</span> <span class="nf">_as_real_imag</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">deep</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="o">**</span><span class="n">hints</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">args</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">is_real</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">deep</span><span class="p">:</span>
                <span class="n">hints</span><span class="p">[</span><span class="s">&#39;complex&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">False</span>
                <span class="k">return</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">expand</span><span class="p">(</span><span class="n">deep</span><span class="p">,</span> <span class="o">**</span><span class="n">hints</span><span class="p">),</span> <span class="n">S</span><span class="o">.</span><span class="n">Zero</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">return</span> <span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">S</span><span class="o">.</span><span class="n">Zero</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">deep</span><span class="p">:</span>
            <span class="n">re</span><span class="p">,</span> <span class="n">im</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">args</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">expand</span><span class="p">(</span><span class="n">deep</span><span class="p">,</span> <span class="o">**</span><span class="n">hints</span><span class="p">)</span><span class="o">.</span><span class="n">as_real_imag</span><span class="p">()</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">re</span><span class="p">,</span> <span class="n">im</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">args</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">as_real_imag</span><span class="p">()</span>
        <span class="k">return</span> <span class="p">(</span><span class="n">re</span><span class="p">,</span> <span class="n">im</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">as_real_imag</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">deep</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="o">**</span><span class="n">hints</span><span class="p">):</span>
        <span class="c"># Fresnel S</span>
        <span class="c"># http://functions.wolfram.com/06.32.19.0003.01</span>
        <span class="c"># http://functions.wolfram.com/06.32.19.0006.01</span>
        <span class="c"># Fresnel C</span>
        <span class="c"># http://functions.wolfram.com/06.33.19.0003.01</span>
        <span class="c"># http://functions.wolfram.com/06.33.19.0006.01</span>
        <span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_as_real_imag</span><span class="p">(</span><span class="n">deep</span><span class="o">=</span><span class="n">deep</span><span class="p">,</span> <span class="o">**</span><span class="n">hints</span><span class="p">)</span>
        <span class="n">sq</span> <span class="o">=</span> <span class="o">-</span><span class="n">y</span><span class="o">**</span><span class="mi">2</span><span class="o">/</span><span class="n">x</span><span class="o">**</span><span class="mi">2</span>
        <span class="n">re</span> <span class="o">=</span> <span class="n">S</span><span class="o">.</span><span class="n">Half</span><span class="o">*</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">func</span><span class="p">(</span><span class="n">x</span> <span class="o">+</span> <span class="n">x</span><span class="o">*</span><span class="n">sqrt</span><span class="p">(</span><span class="n">sq</span><span class="p">))</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">func</span><span class="p">(</span><span class="n">x</span> <span class="o">-</span> <span class="n">x</span><span class="o">*</span><span class="n">sqrt</span><span class="p">(</span><span class="n">sq</span><span class="p">)))</span>
        <span class="n">im</span> <span class="o">=</span> <span class="n">x</span><span class="o">/</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">y</span><span class="p">)</span> <span class="o">*</span> <span class="n">sqrt</span><span class="p">(</span><span class="n">sq</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">func</span><span class="p">(</span><span class="n">x</span> <span class="o">-</span> <span class="n">x</span><span class="o">*</span><span class="n">sqrt</span><span class="p">(</span><span class="n">sq</span><span class="p">))</span> <span class="o">-</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">func</span><span class="p">(</span><span class="n">x</span> <span class="o">+</span> <span class="n">x</span><span class="o">*</span><span class="n">sqrt</span><span class="p">(</span><span class="n">sq</span><span class="p">)))</span>
        <span class="k">return</span> <span class="p">(</span><span class="n">re</span><span class="p">,</span> <span class="n">im</span><span class="p">)</span>

</div>
<div class="viewcode-block" id="fresnels"><a class="viewcode-back" href="../../../../modules/functions/special.html#sympy.functions.special.error_functions.fresnels">[docs]</a><span class="k">class</span> <span class="nc">fresnels</span><span class="p">(</span><span class="n">FresnelIntegral</span><span class="p">):</span>
    <span class="sd">r&quot;&quot;&quot;</span>
<span class="sd">    Fresnel integral S.</span>

<span class="sd">    This function is defined by</span>

<span class="sd">    .. math:: \operatorname{S}(z) = \int_0^z \sin{\frac{\pi}{2} t^2} \mathrm{d}t.</span>

<span class="sd">    It is an entire function.</span>

<span class="sd">    Examples</span>
<span class="sd">    ========</span>

<span class="sd">    &gt;&gt;&gt; from sympy import I, oo, fresnels</span>
<span class="sd">    &gt;&gt;&gt; from sympy.abc import z</span>

<span class="sd">    Several special values are known:</span>

<span class="sd">    &gt;&gt;&gt; fresnels(0)</span>
<span class="sd">    0</span>
<span class="sd">    &gt;&gt;&gt; fresnels(oo)</span>
<span class="sd">    1/2</span>
<span class="sd">    &gt;&gt;&gt; fresnels(-oo)</span>
<span class="sd">    -1/2</span>
<span class="sd">    &gt;&gt;&gt; fresnels(I*oo)</span>
<span class="sd">    -I/2</span>
<span class="sd">    &gt;&gt;&gt; fresnels(-I*oo)</span>
<span class="sd">    I/2</span>

<span class="sd">    In general one can pull out factors of -1 and `i` from the argument:</span>

<span class="sd">    &gt;&gt;&gt; fresnels(-z)</span>
<span class="sd">    -fresnels(z)</span>
<span class="sd">    &gt;&gt;&gt; fresnels(I*z)</span>
<span class="sd">    -I*fresnels(z)</span>

<span class="sd">    The Fresnel S integral obeys the mirror symmetry</span>
<span class="sd">    `\overline{S(z)} = S(\bar{z})`:</span>

<span class="sd">    &gt;&gt;&gt; from sympy import conjugate</span>
<span class="sd">    &gt;&gt;&gt; conjugate(fresnels(z))</span>
<span class="sd">    fresnels(conjugate(z))</span>

<span class="sd">    Differentiation with respect to `z` is supported:</span>

<span class="sd">    &gt;&gt;&gt; from sympy import diff</span>
<span class="sd">    &gt;&gt;&gt; diff(fresnels(z), z)</span>
<span class="sd">    sin(pi*z**2/2)</span>

<span class="sd">    Defining the Fresnel functions via an integral</span>

<span class="sd">    &gt;&gt;&gt; from sympy import integrate, pi, sin, gamma, expand_func</span>
<span class="sd">    &gt;&gt;&gt; integrate(sin(pi*z**2/2), z)</span>
<span class="sd">    3*fresnels(z)*gamma(3/4)/(4*gamma(7/4))</span>
<span class="sd">    &gt;&gt;&gt; expand_func(integrate(sin(pi*z**2/2), z))</span>
<span class="sd">    fresnels(z)</span>

<span class="sd">    We can numerically evaluate the Fresnel integral to arbitrary precision</span>
<span class="sd">    on the whole complex plane:</span>

<span class="sd">    &gt;&gt;&gt; fresnels(2).evalf(30)</span>
<span class="sd">    0.343415678363698242195300815958</span>

<span class="sd">    &gt;&gt;&gt; fresnels(-2*I).evalf(30)</span>
<span class="sd">    0.343415678363698242195300815958*I</span>

<span class="sd">    See Also</span>
<span class="sd">    ========</span>

<span class="sd">    fresnelc</span>

<span class="sd">    References</span>
<span class="sd">    ==========</span>

<span class="sd">    .. [1] http://en.wikipedia.org/wiki/Fresnel_integral</span>
<span class="sd">    .. [2] http://dlmf.nist.gov/7</span>
<span class="sd">    .. [3] http://mathworld.wolfram.com/FresnelIntegrals.html</span>
<span class="sd">    .. [4] http://functions.wolfram.com/GammaBetaErf/FresnelS</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">_trigfunc</span> <span class="o">=</span> <span class="n">C</span><span class="o">.</span><span class="n">sin</span>
    <span class="n">_sign</span> <span class="o">=</span> <span class="o">-</span><span class="n">S</span><span class="o">.</span><span class="n">One</span>

    <span class="nd">@staticmethod</span>
    <span class="nd">@cacheit</span>
    <span class="k">def</span> <span class="nf">taylor_term</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="o">*</span><span class="n">previous_terms</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">n</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">S</span><span class="o">.</span><span class="n">Zero</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">x</span> <span class="o">=</span> <span class="n">sympify</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">previous_terms</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
                <span class="n">p</span> <span class="o">=</span> <span class="n">previous_terms</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
                <span class="k">return</span> <span class="p">(</span><span class="o">-</span><span class="n">pi</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">x</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="p">(</span><span class="mi">4</span><span class="o">*</span><span class="n">n</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="mi">8</span><span class="o">*</span><span class="n">n</span><span class="o">*</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">n</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="mi">4</span><span class="o">*</span><span class="n">n</span> <span class="o">+</span> <span class="mi">3</span><span class="p">)))</span> <span class="o">*</span> <span class="n">p</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">x</span><span class="o">**</span><span class="mi">3</span> <span class="o">*</span> <span class="p">(</span><span class="o">-</span><span class="n">x</span><span class="o">**</span><span class="mi">4</span><span class="p">)</span><span class="o">**</span><span class="n">n</span> <span class="o">*</span> <span class="p">(</span><span class="n">S</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="o">*</span><span class="n">n</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">pi</span><span class="o">**</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">n</span> <span class="o">+</span> <span class="mi">1</span><span class="p">))</span> <span class="o">/</span> <span class="p">((</span><span class="mi">4</span><span class="o">*</span><span class="n">n</span> <span class="o">+</span> <span class="mi">3</span><span class="p">)</span><span class="o">*</span><span class="n">C</span><span class="o">.</span><span class="n">factorial</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">n</span> <span class="o">+</span> <span class="mi">1</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">_eval_rewrite_as_erf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">z</span><span class="p">):</span>
        <span class="k">return</span> <span class="p">(</span><span class="n">S</span><span class="o">.</span><span class="n">One</span> <span class="o">+</span> <span class="n">I</span><span class="p">)</span><span class="o">/</span><span class="mi">4</span> <span class="o">*</span> <span class="p">(</span><span class="n">erf</span><span class="p">((</span><span class="n">S</span><span class="o">.</span><span class="n">One</span> <span class="o">+</span> <span class="n">I</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="o">*</span><span class="n">sqrt</span><span class="p">(</span><span class="n">pi</span><span class="p">)</span><span class="o">*</span><span class="n">z</span><span class="p">)</span> <span class="o">-</span> <span class="n">I</span><span class="o">*</span><span class="n">erf</span><span class="p">((</span><span class="n">S</span><span class="o">.</span><span class="n">One</span> <span class="o">-</span> <span class="n">I</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="o">*</span><span class="n">sqrt</span><span class="p">(</span><span class="n">pi</span><span class="p">)</span><span class="o">*</span><span class="n">z</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">_eval_rewrite_as_hyper</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">z</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">pi</span><span class="o">*</span><span class="n">z</span><span class="o">**</span><span class="mi">3</span><span class="o">/</span><span class="mi">6</span> <span class="o">*</span> <span class="n">hyper</span><span class="p">([</span><span class="n">S</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="o">/</span><span class="mi">4</span><span class="p">],</span> <span class="p">[</span><span class="n">S</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="n">S</span><span class="p">(</span><span class="mi">7</span><span class="p">)</span><span class="o">/</span><span class="mi">4</span><span class="p">],</span> <span class="o">-</span><span class="n">pi</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">z</span><span class="o">**</span><span class="mi">4</span><span class="o">/</span><span class="mi">16</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_eval_rewrite_as_meijerg</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">z</span><span class="p">):</span>
        <span class="k">return</span> <span class="p">(</span><span class="n">pi</span><span class="o">*</span><span class="n">z</span><span class="o">**</span><span class="p">(</span><span class="n">S</span><span class="p">(</span><span class="mi">9</span><span class="p">)</span><span class="o">/</span><span class="mi">4</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">z</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="n">S</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="o">/</span><span class="mi">4</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">z</span><span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="n">S</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="o">/</span><span class="mi">4</span><span class="p">))</span>
                <span class="o">*</span> <span class="n">meijerg</span><span class="p">([],</span> <span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="n">S</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="o">/</span><span class="mi">4</span><span class="p">],</span> <span class="p">[</span><span class="n">S</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="mi">4</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="o">-</span><span class="n">pi</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">z</span><span class="o">**</span><span class="mi">4</span><span class="o">/</span><span class="mi">16</span><span class="p">))</span>

</div>
<div class="viewcode-block" id="fresnelc"><a class="viewcode-back" href="../../../../modules/functions/special.html#sympy.functions.special.error_functions.fresnelc">[docs]</a><span class="k">class</span> <span class="nc">fresnelc</span><span class="p">(</span><span class="n">FresnelIntegral</span><span class="p">):</span>
    <span class="sd">r&quot;&quot;&quot;</span>
<span class="sd">    Fresnel integral C.</span>

<span class="sd">    This function is defined by</span>

<span class="sd">    .. math:: \operatorname{C}(z) = \int_0^z \cos{\frac{\pi}{2} t^2} \mathrm{d}t.</span>

<span class="sd">    It is an entire function.</span>

<span class="sd">    Examples</span>
<span class="sd">    ========</span>

<span class="sd">    &gt;&gt;&gt; from sympy import I, oo, fresnelc</span>
<span class="sd">    &gt;&gt;&gt; from sympy.abc import z</span>

<span class="sd">    Several special values are known:</span>

<span class="sd">    &gt;&gt;&gt; fresnelc(0)</span>
<span class="sd">    0</span>
<span class="sd">    &gt;&gt;&gt; fresnelc(oo)</span>
<span class="sd">    1/2</span>
<span class="sd">    &gt;&gt;&gt; fresnelc(-oo)</span>
<span class="sd">    -1/2</span>
<span class="sd">    &gt;&gt;&gt; fresnelc(I*oo)</span>
<span class="sd">    I/2</span>
<span class="sd">    &gt;&gt;&gt; fresnelc(-I*oo)</span>
<span class="sd">    -I/2</span>

<span class="sd">    In general one can pull out factors of -1 and `i` from the argument:</span>

<span class="sd">    &gt;&gt;&gt; fresnelc(-z)</span>
<span class="sd">    -fresnelc(z)</span>
<span class="sd">    &gt;&gt;&gt; fresnelc(I*z)</span>
<span class="sd">    I*fresnelc(z)</span>

<span class="sd">    The Fresnel C integral obeys the mirror symmetry</span>
<span class="sd">    `\overline{C(z)} = C(\bar{z})`:</span>

<span class="sd">    &gt;&gt;&gt; from sympy import conjugate</span>
<span class="sd">    &gt;&gt;&gt; conjugate(fresnelc(z))</span>
<span class="sd">    fresnelc(conjugate(z))</span>

<span class="sd">    Differentiation with respect to `z` is supported:</span>

<span class="sd">    &gt;&gt;&gt; from sympy import diff</span>
<span class="sd">    &gt;&gt;&gt; diff(fresnelc(z), z)</span>
<span class="sd">    cos(pi*z**2/2)</span>

<span class="sd">    Defining the Fresnel functions via an integral</span>

<span class="sd">    &gt;&gt;&gt; from sympy import integrate, pi, cos, gamma, expand_func</span>
<span class="sd">    &gt;&gt;&gt; integrate(cos(pi*z**2/2), z)</span>
<span class="sd">    fresnelc(z)*gamma(1/4)/(4*gamma(5/4))</span>
<span class="sd">    &gt;&gt;&gt; expand_func(integrate(cos(pi*z**2/2), z))</span>
<span class="sd">    fresnelc(z)</span>

<span class="sd">    We can numerically evaluate the Fresnel integral to arbitrary precision</span>
<span class="sd">    on the whole complex plane:</span>

<span class="sd">    &gt;&gt;&gt; fresnelc(2).evalf(30)</span>
<span class="sd">    0.488253406075340754500223503357</span>

<span class="sd">    &gt;&gt;&gt; fresnelc(-2*I).evalf(30)</span>
<span class="sd">    -0.488253406075340754500223503357*I</span>

<span class="sd">    See Also</span>
<span class="sd">    ========</span>

<span class="sd">    fresnels</span>

<span class="sd">    References</span>
<span class="sd">    ==========</span>

<span class="sd">    .. [1] http://en.wikipedia.org/wiki/Fresnel_integral</span>
<span class="sd">    .. [2] http://dlmf.nist.gov/7</span>
<span class="sd">    .. [3] http://mathworld.wolfram.com/FresnelIntegrals.html</span>
<span class="sd">    .. [4] http://functions.wolfram.com/GammaBetaErf/FresnelC</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">_trigfunc</span> <span class="o">=</span> <span class="n">C</span><span class="o">.</span><span class="n">cos</span>
    <span class="n">_sign</span> <span class="o">=</span> <span class="n">S</span><span class="o">.</span><span class="n">One</span>

    <span class="nd">@staticmethod</span>
    <span class="nd">@cacheit</span>
    <span class="k">def</span> <span class="nf">taylor_term</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="o">*</span><span class="n">previous_terms</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">n</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">S</span><span class="o">.</span><span class="n">Zero</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">x</span> <span class="o">=</span> <span class="n">sympify</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">previous_terms</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
                <span class="n">p</span> <span class="o">=</span> <span class="n">previous_terms</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
                <span class="k">return</span> <span class="p">(</span><span class="o">-</span><span class="n">pi</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">x</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="p">(</span><span class="mi">4</span><span class="o">*</span><span class="n">n</span> <span class="o">-</span> <span class="mi">3</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="mi">8</span><span class="o">*</span><span class="n">n</span><span class="o">*</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">n</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="mi">4</span><span class="o">*</span><span class="n">n</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)))</span> <span class="o">*</span> <span class="n">p</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">x</span> <span class="o">*</span> <span class="p">(</span><span class="o">-</span><span class="n">x</span><span class="o">**</span><span class="mi">4</span><span class="p">)</span><span class="o">**</span><span class="n">n</span> <span class="o">*</span> <span class="p">(</span><span class="n">S</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="o">*</span><span class="n">n</span><span class="p">)</span><span class="o">*</span><span class="n">pi</span><span class="o">**</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">n</span><span class="p">))</span> <span class="o">/</span> <span class="p">((</span><span class="mi">4</span><span class="o">*</span><span class="n">n</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">C</span><span class="o">.</span><span class="n">factorial</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">n</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">_eval_rewrite_as_erf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">z</span><span class="p">):</span>
        <span class="k">return</span> <span class="p">(</span><span class="n">S</span><span class="o">.</span><span class="n">One</span> <span class="o">-</span> <span class="n">I</span><span class="p">)</span><span class="o">/</span><span class="mi">4</span> <span class="o">*</span> <span class="p">(</span><span class="n">erf</span><span class="p">((</span><span class="n">S</span><span class="o">.</span><span class="n">One</span> <span class="o">+</span> <span class="n">I</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="o">*</span><span class="n">sqrt</span><span class="p">(</span><span class="n">pi</span><span class="p">)</span><span class="o">*</span><span class="n">z</span><span class="p">)</span> <span class="o">+</span> <span class="n">I</span><span class="o">*</span><span class="n">erf</span><span class="p">((</span><span class="n">S</span><span class="o">.</span><span class="n">One</span> <span class="o">-</span> <span class="n">I</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="o">*</span><span class="n">sqrt</span><span class="p">(</span><span class="n">pi</span><span class="p">)</span><span class="o">*</span><span class="n">z</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">_eval_rewrite_as_hyper</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">z</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">z</span> <span class="o">*</span> <span class="n">hyper</span><span class="p">([</span><span class="n">S</span><span class="o">.</span><span class="n">One</span><span class="o">/</span><span class="mi">4</span><span class="p">],</span> <span class="p">[</span><span class="n">S</span><span class="o">.</span><span class="n">One</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="n">S</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span><span class="o">/</span><span class="mi">4</span><span class="p">],</span> <span class="o">-</span><span class="n">pi</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">z</span><span class="o">**</span><span class="mi">4</span><span class="o">/</span><span class="mi">16</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_eval_rewrite_as_meijerg</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">z</span><span class="p">):</span>
        <span class="k">return</span> <span class="p">(</span><span class="n">pi</span><span class="o">*</span><span class="n">z</span><span class="o">**</span><span class="p">(</span><span class="n">S</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="o">/</span><span class="mi">4</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">root</span><span class="p">(</span><span class="n">z</span><span class="o">**</span><span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span><span class="o">*</span><span class="n">root</span><span class="p">(</span><span class="o">-</span><span class="n">z</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>
                <span class="o">*</span> <span class="n">meijerg</span><span class="p">([],</span> <span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="n">S</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="mi">4</span><span class="p">],</span> <span class="p">[</span><span class="n">S</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="o">/</span><span class="mi">4</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="o">-</span><span class="n">pi</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">z</span><span class="o">**</span><span class="mi">4</span><span class="o">/</span><span class="mi">16</span><span class="p">))</span>

<span class="c">###############################################################################</span>
<span class="c">#################### HELPER FUNCTIONS #########################################</span>
<span class="c">###############################################################################</span>

</div>
<span class="k">class</span> <span class="nc">_erfs</span><span class="p">(</span><span class="n">Function</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Helper function to make the `\\mathrm{erf}(z)` function</span>
<span class="sd">    tractable for the Gruntz algorithm.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">nargs</span> <span class="o">=</span> <span class="mi">1</span>

    <span class="k">def</span> <span class="nf">_eval_aseries</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">args0</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">logx</span><span class="p">):</span>
        <span class="n">point</span> <span class="o">=</span> <span class="n">args0</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

        <span class="c"># Expansion at oo</span>
        <span class="k">if</span> <span class="n">point</span> <span class="ow">is</span> <span class="n">S</span><span class="o">.</span><span class="n">Infinity</span><span class="p">:</span>
            <span class="n">z</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">args</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="n">l</span> <span class="o">=</span> <span class="p">[</span> <span class="mi">1</span><span class="o">/</span><span class="n">sqrt</span><span class="p">(</span><span class="n">S</span><span class="o">.</span><span class="n">Pi</span><span class="p">)</span> <span class="o">*</span> <span class="n">C</span><span class="o">.</span><span class="n">factorial</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">k</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">S</span><span class="p">(</span>
                <span class="mi">4</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="n">k</span><span class="p">)</span><span class="o">/</span><span class="n">C</span><span class="o">.</span><span class="n">factorial</span><span class="p">(</span><span class="n">k</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="n">z</span><span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">xrange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span> <span class="p">]</span>
            <span class="n">o</span> <span class="o">=</span> <span class="n">C</span><span class="o">.</span><span class="n">Order</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="n">z</span><span class="o">**</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">n</span> <span class="o">+</span> <span class="mi">1</span><span class="p">),</span> <span class="n">x</span><span class="p">)</span>
            <span class="c"># It is very inefficient to first add the order and then do the nseries</span>
            <span class="k">return</span> <span class="p">(</span><span class="n">Add</span><span class="p">(</span><span class="o">*</span><span class="n">l</span><span class="p">))</span><span class="o">.</span><span class="n">_eval_nseries</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">logx</span><span class="p">)</span> <span class="o">+</span> <span class="n">o</span>

        <span class="c"># Expansion at I*oo</span>
        <span class="n">t</span> <span class="o">=</span> <span class="n">point</span><span class="o">.</span><span class="n">extract_multiplicatively</span><span class="p">(</span><span class="n">S</span><span class="o">.</span><span class="n">ImaginaryUnit</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">t</span> <span class="ow">is</span> <span class="n">S</span><span class="o">.</span><span class="n">Infinity</span><span class="p">:</span>
            <span class="n">z</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">args</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="c"># TODO: is the series really correct?</span>
            <span class="n">l</span> <span class="o">=</span> <span class="p">[</span> <span class="mi">1</span><span class="o">/</span><span class="n">sqrt</span><span class="p">(</span><span class="n">S</span><span class="o">.</span><span class="n">Pi</span><span class="p">)</span> <span class="o">*</span> <span class="n">C</span><span class="o">.</span><span class="n">factorial</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">k</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">S</span><span class="p">(</span>
                <span class="mi">4</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="n">k</span><span class="p">)</span><span class="o">/</span><span class="n">C</span><span class="o">.</span><span class="n">factorial</span><span class="p">(</span><span class="n">k</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="n">z</span><span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">xrange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span> <span class="p">]</span>
            <span class="n">o</span> <span class="o">=</span> <span class="n">C</span><span class="o">.</span><span class="n">Order</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="n">z</span><span class="o">**</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">n</span> <span class="o">+</span> <span class="mi">1</span><span class="p">),</span> <span class="n">x</span><span class="p">)</span>
            <span class="c"># It is very inefficient to first add the order and then do the nseries</span>
            <span class="k">return</span> <span class="p">(</span><span class="n">Add</span><span class="p">(</span><span class="o">*</span><span class="n">l</span><span class="p">))</span><span class="o">.</span><span class="n">_eval_nseries</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">logx</span><span class="p">)</span> <span class="o">+</span> <span class="n">o</span>

        <span class="c"># All other points are not handled</span>
        <span class="k">return</span> <span class="nb">super</span><span class="p">(</span><span class="n">_erfs</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">_eval_aseries</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">args0</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">logx</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">fdiff</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">argindex</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">argindex</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">z</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">args</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="k">return</span> <span class="o">-</span><span class="mi">2</span><span class="o">/</span><span class="n">sqrt</span><span class="p">(</span><span class="n">S</span><span class="o">.</span><span class="n">Pi</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">z</span><span class="o">*</span><span class="n">_erfs</span><span class="p">(</span><span class="n">z</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">ArgumentIndexError</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">argindex</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_eval_rewrite_as_intractable</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">z</span><span class="p">):</span>
        <span class="k">return</span> <span class="p">(</span><span class="n">S</span><span class="o">.</span><span class="n">One</span> <span class="o">-</span> <span class="n">erf</span><span class="p">(</span><span class="n">z</span><span class="p">))</span><span class="o">*</span><span class="n">C</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">z</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>


<span class="k">class</span> <span class="nc">_eis</span><span class="p">(</span><span class="n">Function</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Helper function to make the `\\mathrm{Ei}(z)` and `\\mathrm{li}(z)` functions</span>
<span class="sd">    tractable for the Gruntz algorithm.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">nargs</span> <span class="o">=</span> <span class="mi">1</span>

    <span class="k">def</span> <span class="nf">_eval_aseries</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">args0</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">logx</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">args0</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">!=</span> <span class="n">S</span><span class="o">.</span><span class="n">Infinity</span><span class="p">:</span>
            <span class="k">return</span> <span class="nb">super</span><span class="p">(</span><span class="n">_erfs</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">_eval_aseries</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">args0</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">logx</span><span class="p">)</span>

        <span class="n">z</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">args</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">l</span> <span class="o">=</span> <span class="p">[</span> <span class="n">C</span><span class="o">.</span><span class="n">factorial</span><span class="p">(</span><span class="n">k</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="n">z</span><span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">xrange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span> <span class="p">]</span>
        <span class="n">o</span> <span class="o">=</span> <span class="n">C</span><span class="o">.</span><span class="n">Order</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="n">z</span><span class="o">**</span><span class="p">(</span><span class="n">n</span> <span class="o">+</span> <span class="mi">1</span><span class="p">),</span> <span class="n">x</span><span class="p">)</span>
        <span class="c"># It is very inefficient to first add the order and then do the nseries</span>
        <span class="k">return</span> <span class="p">(</span><span class="n">Add</span><span class="p">(</span><span class="o">*</span><span class="n">l</span><span class="p">))</span><span class="o">.</span><span class="n">_eval_nseries</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">logx</span><span class="p">)</span> <span class="o">+</span> <span class="n">o</span>


    <span class="k">def</span> <span class="nf">fdiff</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">argindex</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">argindex</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">z</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">args</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="k">return</span> <span class="n">S</span><span class="o">.</span><span class="n">One</span> <span class="o">/</span> <span class="n">z</span> <span class="o">-</span> <span class="n">_eis</span><span class="p">(</span><span class="n">z</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">ArgumentIndexError</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">argindex</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_eval_rewrite_as_intractable</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">z</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">C</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">z</span><span class="p">)</span><span class="o">*</span><span class="n">Ei</span><span class="p">(</span><span class="n">z</span><span class="p">)</span>
</pre></div>

          </div>
        </div>
      </div>
      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper">
            <p class="logo"><a href="../../../../index.html">
              <img class="logo" src="../../../../_static/sympylogo.png" alt="Logo"/>
            </a></p>
<div id="searchbox" style="display: none">
  <h3>Quick search</h3>
    <form class="search" action="../../../../search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../../../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../../../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="../../../../np-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li><a href="../../../../index.html">SymPy 0.7.3 documentation</a> &raquo;</li>
          <li><a href="../../../index.html" >Module code</a> &raquo;</li>
          <li><a href="../../../sympy.html" >sympy</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer">
        &copy; Copyright 2013 SymPy Development Team.
      Last updated on Aug 04, 2013.
      Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 1.1.3.
    </div>
  </body>
</html>