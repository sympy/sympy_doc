
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>Number Theory &#8212; SymPy 1.1.1 documentation</title>
    <link rel="stylesheet" href="../_static/default.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="http://live.sympy.org/static/live-core.css" type="text/css" />
    <link rel="stylesheet" href="http://live.sympy.org/static/live-autocomplete.css" type="text/css" />
    <link rel="stylesheet" href="http://live.sympy.org/static/live-sphinx.css" type="text/css" />
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../',
        VERSION:     '1.1.1',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true,
        SOURCELINK_SUFFIX: '.txt'
      };
    </script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS_HTML-full"></script>
    <script type="text/javascript" src="http://live.sympy.org/static/utilities.js"></script>
    <script type="text/javascript" src="http://live.sympy.org/static/external/classy.js"></script>
    <script type="text/javascript" src="http://live.sympy.org/static/live-core.js"></script>
    <script type="text/javascript" src="http://live.sympy.org/static/live-autocomplete.js"></script>
    <script type="text/javascript" src="http://live.sympy.org/static/live-sphinx.js"></script>
    <link rel="shortcut icon" href="../_static/sympy-notailtext-favicon.ico"/>
    <link href="http://docs.sympy.org/latest/modules/ntheory.html" rel="canonical" />
    
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Basic Cryptography Module" href="crypto.html" />
    <link rel="prev" title="Finitely Presented Groups" href="combinatorics/fp_groups.html" /> 
  </head>
  <body>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="crypto.html" title="Basic Cryptography Module"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="combinatorics/fp_groups.html" title="Finitely Presented Groups"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../index.html">SymPy 1.1.1 documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="index.html" accesskey="U">SymPy Modules Reference</a> &#187;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="module-sympy.ntheory.generate">
<span id="number-theory"></span><h1>Number Theory<a class="headerlink" href="#module-sympy.ntheory.generate" title="Permalink to this headline">¶</a></h1>
<div class="section" id="ntheory-class-reference">
<h2>Ntheory Class Reference<a class="headerlink" href="#ntheory-class-reference" title="Permalink to this headline">¶</a></h2>
<dl class="class">
<dt id="sympy.ntheory.generate.Sieve">
<em class="property">class </em><code class="descclassname">sympy.ntheory.generate.</code><code class="descname">Sieve</code><a class="reference internal" href="../_modules/sympy/ntheory/generate.html#Sieve"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#sympy.ntheory.generate.Sieve" title="Permalink to this definition">¶</a></dt>
<dd><p>An infinite list of prime numbers, implemented as a dynamically
growing sieve of Eratosthenes. When a lookup is requested involving
an odd number that has not been sieved, the sieve is automatically
extended up to that number.</p>
<p class="rubric">Examples</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sympy</span> <span class="k">import</span> <span class="n">sieve</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sieve</span><span class="o">.</span><span class="n">_reset</span><span class="p">()</span> <span class="c1"># this line for doctest only</span>
<span class="gp">&gt;&gt;&gt; </span><span class="mi">25</span> <span class="ow">in</span> <span class="n">sieve</span>
<span class="go">False</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sieve</span><span class="o">.</span><span class="n">_list</span>
<span class="go">array(&#39;l&#39;, [2, 3, 5, 7, 11, 13, 17, 19, 23])</span>
</pre></div>
</div>
<dl class="method">
<dt id="sympy.ntheory.generate.Sieve.extend">
<code class="descname">extend</code><span class="sig-paren">(</span><em>n</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sympy/ntheory/generate.html#Sieve.extend"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#sympy.ntheory.generate.Sieve.extend" title="Permalink to this definition">¶</a></dt>
<dd><p>Grow the sieve to cover all primes &lt;= n (a real number).</p>
<p class="rubric">Examples</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sympy</span> <span class="k">import</span> <span class="n">sieve</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sieve</span><span class="o">.</span><span class="n">_reset</span><span class="p">()</span> <span class="c1"># this line for doctest only</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sieve</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="mi">30</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sieve</span><span class="p">[</span><span class="mi">10</span><span class="p">]</span> <span class="o">==</span> <span class="mi">29</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sympy.ntheory.generate.Sieve.extend_to_no">
<code class="descname">extend_to_no</code><span class="sig-paren">(</span><em>i</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sympy/ntheory/generate.html#Sieve.extend_to_no"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#sympy.ntheory.generate.Sieve.extend_to_no" title="Permalink to this definition">¶</a></dt>
<dd><p>Extend to include the ith prime number.</p>
<p>i must be an integer.</p>
<p>The list is extended by 50% if it is too short, so it is
likely that it will be longer than requested.</p>
<p class="rubric">Examples</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sympy</span> <span class="k">import</span> <span class="n">sieve</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sieve</span><span class="o">.</span><span class="n">_reset</span><span class="p">()</span> <span class="c1"># this line for doctest only</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sieve</span><span class="o">.</span><span class="n">extend_to_no</span><span class="p">(</span><span class="mi">9</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sieve</span><span class="o">.</span><span class="n">_list</span>
<span class="go">array(&#39;l&#39;, [2, 3, 5, 7, 11, 13, 17, 19, 23])</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sympy.ntheory.generate.Sieve.primerange">
<code class="descname">primerange</code><span class="sig-paren">(</span><em>a</em>, <em>b</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sympy/ntheory/generate.html#Sieve.primerange"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#sympy.ntheory.generate.Sieve.primerange" title="Permalink to this definition">¶</a></dt>
<dd><p>Generate all prime numbers in the range [a, b).</p>
<p class="rubric">Examples</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sympy</span> <span class="k">import</span> <span class="n">sieve</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">([</span><span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">sieve</span><span class="o">.</span><span class="n">primerange</span><span class="p">(</span><span class="mi">7</span><span class="p">,</span> <span class="mi">18</span><span class="p">)])</span>
<span class="go">[7, 11, 13, 17]</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sympy.ntheory.generate.Sieve.search">
<code class="descname">search</code><span class="sig-paren">(</span><em>n</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sympy/ntheory/generate.html#Sieve.search"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#sympy.ntheory.generate.Sieve.search" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the indices i, j of the primes that bound n.</p>
<p>If n is prime then i == j.</p>
<p>Although n can be an expression, if ceiling cannot convert
it to an integer then an n error will be raised.</p>
<p class="rubric">Examples</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sympy</span> <span class="k">import</span> <span class="n">sieve</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sieve</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="mi">25</span><span class="p">)</span>
<span class="go">(9, 10)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sieve</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="mi">23</span><span class="p">)</span>
<span class="go">(9, 9)</span>
</pre></div>
</div>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="ntheory-functions-reference">
<h2>Ntheory Functions Reference<a class="headerlink" href="#ntheory-functions-reference" title="Permalink to this headline">¶</a></h2>
<dl class="function">
<dt id="sympy.ntheory.generate.prime">
<code class="descclassname">sympy.ntheory.generate.</code><code class="descname">prime</code><span class="sig-paren">(</span><em>nth</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sympy/ntheory/generate.html#prime"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#sympy.ntheory.generate.prime" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the nth prime, with the primes indexed as prime(1) = 2,
prime(2) = 3, etc…. The nth prime is approximately n*log(n).</p>
<p>Logarithmic integral of x is a pretty nice approximation for number of
primes &lt;= x, i.e.
li(x) ~ pi(x)
In fact, for the numbers we are concerned about( x&lt;1e11 ),
li(x) - pi(x) &lt; 50000</p>
<p>Also,
li(x) &gt; pi(x) can be safely assumed for the numbers which
can be evaluated by this function.</p>
<p>Here, we find the least integer m such that li(m) &gt; n using binary search.
Now pi(m-1) &lt; li(m-1) &lt;= n,</p>
<p>We find pi(m - 1) using primepi function.</p>
<p>Starting from m, we have to find n - pi(m-1) more primes.</p>
<p>For the inputs this implementation can handle, we will have to test
primality for at max about 10**5 numbers, to get our answer.</p>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<dl class="last docutils">
<dt><a class="reference internal" href="#sympy.ntheory.primetest.isprime" title="sympy.ntheory.primetest.isprime"><code class="xref py py-obj docutils literal"><span class="pre">sympy.ntheory.primetest.isprime</span></code></a></dt>
<dd>Test if n is prime</dd>
<dt><a class="reference internal" href="#sympy.ntheory.generate.primerange" title="sympy.ntheory.generate.primerange"><code class="xref py py-obj docutils literal"><span class="pre">primerange</span></code></a></dt>
<dd>Generate all primes in a given range</dd>
<dt><a class="reference internal" href="#sympy.ntheory.generate.primepi" title="sympy.ntheory.generate.primepi"><code class="xref py py-obj docutils literal"><span class="pre">primepi</span></code></a></dt>
<dd>Return the number of primes less than or equal to n</dd>
</dl>
</div>
<p class="rubric">References</p>
<ul class="simple">
<li><a class="reference external" href="https://en.wikipedia.org/wiki/Prime_number_theorem#Table_of_.CF.80.28x.29.2C_x_.2F_log_x.2C_and_li.28x.29">https://en.wikipedia.org/wiki/Prime_number_theorem#Table_of_.CF.80.28x.29.2C_x_.2F_log_x.2C_and_li.28x.29</a></li>
<li><a class="reference external" href="https://en.wikipedia.org/wiki/Prime_number_theorem#Approximations_for_the_nth_prime_number">https://en.wikipedia.org/wiki/Prime_number_theorem#Approximations_for_the_nth_prime_number</a></li>
<li><a class="reference external" href="https://en.wikipedia.org/wiki/Skewes%27_number">https://en.wikipedia.org/wiki/Skewes%27_number</a></li>
</ul>
<p class="rubric">Examples</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sympy</span> <span class="k">import</span> <span class="n">prime</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">prime</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
<span class="go">29</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">prime</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="go">2</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">prime</span><span class="p">(</span><span class="mi">100000</span><span class="p">)</span>
<span class="go">1299709</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="sympy.ntheory.generate.primepi">
<code class="descclassname">sympy.ntheory.generate.</code><code class="descname">primepi</code><span class="sig-paren">(</span><em>n</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sympy/ntheory/generate.html#primepi"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#sympy.ntheory.generate.primepi" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the value of the prime counting function pi(n) = the number
of prime numbers less than or equal to n.</p>
<p>Algorithm Description:</p>
<p>In sieve method, we remove all multiples of prime p
except p itself.</p>
<p>Let phi(i,j) be the number of integers 2 &lt;= k &lt;= i
which remain after sieving from primes less than
or equal to j.
Clearly, pi(n) = phi(n, sqrt(n))</p>
<p>If j is not a prime,
phi(i,j) = phi(i, j - 1)</p>
<p>if j is a prime,
We remove all numbers(except j) whose
smallest prime factor is j.</p>
<p>Let x= j*a be such a number, where 2 &lt;= a&lt;= i / j
Now, after sieving from primes &lt;= j - 1,
a must remain
(because x, and hence a has no prime factor &lt;= j - 1)
Clearly, there are phi(i / j, j - 1) such a
which remain on sieving from primes &lt;= j - 1</p>
<p>Now, if a is a prime less than equal to j - 1,
x= j*a has smallest prime factor = a, and
has already been removed(by sieving from a).
So, we don’t need to remove it again.
(Note: there will be pi(j - 1) such x)</p>
<p>Thus, number of x, that will be removed are:
phi(i / j, j - 1) - phi(j - 1, j - 1)
(Note that pi(j - 1) = phi(j - 1, j - 1))</p>
<p>=&gt; phi(i,j) = phi(i, j - 1) - phi(i / j, j - 1) + phi(j - 1, j - 1)</p>
<p>So,following recursion is used and implemented as dp:</p>
<p>phi(a, b) = phi(a, b - 1), if b is not a prime
phi(a, b) = phi(a, b-1)-phi(a / b, b-1) + phi(b-1, b-1), if b is prime</p>
<p>Clearly a is always of the form floor(n / k),
which can take at most 2*sqrt(n) values.
Two arrays arr1,arr2 are maintained
arr1[i] = phi(i, j),
arr2[i] = phi(n // i, j)</p>
<p>Finally the answer is arr2[1]</p>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<dl class="last docutils">
<dt><a class="reference internal" href="#sympy.ntheory.primetest.isprime" title="sympy.ntheory.primetest.isprime"><code class="xref py py-obj docutils literal"><span class="pre">sympy.ntheory.primetest.isprime</span></code></a></dt>
<dd>Test if n is prime</dd>
<dt><a class="reference internal" href="#sympy.ntheory.generate.primerange" title="sympy.ntheory.generate.primerange"><code class="xref py py-obj docutils literal"><span class="pre">primerange</span></code></a></dt>
<dd>Generate all primes in a given range</dd>
<dt><a class="reference internal" href="#sympy.ntheory.generate.prime" title="sympy.ntheory.generate.prime"><code class="xref py py-obj docutils literal"><span class="pre">prime</span></code></a></dt>
<dd>Return the nth prime</dd>
</dl>
</div>
<p class="rubric">Examples</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sympy</span> <span class="k">import</span> <span class="n">primepi</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">primepi</span><span class="p">(</span><span class="mi">25</span><span class="p">)</span>
<span class="go">9</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="sympy.ntheory.generate.nextprime">
<code class="descclassname">sympy.ntheory.generate.</code><code class="descname">nextprime</code><span class="sig-paren">(</span><em>n</em>, <em>ith=1</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sympy/ntheory/generate.html#nextprime"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#sympy.ntheory.generate.nextprime" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the ith prime greater than n.</p>
<p>i must be an integer.</p>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<dl class="last docutils">
<dt><a class="reference internal" href="#sympy.ntheory.generate.prevprime" title="sympy.ntheory.generate.prevprime"><code class="xref py py-obj docutils literal"><span class="pre">prevprime</span></code></a></dt>
<dd>Return the largest prime smaller than n</dd>
<dt><a class="reference internal" href="#sympy.ntheory.generate.primerange" title="sympy.ntheory.generate.primerange"><code class="xref py py-obj docutils literal"><span class="pre">primerange</span></code></a></dt>
<dd>Generate all primes in a given range</dd>
</dl>
</div>
<p class="rubric">Notes</p>
<p>Potential primes are located at 6*j +/- 1. This
property is used during searching.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sympy</span> <span class="k">import</span> <span class="n">nextprime</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">[(</span><span class="n">i</span><span class="p">,</span> <span class="n">nextprime</span><span class="p">(</span><span class="n">i</span><span class="p">))</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">15</span><span class="p">)]</span>
<span class="go">[(10, 11), (11, 13), (12, 13), (13, 17), (14, 17)]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">nextprime</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">ith</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span> <span class="c1"># the 2nd prime after 2</span>
<span class="go">5</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="sympy.ntheory.generate.prevprime">
<code class="descclassname">sympy.ntheory.generate.</code><code class="descname">prevprime</code><span class="sig-paren">(</span><em>n</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sympy/ntheory/generate.html#prevprime"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#sympy.ntheory.generate.prevprime" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the largest prime smaller than n.</p>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<dl class="last docutils">
<dt><a class="reference internal" href="#sympy.ntheory.generate.nextprime" title="sympy.ntheory.generate.nextprime"><code class="xref py py-obj docutils literal"><span class="pre">nextprime</span></code></a></dt>
<dd>Return the ith prime greater than n</dd>
<dt><a class="reference internal" href="#sympy.ntheory.generate.primerange" title="sympy.ntheory.generate.primerange"><code class="xref py py-obj docutils literal"><span class="pre">primerange</span></code></a></dt>
<dd>Generates all primes in a given range</dd>
</dl>
</div>
<p class="rubric">Notes</p>
<p>Potential primes are located at 6*j +/- 1. This
property is used during searching.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sympy</span> <span class="k">import</span> <span class="n">prevprime</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">[(</span><span class="n">i</span><span class="p">,</span> <span class="n">prevprime</span><span class="p">(</span><span class="n">i</span><span class="p">))</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">15</span><span class="p">)]</span>
<span class="go">[(10, 7), (11, 7), (12, 11), (13, 11), (14, 13)]</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="sympy.ntheory.generate.primerange">
<code class="descclassname">sympy.ntheory.generate.</code><code class="descname">primerange</code><span class="sig-paren">(</span><em>a</em>, <em>b</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sympy/ntheory/generate.html#primerange"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#sympy.ntheory.generate.primerange" title="Permalink to this definition">¶</a></dt>
<dd><p>Generate a list of all prime numbers in the range [a, b).</p>
<p>If the range exists in the default sieve, the values will
be returned from there; otherwise values will be returned
but will not modify the sieve.</p>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<dl class="last docutils">
<dt><a class="reference internal" href="#sympy.ntheory.generate.nextprime" title="sympy.ntheory.generate.nextprime"><code class="xref py py-obj docutils literal"><span class="pre">nextprime</span></code></a></dt>
<dd>Return the ith prime greater than n</dd>
<dt><a class="reference internal" href="#sympy.ntheory.generate.prevprime" title="sympy.ntheory.generate.prevprime"><code class="xref py py-obj docutils literal"><span class="pre">prevprime</span></code></a></dt>
<dd>Return the largest prime smaller than n</dd>
<dt><a class="reference internal" href="#sympy.ntheory.generate.randprime" title="sympy.ntheory.generate.randprime"><code class="xref py py-obj docutils literal"><span class="pre">randprime</span></code></a></dt>
<dd>Returns a random prime in a given range</dd>
<dt><a class="reference internal" href="#sympy.ntheory.generate.primorial" title="sympy.ntheory.generate.primorial"><code class="xref py py-obj docutils literal"><span class="pre">primorial</span></code></a></dt>
<dd>Returns the product of primes based on condition</dd>
<dt><a class="reference internal" href="#sympy.ntheory.generate.Sieve.primerange" title="sympy.ntheory.generate.Sieve.primerange"><code class="xref py py-obj docutils literal"><span class="pre">Sieve.primerange</span></code></a></dt>
<dd>return range from already computed primes or extend the sieve to contain the requested range.</dd>
</dl>
</div>
<p class="rubric">Notes</p>
<p>Some famous conjectures about the occurence of primes in a given
range are [1]:</p>
<ul class="simple">
<li><dl class="first docutils">
<dt>Twin primes: though often not, the following will give 2 primes</dt>
<dd><dl class="first last docutils">
<dt>an infinite number of times:</dt>
<dd>primerange(6*n - 1, 6*n + 2)</dd>
</dl>
</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt>Legendre’s: the following always yields at least one prime</dt>
<dd>primerange(n**2, (n+1)**2+1)</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt>Bertrand’s (proven): there is always a prime in the range</dt>
<dd>primerange(n, 2*n)</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt>Brocard’s: there are at least four primes in the range</dt>
<dd>primerange(prime(n)**2, prime(n+1)**2)</dd>
</dl>
</li>
</ul>
<p>The average gap between primes is log(n) [2]; the gap between
primes can be arbitrarily large since sequences of composite
numbers are arbitrarily large, e.g. the numbers in the sequence
n! + 2, n! + 3 … n! + n are all composite.</p>
<p class="rubric">References</p>
<ol class="arabic simple">
<li><a class="reference external" href="http://en.wikipedia.org/wiki/Prime_number">http://en.wikipedia.org/wiki/Prime_number</a></li>
<li><a class="reference external" href="http://primes.utm.edu/notes/gaps.html">http://primes.utm.edu/notes/gaps.html</a></li>
</ol>
<p class="rubric">Examples</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sympy</span> <span class="k">import</span> <span class="n">primerange</span><span class="p">,</span> <span class="n">sieve</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">([</span><span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">primerange</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">30</span><span class="p">)])</span>
<span class="go">[2, 3, 5, 7, 11, 13, 17, 19, 23, 29]</span>
</pre></div>
</div>
<p>The Sieve method, primerange, is generally faster but it will
occupy more memory as the sieve stores values. The default
instance of Sieve, named sieve, can be used:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">list</span><span class="p">(</span><span class="n">sieve</span><span class="o">.</span><span class="n">primerange</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">30</span><span class="p">))</span>
<span class="go">[2, 3, 5, 7, 11, 13, 17, 19, 23, 29]</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="sympy.ntheory.generate.randprime">
<code class="descclassname">sympy.ntheory.generate.</code><code class="descname">randprime</code><span class="sig-paren">(</span><em>a</em>, <em>b</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sympy/ntheory/generate.html#randprime"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#sympy.ntheory.generate.randprime" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a random prime number in the range [a, b).</p>
<p>Bertrand’s postulate assures that
randprime(a, 2*a) will always succeed for a &gt; 1.</p>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<dl class="last docutils">
<dt><a class="reference internal" href="#sympy.ntheory.generate.primerange" title="sympy.ntheory.generate.primerange"><code class="xref py py-obj docutils literal"><span class="pre">primerange</span></code></a></dt>
<dd>Generate all primes in a given range</dd>
</dl>
</div>
<p class="rubric">References</p>
<ul class="simple">
<li><a class="reference external" href="http://en.wikipedia.org/wiki/Bertrand's_postulate">http://en.wikipedia.org/wiki/Bertrand’s_postulate</a></li>
</ul>
<p class="rubric">Examples</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sympy</span> <span class="k">import</span> <span class="n">randprime</span><span class="p">,</span> <span class="n">isprime</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">randprime</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">30</span><span class="p">)</span> 
<span class="go">13</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">isprime</span><span class="p">(</span><span class="n">randprime</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">30</span><span class="p">))</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="sympy.ntheory.generate.primorial">
<code class="descclassname">sympy.ntheory.generate.</code><code class="descname">primorial</code><span class="sig-paren">(</span><em>n</em>, <em>nth=True</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sympy/ntheory/generate.html#primorial"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#sympy.ntheory.generate.primorial" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the product of the first n primes (default) or
the primes less than or equal to n (when <code class="docutils literal"><span class="pre">nth=False</span></code>).</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sympy.ntheory.generate</span> <span class="k">import</span> <span class="n">primorial</span><span class="p">,</span> <span class="n">randprime</span><span class="p">,</span> <span class="n">primerange</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sympy</span> <span class="k">import</span> <span class="n">factorint</span><span class="p">,</span> <span class="n">Mul</span><span class="p">,</span> <span class="n">primefactors</span><span class="p">,</span> <span class="n">sqrt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">primorial</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span> <span class="c1"># the first 4 primes are 2, 3, 5, 7</span>
<span class="go">210</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">primorial</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="n">nth</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span> <span class="c1"># primes &lt;= 4 are 2 and 3</span>
<span class="go">6</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">primorial</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="go">2</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">primorial</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">nth</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="go">1</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">primorial</span><span class="p">(</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">101</span><span class="p">),</span> <span class="n">nth</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="go">210</span>
</pre></div>
</div>
<p>One can argue that the primes are infinite since if you take
a set of primes and multiply them together (e.g. the primorial) and
then add or subtract 1, the result cannot be divided by any of the
original factors, hence either 1 or more new primes must divide this
product of primes.</p>
<p>In this case, the number itself is a new prime:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">factorint</span><span class="p">(</span><span class="n">primorial</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
<span class="go">{211: 1}</span>
</pre></div>
</div>
<p>In this case two new primes are the factors:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">factorint</span><span class="p">(</span><span class="n">primorial</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
<span class="go">{11: 1, 19: 1}</span>
</pre></div>
</div>
<p>Here, some primes smaller and larger than the primes multiplied together
are obtained:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">p</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">primerange</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">20</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">sorted</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">primefactors</span><span class="p">(</span><span class="n">Mul</span><span class="p">(</span><span class="o">*</span><span class="n">p</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">))</span><span class="o">.</span><span class="n">difference</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">p</span><span class="p">)))</span>
<span class="go">[2, 5, 31, 149]</span>
</pre></div>
</div>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<dl class="last docutils">
<dt><a class="reference internal" href="#sympy.ntheory.generate.primerange" title="sympy.ntheory.generate.primerange"><code class="xref py py-obj docutils literal"><span class="pre">primerange</span></code></a></dt>
<dd>Generate all primes in a given range</dd>
</dl>
</div>
</dd></dl>

<dl class="function">
<dt id="sympy.ntheory.generate.cycle_length">
<code class="descclassname">sympy.ntheory.generate.</code><code class="descname">cycle_length</code><span class="sig-paren">(</span><em>f</em>, <em>x0</em>, <em>nmax=None</em>, <em>values=False</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sympy/ntheory/generate.html#cycle_length"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#sympy.ntheory.generate.cycle_length" title="Permalink to this definition">¶</a></dt>
<dd><p>For a given iterated sequence, return a generator that gives
the length of the iterated cycle (lambda) and the length of terms
before the cycle begins (mu); if <code class="docutils literal"><span class="pre">values</span></code> is True then the
terms of the sequence will be returned instead. The sequence is
started with value <code class="docutils literal"><span class="pre">x0</span></code>.</p>
<p>Note: more than the first lambda + mu terms may be returned and this
is the cost of cycle detection with Brent’s method; there are, however,
generally less terms calculated than would have been calculated if the
proper ending point were determined, e.g. by using Floyd’s method.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sympy.ntheory.generate</span> <span class="k">import</span> <span class="n">cycle_length</span>
</pre></div>
</div>
<p>This will yield successive values of i &lt;– func(i):</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="k">def</span> <span class="nf">iter</span><span class="p">(</span><span class="n">func</span><span class="p">,</span> <span class="n">i</span><span class="p">):</span>
<span class="gp">... </span>    <span class="k">while</span> <span class="mi">1</span><span class="p">:</span>
<span class="gp">... </span>        <span class="n">ii</span> <span class="o">=</span> <span class="n">func</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
<span class="gp">... </span>        <span class="k">yield</span> <span class="n">ii</span>
<span class="gp">... </span>        <span class="n">i</span> <span class="o">=</span> <span class="n">ii</span>
<span class="gp">...</span>
</pre></div>
</div>
<p>A function is defined:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">func</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">i</span><span class="p">:</span> <span class="p">(</span><span class="n">i</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">%</span> <span class="mi">51</span>
</pre></div>
</div>
<p>and given a seed of 4 and the mu and lambda terms calculated:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">next</span><span class="p">(</span><span class="n">cycle_length</span><span class="p">(</span><span class="n">func</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>
<span class="go">(6, 2)</span>
</pre></div>
</div>
<p>We can see what is meant by looking at the output:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">n</span> <span class="o">=</span> <span class="n">cycle_length</span><span class="p">(</span><span class="n">func</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="n">values</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">list</span><span class="p">(</span><span class="n">ni</span> <span class="k">for</span> <span class="n">ni</span> <span class="ow">in</span> <span class="n">n</span><span class="p">)</span>
<span class="go">[17, 35, 2, 5, 26, 14, 44, 50, 2, 5, 26, 14]</span>
</pre></div>
</div>
<p>There are 6 repeating values after the first 2.</p>
<p>If a sequence is suspected of being longer than you might wish, <code class="docutils literal"><span class="pre">nmax</span></code>
can be used to exit early (and mu will be returned as None):</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">next</span><span class="p">(</span><span class="n">cycle_length</span><span class="p">(</span><span class="n">func</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="n">nmax</span> <span class="o">=</span> <span class="mi">4</span><span class="p">))</span>
<span class="go">(4, None)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">[</span><span class="n">ni</span> <span class="k">for</span> <span class="n">ni</span> <span class="ow">in</span> <span class="n">cycle_length</span><span class="p">(</span><span class="n">func</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="n">nmax</span> <span class="o">=</span> <span class="mi">4</span><span class="p">,</span> <span class="n">values</span><span class="o">=</span><span class="kc">True</span><span class="p">)]</span>
<span class="go">[17, 35, 2, 5]</span>
</pre></div>
</div>
<dl class="docutils">
<dt>Code modified from:</dt>
<dd><a class="reference external" href="http://en.wikipedia.org/wiki/Cycle_detection">http://en.wikipedia.org/wiki/Cycle_detection</a>.</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="sympy.ntheory.generate.composite">
<code class="descclassname">sympy.ntheory.generate.</code><code class="descname">composite</code><span class="sig-paren">(</span><em>nth</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sympy/ntheory/generate.html#composite"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#sympy.ntheory.generate.composite" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the nth composite number, with the composite numbers indexed as
composite(1) = 4, composite(2) = 6, etc….</p>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<dl class="last docutils">
<dt><a class="reference internal" href="#sympy.ntheory.primetest.isprime" title="sympy.ntheory.primetest.isprime"><code class="xref py py-obj docutils literal"><span class="pre">sympy.ntheory.primetest.isprime</span></code></a></dt>
<dd>Test if n is prime</dd>
<dt><a class="reference internal" href="#sympy.ntheory.generate.primerange" title="sympy.ntheory.generate.primerange"><code class="xref py py-obj docutils literal"><span class="pre">primerange</span></code></a></dt>
<dd>Generate all primes in a given range</dd>
<dt><a class="reference internal" href="#sympy.ntheory.generate.primepi" title="sympy.ntheory.generate.primepi"><code class="xref py py-obj docutils literal"><span class="pre">primepi</span></code></a></dt>
<dd>Return the number of primes less than or equal to n</dd>
<dt><a class="reference internal" href="#sympy.ntheory.generate.prime" title="sympy.ntheory.generate.prime"><code class="xref py py-obj docutils literal"><span class="pre">prime</span></code></a></dt>
<dd>Return the nth prime</dd>
<dt><a class="reference internal" href="#sympy.ntheory.generate.compositepi" title="sympy.ntheory.generate.compositepi"><code class="xref py py-obj docutils literal"><span class="pre">compositepi</span></code></a></dt>
<dd>Return the number of positive composite numbers less than or equal to n</dd>
</dl>
</div>
<p class="rubric">Examples</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sympy</span> <span class="k">import</span> <span class="n">composite</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">composite</span><span class="p">(</span><span class="mi">36</span><span class="p">)</span>
<span class="go">52</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">composite</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="go">4</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">composite</span><span class="p">(</span><span class="mi">17737</span><span class="p">)</span>
<span class="go">20000</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="sympy.ntheory.generate.compositepi">
<code class="descclassname">sympy.ntheory.generate.</code><code class="descname">compositepi</code><span class="sig-paren">(</span><em>n</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sympy/ntheory/generate.html#compositepi"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#sympy.ntheory.generate.compositepi" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the number of positive composite numbers less than or equal to n.
The first positive composite is 4, i.e. compositepi(4) = 1.</p>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<dl class="last docutils">
<dt><a class="reference internal" href="#sympy.ntheory.primetest.isprime" title="sympy.ntheory.primetest.isprime"><code class="xref py py-obj docutils literal"><span class="pre">sympy.ntheory.primetest.isprime</span></code></a></dt>
<dd>Test if n is prime</dd>
<dt><a class="reference internal" href="#sympy.ntheory.generate.primerange" title="sympy.ntheory.generate.primerange"><code class="xref py py-obj docutils literal"><span class="pre">primerange</span></code></a></dt>
<dd>Generate all primes in a given range</dd>
<dt><a class="reference internal" href="#sympy.ntheory.generate.prime" title="sympy.ntheory.generate.prime"><code class="xref py py-obj docutils literal"><span class="pre">prime</span></code></a></dt>
<dd>Return the nth prime</dd>
<dt><a class="reference internal" href="#sympy.ntheory.generate.primepi" title="sympy.ntheory.generate.primepi"><code class="xref py py-obj docutils literal"><span class="pre">primepi</span></code></a></dt>
<dd>Return the number of primes less than or equal to n</dd>
<dt><a class="reference internal" href="#sympy.ntheory.generate.composite" title="sympy.ntheory.generate.composite"><code class="xref py py-obj docutils literal"><span class="pre">composite</span></code></a></dt>
<dd>Return the nth composite number</dd>
</dl>
</div>
<p class="rubric">Examples</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sympy</span> <span class="k">import</span> <span class="n">compositepi</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">compositepi</span><span class="p">(</span><span class="mi">25</span><span class="p">)</span>
<span class="go">15</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">compositepi</span><span class="p">(</span><span class="mi">1000</span><span class="p">)</span>
<span class="go">831</span>
</pre></div>
</div>
</dd></dl>

<span class="target" id="module-sympy.ntheory.factor_"></span><dl class="function">
<dt id="sympy.ntheory.factor_.smoothness">
<code class="descclassname">sympy.ntheory.factor_.</code><code class="descname">smoothness</code><span class="sig-paren">(</span><em>n</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sympy/ntheory/factor_.html#smoothness"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#sympy.ntheory.factor_.smoothness" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the B-smooth and B-power smooth values of n.</p>
<p>The smoothness of n is the largest prime factor of n; the power-
smoothness is the largest divisor raised to its multiplicity.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sympy.ntheory.factor_</span> <span class="k">import</span> <span class="n">smoothness</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">smoothness</span><span class="p">(</span><span class="mi">2</span><span class="o">**</span><span class="mi">7</span><span class="o">*</span><span class="mi">3</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
<span class="go">(3, 128)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">smoothness</span><span class="p">(</span><span class="mi">2</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="mi">13</span><span class="p">)</span>
<span class="go">(13, 16)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">smoothness</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="go">(2, 2)</span>
</pre></div>
</div>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<p class="last"><a class="reference internal" href="#sympy.ntheory.factor_.factorint" title="sympy.ntheory.factor_.factorint"><code class="xref py py-obj docutils literal"><span class="pre">factorint</span></code></a>, <a class="reference internal" href="#sympy.ntheory.factor_.smoothness_p" title="sympy.ntheory.factor_.smoothness_p"><code class="xref py py-obj docutils literal"><span class="pre">smoothness_p</span></code></a></p>
</div>
</dd></dl>

<dl class="function">
<dt id="sympy.ntheory.factor_.smoothness_p">
<code class="descclassname">sympy.ntheory.factor_.</code><code class="descname">smoothness_p</code><span class="sig-paren">(</span><em>n</em>, <em>m=-1</em>, <em>power=0</em>, <em>visual=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sympy/ntheory/factor_.html#smoothness_p"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#sympy.ntheory.factor_.smoothness_p" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a list of [m, (p, (M, sm(p + m), psm(p + m)))…]
where:</p>
<ol class="arabic simple">
<li>p**M is the base-p divisor of n</li>
<li>sm(p + m) is the smoothness of p + m (m = -1 by default)</li>
<li>psm(p + m) is the power smoothness of p + m</li>
</ol>
<p>The list is sorted according to smoothness (default) or by power smoothness
if power=1.</p>
<p>The smoothness of the numbers to the left (m = -1) or right (m = 1) of a
factor govern the results that are obtained from the p +/- 1 type factoring
methods.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sympy.ntheory.factor_</span> <span class="k">import</span> <span class="n">smoothness_p</span><span class="p">,</span> <span class="n">factorint</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">smoothness_p</span><span class="p">(</span><span class="mi">10431</span><span class="p">,</span> <span class="n">m</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="go">(1, [(3, (2, 2, 4)), (19, (1, 5, 5)), (61, (1, 31, 31))])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">smoothness_p</span><span class="p">(</span><span class="mi">10431</span><span class="p">)</span>
<span class="go">(-1, [(3, (2, 2, 2)), (19, (1, 3, 9)), (61, (1, 5, 5))])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">smoothness_p</span><span class="p">(</span><span class="mi">10431</span><span class="p">,</span> <span class="n">power</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="go">(-1, [(3, (2, 2, 2)), (61, (1, 5, 5)), (19, (1, 3, 9))])</span>
</pre></div>
</div>
<p>If visual=True then an annotated string will be returned:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">smoothness_p</span><span class="p">(</span><span class="mi">21477639576571</span><span class="p">,</span> <span class="n">visual</span><span class="o">=</span><span class="mi">1</span><span class="p">))</span>
<span class="go">p**i=4410317**1 has p-1 B=1787, B-pow=1787</span>
<span class="go">p**i=4869863**1 has p-1 B=2434931, B-pow=2434931</span>
</pre></div>
</div>
<p>This string can also be generated directly from a factorization dictionary
and vice versa:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">factorint</span><span class="p">(</span><span class="mi">17</span><span class="o">*</span><span class="mi">9</span><span class="p">)</span>
<span class="go">{3: 2, 17: 1}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">smoothness_p</span><span class="p">(</span><span class="n">_</span><span class="p">)</span>
<span class="go">&#39;p**i=3**2 has p-1 B=2, B-pow=2\np**i=17**1 has p-1 B=2, B-pow=16&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">smoothness_p</span><span class="p">(</span><span class="n">_</span><span class="p">)</span>
<span class="go">{3: 2, 17: 1}</span>
</pre></div>
</div>
<p>The table of the output logic is:</p>
<blockquote>
<div><table border="1" class="docutils">
<colgroup>
<col width="23%" />
<col width="23%" />
<col width="27%" />
<col width="27%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head"><div class="first last line-block">
<div class="line"><br /></div>
</div>
</th>
<th class="head" colspan="3">Visual</th>
</tr>
<tr class="row-even"><th class="head">Input</th>
<th class="head">True</th>
<th class="head">False</th>
<th class="head">other</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-odd"><td>dict</td>
<td>str</td>
<td>tuple</td>
<td>str</td>
</tr>
<tr class="row-even"><td>str</td>
<td>str</td>
<td>tuple</td>
<td>dict</td>
</tr>
<tr class="row-odd"><td>tuple</td>
<td>str</td>
<td>tuple</td>
<td>str</td>
</tr>
<tr class="row-even"><td>n</td>
<td>str</td>
<td>tuple</td>
<td>tuple</td>
</tr>
<tr class="row-odd"><td>mul</td>
<td>str</td>
<td>tuple</td>
<td>tuple</td>
</tr>
</tbody>
</table>
</div></blockquote>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<p class="last"><a class="reference internal" href="#sympy.ntheory.factor_.factorint" title="sympy.ntheory.factor_.factorint"><code class="xref py py-obj docutils literal"><span class="pre">factorint</span></code></a>, <a class="reference internal" href="#sympy.ntheory.factor_.smoothness" title="sympy.ntheory.factor_.smoothness"><code class="xref py py-obj docutils literal"><span class="pre">smoothness</span></code></a></p>
</div>
</dd></dl>

<dl class="function">
<dt id="sympy.ntheory.factor_.trailing">
<code class="descclassname">sympy.ntheory.factor_.</code><code class="descname">trailing</code><span class="sig-paren">(</span><em>n</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sympy/ntheory/factor_.html#trailing"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#sympy.ntheory.factor_.trailing" title="Permalink to this definition">¶</a></dt>
<dd><p>Count the number of trailing zero digits in the binary
representation of n, i.e. determine the largest power of 2
that divides n.</p>
<p class="rubric">Examples</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sympy</span> <span class="k">import</span> <span class="n">trailing</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">trailing</span><span class="p">(</span><span class="mi">128</span><span class="p">)</span>
<span class="go">7</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">trailing</span><span class="p">(</span><span class="mi">63</span><span class="p">)</span>
<span class="go">0</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="sympy.ntheory.factor_.multiplicity">
<code class="descclassname">sympy.ntheory.factor_.</code><code class="descname">multiplicity</code><span class="sig-paren">(</span><em>p</em>, <em>n</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sympy/ntheory/factor_.html#multiplicity"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#sympy.ntheory.factor_.multiplicity" title="Permalink to this definition">¶</a></dt>
<dd><p>Find the greatest integer m such that p**m divides n.</p>
<p class="rubric">Examples</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sympy.ntheory</span> <span class="k">import</span> <span class="n">multiplicity</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sympy.core.numbers</span> <span class="k">import</span> <span class="n">Rational</span> <span class="k">as</span> <span class="n">R</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">[</span><span class="n">multiplicity</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span> <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">8</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">25</span><span class="p">,</span> <span class="mi">125</span><span class="p">,</span> <span class="mi">250</span><span class="p">]]</span>
<span class="go">[0, 1, 2, 3, 3]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">multiplicity</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="n">R</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">9</span><span class="p">))</span>
<span class="go">-2</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="sympy.ntheory.factor_.perfect_power">
<code class="descclassname">sympy.ntheory.factor_.</code><code class="descname">perfect_power</code><span class="sig-paren">(</span><em>n</em>, <em>candidates=None</em>, <em>big=True</em>, <em>factor=True</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sympy/ntheory/factor_.html#perfect_power"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#sympy.ntheory.factor_.perfect_power" title="Permalink to this definition">¶</a></dt>
<dd><p>Return <code class="docutils literal"><span class="pre">(b,</span> <span class="pre">e)</span></code> such that <code class="docutils literal"><span class="pre">n</span></code> == <code class="docutils literal"><span class="pre">b**e</span></code> if <code class="docutils literal"><span class="pre">n</span></code> is a
perfect power; otherwise return <code class="docutils literal"><span class="pre">False</span></code>.</p>
<p>By default, the base is recursively decomposed and the exponents
collected so the largest possible <code class="docutils literal"><span class="pre">e</span></code> is sought. If <code class="docutils literal"><span class="pre">big=False</span></code>
then the smallest possible <code class="docutils literal"><span class="pre">e</span></code> (thus prime) will be chosen.</p>
<p>If <code class="docutils literal"><span class="pre">candidates</span></code> for exponents are given, they are assumed to be sorted
and the first one that is larger than the computed maximum will signal
failure for the routine.</p>
<p>If <code class="docutils literal"><span class="pre">factor=True</span></code> then simultaneous factorization of n is attempted
since finding a factor indicates the only possible root for n. This
is True by default since only a few small factors will be tested in
the course of searching for the perfect power.</p>
<p class="rubric">Examples</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sympy</span> <span class="k">import</span> <span class="n">perfect_power</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">perfect_power</span><span class="p">(</span><span class="mi">16</span><span class="p">)</span>
<span class="go">(2, 4)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">perfect_power</span><span class="p">(</span><span class="mi">16</span><span class="p">,</span> <span class="n">big</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span>
<span class="go">(4, 2)</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="sympy.ntheory.factor_.pollard_rho">
<code class="descclassname">sympy.ntheory.factor_.</code><code class="descname">pollard_rho</code><span class="sig-paren">(</span><em>n</em>, <em>s=2</em>, <em>a=1</em>, <em>retries=5</em>, <em>seed=1234</em>, <em>max_steps=None</em>, <em>F=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sympy/ntheory/factor_.html#pollard_rho"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#sympy.ntheory.factor_.pollard_rho" title="Permalink to this definition">¶</a></dt>
<dd><p>Use Pollard’s rho method to try to extract a nontrivial factor
of <code class="docutils literal"><span class="pre">n</span></code>. The returned factor may be a composite number. If no
factor is found, <code class="docutils literal"><span class="pre">None</span></code> is returned.</p>
<p>The algorithm generates pseudo-random values of x with a generator
function, replacing x with F(x). If F is not supplied then the
function x**2 + <code class="docutils literal"><span class="pre">a</span></code> is used. The first value supplied to F(x) is <code class="docutils literal"><span class="pre">s</span></code>.
Upon failure (if <code class="docutils literal"><span class="pre">retries</span></code> is &gt; 0) a new <code class="docutils literal"><span class="pre">a</span></code> and <code class="docutils literal"><span class="pre">s</span></code> will be
supplied; the <code class="docutils literal"><span class="pre">a</span></code> will be ignored if F was supplied.</p>
<p>The sequence of numbers generated by such functions generally have a
a lead-up to some number and then loop around back to that number and
begin to repeat the sequence, e.g. 1, 2, 3, 4, 5, 3, 4, 5 – this leader
and loop look a bit like the Greek letter rho, and thus the name, ‘rho’.</p>
<p>For a given function, very different leader-loop values can be obtained
so it is a good idea to allow for retries:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sympy.ntheory.generate</span> <span class="k">import</span> <span class="n">cycle_length</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">n</span> <span class="o">=</span> <span class="mi">16843009</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">F</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:(</span><span class="mi">2048</span><span class="o">*</span><span class="nb">pow</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span> <span class="o">+</span> <span class="mi">32767</span><span class="p">)</span> <span class="o">%</span> <span class="n">n</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">5</span><span class="p">):</span>
<span class="gp">... </span>    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;loop length = </span><span class="si">%4i</span><span class="s1">; leader length = </span><span class="si">%3i</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="nb">next</span><span class="p">(</span><span class="n">cycle_length</span><span class="p">(</span><span class="n">F</span><span class="p">,</span> <span class="n">s</span><span class="p">)))</span>
<span class="gp">...</span>
<span class="go">loop length = 2489; leader length =  42</span>
<span class="go">loop length =   78; leader length = 120</span>
<span class="go">loop length = 1482; leader length =  99</span>
<span class="go">loop length = 1482; leader length = 285</span>
<span class="go">loop length = 1482; leader length = 100</span>
</pre></div>
</div>
<p>Here is an explicit example where there is a two element leadup to
a sequence of 3 numbers (11, 14, 4) that then repeat:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">x</span><span class="o">=</span><span class="mi">2</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">9</span><span class="p">):</span>
<span class="gp">... </span>    <span class="n">x</span><span class="o">=</span><span class="p">(</span><span class="n">x</span><span class="o">**</span><span class="mi">2</span><span class="o">+</span><span class="mi">12</span><span class="p">)</span><span class="o">%</span><span class="mi">17</span>
<span class="gp">... </span>    <span class="nb">print</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="gp">...</span>
<span class="go">16</span>
<span class="go">13</span>
<span class="go">11</span>
<span class="go">14</span>
<span class="go">4</span>
<span class="go">11</span>
<span class="go">14</span>
<span class="go">4</span>
<span class="go">11</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">next</span><span class="p">(</span><span class="n">cycle_length</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="p">(</span><span class="n">x</span><span class="o">**</span><span class="mi">2</span><span class="o">+</span><span class="mi">12</span><span class="p">)</span><span class="o">%</span><span class="mi">17</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span>
<span class="go">(3, 2)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">list</span><span class="p">(</span><span class="n">cycle_length</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="p">(</span><span class="n">x</span><span class="o">**</span><span class="mi">2</span><span class="o">+</span><span class="mi">12</span><span class="p">)</span><span class="o">%</span><span class="mi">17</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">values</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span>
<span class="go">[16, 13, 11, 14, 4]</span>
</pre></div>
</div>
<p>Instead of checking the differences of all generated values for a gcd
with n, only the kth and 2*kth numbers are checked, e.g. 1st and 2nd,
2nd and 4th, 3rd and 6th until it has been detected that the loop has been
traversed. Loops may be many thousands of steps long before rho finds a
factor or reports failure. If <code class="docutils literal"><span class="pre">max_steps</span></code> is specified, the iteration
is cancelled with a failure after the specified number of steps.</p>
<p class="rubric">References</p>
<ul class="simple">
<li>Richard Crandall &amp; Carl Pomerance (2005), “Prime Numbers:
A Computational Perspective”, Springer, 2nd edition, 229-231</li>
</ul>
<p class="rubric">Examples</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sympy</span> <span class="k">import</span> <span class="n">pollard_rho</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">n</span><span class="o">=</span><span class="mi">16843009</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">F</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:(</span><span class="mi">2048</span><span class="o">*</span><span class="nb">pow</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="n">n</span><span class="p">)</span> <span class="o">+</span> <span class="mi">32767</span><span class="p">)</span> <span class="o">%</span> <span class="n">n</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pollard_rho</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">F</span><span class="o">=</span><span class="n">F</span><span class="p">)</span>
<span class="go">257</span>
</pre></div>
</div>
<p>Use the default setting with a bad value of <code class="docutils literal"><span class="pre">a</span></code> and no retries:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">pollard_rho</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">a</span><span class="o">=</span><span class="n">n</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="n">retries</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</pre></div>
</div>
<p>If retries is &gt; 0 then perhaps the problem will correct itself when
new values are generated for a:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">pollard_rho</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">a</span><span class="o">=</span><span class="n">n</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="n">retries</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="go">257</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="sympy.ntheory.factor_.pollard_pm1">
<code class="descclassname">sympy.ntheory.factor_.</code><code class="descname">pollard_pm1</code><span class="sig-paren">(</span><em>n</em>, <em>B=10</em>, <em>a=2</em>, <em>retries=0</em>, <em>seed=1234</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sympy/ntheory/factor_.html#pollard_pm1"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#sympy.ntheory.factor_.pollard_pm1" title="Permalink to this definition">¶</a></dt>
<dd><p>Use Pollard’s p-1 method to try to extract a nontrivial factor
of <code class="docutils literal"><span class="pre">n</span></code>. Either a divisor (perhaps composite) or <code class="docutils literal"><span class="pre">None</span></code> is returned.</p>
<p>The value of <code class="docutils literal"><span class="pre">a</span></code> is the base that is used in the test gcd(a**M - 1, n).
The default is 2.  If <code class="docutils literal"><span class="pre">retries</span></code> &gt; 0 then if no factor is found after the
first attempt, a new <code class="docutils literal"><span class="pre">a</span></code> will be generated randomly (using the <code class="docutils literal"><span class="pre">seed</span></code>)
and the process repeated.</p>
<p>Note: the value of M is lcm(1..B) = reduce(ilcm, range(2, B + 1)).</p>
<p>A search is made for factors next to even numbers having a power smoothness
less than <code class="docutils literal"><span class="pre">B</span></code>. Choosing a larger B increases the likelihood of finding a
larger factor but takes longer. Whether a factor of n is found or not
depends on <code class="docutils literal"><span class="pre">a</span></code> and the power smoothness of the even mumber just less than
the factor p (hence the name p - 1).</p>
<p>Although some discussion of what constitutes a good <code class="docutils literal"><span class="pre">a</span></code> some
descriptions are hard to interpret. At the modular.math site referenced
below it is stated that if gcd(a**M - 1, n) = N then a**M % q**r is 1
for every prime power divisor of N. But consider the following:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sympy.ntheory.factor_</span> <span class="k">import</span> <span class="n">smoothness_p</span><span class="p">,</span> <span class="n">pollard_pm1</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">n</span><span class="o">=</span><span class="mi">257</span><span class="o">*</span><span class="mi">1009</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">smoothness_p</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
<span class="go">(-1, [(257, (1, 2, 256)), (1009, (1, 7, 16))])</span>
</pre></div>
</div>
<p>So we should (and can) find a root with B=16:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">pollard_pm1</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">B</span><span class="o">=</span><span class="mi">16</span><span class="p">,</span> <span class="n">a</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<span class="go">1009</span>
</pre></div>
</div>
<p>If we attempt to increase B to 256 we find that it doesn’t work:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">pollard_pm1</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">B</span><span class="o">=</span><span class="mi">256</span><span class="p">)</span>
<span class="go">&gt;&gt;&gt;</span>
</pre></div>
</div>
<p>But if the value of <code class="docutils literal"><span class="pre">a</span></code> is changed we find that only multiples of
257 work, e.g.:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">pollard_pm1</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">B</span><span class="o">=</span><span class="mi">256</span><span class="p">,</span> <span class="n">a</span><span class="o">=</span><span class="mi">257</span><span class="p">)</span>
<span class="go">1009</span>
</pre></div>
</div>
<p>Checking different <code class="docutils literal"><span class="pre">a</span></code> values shows that all the ones that didn’t
work had a gcd value not equal to <code class="docutils literal"><span class="pre">n</span></code> but equal to one of the
factors:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sympy.core.numbers</span> <span class="k">import</span> <span class="n">ilcm</span><span class="p">,</span> <span class="n">igcd</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sympy</span> <span class="k">import</span> <span class="n">factorint</span><span class="p">,</span> <span class="n">Pow</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">M</span> <span class="o">=</span> <span class="mi">1</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">256</span><span class="p">):</span>
<span class="gp">... </span>    <span class="n">M</span> <span class="o">=</span> <span class="n">ilcm</span><span class="p">(</span><span class="n">M</span><span class="p">,</span> <span class="n">i</span><span class="p">)</span>
<span class="gp">...</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">set</span><span class="p">([</span><span class="n">igcd</span><span class="p">(</span><span class="nb">pow</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">M</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span> <span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">256</span><span class="p">)</span> <span class="k">if</span>
<span class="gp">... </span>     <span class="n">igcd</span><span class="p">(</span><span class="nb">pow</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">M</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span> <span class="o">!=</span> <span class="n">n</span><span class="p">])</span>
<span class="go">{1009}</span>
</pre></div>
</div>
<p>But does aM % d for every divisor of n give 1?</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">aM</span> <span class="o">=</span> <span class="nb">pow</span><span class="p">(</span><span class="mi">255</span><span class="p">,</span> <span class="n">M</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">[(</span><span class="n">d</span><span class="p">,</span> <span class="n">aM</span><span class="o">%</span><span class="n">Pow</span><span class="p">(</span><span class="o">*</span><span class="n">d</span><span class="o">.</span><span class="n">args</span><span class="p">))</span> <span class="k">for</span> <span class="n">d</span> <span class="ow">in</span> <span class="n">factorint</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">visual</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">args</span><span class="p">]</span>
<span class="go">[(257**1, 1), (1009**1, 1)]</span>
</pre></div>
</div>
<p>No, only one of them. So perhaps the principle is that a root will
be found for a given value of B provided that:</p>
<ol class="arabic simple">
<li>the power smoothness of the p - 1 value next to the root
does not exceed B</li>
<li>a**M % p != 1 for any of the divisors of n.</li>
</ol>
<p>By trying more than one <code class="docutils literal"><span class="pre">a</span></code> it is possible that one of them
will yield a factor.</p>
<p class="rubric">References</p>
<ul class="simple">
<li>Richard Crandall &amp; Carl Pomerance (2005), “Prime Numbers:
A Computational Perspective”, Springer, 2nd edition, 236-238</li>
<li><a class="reference external" href="http://modular.math.washington.edu/edu/2007/spring/ent/ent-html/node81.html">http://modular.math.washington.edu/edu/2007/spring/ent/ent-html/node81.html</a></li>
<li><a class="reference external" href="http://www.cs.toronto.edu/~yuvalf/Factorization.pdf">http://www.cs.toronto.edu/~yuvalf/Factorization.pdf</a></li>
</ul>
<p class="rubric">Examples</p>
<p>With the default smoothness bound, this number can’t be cracked:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sympy.ntheory</span> <span class="k">import</span> <span class="n">pollard_pm1</span><span class="p">,</span> <span class="n">primefactors</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pollard_pm1</span><span class="p">(</span><span class="mi">21477639576571</span><span class="p">)</span>
</pre></div>
</div>
<p>Increasing the smoothness bound helps:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">pollard_pm1</span><span class="p">(</span><span class="mi">21477639576571</span><span class="p">,</span> <span class="n">B</span><span class="o">=</span><span class="mi">2000</span><span class="p">)</span>
<span class="go">4410317</span>
</pre></div>
</div>
<p>Looking at the smoothness of the factors of this number we find:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sympy.utilities</span> <span class="k">import</span> <span class="n">flatten</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sympy.ntheory.factor_</span> <span class="k">import</span> <span class="n">smoothness_p</span><span class="p">,</span> <span class="n">factorint</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">smoothness_p</span><span class="p">(</span><span class="mi">21477639576571</span><span class="p">,</span> <span class="n">visual</span><span class="o">=</span><span class="mi">1</span><span class="p">))</span>
<span class="go">p**i=4410317**1 has p-1 B=1787, B-pow=1787</span>
<span class="go">p**i=4869863**1 has p-1 B=2434931, B-pow=2434931</span>
</pre></div>
</div>
<p>The B and B-pow are the same for the p - 1 factorizations of the divisors
because those factorizations had a very large prime factor:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">factorint</span><span class="p">(</span><span class="mi">4410317</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
<span class="go">{2: 2, 617: 1, 1787: 1}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">factorint</span><span class="p">(</span><span class="mi">4869863</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span class="go">{2: 1, 2434931: 1}</span>
</pre></div>
</div>
<p>Note that until B reaches the B-pow value of 1787, the number is not cracked;</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">pollard_pm1</span><span class="p">(</span><span class="mi">21477639576571</span><span class="p">,</span> <span class="n">B</span><span class="o">=</span><span class="mi">1786</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pollard_pm1</span><span class="p">(</span><span class="mi">21477639576571</span><span class="p">,</span> <span class="n">B</span><span class="o">=</span><span class="mi">1787</span><span class="p">)</span>
<span class="go">4410317</span>
</pre></div>
</div>
<p>The B value has to do with the factors of the number next to the divisor,
not the divisors themselves. A worst case scenario is that the number next
to the factor p has a large prime divisisor or is a perfect power. If these
conditions apply then the power-smoothness will be about p/2 or p. The more
realistic is that there will be a large prime factor next to p requiring
a B value on the order of p/2. Although primes may have been searched for
up to this level, the p/2 is a factor of p - 1, something that we don’t
know. The modular.math reference below states that 15% of numbers in the
range of 10**15 to 15**15 + 10**4 are 10**6 power smooth so a B of 10**6
will fail 85% of the time in that range. From 10**8 to 10**8 + 10**3 the
percentages are nearly reversed…but in that range the simple trial
division is quite fast.</p>
</dd></dl>

<dl class="function">
<dt id="sympy.ntheory.factor_.factorint">
<code class="descclassname">sympy.ntheory.factor_.</code><code class="descname">factorint</code><span class="sig-paren">(</span><em>n</em>, <em>limit=None</em>, <em>use_trial=True</em>, <em>use_rho=True</em>, <em>use_pm1=True</em>, <em>verbose=False</em>, <em>visual=None</em>, <em>multiple=False</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sympy/ntheory/factor_.html#factorint"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#sympy.ntheory.factor_.factorint" title="Permalink to this definition">¶</a></dt>
<dd><p>Given a positive integer <code class="docutils literal"><span class="pre">n</span></code>, <code class="docutils literal"><span class="pre">factorint(n)</span></code> returns a dict containing
the prime factors of <code class="docutils literal"><span class="pre">n</span></code> as keys and their respective multiplicities
as values. For example:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sympy.ntheory</span> <span class="k">import</span> <span class="n">factorint</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">factorint</span><span class="p">(</span><span class="mi">2000</span><span class="p">)</span>    <span class="c1"># 2000 = (2**4) * (5**3)</span>
<span class="go">{2: 4, 5: 3}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">factorint</span><span class="p">(</span><span class="mi">65537</span><span class="p">)</span>   <span class="c1"># This number is prime</span>
<span class="go">{65537: 1}</span>
</pre></div>
</div>
<p>For input less than 2, factorint behaves as follows:</p>
<blockquote>
<div><ul class="simple">
<li><code class="docutils literal"><span class="pre">factorint(1)</span></code> returns the empty factorization, <code class="docutils literal"><span class="pre">{}</span></code></li>
<li><code class="docutils literal"><span class="pre">factorint(0)</span></code> returns <code class="docutils literal"><span class="pre">{0:1}</span></code></li>
<li><code class="docutils literal"><span class="pre">factorint(-n)</span></code> adds <code class="docutils literal"><span class="pre">-1:1</span></code> to the factors and then factors <code class="docutils literal"><span class="pre">n</span></code></li>
</ul>
</div></blockquote>
<p>Partial Factorization:</p>
<p>If <code class="docutils literal"><span class="pre">limit</span></code> (&gt; 3) is specified, the search is stopped after performing
trial division up to (and including) the limit (or taking a
corresponding number of rho/p-1 steps). This is useful if one has
a large number and only is interested in finding small factors (if
any). Note that setting a limit does not prevent larger factors
from being found early; it simply means that the largest factor may
be composite. Since checking for perfect power is relatively cheap, it is
done regardless of the limit setting.</p>
<p>This number, for example, has two small factors and a huge
semi-prime factor that cannot be reduced easily:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sympy.ntheory</span> <span class="k">import</span> <span class="n">isprime</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sympy.core.compatibility</span> <span class="k">import</span> <span class="n">long</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a</span> <span class="o">=</span> <span class="mi">1407633717262338957430697921446883</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">f</span> <span class="o">=</span> <span class="n">factorint</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">limit</span><span class="o">=</span><span class="mi">10000</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">f</span> <span class="o">==</span> <span class="p">{</span><span class="mi">991</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="n">long</span><span class="p">(</span><span class="mi">202916782076162456022877024859</span><span class="p">):</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">7</span><span class="p">:</span> <span class="mi">1</span><span class="p">}</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">isprime</span><span class="p">(</span><span class="nb">max</span><span class="p">(</span><span class="n">f</span><span class="p">))</span>
<span class="go">False</span>
</pre></div>
</div>
<p>This number has a small factor and a residual perfect power whose
base is greater than the limit:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">factorint</span><span class="p">(</span><span class="mi">3</span><span class="o">*</span><span class="mi">101</span><span class="o">**</span><span class="mi">7</span><span class="p">,</span> <span class="n">limit</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
<span class="go">{3: 1, 101: 7}</span>
</pre></div>
</div>
<p>List of Factors:</p>
<p>If <code class="docutils literal"><span class="pre">multiple</span></code> is set to <code class="docutils literal"><span class="pre">True</span></code> then a list containing the
prime factors including multiplicities is returned.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">factorint</span><span class="p">(</span><span class="mi">24</span><span class="p">,</span> <span class="n">multiple</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="go">[2, 2, 2, 3]</span>
</pre></div>
</div>
<p>Visual Factorization:</p>
<p>If <code class="docutils literal"><span class="pre">visual</span></code> is set to <code class="docutils literal"><span class="pre">True</span></code>, then it will return a visual
factorization of the integer.  For example:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sympy</span> <span class="k">import</span> <span class="n">pprint</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pprint</span><span class="p">(</span><span class="n">factorint</span><span class="p">(</span><span class="mi">4200</span><span class="p">,</span> <span class="n">visual</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span>
<span class="go"> 3  1  2  1</span>
<span class="go">2 *3 *5 *7</span>
</pre></div>
</div>
<p>Note that this is achieved by using the evaluate=False flag in Mul
and Pow. If you do other manipulations with an expression where
evaluate=False, it may evaluate.  Therefore, you should use the
visual option only for visualization, and use the normal dictionary
returned by visual=False if you want to perform operations on the
factors.</p>
<p>You can easily switch between the two forms by sending them back to
factorint:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sympy</span> <span class="k">import</span> <span class="n">Mul</span><span class="p">,</span> <span class="n">Pow</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">regular</span> <span class="o">=</span> <span class="n">factorint</span><span class="p">(</span><span class="mi">1764</span><span class="p">);</span> <span class="n">regular</span>
<span class="go">{2: 2, 3: 2, 7: 2}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pprint</span><span class="p">(</span><span class="n">factorint</span><span class="p">(</span><span class="n">regular</span><span class="p">))</span>
<span class="go"> 2  2  2</span>
<span class="go">2 *3 *7</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">visual</span> <span class="o">=</span> <span class="n">factorint</span><span class="p">(</span><span class="mi">1764</span><span class="p">,</span> <span class="n">visual</span><span class="o">=</span><span class="kc">True</span><span class="p">);</span> <span class="n">pprint</span><span class="p">(</span><span class="n">visual</span><span class="p">)</span>
<span class="go"> 2  2  2</span>
<span class="go">2 *3 *7</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">factorint</span><span class="p">(</span><span class="n">visual</span><span class="p">))</span>
<span class="go">{2: 2, 3: 2, 7: 2}</span>
</pre></div>
</div>
<p>If you want to send a number to be factored in a partially factored form
you can do so with a dictionary or unevaluated expression:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">factorint</span><span class="p">(</span><span class="n">factorint</span><span class="p">({</span><span class="mi">4</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">12</span><span class="p">:</span> <span class="mi">3</span><span class="p">}))</span> <span class="c1"># twice to toggle to dict form</span>
<span class="go">{2: 10, 3: 3}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">factorint</span><span class="p">(</span><span class="n">Mul</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="n">evaluate</span><span class="o">=</span><span class="kc">False</span><span class="p">))</span>
<span class="go">{2: 4, 3: 1}</span>
</pre></div>
</div>
<p>The table of the output logic is:</p>
<blockquote>
<div><table border="1" class="docutils">
<colgroup>
<col width="23%" />
<col width="23%" />
<col width="27%" />
<col width="27%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">&#160;</th>
<th class="head" colspan="3">&#160;</th>
</tr>
<tr class="row-even"><th class="head">Input</th>
<th class="head">True</th>
<th class="head">False</th>
<th class="head">other</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-odd"><td>dict</td>
<td>mul</td>
<td>dict</td>
<td>mul</td>
</tr>
<tr class="row-even"><td>n</td>
<td>mul</td>
<td>dict</td>
<td>dict</td>
</tr>
<tr class="row-odd"><td>mul</td>
<td>mul</td>
<td>dict</td>
<td>dict</td>
</tr>
</tbody>
</table>
</div></blockquote>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<p class="last"><a class="reference internal" href="#sympy.ntheory.factor_.smoothness" title="sympy.ntheory.factor_.smoothness"><code class="xref py py-obj docutils literal"><span class="pre">smoothness</span></code></a>, <a class="reference internal" href="#sympy.ntheory.factor_.smoothness_p" title="sympy.ntheory.factor_.smoothness_p"><code class="xref py py-obj docutils literal"><span class="pre">smoothness_p</span></code></a>, <a class="reference internal" href="#sympy.ntheory.factor_.divisors" title="sympy.ntheory.factor_.divisors"><code class="xref py py-obj docutils literal"><span class="pre">divisors</span></code></a></p>
</div>
<p class="rubric">Notes</p>
<p>Algorithm:</p>
<p>The function switches between multiple algorithms. Trial division
quickly finds small factors (of the order 1-5 digits), and finds
all large factors if given enough time. The Pollard rho and p-1
algorithms are used to find large factors ahead of time; they
will often find factors of the order of 10 digits within a few
seconds:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">factors</span> <span class="o">=</span> <span class="n">factorint</span><span class="p">(</span><span class="mi">12345678910111213141516</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">base</span><span class="p">,</span> <span class="n">exp</span> <span class="ow">in</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">factors</span><span class="o">.</span><span class="n">items</span><span class="p">()):</span>
<span class="gp">... </span>    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">%s</span><span class="s1"> </span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">base</span><span class="p">,</span> <span class="n">exp</span><span class="p">))</span>
<span class="gp">...</span>
<span class="go">2 2</span>
<span class="go">2507191691 1</span>
<span class="go">1231026625769 1</span>
</pre></div>
</div>
<p>Any of these methods can optionally be disabled with the following
boolean parameters:</p>
<blockquote>
<div><ul class="simple">
<li><code class="docutils literal"><span class="pre">use_trial</span></code>: Toggle use of trial division</li>
<li><code class="docutils literal"><span class="pre">use_rho</span></code>: Toggle use of Pollard’s rho method</li>
<li><code class="docutils literal"><span class="pre">use_pm1</span></code>: Toggle use of Pollard’s p-1 method</li>
</ul>
</div></blockquote>
<p><code class="docutils literal"><span class="pre">factorint</span></code> also periodically checks if the remaining part is
a prime number or a perfect power, and in those cases stops.</p>
<p>If <code class="docutils literal"><span class="pre">verbose</span></code> is set to <code class="docutils literal"><span class="pre">True</span></code>, detailed progress is printed.</p>
</dd></dl>

<dl class="function">
<dt id="sympy.ntheory.factor_.primefactors">
<code class="descclassname">sympy.ntheory.factor_.</code><code class="descname">primefactors</code><span class="sig-paren">(</span><em>n</em>, <em>limit=None</em>, <em>verbose=False</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sympy/ntheory/factor_.html#primefactors"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#sympy.ntheory.factor_.primefactors" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a sorted list of n’s prime factors, ignoring multiplicity
and any composite factor that remains if the limit was set too low
for complete factorization. Unlike factorint(), primefactors() does
not return -1 or 0.</p>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<p class="last"><a class="reference internal" href="#sympy.ntheory.factor_.divisors" title="sympy.ntheory.factor_.divisors"><code class="xref py py-obj docutils literal"><span class="pre">divisors</span></code></a></p>
</div>
<p class="rubric">Examples</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sympy.ntheory</span> <span class="k">import</span> <span class="n">primefactors</span><span class="p">,</span> <span class="n">factorint</span><span class="p">,</span> <span class="n">isprime</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">primefactors</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span>
<span class="go">[2, 3]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">primefactors</span><span class="p">(</span><span class="o">-</span><span class="mi">5</span><span class="p">)</span>
<span class="go">[5]</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">sorted</span><span class="p">(</span><span class="n">factorint</span><span class="p">(</span><span class="mi">123456</span><span class="p">)</span><span class="o">.</span><span class="n">items</span><span class="p">())</span>
<span class="go">[(2, 6), (3, 1), (643, 1)]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">primefactors</span><span class="p">(</span><span class="mi">123456</span><span class="p">)</span>
<span class="go">[2, 3, 643]</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">sorted</span><span class="p">(</span><span class="n">factorint</span><span class="p">(</span><span class="mi">10000000001</span><span class="p">,</span> <span class="n">limit</span><span class="o">=</span><span class="mi">200</span><span class="p">)</span><span class="o">.</span><span class="n">items</span><span class="p">())</span>
<span class="go">[(101, 1), (99009901, 1)]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">isprime</span><span class="p">(</span><span class="mi">99009901</span><span class="p">)</span>
<span class="go">False</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">primefactors</span><span class="p">(</span><span class="mi">10000000001</span><span class="p">,</span> <span class="n">limit</span><span class="o">=</span><span class="mi">300</span><span class="p">)</span>
<span class="go">[101]</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="sympy.ntheory.factor_.divisors">
<code class="descclassname">sympy.ntheory.factor_.</code><code class="descname">divisors</code><span class="sig-paren">(</span><em>n</em>, <em>generator=False</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sympy/ntheory/factor_.html#divisors"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#sympy.ntheory.factor_.divisors" title="Permalink to this definition">¶</a></dt>
<dd><p>Return all divisors of n sorted from 1..n by default.
If generator is <code class="docutils literal"><span class="pre">True</span></code> an unordered generator is returned.</p>
<p>The number of divisors of n can be quite large if there are many
prime factors (counting repeated factors). If only the number of
factors is desired use divisor_count(n).</p>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<p class="last"><a class="reference internal" href="#sympy.ntheory.factor_.primefactors" title="sympy.ntheory.factor_.primefactors"><code class="xref py py-obj docutils literal"><span class="pre">primefactors</span></code></a>, <a class="reference internal" href="#sympy.ntheory.factor_.factorint" title="sympy.ntheory.factor_.factorint"><code class="xref py py-obj docutils literal"><span class="pre">factorint</span></code></a>, <a class="reference internal" href="#sympy.ntheory.factor_.divisor_count" title="sympy.ntheory.factor_.divisor_count"><code class="xref py py-obj docutils literal"><span class="pre">divisor_count</span></code></a></p>
</div>
<p class="rubric">Examples</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sympy</span> <span class="k">import</span> <span class="n">divisors</span><span class="p">,</span> <span class="n">divisor_count</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">divisors</span><span class="p">(</span><span class="mi">24</span><span class="p">)</span>
<span class="go">[1, 2, 3, 4, 6, 8, 12, 24]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">divisor_count</span><span class="p">(</span><span class="mi">24</span><span class="p">)</span>
<span class="go">8</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">list</span><span class="p">(</span><span class="n">divisors</span><span class="p">(</span><span class="mi">120</span><span class="p">,</span> <span class="n">generator</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span>
<span class="go">[1, 2, 4, 8, 3, 6, 12, 24, 5, 10, 20, 40, 15, 30, 60, 120]</span>
</pre></div>
</div>
<p>This is a slightly modified version of Tim Peters referenced at:
<a class="reference external" href="http://stackoverflow.com/questions/1010381/python-factorization">http://stackoverflow.com/questions/1010381/python-factorization</a></p>
</dd></dl>

<dl class="function">
<dt id="sympy.ntheory.factor_.divisor_count">
<code class="descclassname">sympy.ntheory.factor_.</code><code class="descname">divisor_count</code><span class="sig-paren">(</span><em>n</em>, <em>modulus=1</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sympy/ntheory/factor_.html#divisor_count"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#sympy.ntheory.factor_.divisor_count" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the number of divisors of <code class="docutils literal"><span class="pre">n</span></code>. If <code class="docutils literal"><span class="pre">modulus</span></code> is not 1 then only
those that are divisible by <code class="docutils literal"><span class="pre">modulus</span></code> are counted.</p>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<p class="last"><a class="reference internal" href="#sympy.ntheory.factor_.factorint" title="sympy.ntheory.factor_.factorint"><code class="xref py py-obj docutils literal"><span class="pre">factorint</span></code></a>, <a class="reference internal" href="#sympy.ntheory.factor_.divisors" title="sympy.ntheory.factor_.divisors"><code class="xref py py-obj docutils literal"><span class="pre">divisors</span></code></a>, <a class="reference internal" href="#sympy.ntheory.factor_.totient" title="sympy.ntheory.factor_.totient"><code class="xref py py-obj docutils literal"><span class="pre">totient</span></code></a></p>
</div>
<p class="rubric">References</p>
<ul class="simple">
<li><a class="reference external" href="http://www.mayer.dial.pipex.com/maths/formulae.htm">http://www.mayer.dial.pipex.com/maths/formulae.htm</a></li>
</ul>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sympy</span> <span class="k">import</span> <span class="n">divisor_count</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">divisor_count</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span>
<span class="go">4</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="sympy.ntheory.factor_.udivisors">
<code class="descclassname">sympy.ntheory.factor_.</code><code class="descname">udivisors</code><span class="sig-paren">(</span><em>n</em>, <em>generator=False</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sympy/ntheory/factor_.html#udivisors"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#sympy.ntheory.factor_.udivisors" title="Permalink to this definition">¶</a></dt>
<dd><p>Return all unitary divisors of n sorted from 1..n by default.
If generator is <code class="docutils literal"><span class="pre">True</span></code> an unordered generator is returned.</p>
<p>The number of unitary divisors of n can be quite large if there are many
prime factors. If only the number of unitary divisors is desired use
udivisor_count(n).</p>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<p class="last"><a class="reference internal" href="#sympy.ntheory.factor_.primefactors" title="sympy.ntheory.factor_.primefactors"><code class="xref py py-obj docutils literal"><span class="pre">primefactors</span></code></a>, <a class="reference internal" href="#sympy.ntheory.factor_.factorint" title="sympy.ntheory.factor_.factorint"><code class="xref py py-obj docutils literal"><span class="pre">factorint</span></code></a>, <a class="reference internal" href="#sympy.ntheory.factor_.divisors" title="sympy.ntheory.factor_.divisors"><code class="xref py py-obj docutils literal"><span class="pre">divisors</span></code></a>, <a class="reference internal" href="#sympy.ntheory.factor_.divisor_count" title="sympy.ntheory.factor_.divisor_count"><code class="xref py py-obj docutils literal"><span class="pre">divisor_count</span></code></a>, <a class="reference internal" href="#sympy.ntheory.factor_.udivisor_count" title="sympy.ntheory.factor_.udivisor_count"><code class="xref py py-obj docutils literal"><span class="pre">udivisor_count</span></code></a></p>
</div>
<p class="rubric">References</p>
<ul class="simple">
<li><a class="reference external" href="http://en.wikipedia.org/wiki/Unitary_divisor">http://en.wikipedia.org/wiki/Unitary_divisor</a></li>
<li><a class="reference external" href="http://mathworld.wolfram.com/UnitaryDivisor.html">http://mathworld.wolfram.com/UnitaryDivisor.html</a></li>
</ul>
<p class="rubric">Examples</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sympy.ntheory.factor_</span> <span class="k">import</span> <span class="n">udivisors</span><span class="p">,</span> <span class="n">udivisor_count</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">udivisors</span><span class="p">(</span><span class="mi">15</span><span class="p">)</span>
<span class="go">[1, 3, 5, 15]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">udivisor_count</span><span class="p">(</span><span class="mi">15</span><span class="p">)</span>
<span class="go">4</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">sorted</span><span class="p">(</span><span class="n">udivisors</span><span class="p">(</span><span class="mi">120</span><span class="p">,</span> <span class="n">generator</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span>
<span class="go">[1, 3, 5, 8, 15, 24, 40, 120]</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="sympy.ntheory.factor_.udivisor_count">
<code class="descclassname">sympy.ntheory.factor_.</code><code class="descname">udivisor_count</code><span class="sig-paren">(</span><em>n</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sympy/ntheory/factor_.html#udivisor_count"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#sympy.ntheory.factor_.udivisor_count" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the number of unitary divisors of <code class="docutils literal"><span class="pre">n</span></code>.</p>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<p class="last"><a class="reference internal" href="#sympy.ntheory.factor_.factorint" title="sympy.ntheory.factor_.factorint"><code class="xref py py-obj docutils literal"><span class="pre">factorint</span></code></a>, <a class="reference internal" href="#sympy.ntheory.factor_.divisors" title="sympy.ntheory.factor_.divisors"><code class="xref py py-obj docutils literal"><span class="pre">divisors</span></code></a>, <a class="reference internal" href="#sympy.ntheory.factor_.udivisors" title="sympy.ntheory.factor_.udivisors"><code class="xref py py-obj docutils literal"><span class="pre">udivisors</span></code></a>, <a class="reference internal" href="#sympy.ntheory.factor_.divisor_count" title="sympy.ntheory.factor_.divisor_count"><code class="xref py py-obj docutils literal"><span class="pre">divisor_count</span></code></a>, <a class="reference internal" href="#sympy.ntheory.factor_.totient" title="sympy.ntheory.factor_.totient"><code class="xref py py-obj docutils literal"><span class="pre">totient</span></code></a></p>
</div>
<p class="rubric">References</p>
<ul class="simple">
<li><a class="reference external" href="http://mathworld.wolfram.com/UnitaryDivisorFunction.html">http://mathworld.wolfram.com/UnitaryDivisorFunction.html</a></li>
</ul>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sympy.ntheory.factor_</span> <span class="k">import</span> <span class="n">udivisor_count</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">udivisor_count</span><span class="p">(</span><span class="mi">120</span><span class="p">)</span>
<span class="go">8</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="sympy.ntheory.factor_.antidivisors">
<code class="descclassname">sympy.ntheory.factor_.</code><code class="descname">antidivisors</code><span class="sig-paren">(</span><em>n</em>, <em>generator=False</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sympy/ntheory/factor_.html#antidivisors"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#sympy.ntheory.factor_.antidivisors" title="Permalink to this definition">¶</a></dt>
<dd><p>Return all antidivisors of n sorted from 1..n by default.</p>
<p>Antidivisors <a class="reference internal" href="#r395" id="id1">[R395]</a> of n are numbers that do not divide n by the largest
possible margin.  If generator is True an unordered generator is returned.</p>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<p class="last"><a class="reference internal" href="#sympy.ntheory.factor_.primefactors" title="sympy.ntheory.factor_.primefactors"><code class="xref py py-obj docutils literal"><span class="pre">primefactors</span></code></a>, <a class="reference internal" href="#sympy.ntheory.factor_.factorint" title="sympy.ntheory.factor_.factorint"><code class="xref py py-obj docutils literal"><span class="pre">factorint</span></code></a>, <a class="reference internal" href="#sympy.ntheory.factor_.divisors" title="sympy.ntheory.factor_.divisors"><code class="xref py py-obj docutils literal"><span class="pre">divisors</span></code></a>, <a class="reference internal" href="#sympy.ntheory.factor_.divisor_count" title="sympy.ntheory.factor_.divisor_count"><code class="xref py py-obj docutils literal"><span class="pre">divisor_count</span></code></a>, <a class="reference internal" href="#sympy.ntheory.factor_.antidivisor_count" title="sympy.ntheory.factor_.antidivisor_count"><code class="xref py py-obj docutils literal"><span class="pre">antidivisor_count</span></code></a></p>
</div>
<p class="rubric">References</p>
<table class="docutils citation" frame="void" id="r395" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label">[R395]</td><td><em>(<a class="fn-backref" href="#id1">1</a>, <a class="fn-backref" href="#id2">2</a>)</em> definition is described in <a class="reference external" href="http://oeis.org/A066272/a066272a.html">http://oeis.org/A066272/a066272a.html</a></td></tr>
</tbody>
</table>
<p class="rubric">Examples</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sympy.ntheory.factor_</span> <span class="k">import</span> <span class="n">antidivisors</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">antidivisors</span><span class="p">(</span><span class="mi">24</span><span class="p">)</span>
<span class="go">[7, 16]</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">sorted</span><span class="p">(</span><span class="n">antidivisors</span><span class="p">(</span><span class="mi">128</span><span class="p">,</span> <span class="n">generator</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span>
<span class="go">[3, 5, 15, 17, 51, 85]</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="sympy.ntheory.factor_.antidivisor_count">
<code class="descclassname">sympy.ntheory.factor_.</code><code class="descname">antidivisor_count</code><span class="sig-paren">(</span><em>n</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sympy/ntheory/factor_.html#antidivisor_count"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#sympy.ntheory.factor_.antidivisor_count" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the number of antidivisors <a class="reference internal" href="#r396" id="id3">[R396]</a> of <code class="docutils literal"><span class="pre">n</span></code>.</p>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<p class="last"><a class="reference internal" href="#sympy.ntheory.factor_.factorint" title="sympy.ntheory.factor_.factorint"><code class="xref py py-obj docutils literal"><span class="pre">factorint</span></code></a>, <a class="reference internal" href="#sympy.ntheory.factor_.divisors" title="sympy.ntheory.factor_.divisors"><code class="xref py py-obj docutils literal"><span class="pre">divisors</span></code></a>, <a class="reference internal" href="#sympy.ntheory.factor_.antidivisors" title="sympy.ntheory.factor_.antidivisors"><code class="xref py py-obj docutils literal"><span class="pre">antidivisors</span></code></a>, <a class="reference internal" href="#sympy.ntheory.factor_.divisor_count" title="sympy.ntheory.factor_.divisor_count"><code class="xref py py-obj docutils literal"><span class="pre">divisor_count</span></code></a>, <a class="reference internal" href="#sympy.ntheory.factor_.totient" title="sympy.ntheory.factor_.totient"><code class="xref py py-obj docutils literal"><span class="pre">totient</span></code></a></p>
</div>
<p class="rubric">References</p>
<table class="docutils citation" frame="void" id="r396" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label">[R396]</td><td><em>(<a class="fn-backref" href="#id3">1</a>, <a class="fn-backref" href="#id4">2</a>)</em> formula from <a class="reference external" href="https://oeis.org/A066272">https://oeis.org/A066272</a></td></tr>
</tbody>
</table>
<p class="rubric">Examples</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sympy.ntheory.factor_</span> <span class="k">import</span> <span class="n">antidivisor_count</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">antidivisor_count</span><span class="p">(</span><span class="mi">13</span><span class="p">)</span>
<span class="go">4</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">antidivisor_count</span><span class="p">(</span><span class="mi">27</span><span class="p">)</span>
<span class="go">5</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="sympy.ntheory.factor_.totient">
<code class="descclassname">sympy.ntheory.factor_.</code><code class="descname">totient</code><span class="sig-paren">(</span><em>n</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sympy/ntheory/factor_.html#totient"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#sympy.ntheory.factor_.totient" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate the Euler totient function phi(n)</p>
<p><code class="docutils literal"><span class="pre">totient(n)</span></code> or <span class="math">\(\phi(n)\)</span> is the number of positive integers <span class="math">\(\leq\)</span> n
that are relatively prime to n.</p>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<p class="last"><a class="reference internal" href="#sympy.ntheory.factor_.divisor_count" title="sympy.ntheory.factor_.divisor_count"><code class="xref py py-obj docutils literal"><span class="pre">divisor_count</span></code></a></p>
</div>
<p class="rubric">References</p>
<table class="docutils citation" frame="void" id="r397" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id5">[R397]</a></td><td><a class="reference external" href="https://en.wikipedia.org/wiki/Euler%27s_totient_function">https://en.wikipedia.org/wiki/Euler%27s_totient_function</a></td></tr>
</tbody>
</table>
<table class="docutils citation" frame="void" id="r398" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id6">[R398]</a></td><td><a class="reference external" href="http://mathworld.wolfram.com/TotientFunction.html">http://mathworld.wolfram.com/TotientFunction.html</a></td></tr>
</tbody>
</table>
<p class="rubric">Examples</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sympy.ntheory</span> <span class="k">import</span> <span class="n">totient</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">totient</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="go">1</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">totient</span><span class="p">(</span><span class="mi">25</span><span class="p">)</span>
<span class="go">20</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="sympy.ntheory.factor_.reduced_totient">
<code class="descclassname">sympy.ntheory.factor_.</code><code class="descname">reduced_totient</code><span class="sig-paren">(</span><em>n</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sympy/ntheory/factor_.html#reduced_totient"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#sympy.ntheory.factor_.reduced_totient" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate the Carmichael reduced totient function lambda(n)</p>
<p><code class="docutils literal"><span class="pre">reduced_totient(n)</span></code> or <span class="math">\(\lambda(n)\)</span> is the smallest m &gt; 0 such that
<span class="math">\(k^m \equiv 1 \mod n\)</span> for all k relatively prime to n.</p>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<p class="last"><a class="reference internal" href="#sympy.ntheory.factor_.totient" title="sympy.ntheory.factor_.totient"><code class="xref py py-obj docutils literal"><span class="pre">totient</span></code></a></p>
</div>
<p class="rubric">References</p>
<table class="docutils citation" frame="void" id="r399" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id7">[R399]</a></td><td><a class="reference external" href="https://en.wikipedia.org/wiki/Carmichael_function">https://en.wikipedia.org/wiki/Carmichael_function</a></td></tr>
</tbody>
</table>
<table class="docutils citation" frame="void" id="r400" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id8">[R400]</a></td><td><a class="reference external" href="http://mathworld.wolfram.com/CarmichaelFunction.html">http://mathworld.wolfram.com/CarmichaelFunction.html</a></td></tr>
</tbody>
</table>
<p class="rubric">Examples</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sympy.ntheory</span> <span class="k">import</span> <span class="n">reduced_totient</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">reduced_totient</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="go">1</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">reduced_totient</span><span class="p">(</span><span class="mi">8</span><span class="p">)</span>
<span class="go">2</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">reduced_totient</span><span class="p">(</span><span class="mi">30</span><span class="p">)</span>
<span class="go">4</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="sympy.ntheory.factor_.divisor_sigma">
<code class="descclassname">sympy.ntheory.factor_.</code><code class="descname">divisor_sigma</code><span class="sig-paren">(</span><em>n</em>, <em>k=1</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sympy/ntheory/factor_.html#divisor_sigma"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#sympy.ntheory.factor_.divisor_sigma" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate the divisor function <span class="math">\(\sigma_k(n)\)</span> for positive integer n</p>
<p><code class="docutils literal"><span class="pre">divisor_sigma(n,</span> <span class="pre">k)</span></code> is equal to <code class="docutils literal"><span class="pre">sum([x**k</span> <span class="pre">for</span> <span class="pre">x</span> <span class="pre">in</span> <span class="pre">divisors(n)])</span></code></p>
<p>If n’s prime factorization is:</p>
<div class="math">
\[n = \prod_{i=1}^\omega p_i^{m_i},\]</div>
<p>then</p>
<div class="math">
\[\sigma_k(n) = \prod_{i=1}^\omega (1+p_i^k+p_i^{2k}+\cdots
+ p_i^{m_ik}).\]</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>k</strong> : power of divisors in the sum</p>
<blockquote class="last">
<div><p>for k = 0, 1:
<code class="docutils literal"><span class="pre">divisor_sigma(n,</span> <span class="pre">0)</span></code> is equal to <code class="docutils literal"><span class="pre">divisor_count(n)</span></code>
<code class="docutils literal"><span class="pre">divisor_sigma(n,</span> <span class="pre">1)</span></code> is equal to <code class="docutils literal"><span class="pre">sum(divisors(n))</span></code></p>
<p>Default for k is 1.</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<p class="last"><a class="reference internal" href="#sympy.ntheory.factor_.divisor_count" title="sympy.ntheory.factor_.divisor_count"><code class="xref py py-obj docutils literal"><span class="pre">divisor_count</span></code></a>, <a class="reference internal" href="#sympy.ntheory.factor_.totient" title="sympy.ntheory.factor_.totient"><code class="xref py py-obj docutils literal"><span class="pre">totient</span></code></a>, <a class="reference internal" href="#sympy.ntheory.factor_.divisors" title="sympy.ntheory.factor_.divisors"><code class="xref py py-obj docutils literal"><span class="pre">divisors</span></code></a>, <a class="reference internal" href="#sympy.ntheory.factor_.factorint" title="sympy.ntheory.factor_.factorint"><code class="xref py py-obj docutils literal"><span class="pre">factorint</span></code></a></p>
</div>
<p class="rubric">References</p>
<table class="docutils citation" frame="void" id="r401" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id9">[R401]</a></td><td><a class="reference external" href="http://en.wikipedia.org/wiki/Divisor_function">http://en.wikipedia.org/wiki/Divisor_function</a></td></tr>
</tbody>
</table>
<p class="rubric">Examples</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sympy.ntheory</span> <span class="k">import</span> <span class="n">divisor_sigma</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">divisor_sigma</span><span class="p">(</span><span class="mi">18</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
<span class="go">6</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">divisor_sigma</span><span class="p">(</span><span class="mi">39</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="go">56</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">divisor_sigma</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="go">210</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">divisor_sigma</span><span class="p">(</span><span class="mi">37</span><span class="p">)</span>
<span class="go">38</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="sympy.ntheory.factor_.udivisor_sigma">
<code class="descclassname">sympy.ntheory.factor_.</code><code class="descname">udivisor_sigma</code><span class="sig-paren">(</span><em>n</em>, <em>k=1</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sympy/ntheory/factor_.html#udivisor_sigma"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#sympy.ntheory.factor_.udivisor_sigma" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate the unitary divisor function <span class="math">\(\sigma_k^*(n)\)</span> for positive integer n</p>
<p><code class="docutils literal"><span class="pre">udivisor_sigma(n,</span> <span class="pre">k)</span></code> is equal to <code class="docutils literal"><span class="pre">sum([x**k</span> <span class="pre">for</span> <span class="pre">x</span> <span class="pre">in</span> <span class="pre">udivisors(n)])</span></code></p>
<p>If n’s prime factorization is:</p>
<div class="math">
\[n = \prod_{i=1}^\omega p_i^{m_i},\]</div>
<p>then</p>
<div class="math">
\[\sigma_k^*(n) = \prod_{i=1}^\omega (1+ p_i^{m_ik}).\]</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>k</strong> : power of divisors in the sum</p>
<blockquote class="last">
<div><p>for k = 0, 1:
<code class="docutils literal"><span class="pre">udivisor_sigma(n,</span> <span class="pre">0)</span></code> is equal to <code class="docutils literal"><span class="pre">udivisor_count(n)</span></code>
<code class="docutils literal"><span class="pre">udivisor_sigma(n,</span> <span class="pre">1)</span></code> is equal to <code class="docutils literal"><span class="pre">sum(udivisors(n))</span></code></p>
<p>Default for k is 1.</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<p class="last"><a class="reference internal" href="#sympy.ntheory.factor_.divisor_count" title="sympy.ntheory.factor_.divisor_count"><code class="xref py py-obj docutils literal"><span class="pre">divisor_count</span></code></a>, <a class="reference internal" href="#sympy.ntheory.factor_.totient" title="sympy.ntheory.factor_.totient"><code class="xref py py-obj docutils literal"><span class="pre">totient</span></code></a>, <a class="reference internal" href="#sympy.ntheory.factor_.divisors" title="sympy.ntheory.factor_.divisors"><code class="xref py py-obj docutils literal"><span class="pre">divisors</span></code></a>, <a class="reference internal" href="#sympy.ntheory.factor_.udivisors" title="sympy.ntheory.factor_.udivisors"><code class="xref py py-obj docutils literal"><span class="pre">udivisors</span></code></a>, <a class="reference internal" href="#sympy.ntheory.factor_.udivisor_count" title="sympy.ntheory.factor_.udivisor_count"><code class="xref py py-obj docutils literal"><span class="pre">udivisor_count</span></code></a>, <a class="reference internal" href="#sympy.ntheory.factor_.divisor_sigma" title="sympy.ntheory.factor_.divisor_sigma"><code class="xref py py-obj docutils literal"><span class="pre">divisor_sigma</span></code></a>, <a class="reference internal" href="#sympy.ntheory.factor_.factorint" title="sympy.ntheory.factor_.factorint"><code class="xref py py-obj docutils literal"><span class="pre">factorint</span></code></a></p>
</div>
<p class="rubric">References</p>
<table class="docutils citation" frame="void" id="r402" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id10">[R402]</a></td><td><a class="reference external" href="http://mathworld.wolfram.com/UnitaryDivisorFunction.html">http://mathworld.wolfram.com/UnitaryDivisorFunction.html</a></td></tr>
</tbody>
</table>
<p class="rubric">Examples</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sympy.ntheory.factor_</span> <span class="k">import</span> <span class="n">udivisor_sigma</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">udivisor_sigma</span><span class="p">(</span><span class="mi">18</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
<span class="go">4</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">udivisor_sigma</span><span class="p">(</span><span class="mi">74</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="go">114</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">udivisor_sigma</span><span class="p">(</span><span class="mi">36</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
<span class="go">47450</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">udivisor_sigma</span><span class="p">(</span><span class="mi">111</span><span class="p">)</span>
<span class="go">152</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="sympy.ntheory.factor_.core">
<code class="descclassname">sympy.ntheory.factor_.</code><code class="descname">core</code><span class="sig-paren">(</span><em>n</em>, <em>t=2</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sympy/ntheory/factor_.html#core"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#sympy.ntheory.factor_.core" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate core(n,t) = <span class="math">\(core_t(n)\)</span> of a positive integer n</p>
<p><code class="docutils literal"><span class="pre">core_2(n)</span></code> is equal to the squarefree part of n</p>
<p>If n’s prime factorization is:</p>
<div class="math">
\[n = \prod_{i=1}^\omega p_i^{m_i},\]</div>
<p>then</p>
<div class="math">
\[core_t(n) = \prod_{i=1}^\omega p_i^{m_i \mod t}.\]</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>t</strong> : core(n,t) calculates the t-th power free part of n</p>
<blockquote class="last">
<div><p><code class="docutils literal"><span class="pre">core(n,</span> <span class="pre">2)</span></code> is the squarefree part of <code class="docutils literal"><span class="pre">n</span></code>
<code class="docutils literal"><span class="pre">core(n,</span> <span class="pre">3)</span></code> is the cubefree part of <code class="docutils literal"><span class="pre">n</span></code></p>
<p>Default for t is 2.</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<p class="last"><a class="reference internal" href="#sympy.ntheory.factor_.factorint" title="sympy.ntheory.factor_.factorint"><code class="xref py py-obj docutils literal"><span class="pre">factorint</span></code></a>, <a class="reference internal" href="solvers/diophantine.html#sympy.solvers.diophantine.square_factor" title="sympy.solvers.diophantine.square_factor"><code class="xref py py-obj docutils literal"><span class="pre">sympy.solvers.diophantine.square_factor</span></code></a></p>
</div>
<p class="rubric">References</p>
<table class="docutils citation" frame="void" id="r403" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id11">[R403]</a></td><td><a class="reference external" href="http://en.wikipedia.org/wiki/Square-free_integer#Squarefree_core">http://en.wikipedia.org/wiki/Square-free_integer#Squarefree_core</a></td></tr>
</tbody>
</table>
<p class="rubric">Examples</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sympy.ntheory.factor_</span> <span class="k">import</span> <span class="n">core</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">core</span><span class="p">(</span><span class="mi">24</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="go">6</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">core</span><span class="p">(</span><span class="mi">9424</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
<span class="go">1178</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">core</span><span class="p">(</span><span class="mi">379238</span><span class="p">)</span>
<span class="go">379238</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">core</span><span class="p">(</span><span class="mi">15</span><span class="o">**</span><span class="mi">11</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
<span class="go">15</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="sympy.ntheory.factor_.digits">
<code class="descclassname">sympy.ntheory.factor_.</code><code class="descname">digits</code><span class="sig-paren">(</span><em>n</em>, <em>b=10</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sympy/ntheory/factor_.html#digits"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#sympy.ntheory.factor_.digits" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a list of the digits of n in base b. The first element in the list
is b (or -b if n is negative).</p>
<p class="rubric">Examples</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sympy.ntheory.factor_</span> <span class="k">import</span> <span class="n">digits</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">digits</span><span class="p">(</span><span class="mi">35</span><span class="p">)</span>
<span class="go">[10, 3, 5]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">digits</span><span class="p">(</span><span class="mi">27</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="go">[2, 1, 1, 0, 1, 1]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">digits</span><span class="p">(</span><span class="mi">65536</span><span class="p">,</span> <span class="mi">256</span><span class="p">)</span>
<span class="go">[256, 1, 0, 0]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">digits</span><span class="p">(</span><span class="o">-</span><span class="mi">3958</span><span class="p">,</span> <span class="mi">27</span><span class="p">)</span>
<span class="go">[-27, 5, 11, 16]</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="sympy.ntheory.factor_.primenu">
<code class="descclassname">sympy.ntheory.factor_.</code><code class="descname">primenu</code><span class="sig-paren">(</span><em>n</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sympy/ntheory/factor_.html#primenu"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#sympy.ntheory.factor_.primenu" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate the number of distinct prime factors for a positive integer n.</p>
<p>If n’s prime factorization is:</p>
<div class="math">
\[n = \prod_{i=1}^k p_i^{m_i},\]</div>
<p>then <code class="docutils literal"><span class="pre">primenu(n)</span></code> or <span class="math">\(\nu(n)\)</span> is:</p>
<div class="math">
\[\nu(n) = k.\]</div>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<p class="last"><a class="reference internal" href="#sympy.ntheory.factor_.factorint" title="sympy.ntheory.factor_.factorint"><code class="xref py py-obj docutils literal"><span class="pre">factorint</span></code></a></p>
</div>
<p class="rubric">References</p>
<table class="docutils citation" frame="void" id="r404" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id12">[R404]</a></td><td><a class="reference external" href="http://mathworld.wolfram.com/PrimeFactor.html">http://mathworld.wolfram.com/PrimeFactor.html</a></td></tr>
</tbody>
</table>
<p class="rubric">Examples</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sympy.ntheory.factor_</span> <span class="k">import</span> <span class="n">primenu</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">primenu</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="go">0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">primenu</span><span class="p">(</span><span class="mi">30</span><span class="p">)</span>
<span class="go">3</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="sympy.ntheory.factor_.primeomega">
<code class="descclassname">sympy.ntheory.factor_.</code><code class="descname">primeomega</code><span class="sig-paren">(</span><em>n</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sympy/ntheory/factor_.html#primeomega"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#sympy.ntheory.factor_.primeomega" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate the number of prime factors counting multiplicities for a
positive integer n.</p>
<p>If n’s prime factorization is:</p>
<div class="math">
\[n = \prod_{i=1}^k p_i^{m_i},\]</div>
<p>then <code class="docutils literal"><span class="pre">primeomega(n)</span></code>  or <span class="math">\(\Omega(n)\)</span> is:</p>
<div class="math">
\[\Omega(n) = \sum_{i=1}^k m_i.\]</div>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<p class="last"><a class="reference internal" href="#sympy.ntheory.factor_.factorint" title="sympy.ntheory.factor_.factorint"><code class="xref py py-obj docutils literal"><span class="pre">factorint</span></code></a></p>
</div>
<p class="rubric">References</p>
<table class="docutils citation" frame="void" id="r405" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id13">[R405]</a></td><td><a class="reference external" href="http://mathworld.wolfram.com/PrimeFactor.html">http://mathworld.wolfram.com/PrimeFactor.html</a></td></tr>
</tbody>
</table>
<p class="rubric">Examples</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sympy.ntheory.factor_</span> <span class="k">import</span> <span class="n">primeomega</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">primeomega</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="go">0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">primeomega</span><span class="p">(</span><span class="mi">20</span><span class="p">)</span>
<span class="go">3</span>
</pre></div>
</div>
</dd></dl>

<span class="target" id="module-sympy.ntheory.modular"></span><dl class="function">
<dt id="sympy.ntheory.modular.symmetric_residue">
<code class="descclassname">sympy.ntheory.modular.</code><code class="descname">symmetric_residue</code><span class="sig-paren">(</span><em>a</em>, <em>m</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sympy/ntheory/modular.html#symmetric_residue"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#sympy.ntheory.modular.symmetric_residue" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the residual mod m such that it is within half of the modulus.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sympy.ntheory.modular</span> <span class="k">import</span> <span class="n">symmetric_residue</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">symmetric_residue</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">6</span><span class="p">)</span>
<span class="go">1</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">symmetric_residue</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">6</span><span class="p">)</span>
<span class="go">-2</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="sympy.ntheory.modular.crt">
<code class="descclassname">sympy.ntheory.modular.</code><code class="descname">crt</code><span class="sig-paren">(</span><em>m</em>, <em>v</em>, <em>symmetric=False</em>, <em>check=True</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sympy/ntheory/modular.html#crt"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#sympy.ntheory.modular.crt" title="Permalink to this definition">¶</a></dt>
<dd><p>Chinese Remainder Theorem.</p>
<p>The moduli in m are assumed to be pairwise coprime.  The output
is then an integer f, such that f = v_i mod m_i for each pair out
of v and m. If <code class="docutils literal"><span class="pre">symmetric</span></code> is False a positive integer will be
returned, else |f| will be less than or equal to the LCM of the
moduli, and thus f may be negative.</p>
<p>If the moduli are not co-prime the correct result will be returned
if/when the test of the result is found to be incorrect. This result
will be None if there is no solution.</p>
<p>The keyword <code class="docutils literal"><span class="pre">check</span></code> can be set to False if it is known that the moduli
are coprime.</p>
<p>As an example consider a set of residues <code class="docutils literal"><span class="pre">U</span> <span class="pre">=</span> <span class="pre">[49,</span> <span class="pre">76,</span> <span class="pre">65]</span></code>
and a set of moduli <code class="docutils literal"><span class="pre">M</span> <span class="pre">=</span> <span class="pre">[99,</span> <span class="pre">97,</span> <span class="pre">95]</span></code>. Then we have:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sympy.ntheory.modular</span> <span class="k">import</span> <span class="n">crt</span><span class="p">,</span> <span class="n">solve_congruence</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">crt</span><span class="p">([</span><span class="mi">99</span><span class="p">,</span> <span class="mi">97</span><span class="p">,</span> <span class="mi">95</span><span class="p">],</span> <span class="p">[</span><span class="mi">49</span><span class="p">,</span> <span class="mi">76</span><span class="p">,</span> <span class="mi">65</span><span class="p">])</span>
<span class="go">(639985, 912285)</span>
</pre></div>
</div>
<p>This is the correct result because:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="p">[</span><span class="mi">639985</span> <span class="o">%</span> <span class="n">m</span> <span class="k">for</span> <span class="n">m</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">99</span><span class="p">,</span> <span class="mi">97</span><span class="p">,</span> <span class="mi">95</span><span class="p">]]</span>
<span class="go">[49, 76, 65]</span>
</pre></div>
</div>
<p>If the moduli are not co-prime, you may receive an incorrect result
if you use <code class="docutils literal"><span class="pre">check=False</span></code>:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">crt</span><span class="p">([</span><span class="mi">12</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">17</span><span class="p">],</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="n">check</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="go">(954, 1224)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">[</span><span class="mi">954</span> <span class="o">%</span> <span class="n">m</span> <span class="k">for</span> <span class="n">m</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">12</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">17</span><span class="p">]]</span>
<span class="go">[6, 0, 2]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">crt</span><span class="p">([</span><span class="mi">12</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">17</span><span class="p">],</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">2</span><span class="p">])</span> <span class="ow">is</span> <span class="kc">None</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">crt</span><span class="p">([</span><span class="mi">3</span><span class="p">,</span> <span class="mi">6</span><span class="p">],</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">5</span><span class="p">])</span>
<span class="go">(5, 6)</span>
</pre></div>
</div>
<p>Note: the order of gf_crt’s arguments is reversed relative to crt,
and that solve_congruence takes residue, modulus pairs.</p>
<p>Programmer’s note: rather than checking that all pairs of moduli share
no GCD (an O(n**2) test) and rather than factoring all moduli and seeing
that there is no factor in common, a check that the result gives the
indicated residuals is performed – an O(n) operation.</p>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<p><a class="reference internal" href="#sympy.ntheory.modular.solve_congruence" title="sympy.ntheory.modular.solve_congruence"><code class="xref py py-obj docutils literal"><span class="pre">solve_congruence</span></code></a></p>
<dl class="last docutils">
<dt><a class="reference internal" href="polys/internals.html#sympy.polys.galoistools.gf_crt" title="sympy.polys.galoistools.gf_crt"><code class="xref py py-obj docutils literal"><span class="pre">sympy.polys.galoistools.gf_crt</span></code></a></dt>
<dd>low level crt routine used by this routine</dd>
</dl>
</div>
</dd></dl>

<dl class="function">
<dt id="sympy.ntheory.modular.crt1">
<code class="descclassname">sympy.ntheory.modular.</code><code class="descname">crt1</code><span class="sig-paren">(</span><em>m</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sympy/ntheory/modular.html#crt1"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#sympy.ntheory.modular.crt1" title="Permalink to this definition">¶</a></dt>
<dd><p>First part of Chinese Remainder Theorem, for multiple application.</p>
<p class="rubric">Examples</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sympy.ntheory.modular</span> <span class="k">import</span> <span class="n">crt1</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">crt1</span><span class="p">([</span><span class="mi">18</span><span class="p">,</span> <span class="mi">42</span><span class="p">,</span> <span class="mi">6</span><span class="p">])</span>
<span class="go">(4536, [252, 108, 756], [0, 2, 0])</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="sympy.ntheory.modular.crt2">
<code class="descclassname">sympy.ntheory.modular.</code><code class="descname">crt2</code><span class="sig-paren">(</span><em>m</em>, <em>v</em>, <em>mm</em>, <em>e</em>, <em>s</em>, <em>symmetric=False</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sympy/ntheory/modular.html#crt2"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#sympy.ntheory.modular.crt2" title="Permalink to this definition">¶</a></dt>
<dd><p>Second part of Chinese Remainder Theorem, for multiple application.</p>
<p class="rubric">Examples</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sympy.ntheory.modular</span> <span class="k">import</span> <span class="n">crt1</span><span class="p">,</span> <span class="n">crt2</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mm</span><span class="p">,</span> <span class="n">e</span><span class="p">,</span> <span class="n">s</span> <span class="o">=</span> <span class="n">crt1</span><span class="p">([</span><span class="mi">18</span><span class="p">,</span> <span class="mi">42</span><span class="p">,</span> <span class="mi">6</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">crt2</span><span class="p">([</span><span class="mi">18</span><span class="p">,</span> <span class="mi">42</span><span class="p">,</span> <span class="mi">6</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">mm</span><span class="p">,</span> <span class="n">e</span><span class="p">,</span> <span class="n">s</span><span class="p">)</span>
<span class="go">(0, 4536)</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="sympy.ntheory.modular.solve_congruence">
<code class="descclassname">sympy.ntheory.modular.</code><code class="descname">solve_congruence</code><span class="sig-paren">(</span><em>*remainder_modulus_pairs</em>, <em>**hint</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sympy/ntheory/modular.html#solve_congruence"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#sympy.ntheory.modular.solve_congruence" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the integer <code class="docutils literal"><span class="pre">n</span></code> that has the residual <code class="docutils literal"><span class="pre">ai</span></code> when it is
divided by <code class="docutils literal"><span class="pre">mi</span></code> where the <code class="docutils literal"><span class="pre">ai</span></code> and <code class="docutils literal"><span class="pre">mi</span></code> are given as pairs to
this function: ((a1, m1), (a2, m2), …). If there is no solution,
return None. Otherwise return <code class="docutils literal"><span class="pre">n</span></code> and its modulus.</p>
<p>The <code class="docutils literal"><span class="pre">mi</span></code> values need not be co-prime. If it is known that the moduli are
not co-prime then the hint <code class="docutils literal"><span class="pre">check</span></code> can be set to False (default=True) and
the check for a quicker solution via crt() (valid when the moduli are
co-prime) will be skipped.</p>
<p>If the hint <code class="docutils literal"><span class="pre">symmetric</span></code> is True (default is False), the value of <code class="docutils literal"><span class="pre">n</span></code>
will be within 1/2 of the modulus, possibly negative.</p>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<dl class="last docutils">
<dt><a class="reference internal" href="#sympy.ntheory.modular.crt" title="sympy.ntheory.modular.crt"><code class="xref py py-obj docutils literal"><span class="pre">crt</span></code></a></dt>
<dd>high level routine implementing the Chinese Remainder Theorem</dd>
</dl>
</div>
<p class="rubric">Examples</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sympy.ntheory.modular</span> <span class="k">import</span> <span class="n">solve_congruence</span>
</pre></div>
</div>
<p>What number is 2 mod 3, 3 mod 5 and 2 mod 7?</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">solve_congruence</span><span class="p">((</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span> <span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">5</span><span class="p">),</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">7</span><span class="p">))</span>
<span class="go">(23, 105)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">[</span><span class="mi">23</span> <span class="o">%</span> <span class="n">m</span> <span class="k">for</span> <span class="n">m</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">7</span><span class="p">]]</span>
<span class="go">[2, 3, 2]</span>
</pre></div>
</div>
<p>If you prefer to work with all remainder in one list and
all moduli in another, send the arguments like this:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">solve_congruence</span><span class="p">(</span><span class="o">*</span><span class="nb">zip</span><span class="p">((</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">7</span><span class="p">)))</span>
<span class="go">(23, 105)</span>
</pre></div>
</div>
<p>The moduli need not be co-prime; in this case there may or
may not be a solution:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">solve_congruence</span><span class="p">((</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span> <span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span> <span class="ow">is</span> <span class="kc">None</span>
<span class="go">True</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">solve_congruence</span><span class="p">((</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span> <span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
<span class="go">(5, 6)</span>
</pre></div>
</div>
<p>The symmetric flag will make the result be within 1/2 of the modulus:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">solve_congruence</span><span class="p">((</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span> <span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">),</span> <span class="n">symmetric</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="go">(-1, 6)</span>
</pre></div>
</div>
</dd></dl>

<span class="target" id="module-sympy.ntheory.multinomial"></span><dl class="function">
<dt id="sympy.ntheory.multinomial.binomial_coefficients">
<code class="descclassname">sympy.ntheory.multinomial.</code><code class="descname">binomial_coefficients</code><span class="sig-paren">(</span><em>n</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sympy/ntheory/multinomial.html#binomial_coefficients"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#sympy.ntheory.multinomial.binomial_coefficients" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a dictionary containing pairs <span class="math">\({(k1,k2) : C_kn}\)</span> where
<span class="math">\(C_kn\)</span> are binomial coefficients and <span class="math">\(n=k1+k2\)</span>.
Examples
========</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sympy.ntheory</span> <span class="k">import</span> <span class="n">binomial_coefficients</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">binomial_coefficients</span><span class="p">(</span><span class="mi">9</span><span class="p">)</span>
<span class="go">{(0, 9): 1, (1, 8): 9, (2, 7): 36, (3, 6): 84,</span>
<span class="go"> (4, 5): 126, (5, 4): 126, (6, 3): 84, (7, 2): 36, (8, 1): 9, (9, 0): 1}</span>
</pre></div>
</div>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<p class="last"><a class="reference internal" href="#sympy.ntheory.multinomial.binomial_coefficients_list" title="sympy.ntheory.multinomial.binomial_coefficients_list"><code class="xref py py-obj docutils literal"><span class="pre">binomial_coefficients_list</span></code></a>, <a class="reference internal" href="#sympy.ntheory.multinomial.multinomial_coefficients" title="sympy.ntheory.multinomial.multinomial_coefficients"><code class="xref py py-obj docutils literal"><span class="pre">multinomial_coefficients</span></code></a></p>
</div>
</dd></dl>

<dl class="function">
<dt id="sympy.ntheory.multinomial.binomial_coefficients_list">
<code class="descclassname">sympy.ntheory.multinomial.</code><code class="descname">binomial_coefficients_list</code><span class="sig-paren">(</span><em>n</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sympy/ntheory/multinomial.html#binomial_coefficients_list"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#sympy.ntheory.multinomial.binomial_coefficients_list" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a list of binomial coefficients as rows of the Pascal’s
triangle.</p>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<p class="last"><a class="reference internal" href="#sympy.ntheory.multinomial.binomial_coefficients" title="sympy.ntheory.multinomial.binomial_coefficients"><code class="xref py py-obj docutils literal"><span class="pre">binomial_coefficients</span></code></a>, <a class="reference internal" href="#sympy.ntheory.multinomial.multinomial_coefficients" title="sympy.ntheory.multinomial.multinomial_coefficients"><code class="xref py py-obj docutils literal"><span class="pre">multinomial_coefficients</span></code></a></p>
</div>
<p class="rubric">Examples</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sympy.ntheory</span> <span class="k">import</span> <span class="n">binomial_coefficients_list</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">binomial_coefficients_list</span><span class="p">(</span><span class="mi">9</span><span class="p">)</span>
<span class="go">[1, 9, 36, 84, 126, 126, 84, 36, 9, 1]</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="sympy.ntheory.multinomial.multinomial_coefficients">
<code class="descclassname">sympy.ntheory.multinomial.</code><code class="descname">multinomial_coefficients</code><span class="sig-paren">(</span><em>m</em>, <em>n</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sympy/ntheory/multinomial.html#multinomial_coefficients"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#sympy.ntheory.multinomial.multinomial_coefficients" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a dictionary containing pairs <code class="docutils literal"><span class="pre">{(k1,k2,..,km)</span> <span class="pre">:</span> <span class="pre">C_kn}</span></code>
where <code class="docutils literal"><span class="pre">C_kn</span></code> are multinomial coefficients such that
<code class="docutils literal"><span class="pre">n=k1+k2+..+km</span></code>.</p>
<p>For example:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sympy.ntheory</span> <span class="k">import</span> <span class="n">multinomial_coefficients</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">multinomial_coefficients</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span> <span class="c1"># indirect doctest</span>
<span class="go">{(0, 5): 1, (1, 4): 5, (2, 3): 10, (3, 2): 10, (4, 1): 5, (5, 0): 1}</span>
</pre></div>
</div>
<p>The algorithm is based on the following result:</p>
<div class="math">
\[\binom{n}{k_1, \ldots, k_m} =
\frac{k_1 + 1}{n - k_1} \sum_{i=2}^m \binom{n}{k_1 + 1, \ldots, k_i - 1, \ldots}\]</div>
<p>Code contributed to Sage by Yann Laigle-Chapuy, copied with permission
of the author.</p>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<p class="last"><a class="reference internal" href="#sympy.ntheory.multinomial.binomial_coefficients_list" title="sympy.ntheory.multinomial.binomial_coefficients_list"><code class="xref py py-obj docutils literal"><span class="pre">binomial_coefficients_list</span></code></a>, <a class="reference internal" href="#sympy.ntheory.multinomial.binomial_coefficients" title="sympy.ntheory.multinomial.binomial_coefficients"><code class="xref py py-obj docutils literal"><span class="pre">binomial_coefficients</span></code></a></p>
</div>
</dd></dl>

<dl class="function">
<dt id="sympy.ntheory.multinomial.multinomial_coefficients_iterator">
<code class="descclassname">sympy.ntheory.multinomial.</code><code class="descname">multinomial_coefficients_iterator</code><span class="sig-paren">(</span><em>m</em>, <em>n</em>, <em>_tuple=&lt;class 'tuple'&gt;</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sympy/ntheory/multinomial.html#multinomial_coefficients_iterator"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#sympy.ntheory.multinomial.multinomial_coefficients_iterator" title="Permalink to this definition">¶</a></dt>
<dd><p>multinomial coefficient iterator</p>
<p>This routine has been optimized for <span class="math">\(m\)</span> large with respect to <span class="math">\(n\)</span> by taking
advantage of the fact that when the monomial tuples <span class="math">\(t\)</span> are stripped of
zeros, their coefficient is the same as that of the monomial tuples from
<code class="docutils literal"><span class="pre">multinomial_coefficients(n,</span> <span class="pre">n)</span></code>. Therefore, the latter coefficients are
precomputed to save memory and time.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sympy.ntheory.multinomial</span> <span class="k">import</span> <span class="n">multinomial_coefficients</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">m53</span><span class="p">,</span> <span class="n">m33</span> <span class="o">=</span> <span class="n">multinomial_coefficients</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="mi">3</span><span class="p">),</span> <span class="n">multinomial_coefficients</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">m53</span><span class="p">[(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">)]</span> <span class="o">==</span> <span class="n">m53</span><span class="p">[(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">)]</span> <span class="o">==</span> <span class="n">m53</span><span class="p">[(</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">)]</span> <span class="o">==</span> <span class="n">m33</span><span class="p">[(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">)]</span>
<span class="go">True</span>
</pre></div>
</div>
<p class="rubric">Examples</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sympy.ntheory.multinomial</span> <span class="k">import</span> <span class="n">multinomial_coefficients_iterator</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">it</span> <span class="o">=</span> <span class="n">multinomial_coefficients_iterator</span><span class="p">(</span><span class="mi">20</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">next</span><span class="p">(</span><span class="n">it</span><span class="p">)</span>
<span class="go">((3, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0), 1)</span>
</pre></div>
</div>
</dd></dl>

<span class="target" id="module-sympy.ntheory.partitions_"></span><dl class="function">
<dt id="sympy.ntheory.partitions_.npartitions">
<code class="descclassname">sympy.ntheory.partitions_.</code><code class="descname">npartitions</code><span class="sig-paren">(</span><em>n</em>, <em>verbose=False</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sympy/ntheory/partitions_.html#npartitions"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#sympy.ntheory.partitions_.npartitions" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate the partition function P(n), i.e. the number of ways that
n can be written as a sum of positive integers.</p>
<p>P(n) is computed using the Hardy-Ramanujan-Rademacher formula <a class="reference internal" href="#r406" id="id14">[R406]</a>.</p>
<p>The correctness of this implementation has been tested through 10**10.</p>
<p class="rubric">References</p>
<table class="docutils citation" frame="void" id="r406" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label">[R406]</td><td><em>(<a class="fn-backref" href="#id14">1</a>, <a class="fn-backref" href="#id15">2</a>)</em> <a class="reference external" href="http://mathworld.wolfram.com/PartitionFunctionP.html">http://mathworld.wolfram.com/PartitionFunctionP.html</a></td></tr>
</tbody>
</table>
<p class="rubric">Examples</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sympy.ntheory</span> <span class="k">import</span> <span class="n">npartitions</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">npartitions</span><span class="p">(</span><span class="mi">25</span><span class="p">)</span>
<span class="go">1958</span>
</pre></div>
</div>
</dd></dl>

<span class="target" id="module-sympy.ntheory.primetest"></span><dl class="function">
<dt id="sympy.ntheory.primetest.mr">
<code class="descclassname">sympy.ntheory.primetest.</code><code class="descname">mr</code><span class="sig-paren">(</span><em>n</em>, <em>bases</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sympy/ntheory/primetest.html#mr"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#sympy.ntheory.primetest.mr" title="Permalink to this definition">¶</a></dt>
<dd><p>Perform a Miller-Rabin strong pseudoprime test on n using a
given list of bases/witnesses.</p>
<p class="rubric">References</p>
<ul class="simple">
<li>Richard Crandall &amp; Carl Pomerance (2005), “Prime Numbers:
A Computational Perspective”, Springer, 2nd edition, 135-138</li>
</ul>
<p>A list of thresholds and the bases they require are here:
<a class="reference external" href="http://en.wikipedia.org/wiki/Miller%E2%80%93Rabin_primality_test#Deterministic_variants_of_the_test">http://en.wikipedia.org/wiki/Miller%E2%80%93Rabin_primality_test#Deterministic_variants_of_the_test</a></p>
<p class="rubric">Examples</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sympy.ntheory.primetest</span> <span class="k">import</span> <span class="n">mr</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mr</span><span class="p">(</span><span class="mi">1373651</span><span class="p">,</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">])</span>
<span class="go">False</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mr</span><span class="p">(</span><span class="mi">479001599</span><span class="p">,</span> <span class="p">[</span><span class="mi">31</span><span class="p">,</span> <span class="mi">73</span><span class="p">])</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="sympy.ntheory.primetest.isprime">
<code class="descclassname">sympy.ntheory.primetest.</code><code class="descname">isprime</code><span class="sig-paren">(</span><em>n</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sympy/ntheory/primetest.html#isprime"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#sympy.ntheory.primetest.isprime" title="Permalink to this definition">¶</a></dt>
<dd><p>Test if n is a prime number (True) or not (False). For n &lt; 2^64 the
answer is definitive; larger n values have a small probability of actually
being pseudoprimes.</p>
<p>Negative numbers (e.g. -2) are not considered prime.</p>
<p>The first step is looking for trivial factors, which if found enables
a quick return.  Next, if the sieve is large enough, use bisection search
on the sieve.  For small numbers, a set of deterministic Miller-Rabin
tests are performed with bases that are known to have no counterexamples
in their range.  Finally if the number is larger than 2^64, a strong
BPSW test is performed.  While this is a probable prime test and we
believe counterexamples exist, there are no known counterexamples.</p>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<dl class="last docutils">
<dt><a class="reference internal" href="#sympy.ntheory.generate.primerange" title="sympy.ntheory.generate.primerange"><code class="xref py py-obj docutils literal"><span class="pre">sympy.ntheory.generate.primerange</span></code></a></dt>
<dd>Generates all primes in a given range</dd>
<dt><a class="reference internal" href="#sympy.ntheory.generate.primepi" title="sympy.ntheory.generate.primepi"><code class="xref py py-obj docutils literal"><span class="pre">sympy.ntheory.generate.primepi</span></code></a></dt>
<dd>Return the number of primes less than or equal to n</dd>
<dt><a class="reference internal" href="#sympy.ntheory.generate.prime" title="sympy.ntheory.generate.prime"><code class="xref py py-obj docutils literal"><span class="pre">sympy.ntheory.generate.prime</span></code></a></dt>
<dd>Return the nth prime</dd>
</dl>
</div>
<p class="rubric">References</p>
<ul class="simple">
<li><a class="reference external" href="http://en.wikipedia.org/wiki/Strong_pseudoprime">http://en.wikipedia.org/wiki/Strong_pseudoprime</a></li>
<li>“Lucas Pseudoprimes”, Baillie and Wagstaff, 1980.
<a class="reference external" href="http://mpqs.free.fr/LucasPseudoprimes.pdf">http://mpqs.free.fr/LucasPseudoprimes.pdf</a></li>
<li><a class="reference external" href="https://en.wikipedia.org/wiki/Baillie-PSW_primality_test">https://en.wikipedia.org/wiki/Baillie-PSW_primality_test</a></li>
</ul>
<p class="rubric">Examples</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sympy.ntheory</span> <span class="k">import</span> <span class="n">isprime</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">isprime</span><span class="p">(</span><span class="mi">13</span><span class="p">)</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">isprime</span><span class="p">(</span><span class="mi">15</span><span class="p">)</span>
<span class="go">False</span>
</pre></div>
</div>
</dd></dl>

<span class="target" id="module-sympy.ntheory.residue_ntheory"></span><dl class="function">
<dt id="sympy.ntheory.residue_ntheory.n_order">
<code class="descclassname">sympy.ntheory.residue_ntheory.</code><code class="descname">n_order</code><span class="sig-paren">(</span><em>a</em>, <em>n</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sympy/ntheory/residue_ntheory.html#n_order"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#sympy.ntheory.residue_ntheory.n_order" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the order of <code class="docutils literal"><span class="pre">a</span></code> modulo <code class="docutils literal"><span class="pre">n</span></code>.</p>
<p>The order of <code class="docutils literal"><span class="pre">a</span></code> modulo <code class="docutils literal"><span class="pre">n</span></code> is the smallest integer
<code class="docutils literal"><span class="pre">k</span></code> such that <code class="docutils literal"><span class="pre">a**k</span></code> leaves a remainder of 1 with <code class="docutils literal"><span class="pre">n</span></code>.</p>
<p class="rubric">Examples</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sympy.ntheory</span> <span class="k">import</span> <span class="n">n_order</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">n_order</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">7</span><span class="p">)</span>
<span class="go">6</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">n_order</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">7</span><span class="p">)</span>
<span class="go">3</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="sympy.ntheory.residue_ntheory.is_primitive_root">
<code class="descclassname">sympy.ntheory.residue_ntheory.</code><code class="descname">is_primitive_root</code><span class="sig-paren">(</span><em>a</em>, <em>p</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sympy/ntheory/residue_ntheory.html#is_primitive_root"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#sympy.ntheory.residue_ntheory.is_primitive_root" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns True if <code class="docutils literal"><span class="pre">a</span></code> is a primitive root of <code class="docutils literal"><span class="pre">p</span></code></p>
<p><code class="docutils literal"><span class="pre">a</span></code> is said to be the primitive root of <code class="docutils literal"><span class="pre">p</span></code> if gcd(a, p) == 1 and
totient(p) is the smallest positive number s.t.</p>
<blockquote>
<div>a**totient(p) cong 1 mod(p)</div></blockquote>
<p class="rubric">Examples</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sympy.ntheory</span> <span class="k">import</span> <span class="n">is_primitive_root</span><span class="p">,</span> <span class="n">n_order</span><span class="p">,</span> <span class="n">totient</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">is_primitive_root</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">is_primitive_root</span><span class="p">(</span><span class="mi">9</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
<span class="go">False</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">n_order</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span> <span class="o">==</span> <span class="n">totient</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">n_order</span><span class="p">(</span><span class="mi">9</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span> <span class="o">==</span> <span class="n">totient</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
<span class="go">False</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="sympy.ntheory.residue_ntheory.primitive_root">
<code class="descclassname">sympy.ntheory.residue_ntheory.</code><code class="descname">primitive_root</code><span class="sig-paren">(</span><em>p</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sympy/ntheory/residue_ntheory.html#primitive_root"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#sympy.ntheory.residue_ntheory.primitive_root" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the smallest primitive root or None</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>p</strong> : positive integer</td>
</tr>
</tbody>
</table>
<p class="rubric">References</p>
<table class="docutils citation" frame="void" id="r407" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id16">[R407]</a></td><td><ol class="first last upperalpha simple" start="23">
<li>Stein “Elementary Number Theory” (2011), page 44</li>
</ol>
</td></tr>
</tbody>
</table>
<table class="docutils citation" frame="void" id="r408" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id17">[R408]</a></td><td><ol class="first last upperalpha simple" start="16">
<li>Hackman “Elementary Number Theory” (2009), Chapter C</li>
</ol>
</td></tr>
</tbody>
</table>
<p class="rubric">Examples</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sympy.ntheory.residue_ntheory</span> <span class="k">import</span> <span class="n">primitive_root</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">primitive_root</span><span class="p">(</span><span class="mi">19</span><span class="p">)</span>
<span class="go">2</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="sympy.ntheory.residue_ntheory.sqrt_mod">
<code class="descclassname">sympy.ntheory.residue_ntheory.</code><code class="descname">sqrt_mod</code><span class="sig-paren">(</span><em>a</em>, <em>p</em>, <em>all_roots=False</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sympy/ntheory/residue_ntheory.html#sqrt_mod"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#sympy.ntheory.residue_ntheory.sqrt_mod" title="Permalink to this definition">¶</a></dt>
<dd><p>Find a root of <code class="docutils literal"><span class="pre">x**2</span> <span class="pre">=</span> <span class="pre">a</span> <span class="pre">mod</span> <span class="pre">p</span></code></p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>a</strong> : integer</p>
<p><strong>p</strong> : positive integer</p>
<p class="last"><strong>all_roots</strong> : if True the list of roots is returned or None</p>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Notes</p>
<p>If there is no root it is returned None; else the returned root
is less or equal to <code class="docutils literal"><span class="pre">p</span> <span class="pre">//</span> <span class="pre">2</span></code>; in general is not the smallest one.
It is returned <code class="docutils literal"><span class="pre">p</span> <span class="pre">//</span> <span class="pre">2</span></code> only if it is the only root.</p>
<p>Use <code class="docutils literal"><span class="pre">all_roots</span></code> only when it is expected that all the roots fit
in memory; otherwise use <code class="docutils literal"><span class="pre">sqrt_mod_iter</span></code>.</p>
<p class="rubric">Examples</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sympy.ntheory</span> <span class="k">import</span> <span class="n">sqrt_mod</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sqrt_mod</span><span class="p">(</span><span class="mi">11</span><span class="p">,</span> <span class="mi">43</span><span class="p">)</span>
<span class="go">21</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sqrt_mod</span><span class="p">(</span><span class="mi">17</span><span class="p">,</span> <span class="mi">32</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span>
<span class="go">[7, 9, 23, 25]</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="sympy.ntheory.residue_ntheory.quadratic_residues">
<code class="descclassname">sympy.ntheory.residue_ntheory.</code><code class="descname">quadratic_residues</code><span class="sig-paren">(</span><em>p</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sympy/ntheory/residue_ntheory.html#quadratic_residues"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#sympy.ntheory.residue_ntheory.quadratic_residues" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the list of quadratic residues.</p>
<p class="rubric">Examples</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sympy.ntheory.residue_ntheory</span> <span class="k">import</span> <span class="n">quadratic_residues</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">quadratic_residues</span><span class="p">(</span><span class="mi">7</span><span class="p">)</span>
<span class="go">[0, 1, 2, 4]</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="sympy.ntheory.residue_ntheory.nthroot_mod">
<code class="descclassname">sympy.ntheory.residue_ntheory.</code><code class="descname">nthroot_mod</code><span class="sig-paren">(</span><em>a</em>, <em>n</em>, <em>p</em>, <em>all_roots=False</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sympy/ntheory/residue_ntheory.html#nthroot_mod"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#sympy.ntheory.residue_ntheory.nthroot_mod" title="Permalink to this definition">¶</a></dt>
<dd><p>Find the solutions to <code class="docutils literal"><span class="pre">x**n</span> <span class="pre">=</span> <span class="pre">a</span> <span class="pre">mod</span> <span class="pre">p</span></code></p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>a</strong> : integer</p>
<p><strong>n</strong> : positive integer</p>
<p><strong>p</strong> : positive integer</p>
<p class="last"><strong>all_roots</strong> : if False returns the smallest root, else the list of roots</p>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Examples</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sympy.ntheory.residue_ntheory</span> <span class="k">import</span> <span class="n">nthroot_mod</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">nthroot_mod</span><span class="p">(</span><span class="mi">11</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">19</span><span class="p">)</span>
<span class="go">8</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">nthroot_mod</span><span class="p">(</span><span class="mi">11</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">19</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span>
<span class="go">[8, 11]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">nthroot_mod</span><span class="p">(</span><span class="mi">68</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">109</span><span class="p">)</span>
<span class="go">23</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="sympy.ntheory.residue_ntheory.is_nthpow_residue">
<code class="descclassname">sympy.ntheory.residue_ntheory.</code><code class="descname">is_nthpow_residue</code><span class="sig-paren">(</span><em>a</em>, <em>n</em>, <em>m</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sympy/ntheory/residue_ntheory.html#is_nthpow_residue"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#sympy.ntheory.residue_ntheory.is_nthpow_residue" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns True if <code class="docutils literal"><span class="pre">x**n</span> <span class="pre">==</span> <span class="pre">a</span> <span class="pre">(mod</span> <span class="pre">m)</span></code> has solutions.</p>
<p class="rubric">References</p>
<table class="docutils citation" frame="void" id="r409" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id18">[R409]</a></td><td><ol class="first last upperalpha simple" start="16">
<li>Hackman “Elementary Number Theory” (2009), page 76</li>
</ol>
</td></tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="sympy.ntheory.residue_ntheory.is_quad_residue">
<code class="descclassname">sympy.ntheory.residue_ntheory.</code><code class="descname">is_quad_residue</code><span class="sig-paren">(</span><em>a</em>, <em>p</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sympy/ntheory/residue_ntheory.html#is_quad_residue"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#sympy.ntheory.residue_ntheory.is_quad_residue" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns True if <code class="docutils literal"><span class="pre">a</span></code> (mod <code class="docutils literal"><span class="pre">p</span></code>) is in the set of squares mod <code class="docutils literal"><span class="pre">p</span></code>,
i.e a % p in set([i**2 % p for i in range(p)]). If <code class="docutils literal"><span class="pre">p</span></code> is an odd
prime, an iterative method is used to make the determination:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sympy.ntheory</span> <span class="k">import</span> <span class="n">is_quad_residue</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">sorted</span><span class="p">(</span><span class="nb">set</span><span class="p">([</span><span class="n">i</span><span class="o">**</span><span class="mi">2</span> <span class="o">%</span> <span class="mi">7</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">7</span><span class="p">)]))</span>
<span class="go">[0, 1, 2, 4]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">[</span><span class="n">j</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">7</span><span class="p">)</span> <span class="k">if</span> <span class="n">is_quad_residue</span><span class="p">(</span><span class="n">j</span><span class="p">,</span> <span class="mi">7</span><span class="p">)]</span>
<span class="go">[0, 1, 2, 4]</span>
</pre></div>
</div>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<p class="last"><a class="reference internal" href="#sympy.ntheory.residue_ntheory.legendre_symbol" title="sympy.ntheory.residue_ntheory.legendre_symbol"><code class="xref py py-obj docutils literal"><span class="pre">legendre_symbol</span></code></a>, <a class="reference internal" href="#sympy.ntheory.residue_ntheory.jacobi_symbol" title="sympy.ntheory.residue_ntheory.jacobi_symbol"><code class="xref py py-obj docutils literal"><span class="pre">jacobi_symbol</span></code></a></p>
</div>
</dd></dl>

<dl class="function">
<dt id="sympy.ntheory.residue_ntheory.legendre_symbol">
<code class="descclassname">sympy.ntheory.residue_ntheory.</code><code class="descname">legendre_symbol</code><span class="sig-paren">(</span><em>a</em>, <em>p</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sympy/ntheory/residue_ntheory.html#legendre_symbol"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#sympy.ntheory.residue_ntheory.legendre_symbol" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the Legendre symbol <span class="math">\((a / p)\)</span>.</p>
<p>For an integer <code class="docutils literal"><span class="pre">a</span></code> and an odd prime <code class="docutils literal"><span class="pre">p</span></code>, the Legendre symbol is
defined as</p>
<div class="math">
\[\begin{split}\genfrac(){}{}{a}{p} = \begin{cases}
     0 &amp; \text{if } p \text{ divides } a\\
     1 &amp; \text{if } a \text{ is a quadratic residue modulo } p\\
    -1 &amp; \text{if } a \text{ is a quadratic nonresidue modulo } p
\end{cases}\end{split}\]</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>a</strong> : integer</p>
<p class="last"><strong>p</strong> : odd prime</p>
</td>
</tr>
</tbody>
</table>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<p class="last"><a class="reference internal" href="#sympy.ntheory.residue_ntheory.is_quad_residue" title="sympy.ntheory.residue_ntheory.is_quad_residue"><code class="xref py py-obj docutils literal"><span class="pre">is_quad_residue</span></code></a>, <a class="reference internal" href="#sympy.ntheory.residue_ntheory.jacobi_symbol" title="sympy.ntheory.residue_ntheory.jacobi_symbol"><code class="xref py py-obj docutils literal"><span class="pre">jacobi_symbol</span></code></a></p>
</div>
<p class="rubric">Examples</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sympy.ntheory</span> <span class="k">import</span> <span class="n">legendre_symbol</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">[</span><span class="n">legendre_symbol</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="mi">7</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">7</span><span class="p">)]</span>
<span class="go">[0, 1, 1, -1, 1, -1, -1]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">sorted</span><span class="p">(</span><span class="nb">set</span><span class="p">([</span><span class="n">i</span><span class="o">**</span><span class="mi">2</span> <span class="o">%</span> <span class="mi">7</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">7</span><span class="p">)]))</span>
<span class="go">[0, 1, 2, 4]</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="sympy.ntheory.residue_ntheory.jacobi_symbol">
<code class="descclassname">sympy.ntheory.residue_ntheory.</code><code class="descname">jacobi_symbol</code><span class="sig-paren">(</span><em>m</em>, <em>n</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sympy/ntheory/residue_ntheory.html#jacobi_symbol"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#sympy.ntheory.residue_ntheory.jacobi_symbol" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the Jacobi symbol <span class="math">\((m / n)\)</span>.</p>
<p>For any integer <code class="docutils literal"><span class="pre">m</span></code> and any positive odd integer <code class="docutils literal"><span class="pre">n</span></code> the Jacobi symbol
is defined as the product of the Legendre symbols corresponding to the
prime factors of <code class="docutils literal"><span class="pre">n</span></code>:</p>
<div class="math">
\[\genfrac(){}{}{m}{n} =
    \genfrac(){}{}{m}{p^{1}}^{\alpha_1}
    \genfrac(){}{}{m}{p^{2}}^{\alpha_2}
    ...
    \genfrac(){}{}{m}{p^{k}}^{\alpha_k}
    \text{ where } n =
        p_1^{\alpha_1}
        p_2^{\alpha_2}
        ...
        p_k^{\alpha_k}\]</div>
<p>Like the Legendre symbol, if the Jacobi symbol <span class="math">\(\genfrac(){}{}{m}{n} = -1\)</span>
then <code class="docutils literal"><span class="pre">m</span></code> is a quadratic nonresidue modulo <code class="docutils literal"><span class="pre">n</span></code>.</p>
<p>But, unlike the Legendre symbol, if the Jacobi symbol
<span class="math">\(\genfrac(){}{}{m}{n} = 1\)</span> then <code class="docutils literal"><span class="pre">m</span></code> may or may not be a quadratic residue
modulo <code class="docutils literal"><span class="pre">n</span></code>.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>m</strong> : integer</p>
<p class="last"><strong>n</strong> : odd positive integer</p>
</td>
</tr>
</tbody>
</table>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<p class="last"><a class="reference internal" href="#sympy.ntheory.residue_ntheory.is_quad_residue" title="sympy.ntheory.residue_ntheory.is_quad_residue"><code class="xref py py-obj docutils literal"><span class="pre">is_quad_residue</span></code></a>, <a class="reference internal" href="#sympy.ntheory.residue_ntheory.legendre_symbol" title="sympy.ntheory.residue_ntheory.legendre_symbol"><code class="xref py py-obj docutils literal"><span class="pre">legendre_symbol</span></code></a></p>
</div>
<p class="rubric">Examples</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sympy.ntheory</span> <span class="k">import</span> <span class="n">jacobi_symbol</span><span class="p">,</span> <span class="n">legendre_symbol</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sympy</span> <span class="k">import</span> <span class="n">Mul</span><span class="p">,</span> <span class="n">S</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">jacobi_symbol</span><span class="p">(</span><span class="mi">45</span><span class="p">,</span> <span class="mi">77</span><span class="p">)</span>
<span class="go">-1</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">jacobi_symbol</span><span class="p">(</span><span class="mi">60</span><span class="p">,</span> <span class="mi">121</span><span class="p">)</span>
<span class="go">1</span>
</pre></div>
</div>
<p>The relationship between the <code class="docutils literal"><span class="pre">jacobi_symbol</span></code> and <code class="docutils literal"><span class="pre">legendre_symbol</span></code> can
be demonstrated as follows:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">L</span> <span class="o">=</span> <span class="n">legendre_symbol</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">S</span><span class="p">(</span><span class="mi">45</span><span class="p">)</span><span class="o">.</span><span class="n">factors</span><span class="p">()</span>
<span class="go">{3: 2, 5: 1}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">jacobi_symbol</span><span class="p">(</span><span class="mi">7</span><span class="p">,</span> <span class="mi">45</span><span class="p">)</span> <span class="o">==</span> <span class="n">L</span><span class="p">(</span><span class="mi">7</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span> <span class="o">*</span> <span class="n">L</span><span class="p">(</span><span class="mi">7</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span><span class="o">**</span><span class="mi">1</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="sympy.ntheory.residue_ntheory.discrete_log">
<code class="descclassname">sympy.ntheory.residue_ntheory.</code><code class="descname">discrete_log</code><span class="sig-paren">(</span><em>n</em>, <em>a</em>, <em>b</em>, <em>order=None</em>, <em>prime_order=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sympy/ntheory/residue_ntheory.html#discrete_log"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#sympy.ntheory.residue_ntheory.discrete_log" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the discrete logarithm of <code class="docutils literal"><span class="pre">a</span></code> to the base <code class="docutils literal"><span class="pre">b</span></code> modulo <code class="docutils literal"><span class="pre">n</span></code>.</p>
<p>This is a recursive function to reduce the discrete logarithm problem in
cyclic groups of composite order to the problem in cyclic groups of prime
order.</p>
<p>It employs different algorithms depending on the problem (subgroup order
size, prime order or not):</p>
<blockquote>
<div><ul class="simple">
<li>Trial multiplication</li>
<li>Baby-step giant-step</li>
<li>Pollard’s Rho</li>
<li>Pohlig-Hellman</li>
</ul>
</div></blockquote>
<p class="rubric">References</p>
<table class="docutils citation" frame="void" id="r410" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id19">[R410]</a></td><td><a class="reference external" href="http://mathworld.wolfram.com/DiscreteLogarithm.html">http://mathworld.wolfram.com/DiscreteLogarithm.html</a></td></tr>
</tbody>
</table>
<table class="docutils citation" frame="void" id="r411" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id20">[R411]</a></td><td>“Handbook of applied cryptography”, Menezes, A. J., Van, O. P. C., &amp;
Vanstone, S. A. (1997).</td></tr>
</tbody>
</table>
<p class="rubric">Examples</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sympy.ntheory</span> <span class="k">import</span> <span class="n">discrete_log</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">discrete_log</span><span class="p">(</span><span class="mi">41</span><span class="p">,</span> <span class="mi">15</span><span class="p">,</span> <span class="mi">7</span><span class="p">)</span>
<span class="go">3</span>
</pre></div>
</div>
</dd></dl>

<span class="target" id="module-sympy.ntheory.continued_fraction"></span><dl class="function">
<dt id="sympy.ntheory.continued_fraction.continued_fraction_convergents">
<code class="descclassname">sympy.ntheory.continued_fraction.</code><code class="descname">continued_fraction_convergents</code><span class="sig-paren">(</span><em>cf</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sympy/ntheory/continued_fraction.html#continued_fraction_convergents"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#sympy.ntheory.continued_fraction.continued_fraction_convergents" title="Permalink to this definition">¶</a></dt>
<dd><p>Return an iterator over the convergents of a continued fraction (cf).</p>
<p>The parameter should be an iterable returning successive
partial quotients of the continued fraction, such as might be
returned by continued_fraction_iterator.  In computing the
convergents, the continued fraction need not be strictly in
canonical form (all integers, all but the first positive).
Rational and negative elements may be present in the expansion.</p>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<p class="last"><a class="reference internal" href="#sympy.ntheory.continued_fraction.continued_fraction_iterator" title="sympy.ntheory.continued_fraction.continued_fraction_iterator"><code class="xref py py-obj docutils literal"><span class="pre">continued_fraction_iterator</span></code></a></p>
</div>
<p class="rubric">Examples</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sympy.core</span> <span class="k">import</span> <span class="n">Rational</span><span class="p">,</span> <span class="n">pi</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sympy</span> <span class="k">import</span> <span class="n">S</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sympy.ntheory.continued_fraction</span> <span class="k">import</span>             <span class="n">continued_fraction_convergents</span><span class="p">,</span> <span class="n">continued_fraction_iterator</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">list</span><span class="p">(</span><span class="n">continued_fraction_convergents</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">]))</span>
<span class="go">[0, 1/2, 1/3, 3/8]</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">list</span><span class="p">(</span><span class="n">continued_fraction_convergents</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="n">S</span><span class="p">(</span><span class="s1">&#39;1/2&#39;</span><span class="p">),</span> <span class="o">-</span><span class="mi">7</span><span class="p">,</span> <span class="n">S</span><span class="p">(</span><span class="s1">&#39;1/4&#39;</span><span class="p">)]))</span>
<span class="go">[1, 3, 19/5, 7]</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">it</span> <span class="o">=</span> <span class="n">continued_fraction_convergents</span><span class="p">(</span><span class="n">continued_fraction_iterator</span><span class="p">(</span><span class="n">pi</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">7</span><span class="p">):</span>
<span class="gp">... </span>    <span class="nb">print</span><span class="p">(</span><span class="nb">next</span><span class="p">(</span><span class="n">it</span><span class="p">))</span>
<span class="go">3</span>
<span class="go">22/7</span>
<span class="go">333/106</span>
<span class="go">355/113</span>
<span class="go">103993/33102</span>
<span class="go">104348/33215</span>
<span class="go">208341/66317</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="sympy.ntheory.continued_fraction.continued_fraction_iterator">
<code class="descclassname">sympy.ntheory.continued_fraction.</code><code class="descname">continued_fraction_iterator</code><span class="sig-paren">(</span><em>x</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sympy/ntheory/continued_fraction.html#continued_fraction_iterator"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#sympy.ntheory.continued_fraction.continued_fraction_iterator" title="Permalink to this definition">¶</a></dt>
<dd><p>Return continued fraction expansion of x as iterator.</p>
<p class="rubric">References</p>
<table class="docutils citation" frame="void" id="r412" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id21">[R412]</a></td><td><a class="reference external" href="http://en.wikipedia.org/wiki/Continued_fraction">http://en.wikipedia.org/wiki/Continued_fraction</a></td></tr>
</tbody>
</table>
<p class="rubric">Examples</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sympy.core</span> <span class="k">import</span> <span class="n">Rational</span><span class="p">,</span> <span class="n">pi</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sympy.ntheory.continued_fraction</span> <span class="k">import</span> <span class="n">continued_fraction_iterator</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">list</span><span class="p">(</span><span class="n">continued_fraction_iterator</span><span class="p">(</span><span class="n">Rational</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">8</span><span class="p">)))</span>
<span class="go">[0, 2, 1, 2]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">list</span><span class="p">(</span><span class="n">continued_fraction_iterator</span><span class="p">(</span><span class="n">Rational</span><span class="p">(</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span> <span class="mi">8</span><span class="p">)))</span>
<span class="go">[-1, 1, 1, 1, 2]</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">continued_fraction_iterator</span><span class="p">(</span><span class="n">pi</span><span class="p">)):</span>
<span class="gp">... </span>    <span class="k">if</span> <span class="n">i</span> <span class="o">&gt;</span> <span class="mi">7</span><span class="p">:</span>
<span class="gp">... </span>        <span class="k">break</span>
<span class="gp">... </span>    <span class="nb">print</span><span class="p">(</span><span class="n">v</span><span class="p">)</span>
<span class="go">3</span>
<span class="go">7</span>
<span class="go">15</span>
<span class="go">1</span>
<span class="go">292</span>
<span class="go">1</span>
<span class="go">1</span>
<span class="go">1</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="sympy.ntheory.continued_fraction.continued_fraction_periodic">
<code class="descclassname">sympy.ntheory.continued_fraction.</code><code class="descname">continued_fraction_periodic</code><span class="sig-paren">(</span><em>p</em>, <em>q</em>, <em>d=0</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sympy/ntheory/continued_fraction.html#continued_fraction_periodic"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#sympy.ntheory.continued_fraction.continued_fraction_periodic" title="Permalink to this definition">¶</a></dt>
<dd><p>Find the periodic continued fraction expansion of a quadratic irrational.</p>
<p>Compute the continued fraction expansion of a rational or a
quadratic irrational number, i.e. <span class="math">\(\frac{p + \sqrt{d}}{q}\)</span>, where
<span class="math">\(p\)</span>, <span class="math">\(q\)</span> and <span class="math">\(d \ge 0\)</span> are integers.</p>
<p>Returns the continued fraction representation (canonical form) as
a list of integers, optionally ending (for quadratic irrationals)
with repeating block as the last term of this list.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>p</strong> : int</p>
<blockquote>
<div><p>the rational part of the number’s numerator</p>
</div></blockquote>
<p><strong>q</strong> : int</p>
<blockquote>
<div><p>the denominator of the number</p>
</div></blockquote>
<p><strong>d</strong> : int, optional</p>
<blockquote class="last">
<div><p>the irrational part (discriminator) of the number’s numerator</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<p class="last"><a class="reference internal" href="#sympy.ntheory.continued_fraction.continued_fraction_iterator" title="sympy.ntheory.continued_fraction.continued_fraction_iterator"><code class="xref py py-obj docutils literal"><span class="pre">continued_fraction_iterator</span></code></a>, <a class="reference internal" href="#sympy.ntheory.continued_fraction.continued_fraction_reduce" title="sympy.ntheory.continued_fraction.continued_fraction_reduce"><code class="xref py py-obj docutils literal"><span class="pre">continued_fraction_reduce</span></code></a></p>
</div>
<p class="rubric">References</p>
<table class="docutils citation" frame="void" id="r413" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id22">[R413]</a></td><td><a class="reference external" href="http://en.wikipedia.org/wiki/Periodic_continued_fraction">http://en.wikipedia.org/wiki/Periodic_continued_fraction</a></td></tr>
</tbody>
</table>
<table class="docutils citation" frame="void" id="r414" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id23">[R414]</a></td><td>K. Rosen. Elementary Number theory and its applications.
Addison-Wesley, 3 Sub edition, pages 379-381, January 1992.</td></tr>
</tbody>
</table>
<p class="rubric">Examples</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sympy.ntheory.continued_fraction</span> <span class="k">import</span> <span class="n">continued_fraction_periodic</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">continued_fraction_periodic</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">7</span><span class="p">)</span>
<span class="go">[2, [1, 4, 1, 1]]</span>
</pre></div>
</div>
<p>Golden ratio has the simplest continued fraction expansion:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">continued_fraction_periodic</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>
<span class="go">[[1]]</span>
</pre></div>
</div>
<p>If the discriminator is zero or a perfect square then the number will be a
rational number:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">continued_fraction_periodic</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
<span class="go">[1, 3]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">continued_fraction_periodic</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">49</span><span class="p">)</span>
<span class="go">[3, 1, 2]</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="sympy.ntheory.continued_fraction.continued_fraction_reduce">
<code class="descclassname">sympy.ntheory.continued_fraction.</code><code class="descname">continued_fraction_reduce</code><span class="sig-paren">(</span><em>cf</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sympy/ntheory/continued_fraction.html#continued_fraction_reduce"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#sympy.ntheory.continued_fraction.continued_fraction_reduce" title="Permalink to this definition">¶</a></dt>
<dd><p>Reduce a continued fraction to a rational or quadratic irrational.</p>
<p>Compute the rational or quadratic irrational number from its
terminating or periodic continued fraction expansion.  The
continued fraction expansion (cf) should be supplied as a
terminating iterator supplying the terms of the expansion.  For
terminating continued fractions, this is equivalent to
<code class="docutils literal"><span class="pre">list(continued_fraction_convergents(cf))[-1]</span></code>, only a little more
efficient.  If the expansion has a repeating part, a list of the
repeating terms should be returned as the last element from the
iterator.  This is the format returned by
continued_fraction_periodic.</p>
<p>For quadratic irrationals, returns the largest solution found,
which is generally the one sought, if the fraction is in canonical
form (all terms positive except possibly the first).</p>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<p class="last"><a class="reference internal" href="#sympy.ntheory.continued_fraction.continued_fraction_periodic" title="sympy.ntheory.continued_fraction.continued_fraction_periodic"><code class="xref py py-obj docutils literal"><span class="pre">continued_fraction_periodic</span></code></a></p>
</div>
<p class="rubric">Examples</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sympy.ntheory.continued_fraction</span> <span class="k">import</span> <span class="n">continued_fraction_reduce</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">continued_fraction_reduce</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">])</span>
<span class="go">225/157</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">continued_fraction_reduce</span><span class="p">([</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">])</span>
<span class="go">-256/233</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">continued_fraction_reduce</span><span class="p">([</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">8</span><span class="p">])</span><span class="o">.</span><span class="n">n</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
<span class="go">2.718281835</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">continued_fraction_reduce</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">]])</span>
<span class="go">(sqrt(21) + 287)/238</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">continued_fraction_reduce</span><span class="p">([[</span><span class="mi">1</span><span class="p">]])</span>
<span class="go">1/2 + sqrt(5)/2</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sympy.ntheory.continued_fraction</span> <span class="k">import</span> <span class="n">continued_fraction_periodic</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">continued_fraction_reduce</span><span class="p">(</span><span class="n">continued_fraction_periodic</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">13</span><span class="p">))</span>
<span class="go">(sqrt(13) + 8)/5</span>
</pre></div>
</div>
</dd></dl>

<dl class="class">
<dt id="sympy.ntheory.mobius">
<em class="property">class </em><code class="descclassname">sympy.ntheory.</code><code class="descname">mobius</code><a class="reference internal" href="../_modules/sympy/ntheory/residue_ntheory.html#mobius"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#sympy.ntheory.mobius" title="Permalink to this definition">¶</a></dt>
<dd><p>Möbius function maps natural number to {-1, 0, 1}</p>
<dl class="docutils">
<dt>It is defined as follows:</dt>
<dd><ol class="first last arabic simple">
<li><span class="math">\(1\)</span> if <span class="math">\(n = 1\)</span>.</li>
<li><span class="math">\(0\)</span> if <span class="math">\(n\)</span> has a squared prime factor.</li>
<li><span class="math">\((-1)^k\)</span> if <span class="math">\(n\)</span> is a square-free positive integer with <span class="math">\(k\)</span>
number of prime factors.</li>
</ol>
</dd>
</dl>
<p>It is an important multiplicative function in number theory
and combinatorics.  It has applications in mathematical series,
algebraic number theory and also physics (Fermion operator has very
concrete realization with Möbius Function model).</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>n</strong> : positive integer</td>
</tr>
</tbody>
</table>
<p class="rubric">References</p>
<table class="docutils citation" frame="void" id="r415" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id24">[R415]</a></td><td><a class="reference external" href="http://en.wikipedia.org/wiki/M%C3%B6bius_function">http://en.wikipedia.org/wiki/M%C3%B6bius_function</a></td></tr>
</tbody>
</table>
<table class="docutils citation" frame="void" id="r416" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id25">[R416]</a></td><td>Thomas Koshy “Elementary Number Theory with Applications”</td></tr>
</tbody>
</table>
<p class="rubric">Examples</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sympy.ntheory</span> <span class="k">import</span> <span class="n">mobius</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mobius</span><span class="p">(</span><span class="mi">13</span><span class="o">*</span><span class="mi">7</span><span class="p">)</span>
<span class="go">1</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mobius</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="go">1</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mobius</span><span class="p">(</span><span class="mi">13</span><span class="o">*</span><span class="mi">7</span><span class="o">*</span><span class="mi">5</span><span class="p">)</span>
<span class="go">-1</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mobius</span><span class="p">(</span><span class="mi">13</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
<span class="go">0</span>
</pre></div>
</div>
</dd></dl>

<span class="target" id="module-sympy.ntheory.egyptian_fraction"></span><dl class="function">
<dt id="sympy.ntheory.egyptian_fraction.egyptian_fraction">
<code class="descclassname">sympy.ntheory.egyptian_fraction.</code><code class="descname">egyptian_fraction</code><span class="sig-paren">(</span><em>r</em>, <em>algorithm='Greedy'</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sympy/ntheory/egyptian_fraction.html#egyptian_fraction"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#sympy.ntheory.egyptian_fraction.egyptian_fraction" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the list of denominators of an Egyptian fraction
expansion <a class="reference internal" href="#r417" id="id26">[R417]</a> of the said rational <span class="math">\(r\)</span>.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>r</strong> : Rational</p>
<blockquote>
<div><p>a positive rational number.</p>
</div></blockquote>
<p><strong>algorithm</strong> : { “Greedy”, “Graham Jewett”, “Takenouchi”, “Golomb” }, optional</p>
<blockquote class="last">
<div><p>Denotes the algorithm to be used (the default is “Greedy”).</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<p class="last"><a class="reference internal" href="core.html#sympy.core.numbers.Rational" title="sympy.core.numbers.Rational"><code class="xref py py-obj docutils literal"><span class="pre">sympy.core.numbers.Rational</span></code></a></p>
</div>
<p class="rubric">Notes</p>
<p>Currently the following algorithms are supported:</p>
<ol class="arabic">
<li><p class="first">Greedy Algorithm</p>
<p>Also called the Fibonacci-Sylvester algorithm <a class="reference internal" href="#r418" id="id27">[R418]</a>.
At each step, extract the largest unit fraction less
than the target and replace the target with the remainder.</p>
<p>It has some distinct properties:</p>
<ol class="loweralpha simple">
<li>Given <span class="math">\(p/q\)</span> in lowest terms, generates an expansion of maximum
length <span class="math">\(p\)</span>. Even as the numerators get large, the number of
terms is seldom more than a handful.</li>
<li>Uses minimal memory.</li>
<li>The terms can blow up (standard examples of this are 5/121 and
31/311).  The denominator is at most squared at each step
(doubly-exponential growth) and typically exhibits
singly-exponential growth.</li>
</ol>
</li>
<li><p class="first">Graham Jewett Algorithm</p>
<p>The algorithm suggested by the result of Graham and Jewett.
Note that this has a tendency to blow up: the length of the
resulting expansion is always <code class="docutils literal"><span class="pre">2**(x/gcd(x,</span> <span class="pre">y))</span> <span class="pre">-</span> <span class="pre">1</span></code>.  See <a class="reference internal" href="#r419" id="id28">[R419]</a>.</p>
</li>
<li><p class="first">Takenouchi Algorithm</p>
<p>The algorithm suggested by Takenouchi (1921).
Differs from the Graham-Jewett algorithm only in the handling
of duplicates.  See <a class="reference internal" href="#r419" id="id29">[R419]</a>.</p>
</li>
<li><p class="first">Golomb’s Algorithm</p>
<p>A method given by Golumb (1962), using modular arithmetic and
inverses.  It yields the same results as a method using continued
fractions proposed by Bleicher (1972).  See <a class="reference internal" href="#r420" id="id30">[R420]</a>.</p>
</li>
</ol>
<p>If the given rational is greater than or equal to 1, a greedy algorithm
of summing the harmonic sequence 1/1 + 1/2 + 1/3 + … is used, taking
all the unit fractions of this sequence until adding one more would be
greater than the given number.  This list of denominators is prefixed
to the result from the requested algorithm used on the remainder.  For
example, if r is 8/3, using the Greedy algorithm, we get [1, 2, 3, 4,
5, 6, 7, 14, 420], where the beginning of the sequence, [1, 2, 3, 4, 5,
6, 7] is part of the harmonic sequence summing to 363/140, leaving a
remainder of 31/420, which yields [14, 420] by the Greedy algorithm.
The result of egyptian_fraction(Rational(8, 3), “Golomb”) is [1, 2, 3,
4, 5, 6, 7, 14, 574, 2788, 6460, 11590, 33062, 113820], and so on.</p>
<p class="rubric">References</p>
<table class="docutils citation" frame="void" id="r417" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label">[R417]</td><td><em>(<a class="fn-backref" href="#id26">1</a>, <a class="fn-backref" href="#id31">2</a>)</em> <a class="reference external" href="http://en.wikipedia.org/wiki/Egyptian_fraction">http://en.wikipedia.org/wiki/Egyptian_fraction</a></td></tr>
</tbody>
</table>
<table class="docutils citation" frame="void" id="r418" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label">[R418]</td><td><em>(<a class="fn-backref" href="#id27">1</a>, <a class="fn-backref" href="#id32">2</a>)</em> <a class="reference external" href="https://en.wikipedia.org/wiki/Greedy_algorithm_for_Egyptian_fractions">https://en.wikipedia.org/wiki/Greedy_algorithm_for_Egyptian_fractions</a></td></tr>
</tbody>
</table>
<table class="docutils citation" frame="void" id="r419" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label">[R419]</td><td><em>(<a class="fn-backref" href="#id28">1</a>, <a class="fn-backref" href="#id29">2</a>, <a class="fn-backref" href="#id33">3</a>)</em> <a class="reference external" href="http://www.ics.uci.edu/~eppstein/numth/egypt/conflict.html">http://www.ics.uci.edu/~eppstein/numth/egypt/conflict.html</a></td></tr>
</tbody>
</table>
<table class="docutils citation" frame="void" id="r420" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label">[R420]</td><td><em>(<a class="fn-backref" href="#id30">1</a>, <a class="fn-backref" href="#id34">2</a>)</em> <a class="reference external" href="http://ami.ektf.hu/uploads/papers/finalpdf/AMI_42_from129to134.pdf">http://ami.ektf.hu/uploads/papers/finalpdf/AMI_42_from129to134.pdf</a></td></tr>
</tbody>
</table>
<p class="rubric">Examples</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sympy</span> <span class="k">import</span> <span class="n">Rational</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sympy.ntheory.egyptian_fraction</span> <span class="k">import</span> <span class="n">egyptian_fraction</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">egyptian_fraction</span><span class="p">(</span><span class="n">Rational</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">7</span><span class="p">))</span>
<span class="go">[3, 11, 231]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">egyptian_fraction</span><span class="p">(</span><span class="n">Rational</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">7</span><span class="p">),</span> <span class="s2">&quot;Graham Jewett&quot;</span><span class="p">)</span>
<span class="go">[7, 8, 9, 56, 57, 72, 3192]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">egyptian_fraction</span><span class="p">(</span><span class="n">Rational</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">7</span><span class="p">),</span> <span class="s2">&quot;Takenouchi&quot;</span><span class="p">)</span>
<span class="go">[4, 7, 28]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">egyptian_fraction</span><span class="p">(</span><span class="n">Rational</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">7</span><span class="p">),</span> <span class="s2">&quot;Golomb&quot;</span><span class="p">)</span>
<span class="go">[3, 15, 35]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">egyptian_fraction</span><span class="p">(</span><span class="n">Rational</span><span class="p">(</span><span class="mi">11</span><span class="p">,</span> <span class="mi">5</span><span class="p">),</span> <span class="s2">&quot;Golomb&quot;</span><span class="p">)</span>
<span class="go">[1, 2, 3, 4, 9, 234, 1118, 2580]</span>
</pre></div>
</div>
</dd></dl>

</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
            <p class="logo"><a href="../index.html">
              <img class="logo" src="../_static/sympylogo.png" alt="Logo"/>
            </a></p>
  <h3><a href="../index.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">Number Theory</a><ul>
<li><a class="reference internal" href="#ntheory-class-reference">Ntheory Class Reference</a></li>
<li><a class="reference internal" href="#ntheory-functions-reference">Ntheory Functions Reference</a></li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="combinatorics/fp_groups.html"
                        title="previous chapter">Finitely Presented Groups</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="crypto.html"
                        title="next chapter">Basic Cryptography Module</a></p>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="../_sources/modules/ntheory.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <form class="search" action="../search.html" method="get">
      <div><input type="text" name="q" /></div>
      <div><input type="submit" value="Go" /></div>
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="crypto.html" title="Basic Cryptography Module"
             >next</a> |</li>
        <li class="right" >
          <a href="combinatorics/fp_groups.html" title="Finitely Presented Groups"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../index.html">SymPy 1.1.1 documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="index.html" >SymPy Modules Reference</a> &#187;</li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; Copyright 2017 SymPy Development Team.
      Last updated on Jul 27, 2017.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.6.3.
    </div>
  </body>
</html>